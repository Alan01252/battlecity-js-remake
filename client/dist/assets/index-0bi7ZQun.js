(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();var ni=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yi(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function Yv(i){if(Object.prototype.hasOwnProperty.call(i,"__esModule"))return i;var e=i.default;if(typeof e=="function"){var t=function r(){var n=!1;try{n=this instanceof r}catch{}return n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(i).forEach(function(r){var n=Object.getOwnPropertyDescriptor(i,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return i[r]}})}),t}var pn={},zu;function zv(){return zu||(zu=1,(function(i){(function(e){var t=e.Promise,r=t&&"resolve"in t&&"reject"in t&&"all"in t&&"race"in t&&(function(){var F;return new t(function(B){F=B}),typeof F=="function"})();i?(i.Promise=r?t:H,i.Polyfill=H):r||(e.Promise=H);var n="pending",s="sealed",o="fulfilled",a="rejected",l=function(){};function u(F){return Object.prototype.toString.call(F)==="[object Array]"}var h=typeof setImmediate<"u"?setImmediate:setTimeout,f=[],c;function d(){for(var F=0;F<f.length;F++)f[F][0](f[F][1]);f=[],c=!1}function p(F,B){f.push([F,B]),c||(c=!0,h(d,0))}function m(F,B){function Y(J){I(B,J)}function D(J){M(B,J)}try{F(Y,D)}catch(J){D(J)}}function v(F){var B=F.owner,Y=B.state_,D=B.data_,J=F[Y],Q=F.then;if(typeof J=="function"){Y=o;try{D=J(D)}catch(q){M(Q,q)}}g(Q,D)||(Y===o&&I(Q,D),Y===a&&M(Q,D))}function g(F,B){var Y;try{if(F===B)throw new TypeError("A promises callback cannot return that same promise.");if(B&&(typeof B=="function"||typeof B=="object")){var D=B.then;if(typeof D=="function")return D.call(B,function(J){Y||(Y=!0,B!==J?I(F,J):w(F,J))},function(J){Y||(Y=!0,M(F,J))}),!0}}catch(J){return Y||M(F,J),!0}return!1}function I(F,B){(F===B||!g(F,B))&&w(F,B)}function w(F,B){F.state_===n&&(F.state_=s,F.data_=B,p(R,F))}function M(F,B){F.state_===n&&(F.state_=s,F.data_=B,p(C,F))}function b(F){var B=F.then_;F.then_=void 0;for(var Y=0;Y<B.length;Y++)v(B[Y])}function R(F){F.state_=o,b(F)}function C(F){F.state_=a,b(F)}function H(F){if(typeof F!="function")throw new TypeError("Promise constructor takes a function argument");if(!(this instanceof H))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],m(F,this)}H.prototype={constructor:H,state_:n,then_:null,data_:void 0,then:function(F,B){var Y={owner:this,then:new this.constructor(l),fulfilled:F,rejected:B};return this.state_===o||this.state_===a?p(v,Y):this.then_.push(Y),Y.then},catch:function(F){return this.then(null,F)}},H.all=function(F){var B=this;if(!u(F))throw new TypeError("You must pass an array to Promise.all().");return new B(function(Y,D){var J=[],Q=0;function q(y){return Q++,function(_){J[y]=_,--Q||Y(J)}}for(var A=0,O;A<F.length;A++)O=F[A],O&&typeof O.then=="function"?O.then(q(A),D):J[A]=O;Q||Y(J)})},H.race=function(F){var B=this;if(!u(F))throw new TypeError("You must pass an array to Promise.race().");return new B(function(Y,D){for(var J=0,Q;J<F.length;J++)Q=F[J],Q&&typeof Q.then=="function"?Q.then(Y,D):Y(Q)})},H.resolve=function(F){var B=this;return F&&typeof F=="object"&&F.constructor===B?F:new B(function(Y){Y(F)})},H.reject=function(F){var B=this;return new B(function(Y,D){D(F)})}})(typeof window<"u"?window:typeof ni<"u"?ni:typeof self<"u"?self:pn)})(pn)),pn}var Vv=zv();/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var zs,Vu;function qv(){if(Vu)return zs;Vu=1;var i=Object.getOwnPropertySymbols,e=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable;function r(s){if(s==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(s)}function n(){try{if(!Object.assign)return!1;var s=new String("abc");if(s[5]="de",Object.getOwnPropertyNames(s)[0]==="5")return!1;for(var o={},a=0;a<10;a++)o["_"+String.fromCharCode(a)]=a;var l=Object.getOwnPropertyNames(o).map(function(h){return o[h]});if(l.join("")!=="0123456789")return!1;var u={};return"abcdefghijklmnopqrst".split("").forEach(function(h){u[h]=h}),Object.keys(Object.assign({},u)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return zs=n()?Object.assign:function(s,o){for(var a,l=r(s),u,h=1;h<arguments.length;h++){a=Object(arguments[h]);for(var f in a)e.call(a,f)&&(l[f]=a[f]);if(i){u=i(a);for(var c=0;c<u.length;c++)t.call(a,u[c])&&(l[u[c]]=a[u[c]])}}return l},zs}var $v=qv();const jv=yi($v);/*!
 * @pixi/polyfill - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/polyfill is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */window.Promise||(window.Promise=Vv.Polyfill);Object.assign||(Object.assign=jv);var Wv=16;Date.now&&Date.prototype.getTime||(Date.now=function(){return new Date().getTime()});if(!(window.performance&&window.performance.now)){var Kv=Date.now();window.performance||(window.performance={}),window.performance.now=function(){return Date.now()-Kv}}var Vs=Date.now(),qu=["ms","moz","webkit","o"];for(var qs=0;qs<qu.length&&!window.requestAnimationFrame;++qs){var $s=qu[qs];window.requestAnimationFrame=window[$s+"RequestAnimationFrame"],window.cancelAnimationFrame=window[$s+"CancelAnimationFrame"]||window[$s+"CancelRequestAnimationFrame"]}window.requestAnimationFrame||(window.requestAnimationFrame=function(i){if(typeof i!="function")throw new TypeError(i+"is not a function");var e=Date.now(),t=Wv+Vs-e;return t<0&&(t=0),Vs=e,window.setTimeout(function(){Vs=Date.now(),i(performance.now())},t)});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(i){return clearTimeout(i)});Math.sign||(Math.sign=function(e){return e=Number(e),e===0||isNaN(e)?e:e>0?1:-1});Number.isInteger||(Number.isInteger=function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e});window.ArrayBuffer||(window.ArrayBuffer=Array);window.Float32Array||(window.Float32Array=Array);window.Uint32Array||(window.Uint32Array=Array);window.Uint16Array||(window.Uint16Array=Array);window.Uint8Array||(window.Uint8Array=Array);window.Int32Array||(window.Int32Array=Array);var js=/iPhone/i,$u=/iPod/i,ju=/iPad/i,Wu=/\biOS-universal(?:.+)Mac\b/i,Ws=/\bAndroid(?:.+)Mobile\b/i,Ku=/Android/i,Yr=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,yn=/Silk/i,Re=/Windows Phone/i,Zu=/\bWindows(?:.+)ARM\b/i,Ju=/BlackBerry/i,Qu=/BB10/i,th=/Opera Mini/i,eh=/\b(CriOS|Chrome)(?:.+)Mobile/i,rh=/Mobile(?:.+)Firefox\b/i,ih=function(i){return typeof i<"u"&&i.platform==="MacIntel"&&typeof i.maxTouchPoints=="number"&&i.maxTouchPoints>1&&typeof MSStream>"u"};function Zv(i){return function(e){return e.test(i)}}function Jv(i){var e={userAgent:"",platform:"",maxTouchPoints:0};!i&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof i=="string"?e.userAgent=i:i&&i.userAgent&&(e={userAgent:i.userAgent,platform:i.platform,maxTouchPoints:i.maxTouchPoints||0});var t=e.userAgent,r=t.split("[FBAN");typeof r[1]<"u"&&(t=r[0]),r=t.split("Twitter"),typeof r[1]<"u"&&(t=r[0]);var n=Zv(t),s={apple:{phone:n(js)&&!n(Re),ipod:n($u),tablet:!n(js)&&(n(ju)||ih(e))&&!n(Re),universal:n(Wu),device:(n(js)||n($u)||n(ju)||n(Wu)||ih(e))&&!n(Re)},amazon:{phone:n(Yr),tablet:!n(Yr)&&n(yn),device:n(Yr)||n(yn)},android:{phone:!n(Re)&&n(Yr)||!n(Re)&&n(Ws),tablet:!n(Re)&&!n(Yr)&&!n(Ws)&&(n(yn)||n(Ku)),device:!n(Re)&&(n(Yr)||n(yn)||n(Ws)||n(Ku))||n(/\bokhttp\b/i)},windows:{phone:n(Re),tablet:n(Zu),device:n(Re)||n(Zu)},other:{blackberry:n(Ju),blackberry10:n(Qu),opera:n(th),firefox:n(rh),chrome:n(eh),device:n(Ju)||n(Qu)||n(th)||n(rh)||n(eh)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}/*!
 * @pixi/settings - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ce=Jv(window.navigator);function Qv(i){var e=!0;if(ce.tablet||ce.phone){if(ce.apple.device){var t=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(t){var r=parseInt(t[1],10);r<11&&(e=!1)}}if(ce.android.device){var t=navigator.userAgent.match(/Android\s([0-9.]*)/);if(t){var r=parseInt(t[1],10);r<7&&(e=!1)}}}return e?i:4}function tm(){return!ce.apple.device}var nt={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:Qv(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:ce.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:tm(),CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},Ks={exports:{}},nh;function em(){return nh||(nh=1,(function(i){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function n(l,u,h){this.fn=l,this.context=u,this.once=h||!1}function s(l,u,h,f,c){if(typeof h!="function")throw new TypeError("The listener must be a function");var d=new n(h,f||l,c),p=t?t+u:u;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],d]:l._events[p].push(d):(l._events[p]=d,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new r:delete l._events[u]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],h,f;if(this._eventsCount===0)return u;for(f in h=this._events)e.call(h,f)&&u.push(t?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},a.prototype.listeners=function(u){var h=t?t+u:u,f=this._events[h];if(!f)return[];if(f.fn)return[f.fn];for(var c=0,d=f.length,p=new Array(d);c<d;c++)p[c]=f[c].fn;return p},a.prototype.listenerCount=function(u){var h=t?t+u:u,f=this._events[h];return f?f.fn?1:f.length:0},a.prototype.emit=function(u,h,f,c,d,p){var m=t?t+u:u;if(!this._events[m])return!1;var v=this._events[m],g=arguments.length,I,w;if(v.fn){switch(v.once&&this.removeListener(u,v.fn,void 0,!0),g){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,h),!0;case 3:return v.fn.call(v.context,h,f),!0;case 4:return v.fn.call(v.context,h,f,c),!0;case 5:return v.fn.call(v.context,h,f,c,d),!0;case 6:return v.fn.call(v.context,h,f,c,d,p),!0}for(w=1,I=new Array(g-1);w<g;w++)I[w-1]=arguments[w];v.fn.apply(v.context,I)}else{var M=v.length,b;for(w=0;w<M;w++)switch(v[w].once&&this.removeListener(u,v[w].fn,void 0,!0),g){case 1:v[w].fn.call(v[w].context);break;case 2:v[w].fn.call(v[w].context,h);break;case 3:v[w].fn.call(v[w].context,h,f);break;case 4:v[w].fn.call(v[w].context,h,f,c);break;default:if(!I)for(b=1,I=new Array(g-1);b<g;b++)I[b-1]=arguments[b];v[w].fn.apply(v[w].context,I)}}return!0},a.prototype.on=function(u,h,f){return s(this,u,h,f,!1)},a.prototype.once=function(u,h,f){return s(this,u,h,f,!0)},a.prototype.removeListener=function(u,h,f,c){var d=t?t+u:u;if(!this._events[d])return this;if(!h)return o(this,d),this;var p=this._events[d];if(p.fn)p.fn===h&&(!c||p.once)&&(!f||p.context===f)&&o(this,d);else{for(var m=0,v=[],g=p.length;m<g;m++)(p[m].fn!==h||c&&!p[m].once||f&&p[m].context!==f)&&v.push(p[m]);v.length?this._events[d]=v.length===1?v[0]:v:o(this,d)}return this},a.prototype.removeAllListeners=function(u){var h;return u?(h=t?t+u:u,this._events[h]&&o(this,h)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,i.exports=a})(Ks)),Ks.exports}var rm=em();const vi=yi(rm);var vn={exports:{}},sh;function im(){if(sh)return vn.exports;sh=1,vn.exports=i,vn.exports.default=i;function i(A,O,y){y=y||2;var _=O&&O.length,x=_?O[0]*y:A.length,T=e(A,0,x,y,!0),S=[];if(!T||T.next===T.prev)return S;var P,L,N,k,U,$,W;if(_&&(T=l(A,O,T,y)),A.length>80*y){P=N=A[0],L=k=A[1];for(var z=y;z<x;z+=y)U=A[z],$=A[z+1],U<P&&(P=U),$<L&&(L=$),U>N&&(N=U),$>k&&(k=$);W=Math.max(N-P,k-L),W=W!==0?32767/W:0}return r(T,S,y,P,L,W,0),S}function e(A,O,y,_,x){var T,S;if(x===q(A,O,y,_)>0)for(T=O;T<y;T+=_)S=D(T,A[T],A[T+1],S);else for(T=y-_;T>=O;T-=_)S=D(T,A[T],A[T+1],S);return S&&M(S,S.next)&&(J(S),S=S.next),S}function t(A,O){if(!A)return A;O||(O=A);var y=A,_;do if(_=!1,!y.steiner&&(M(y,y.next)||w(y.prev,y,y.next)===0)){if(J(y),y=O=y.prev,y===y.next)break;_=!0}else y=y.next;while(_||y!==O);return O}function r(A,O,y,_,x,T,S){if(A){!S&&T&&d(A,_,x,T);for(var P=A,L,N;A.prev!==A.next;){if(L=A.prev,N=A.next,T?s(A,_,x,T):n(A)){O.push(L.i/y|0),O.push(A.i/y|0),O.push(N.i/y|0),J(A),A=N.next,P=N.next;continue}if(A=N,A===P){S?S===1?(A=o(t(A),O,y),r(A,O,y,_,x,T,2)):S===2&&a(A,O,y,_,x,T):r(t(A),O,y,_,x,T,1);break}}}}function n(A){var O=A.prev,y=A,_=A.next;if(w(O,y,_)>=0)return!1;for(var x=O.x,T=y.x,S=_.x,P=O.y,L=y.y,N=_.y,k=x<T?x<S?x:S:T<S?T:S,U=P<L?P<N?P:N:L<N?L:N,$=x>T?x>S?x:S:T>S?T:S,W=P>L?P>N?P:N:L>N?L:N,z=_.next;z!==O;){if(z.x>=k&&z.x<=$&&z.y>=U&&z.y<=W&&g(x,P,T,L,S,N,z.x,z.y)&&w(z.prev,z,z.next)>=0)return!1;z=z.next}return!0}function s(A,O,y,_){var x=A.prev,T=A,S=A.next;if(w(x,T,S)>=0)return!1;for(var P=x.x,L=T.x,N=S.x,k=x.y,U=T.y,$=S.y,W=P<L?P<N?P:N:L<N?L:N,z=k<U?k<$?k:$:U<$?U:$,Z=P>L?P>N?P:N:L>N?L:N,j=k>U?k>$?k:$:U>$?U:$,it=m(W,z,O,y,_),at=m(Z,j,O,y,_),et=A.prevZ,rt=A.nextZ;et&&et.z>=it&&rt&&rt.z<=at;){if(et.x>=W&&et.x<=Z&&et.y>=z&&et.y<=j&&et!==x&&et!==S&&g(P,k,L,U,N,$,et.x,et.y)&&w(et.prev,et,et.next)>=0||(et=et.prevZ,rt.x>=W&&rt.x<=Z&&rt.y>=z&&rt.y<=j&&rt!==x&&rt!==S&&g(P,k,L,U,N,$,rt.x,rt.y)&&w(rt.prev,rt,rt.next)>=0))return!1;rt=rt.nextZ}for(;et&&et.z>=it;){if(et.x>=W&&et.x<=Z&&et.y>=z&&et.y<=j&&et!==x&&et!==S&&g(P,k,L,U,N,$,et.x,et.y)&&w(et.prev,et,et.next)>=0)return!1;et=et.prevZ}for(;rt&&rt.z<=at;){if(rt.x>=W&&rt.x<=Z&&rt.y>=z&&rt.y<=j&&rt!==x&&rt!==S&&g(P,k,L,U,N,$,rt.x,rt.y)&&w(rt.prev,rt,rt.next)>=0)return!1;rt=rt.nextZ}return!0}function o(A,O,y){var _=A;do{var x=_.prev,T=_.next.next;!M(x,T)&&b(x,_,_.next,T)&&F(x,T)&&F(T,x)&&(O.push(x.i/y|0),O.push(_.i/y|0),O.push(T.i/y|0),J(_),J(_.next),_=A=T),_=_.next}while(_!==A);return t(_)}function a(A,O,y,_,x,T){var S=A;do{for(var P=S.next.next;P!==S.prev;){if(S.i!==P.i&&I(S,P)){var L=Y(S,P);S=t(S,S.next),L=t(L,L.next),r(S,O,y,_,x,T,0),r(L,O,y,_,x,T,0);return}P=P.next}S=S.next}while(S!==A)}function l(A,O,y,_){var x=[],T,S,P,L,N;for(T=0,S=O.length;T<S;T++)P=O[T]*_,L=T<S-1?O[T+1]*_:A.length,N=e(A,P,L,_,!1),N===N.next&&(N.steiner=!0),x.push(v(N));for(x.sort(u),T=0;T<x.length;T++)y=h(x[T],y);return y}function u(A,O){return A.x-O.x}function h(A,O){var y=f(A,O);if(!y)return O;var _=Y(y,A);return t(_,_.next),t(y,y.next)}function f(A,O){var y=O,_=A.x,x=A.y,T=-1/0,S;do{if(x<=y.y&&x>=y.next.y&&y.next.y!==y.y){var P=y.x+(x-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(P<=_&&P>T&&(T=P,S=y.x<y.next.x?y:y.next,P===_))return S}y=y.next}while(y!==O);if(!S)return null;var L=S,N=S.x,k=S.y,U=1/0,$;y=S;do _>=y.x&&y.x>=N&&_!==y.x&&g(x<k?_:T,x,N,k,x<k?T:_,x,y.x,y.y)&&($=Math.abs(x-y.y)/(_-y.x),F(y,A)&&($<U||$===U&&(y.x>S.x||y.x===S.x&&c(S,y)))&&(S=y,U=$)),y=y.next;while(y!==L);return S}function c(A,O){return w(A.prev,A,O.prev)<0&&w(O.next,A,A.next)<0}function d(A,O,y,_){var x=A;do x.z===0&&(x.z=m(x.x,x.y,O,y,_)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next;while(x!==A);x.prevZ.nextZ=null,x.prevZ=null,p(x)}function p(A){var O,y,_,x,T,S,P,L,N=1;do{for(y=A,A=null,T=null,S=0;y;){for(S++,_=y,P=0,O=0;O<N&&(P++,_=_.nextZ,!!_);O++);for(L=N;P>0||L>0&&_;)P!==0&&(L===0||!_||y.z<=_.z)?(x=y,y=y.nextZ,P--):(x=_,_=_.nextZ,L--),T?T.nextZ=x:A=x,x.prevZ=T,T=x;y=_}T.nextZ=null,N*=2}while(S>1);return A}function m(A,O,y,_,x){return A=(A-y)*x|0,O=(O-_)*x|0,A=(A|A<<8)&16711935,A=(A|A<<4)&252645135,A=(A|A<<2)&858993459,A=(A|A<<1)&1431655765,O=(O|O<<8)&16711935,O=(O|O<<4)&252645135,O=(O|O<<2)&858993459,O=(O|O<<1)&1431655765,A|O<<1}function v(A){var O=A,y=A;do(O.x<y.x||O.x===y.x&&O.y<y.y)&&(y=O),O=O.next;while(O!==A);return y}function g(A,O,y,_,x,T,S,P){return(x-S)*(O-P)>=(A-S)*(T-P)&&(A-S)*(_-P)>=(y-S)*(O-P)&&(y-S)*(T-P)>=(x-S)*(_-P)}function I(A,O){return A.next.i!==O.i&&A.prev.i!==O.i&&!H(A,O)&&(F(A,O)&&F(O,A)&&B(A,O)&&(w(A.prev,A,O.prev)||w(A,O.prev,O))||M(A,O)&&w(A.prev,A,A.next)>0&&w(O.prev,O,O.next)>0)}function w(A,O,y){return(O.y-A.y)*(y.x-O.x)-(O.x-A.x)*(y.y-O.y)}function M(A,O){return A.x===O.x&&A.y===O.y}function b(A,O,y,_){var x=C(w(A,O,y)),T=C(w(A,O,_)),S=C(w(y,_,A)),P=C(w(y,_,O));return!!(x!==T&&S!==P||x===0&&R(A,y,O)||T===0&&R(A,_,O)||S===0&&R(y,A,_)||P===0&&R(y,O,_))}function R(A,O,y){return O.x<=Math.max(A.x,y.x)&&O.x>=Math.min(A.x,y.x)&&O.y<=Math.max(A.y,y.y)&&O.y>=Math.min(A.y,y.y)}function C(A){return A>0?1:A<0?-1:0}function H(A,O){var y=A;do{if(y.i!==A.i&&y.next.i!==A.i&&y.i!==O.i&&y.next.i!==O.i&&b(y,y.next,A,O))return!0;y=y.next}while(y!==A);return!1}function F(A,O){return w(A.prev,A,A.next)<0?w(A,O,A.next)>=0&&w(A,A.prev,O)>=0:w(A,O,A.prev)<0||w(A,A.next,O)<0}function B(A,O){var y=A,_=!1,x=(A.x+O.x)/2,T=(A.y+O.y)/2;do y.y>T!=y.next.y>T&&y.next.y!==y.y&&x<(y.next.x-y.x)*(T-y.y)/(y.next.y-y.y)+y.x&&(_=!_),y=y.next;while(y!==A);return _}function Y(A,O){var y=new Q(A.i,A.x,A.y),_=new Q(O.i,O.x,O.y),x=A.next,T=O.prev;return A.next=O,O.prev=A,y.next=x,x.prev=y,_.next=y,y.prev=_,T.next=_,_.prev=T,_}function D(A,O,y,_){var x=new Q(A,O,y);return _?(x.next=_.next,x.prev=_,_.next.prev=x,_.next=x):(x.prev=x,x.next=x),x}function J(A){A.next.prev=A.prev,A.prev.next=A.next,A.prevZ&&(A.prevZ.nextZ=A.nextZ),A.nextZ&&(A.nextZ.prevZ=A.prevZ)}function Q(A,O,y){this.i=A,this.x=O,this.y=y,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}i.deviation=function(A,O,y,_){var x=O&&O.length,T=x?O[0]*y:A.length,S=Math.abs(q(A,0,T,y));if(x)for(var P=0,L=O.length;P<L;P++){var N=O[P]*y,k=P<L-1?O[P+1]*y:A.length;S-=Math.abs(q(A,N,k,y))}var U=0;for(P=0;P<_.length;P+=3){var $=_[P]*y,W=_[P+1]*y,z=_[P+2]*y;U+=Math.abs((A[$]-A[z])*(A[W+1]-A[$+1])-(A[$]-A[W])*(A[z+1]-A[$+1]))}return S===0&&U===0?0:Math.abs((U-S)/S)};function q(A,O,y,_){for(var x=0,T=O,S=y-_;T<y;T+=_)x+=(A[S]-A[T])*(A[T+1]+A[S+1]),S=T;return x}return i.flatten=function(A){for(var O=A[0][0].length,y={vertices:[],holes:[],dimensions:O},_=0,x=0;x<A.length;x++){for(var T=0;T<A[x].length;T++)for(var S=0;S<O;S++)y.vertices.push(A[x][T][S]);x>0&&(_+=A[x-1].length,y.holes.push(_))}return y},vn.exports}var nm=im();const Fl=yi(nm);var fr={},Li={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */var sm=Li.exports,oh;function om(){return oh||(oh=1,(function(i,e){(function(t){var r=e&&!e.nodeType&&e,n=i&&!i.nodeType&&i,s=typeof ni=="object"&&ni;(s.global===s||s.window===s||s.self===s)&&(t=s);var o,a=2147483647,l=36,u=1,h=26,f=38,c=700,d=72,p=128,m="-",v=/^xn--/,g=/[^\x20-\x7E]/,I=/[\x2E\u3002\uFF0E\uFF61]/g,w={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},M=l-u,b=Math.floor,R=String.fromCharCode,C;function H(x){throw new RangeError(w[x])}function F(x,T){for(var S=x.length,P=[];S--;)P[S]=T(x[S]);return P}function B(x,T){var S=x.split("@"),P="";S.length>1&&(P=S[0]+"@",x=S[1]),x=x.replace(I,".");var L=x.split("."),N=F(L,T).join(".");return P+N}function Y(x){for(var T=[],S=0,P=x.length,L,N;S<P;)L=x.charCodeAt(S++),L>=55296&&L<=56319&&S<P?(N=x.charCodeAt(S++),(N&64512)==56320?T.push(((L&1023)<<10)+(N&1023)+65536):(T.push(L),S--)):T.push(L);return T}function D(x){return F(x,function(T){var S="";return T>65535&&(T-=65536,S+=R(T>>>10&1023|55296),T=56320|T&1023),S+=R(T),S}).join("")}function J(x){return x-48<10?x-22:x-65<26?x-65:x-97<26?x-97:l}function Q(x,T){return x+22+75*(x<26)-((T!=0)<<5)}function q(x,T,S){var P=0;for(x=S?b(x/c):x>>1,x+=b(x/T);x>M*h>>1;P+=l)x=b(x/M);return b(P+(M+1)*x/(x+f))}function A(x){var T=[],S=x.length,P,L=0,N=p,k=d,U,$,W,z,Z,j,it,at,et;for(U=x.lastIndexOf(m),U<0&&(U=0),$=0;$<U;++$)x.charCodeAt($)>=128&&H("not-basic"),T.push(x.charCodeAt($));for(W=U>0?U+1:0;W<S;){for(z=L,Z=1,j=l;W>=S&&H("invalid-input"),it=J(x.charCodeAt(W++)),(it>=l||it>b((a-L)/Z))&&H("overflow"),L+=it*Z,at=j<=k?u:j>=k+h?h:j-k,!(it<at);j+=l)et=l-at,Z>b(a/et)&&H("overflow"),Z*=et;P=T.length+1,k=q(L-z,P,z==0),b(L/P)>a-N&&H("overflow"),N+=b(L/P),L%=P,T.splice(L++,0,N)}return D(T)}function O(x){var T,S,P,L,N,k,U,$,W,z,Z,j=[],it,at,et,rt;for(x=Y(x),it=x.length,T=p,S=0,N=d,k=0;k<it;++k)Z=x[k],Z<128&&j.push(R(Z));for(P=L=j.length,L&&j.push(m);P<it;){for(U=a,k=0;k<it;++k)Z=x[k],Z>=T&&Z<U&&(U=Z);for(at=P+1,U-T>b((a-S)/at)&&H("overflow"),S+=(U-T)*at,T=U,k=0;k<it;++k)if(Z=x[k],Z<T&&++S>a&&H("overflow"),Z==T){for($=S,W=l;z=W<=N?u:W>=N+h?h:W-N,!($<z);W+=l)rt=$-z,et=l-z,j.push(R(Q(z+rt%et,0))),$=b(rt/et);j.push(R(Q($,0))),N=q(S,at,P==L),S=0,++P}++S,++T}return j.join("")}function y(x){return B(x,function(T){return v.test(T)?A(T.slice(4).toLowerCase()):T})}function _(x){return B(x,function(T){return g.test(T)?"xn--"+O(T):T})}if(o={version:"1.4.1",ucs2:{decode:Y,encode:D},decode:A,encode:O,toASCII:_,toUnicode:y},r&&n)if(i.exports==r)n.exports=o;else for(C in o)o.hasOwnProperty(C)&&(r[C]=o[C]);else t.punycode=o})(sm)})(Li,Li.exports)),Li.exports}var Zs,ah;function mi(){return ah||(ah=1,Zs=TypeError),Zs}const am={},lm=Object.freeze(Object.defineProperty({__proto__:null,default:am},Symbol.toStringTag,{value:"Module"})),um=Yv(lm);var Js,lh;function gs(){if(lh)return Js;lh=1;var i=typeof Map=="function"&&Map.prototype,e=Object.getOwnPropertyDescriptor&&i?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,t=i&&e&&typeof e.get=="function"?e.get:null,r=i&&Map.prototype.forEach,n=typeof Set=="function"&&Set.prototype,s=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,o=n&&s&&typeof s.get=="function"?s.get:null,a=n&&Set.prototype.forEach,l=typeof WeakMap=="function"&&WeakMap.prototype,u=l?WeakMap.prototype.has:null,h=typeof WeakSet=="function"&&WeakSet.prototype,f=h?WeakSet.prototype.has:null,c=typeof WeakRef=="function"&&WeakRef.prototype,d=c?WeakRef.prototype.deref:null,p=Boolean.prototype.valueOf,m=Object.prototype.toString,v=Function.prototype.toString,g=String.prototype.match,I=String.prototype.slice,w=String.prototype.replace,M=String.prototype.toUpperCase,b=String.prototype.toLowerCase,R=RegExp.prototype.test,C=Array.prototype.concat,H=Array.prototype.join,F=Array.prototype.slice,B=Math.floor,Y=typeof BigInt=="function"?BigInt.prototype.valueOf:null,D=Object.getOwnPropertySymbols,J=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Q=typeof Symbol=="function"&&typeof Symbol.iterator=="object",q=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Q||!0)?Symbol.toStringTag:null,A=Object.prototype.propertyIsEnumerable,O=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(X){return X.__proto__}:null);function y(X,G){if(X===1/0||X===-1/0||X!==X||X&&X>-1e3&&X<1e3||R.call(/e/,G))return G;var yt=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof X=="number"){var wt=X<0?-B(-X):B(X);if(wt!==X){var It=String(wt),ut=I.call(G,It.length+1);return w.call(It,yt,"$&_")+"."+w.call(w.call(ut,/([0-9]{3})/g,"$&_"),/_$/,"")}}return w.call(G,yt,"$&_")}var _=um,x=_.custom,T=at(x)?x:null,S={__proto__:null,double:'"',single:"'"},P={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};Js=function X(G,yt,wt,It){var ut=yt||{};if(xt(ut,"quoteStyle")&&!xt(S,ut.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(xt(ut,"maxStringLength")&&(typeof ut.maxStringLength=="number"?ut.maxStringLength<0&&ut.maxStringLength!==1/0:ut.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var $e=xt(ut,"customInspect")?ut.customInspect:!0;if(typeof $e!="boolean"&&$e!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(xt(ut,"indent")&&ut.indent!==null&&ut.indent!=="	"&&!(parseInt(ut.indent,10)===ut.indent&&ut.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(xt(ut,"numericSeparator")&&typeof ut.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var hr=ut.numericSeparator;if(typeof G>"u")return"undefined";if(G===null)return"null";if(typeof G=="boolean")return G?"true":"false";if(typeof G=="string")return Lu(G,ut);if(typeof G=="number"){if(G===0)return 1/0/G>0?"0":"-0";var ie=String(G);return hr?y(G,ie):ie}if(typeof G=="bigint"){var je=String(G)+"n";return hr?y(G,je):je}var Ds=typeof ut.depth>"u"?5:ut.depth;if(typeof wt>"u"&&(wt=0),wt>=Ds&&Ds>0&&typeof G=="object")return U(G)?"[Array]":"[Object]";var Hr=Xv(ut,wt);if(typeof It>"u")It=[];else if(qe(It,G)>=0)return"[Circular]";function me(Gr,dn,Gv){if(dn&&(It=F.call(It),It.push(dn)),Gv){var Yu={depth:ut.depth};return xt(ut,"quoteStyle")&&(Yu.quoteStyle=ut.quoteStyle),X(Gr,Yu,wt+1,It)}return X(Gr,ut,wt+1,It)}if(typeof G=="function"&&!W(G)){var Bu=St(G),Du=fn(G,me);return"[Function"+(Bu?": "+Bu:" (anonymous)")+"]"+(Du.length>0?" { "+H.call(Du,", ")+" }":"")}if(at(G)){var ku=Q?w.call(String(G),/^(Symbol\(.*\))_[^)]*$/,"$1"):J.call(G);return typeof G=="object"&&!Q?Ii(ku):ku}if(Dv(G)){for(var Ei="<"+b.call(String(G.nodeName)),ks=G.attributes||[],cn=0;cn<ks.length;cn++)Ei+=" "+ks[cn].name+"="+L(N(ks[cn].value),"double",ut);return Ei+=">",G.childNodes&&G.childNodes.length&&(Ei+="..."),Ei+="</"+b.call(String(G.nodeName))+">",Ei}if(U(G)){if(G.length===0)return"[]";var Us=fn(G,me);return Hr&&!Uv(Us)?"["+Bs(Us,Hr)+"]":"[ "+H.call(Us,", ")+" ]"}if(z(G)){var Xs=fn(G,me);return!("cause"in Error.prototype)&&"cause"in G&&!A.call(G,"cause")?"{ ["+String(G)+"] "+H.call(C.call("[cause]: "+me(G.cause),Xs),", ")+" }":Xs.length===0?"["+String(G)+"]":"{ ["+String(G)+"] "+H.call(Xs,", ")+" }"}if(typeof G=="object"&&$e){if(T&&typeof G[T]=="function"&&_)return _(G,{depth:Ds-wt});if($e!=="symbol"&&typeof G.inspect=="function")return G.inspect()}if(ve(G)){var Uu=[];return r&&r.call(G,function(Gr,dn){Uu.push(me(dn,G,!0)+" => "+me(Gr,G))}),Nu("Map",t.call(G),Uu,Hr)}if(Xr(G)){var Xu=[];return a&&a.call(G,function(Gr){Xu.push(me(Gr,G))}),Nu("Set",o.call(G),Xu,Hr)}if(kr(G))return Ns("WeakMap");if(Bv(G))return Ns("WeakSet");if(Ur(G))return Ns("WeakRef");if(j(G))return Ii(me(Number(G)));if(et(G))return Ii(me(Y.call(G)));if(it(G))return Ii(p.call(G));if(Z(G))return Ii(me(String(G)));if(typeof window<"u"&&G===window)return"{ [object Window] }";if(typeof globalThis<"u"&&G===globalThis||typeof ni<"u"&&G===ni)return"{ [object globalThis] }";if(!$(G)&&!W(G)){var Hs=fn(G,me),Hu=O?O(G)===Object.prototype:G instanceof Object||G.constructor===Object,Gs=G instanceof Object?"":"null prototype",Gu=!Hu&&q&&Object(G)===G&&q in G?I.call(bt(G),8,-1):Gs?"Object":"",Hv=Hu||typeof G.constructor!="function"?"":G.constructor.name?G.constructor.name+" ":"",Ys=Hv+(Gu||Gs?"["+H.call(C.call([],Gu||[],Gs||[]),": ")+"] ":"");return Hs.length===0?Ys+"{}":Hr?Ys+"{"+Bs(Hs,Hr)+"}":Ys+"{ "+H.call(Hs,", ")+" }"}return String(G)};function L(X,G,yt){var wt=yt.quoteStyle||G,It=S[wt];return It+X+It}function N(X){return w.call(String(X),/"/g,"&quot;")}function k(X){return!q||!(typeof X=="object"&&(q in X||typeof X[q]<"u"))}function U(X){return bt(X)==="[object Array]"&&k(X)}function $(X){return bt(X)==="[object Date]"&&k(X)}function W(X){return bt(X)==="[object RegExp]"&&k(X)}function z(X){return bt(X)==="[object Error]"&&k(X)}function Z(X){return bt(X)==="[object String]"&&k(X)}function j(X){return bt(X)==="[object Number]"&&k(X)}function it(X){return bt(X)==="[object Boolean]"&&k(X)}function at(X){if(Q)return X&&typeof X=="object"&&X instanceof Symbol;if(typeof X=="symbol")return!0;if(!X||typeof X!="object"||!J)return!1;try{return J.call(X),!0}catch{}return!1}function et(X){if(!X||typeof X!="object"||!Y)return!1;try{return Y.call(X),!0}catch{}return!1}var rt=Object.prototype.hasOwnProperty||function(X){return X in this};function xt(X,G){return rt.call(X,G)}function bt(X){return m.call(X)}function St(X){if(X.name)return X.name;var G=g.call(v.call(X),/^function\s*([\w$]+)/);return G?G[1]:null}function qe(X,G){if(X.indexOf)return X.indexOf(G);for(var yt=0,wt=X.length;yt<wt;yt++)if(X[yt]===G)return yt;return-1}function ve(X){if(!t||!X||typeof X!="object")return!1;try{t.call(X);try{o.call(X)}catch{return!0}return X instanceof Map}catch{}return!1}function kr(X){if(!u||!X||typeof X!="object")return!1;try{u.call(X,u);try{f.call(X,f)}catch{return!0}return X instanceof WeakMap}catch{}return!1}function Ur(X){if(!d||!X||typeof X!="object")return!1;try{return d.call(X),!0}catch{}return!1}function Xr(X){if(!o||!X||typeof X!="object")return!1;try{o.call(X);try{t.call(X)}catch{return!0}return X instanceof Set}catch{}return!1}function Bv(X){if(!f||!X||typeof X!="object")return!1;try{f.call(X,f);try{u.call(X,u)}catch{return!0}return X instanceof WeakSet}catch{}return!1}function Dv(X){return!X||typeof X!="object"?!1:typeof HTMLElement<"u"&&X instanceof HTMLElement?!0:typeof X.nodeName=="string"&&typeof X.getAttribute=="function"}function Lu(X,G){if(X.length>G.maxStringLength){var yt=X.length-G.maxStringLength,wt="... "+yt+" more character"+(yt>1?"s":"");return Lu(I.call(X,0,G.maxStringLength),G)+wt}var It=P[G.quoteStyle||"single"];It.lastIndex=0;var ut=w.call(w.call(X,It,"\\$1"),/[\x00-\x1f]/g,kv);return L(ut,"single",G)}function kv(X){var G=X.charCodeAt(0),yt={8:"b",9:"t",10:"n",12:"f",13:"r"}[G];return yt?"\\"+yt:"\\x"+(G<16?"0":"")+M.call(G.toString(16))}function Ii(X){return"Object("+X+")"}function Ns(X){return X+" { ? }"}function Nu(X,G,yt,wt){var It=wt?Bs(yt,wt):H.call(yt,", ");return X+" ("+G+") {"+It+"}"}function Uv(X){for(var G=0;G<X.length;G++)if(qe(X[G],`
`)>=0)return!1;return!0}function Xv(X,G){var yt;if(X.indent==="	")yt="	";else if(typeof X.indent=="number"&&X.indent>0)yt=H.call(Array(X.indent+1)," ");else return null;return{base:yt,prev:H.call(Array(G+1),yt)}}function Bs(X,G){if(X.length===0)return"";var yt=`
`+G.prev+G.base;return yt+H.call(X,","+yt)+`
`+G.prev}function fn(X,G){var yt=U(X),wt=[];if(yt){wt.length=X.length;for(var It=0;It<X.length;It++)wt[It]=xt(X,It)?G(X[It],X):""}var ut=typeof D=="function"?D(X):[],$e;if(Q){$e={};for(var hr=0;hr<ut.length;hr++)$e["$"+ut[hr]]=ut[hr]}for(var ie in X)xt(X,ie)&&(yt&&String(Number(ie))===ie&&ie<X.length||Q&&$e["$"+ie]instanceof Symbol||(R.call(/[^\w$]/,ie)?wt.push(G(ie,X)+": "+G(X[ie],X)):wt.push(ie+": "+G(X[ie],X))));if(typeof D=="function")for(var je=0;je<ut.length;je++)A.call(X,ut[je])&&wt.push("["+G(ut[je])+"]: "+G(X[ut[je]],X));return wt}return Js}var Qs,uh;function hm(){if(uh)return Qs;uh=1;var i=gs(),e=mi(),t=function(a,l,u){for(var h=a,f;(f=h.next)!=null;h=f)if(f.key===l)return h.next=f.next,u||(f.next=a.next,a.next=f),f},r=function(a,l){if(a){var u=t(a,l);return u&&u.value}},n=function(a,l,u){var h=t(a,l);h?h.value=u:a.next={key:l,next:a.next,value:u}},s=function(a,l){return a?!!t(a,l):!1},o=function(a,l){if(a)return t(a,l,!0)};return Qs=function(){var l,u={assert:function(h){if(!u.has(h))throw new e("Side channel does not contain "+i(h))},delete:function(h){var f=l&&l.next,c=o(l,h);return c&&f&&f===c&&(l=void 0),!!c},get:function(h){return r(l,h)},has:function(h){return s(l,h)},set:function(h,f){l||(l={next:void 0}),n(l,h,f)}};return u},Qs}var to,hh;function nd(){return hh||(hh=1,to=Object),to}var eo,fh;function fm(){return fh||(fh=1,eo=Error),eo}var ro,ch;function cm(){return ch||(ch=1,ro=EvalError),ro}var io,dh;function dm(){return dh||(dh=1,io=RangeError),io}var no,ph;function pm(){return ph||(ph=1,no=ReferenceError),no}var so,yh;function ym(){return yh||(yh=1,so=SyntaxError),so}var oo,vh;function vm(){return vh||(vh=1,oo=URIError),oo}var ao,mh;function mm(){return mh||(mh=1,ao=Math.abs),ao}var lo,gh;function gm(){return gh||(gh=1,lo=Math.floor),lo}var uo,_h;function _m(){return _h||(_h=1,uo=Math.max),uo}var ho,bh;function bm(){return bh||(bh=1,ho=Math.min),ho}var fo,xh;function xm(){return xh||(xh=1,fo=Math.pow),fo}var co,wh;function wm(){return wh||(wh=1,co=Math.round),co}var po,Th;function Tm(){return Th||(Th=1,po=Number.isNaN||function(e){return e!==e}),po}var yo,Ih;function Im(){if(Ih)return yo;Ih=1;var i=Tm();return yo=function(t){return i(t)||t===0?t:t<0?-1:1},yo}var vo,Eh;function Em(){return Eh||(Eh=1,vo=Object.getOwnPropertyDescriptor),vo}var mo,Sh;function sd(){if(Sh)return mo;Sh=1;var i=Em();if(i)try{i([],"length")}catch{i=null}return mo=i,mo}var go,Ah;function Sm(){if(Ah)return go;Ah=1;var i=Object.defineProperty||!1;if(i)try{i({},"a",{value:1})}catch{i=!1}return go=i,go}var _o,Ch;function Am(){return Ch||(Ch=1,_o=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),r=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var n=42;e[t]=n;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,t);if(a.value!==n||a.enumerable!==!0)return!1}return!0}),_o}var bo,Ph;function Cm(){if(Ph)return bo;Ph=1;var i=typeof Symbol<"u"&&Symbol,e=Am();return bo=function(){return typeof i!="function"||typeof Symbol!="function"||typeof i("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},bo}var xo,Oh;function od(){return Oh||(Oh=1,xo=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),xo}var wo,Rh;function ad(){if(Rh)return wo;Rh=1;var i=nd();return wo=i.getPrototypeOf||null,wo}var To,Fh;function Pm(){if(Fh)return To;Fh=1;var i="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,t=Math.max,r="[object Function]",n=function(l,u){for(var h=[],f=0;f<l.length;f+=1)h[f]=l[f];for(var c=0;c<u.length;c+=1)h[c+l.length]=u[c];return h},s=function(l,u){for(var h=[],f=u,c=0;f<l.length;f+=1,c+=1)h[c]=l[f];return h},o=function(a,l){for(var u="",h=0;h<a.length;h+=1)u+=a[h],h+1<a.length&&(u+=l);return u};return To=function(l){var u=this;if(typeof u!="function"||e.apply(u)!==r)throw new TypeError(i+u);for(var h=s(arguments,1),f,c=function(){if(this instanceof f){var g=u.apply(this,n(h,arguments));return Object(g)===g?g:this}return u.apply(l,n(h,arguments))},d=t(0,u.length-h.length),p=[],m=0;m<d;m++)p[m]="$"+m;if(f=Function("binder","return function ("+o(p,",")+"){ return binder.apply(this,arguments); }")(c),u.prototype){var v=function(){};v.prototype=u.prototype,f.prototype=new v,v.prototype=null}return f},To}var Io,Mh;function _s(){if(Mh)return Io;Mh=1;var i=Pm();return Io=Function.prototype.bind||i,Io}var Eo,Lh;function Ml(){return Lh||(Lh=1,Eo=Function.prototype.call),Eo}var So,Nh;function ld(){return Nh||(Nh=1,So=Function.prototype.apply),So}var Ao,Bh;function Om(){return Bh||(Bh=1,Ao=typeof Reflect<"u"&&Reflect&&Reflect.apply),Ao}var Co,Dh;function Rm(){if(Dh)return Co;Dh=1;var i=_s(),e=ld(),t=Ml(),r=Om();return Co=r||i.call(t,e),Co}var Po,kh;function ud(){if(kh)return Po;kh=1;var i=_s(),e=mi(),t=Ml(),r=Rm();return Po=function(s){if(s.length<1||typeof s[0]!="function")throw new e("a function is required");return r(i,t,s)},Po}var Oo,Uh;function Fm(){if(Uh)return Oo;Uh=1;var i=ud(),e=sd(),t;try{t=[].__proto__===Array.prototype}catch(o){if(!o||typeof o!="object"||!("code"in o)||o.code!=="ERR_PROTO_ACCESS")throw o}var r=!!t&&e&&e(Object.prototype,"__proto__"),n=Object,s=n.getPrototypeOf;return Oo=r&&typeof r.get=="function"?i([r.get]):typeof s=="function"?function(a){return s(a==null?a:n(a))}:!1,Oo}var Ro,Xh;function Mm(){if(Xh)return Ro;Xh=1;var i=od(),e=ad(),t=Fm();return Ro=i?function(n){return i(n)}:e?function(n){if(!n||typeof n!="object"&&typeof n!="function")throw new TypeError("getProto: not an object");return e(n)}:t?function(n){return t(n)}:null,Ro}var Fo,Hh;function Lm(){if(Hh)return Fo;Hh=1;var i=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=_s();return Fo=t.call(i,e),Fo}var Mo,Gh;function Ll(){if(Gh)return Mo;Gh=1;var i,e=nd(),t=fm(),r=cm(),n=dm(),s=pm(),o=ym(),a=mi(),l=vm(),u=mm(),h=gm(),f=_m(),c=bm(),d=xm(),p=wm(),m=Im(),v=Function,g=function(W){try{return v('"use strict"; return ('+W+").constructor;")()}catch{}},I=sd(),w=Sm(),M=function(){throw new a},b=I?(function(){try{return arguments.callee,M}catch{try{return I(arguments,"callee").get}catch{return M}}})():M,R=Cm()(),C=Mm(),H=ad(),F=od(),B=ld(),Y=Ml(),D={},J=typeof Uint8Array>"u"||!C?i:C(Uint8Array),Q={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?i:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?i:ArrayBuffer,"%ArrayIteratorPrototype%":R&&C?C([][Symbol.iterator]()):i,"%AsyncFromSyncIteratorPrototype%":i,"%AsyncFunction%":D,"%AsyncGenerator%":D,"%AsyncGeneratorFunction%":D,"%AsyncIteratorPrototype%":D,"%Atomics%":typeof Atomics>"u"?i:Atomics,"%BigInt%":typeof BigInt>"u"?i:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?i:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?i:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?i:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":t,"%eval%":eval,"%EvalError%":r,"%Float16Array%":typeof Float16Array>"u"?i:Float16Array,"%Float32Array%":typeof Float32Array>"u"?i:Float32Array,"%Float64Array%":typeof Float64Array>"u"?i:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?i:FinalizationRegistry,"%Function%":v,"%GeneratorFunction%":D,"%Int8Array%":typeof Int8Array>"u"?i:Int8Array,"%Int16Array%":typeof Int16Array>"u"?i:Int16Array,"%Int32Array%":typeof Int32Array>"u"?i:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":R&&C?C(C([][Symbol.iterator]())):i,"%JSON%":typeof JSON=="object"?JSON:i,"%Map%":typeof Map>"u"?i:Map,"%MapIteratorPrototype%":typeof Map>"u"||!R||!C?i:C(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":e,"%Object.getOwnPropertyDescriptor%":I,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?i:Promise,"%Proxy%":typeof Proxy>"u"?i:Proxy,"%RangeError%":n,"%ReferenceError%":s,"%Reflect%":typeof Reflect>"u"?i:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?i:Set,"%SetIteratorPrototype%":typeof Set>"u"||!R||!C?i:C(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?i:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":R&&C?C(""[Symbol.iterator]()):i,"%Symbol%":R?Symbol:i,"%SyntaxError%":o,"%ThrowTypeError%":b,"%TypedArray%":J,"%TypeError%":a,"%Uint8Array%":typeof Uint8Array>"u"?i:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?i:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?i:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?i:Uint32Array,"%URIError%":l,"%WeakMap%":typeof WeakMap>"u"?i:WeakMap,"%WeakRef%":typeof WeakRef>"u"?i:WeakRef,"%WeakSet%":typeof WeakSet>"u"?i:WeakSet,"%Function.prototype.call%":Y,"%Function.prototype.apply%":B,"%Object.defineProperty%":w,"%Object.getPrototypeOf%":H,"%Math.abs%":u,"%Math.floor%":h,"%Math.max%":f,"%Math.min%":c,"%Math.pow%":d,"%Math.round%":p,"%Math.sign%":m,"%Reflect.getPrototypeOf%":F};if(C)try{null.error}catch(W){var q=C(C(W));Q["%Error.prototype%"]=q}var A=function W(z){var Z;if(z==="%AsyncFunction%")Z=g("async function () {}");else if(z==="%GeneratorFunction%")Z=g("function* () {}");else if(z==="%AsyncGeneratorFunction%")Z=g("async function* () {}");else if(z==="%AsyncGenerator%"){var j=W("%AsyncGeneratorFunction%");j&&(Z=j.prototype)}else if(z==="%AsyncIteratorPrototype%"){var it=W("%AsyncGenerator%");it&&C&&(Z=C(it.prototype))}return Q[z]=Z,Z},O={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},y=_s(),_=Lm(),x=y.call(Y,Array.prototype.concat),T=y.call(B,Array.prototype.splice),S=y.call(Y,String.prototype.replace),P=y.call(Y,String.prototype.slice),L=y.call(Y,RegExp.prototype.exec),N=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,k=/\\(\\)?/g,U=function(z){var Z=P(z,0,1),j=P(z,-1);if(Z==="%"&&j!=="%")throw new o("invalid intrinsic syntax, expected closing `%`");if(j==="%"&&Z!=="%")throw new o("invalid intrinsic syntax, expected opening `%`");var it=[];return S(z,N,function(at,et,rt,xt){it[it.length]=rt?S(xt,k,"$1"):et||at}),it},$=function(z,Z){var j=z,it;if(_(O,j)&&(it=O[j],j="%"+it[0]+"%"),_(Q,j)){var at=Q[j];if(at===D&&(at=A(j)),typeof at>"u"&&!Z)throw new a("intrinsic "+z+" exists, but is not available. Please file an issue!");return{alias:it,name:j,value:at}}throw new o("intrinsic "+z+" does not exist!")};return Mo=function(z,Z){if(typeof z!="string"||z.length===0)throw new a("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof Z!="boolean")throw new a('"allowMissing" argument must be a boolean');if(L(/^%?[^%]*%?$/,z)===null)throw new o("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var j=U(z),it=j.length>0?j[0]:"",at=$("%"+it+"%",Z),et=at.name,rt=at.value,xt=!1,bt=at.alias;bt&&(it=bt[0],T(j,x([0,1],bt)));for(var St=1,qe=!0;St<j.length;St+=1){var ve=j[St],kr=P(ve,0,1),Ur=P(ve,-1);if((kr==='"'||kr==="'"||kr==="`"||Ur==='"'||Ur==="'"||Ur==="`")&&kr!==Ur)throw new o("property names with quotes must have matching quotes");if((ve==="constructor"||!qe)&&(xt=!0),it+="."+ve,et="%"+it+"%",_(Q,et))rt=Q[et];else if(rt!=null){if(!(ve in rt)){if(!Z)throw new a("base intrinsic for "+z+" exists, but the property is not available.");return}if(I&&St+1>=j.length){var Xr=I(rt,ve);qe=!!Xr,qe&&"get"in Xr&&!("originalValue"in Xr.get)?rt=Xr.get:rt=rt[ve]}else qe=_(rt,ve),rt=rt[ve];qe&&!xt&&(Q[et]=rt)}}return rt},Mo}var Lo,Yh;function hd(){if(Yh)return Lo;Yh=1;var i=Ll(),e=ud(),t=e([i("%String.prototype.indexOf%")]);return Lo=function(n,s){var o=i(n,!!s);return typeof o=="function"&&t(n,".prototype.")>-1?e([o]):o},Lo}var No,zh;function fd(){if(zh)return No;zh=1;var i=Ll(),e=hd(),t=gs(),r=mi(),n=i("%Map%",!0),s=e("Map.prototype.get",!0),o=e("Map.prototype.set",!0),a=e("Map.prototype.has",!0),l=e("Map.prototype.delete",!0),u=e("Map.prototype.size",!0);return No=!!n&&function(){var f,c={assert:function(d){if(!c.has(d))throw new r("Side channel does not contain "+t(d))},delete:function(d){if(f){var p=l(f,d);return u(f)===0&&(f=void 0),p}return!1},get:function(d){if(f)return s(f,d)},has:function(d){return f?a(f,d):!1},set:function(d,p){f||(f=new n),o(f,d,p)}};return c},No}var Bo,Vh;function Nm(){if(Vh)return Bo;Vh=1;var i=Ll(),e=hd(),t=gs(),r=fd(),n=mi(),s=i("%WeakMap%",!0),o=e("WeakMap.prototype.get",!0),a=e("WeakMap.prototype.set",!0),l=e("WeakMap.prototype.has",!0),u=e("WeakMap.prototype.delete",!0);return Bo=s?function(){var f,c,d={assert:function(p){if(!d.has(p))throw new n("Side channel does not contain "+t(p))},delete:function(p){if(s&&p&&(typeof p=="object"||typeof p=="function")){if(f)return u(f,p)}else if(r&&c)return c.delete(p);return!1},get:function(p){return s&&p&&(typeof p=="object"||typeof p=="function")&&f?o(f,p):c&&c.get(p)},has:function(p){return s&&p&&(typeof p=="object"||typeof p=="function")&&f?l(f,p):!!c&&c.has(p)},set:function(p,m){s&&p&&(typeof p=="object"||typeof p=="function")?(f||(f=new s),a(f,p,m)):r&&(c||(c=r()),c.set(p,m))}};return d}:r,Bo}var Do,qh;function Bm(){if(qh)return Do;qh=1;var i=mi(),e=gs(),t=hm(),r=fd(),n=Nm(),s=n||r||t;return Do=function(){var a,l={assert:function(u){if(!l.has(u))throw new i("Side channel does not contain "+e(u))},delete:function(u){return!!a&&a.delete(u)},get:function(u){return a&&a.get(u)},has:function(u){return!!a&&a.has(u)},set:function(u,h){a||(a=s()),a.set(u,h)}};return l},Do}var ko,$h;function Nl(){if($h)return ko;$h=1;var i=String.prototype.replace,e=/%20/g,t={RFC1738:"RFC1738",RFC3986:"RFC3986"};return ko={default:t.RFC3986,formatters:{RFC1738:function(r){return i.call(r,e,"+")},RFC3986:function(r){return String(r)}},RFC1738:t.RFC1738,RFC3986:t.RFC3986},ko}var Uo,jh;function cd(){if(jh)return Uo;jh=1;var i=Nl(),e=Object.prototype.hasOwnProperty,t=Array.isArray,r=(function(){for(var v=[],g=0;g<256;++g)v.push("%"+((g<16?"0":"")+g.toString(16)).toUpperCase());return v})(),n=function(g){for(;g.length>1;){var I=g.pop(),w=I.obj[I.prop];if(t(w)){for(var M=[],b=0;b<w.length;++b)typeof w[b]<"u"&&M.push(w[b]);I.obj[I.prop]=M}}},s=function(g,I){for(var w=I&&I.plainObjects?{__proto__:null}:{},M=0;M<g.length;++M)typeof g[M]<"u"&&(w[M]=g[M]);return w},o=function v(g,I,w){if(!I)return g;if(typeof I!="object"&&typeof I!="function"){if(t(g))g.push(I);else if(g&&typeof g=="object")(w&&(w.plainObjects||w.allowPrototypes)||!e.call(Object.prototype,I))&&(g[I]=!0);else return[g,I];return g}if(!g||typeof g!="object")return[g].concat(I);var M=g;return t(g)&&!t(I)&&(M=s(g,w)),t(g)&&t(I)?(I.forEach(function(b,R){if(e.call(g,R)){var C=g[R];C&&typeof C=="object"&&b&&typeof b=="object"?g[R]=v(C,b,w):g.push(b)}else g[R]=b}),g):Object.keys(I).reduce(function(b,R){var C=I[R];return e.call(b,R)?b[R]=v(b[R],C,w):b[R]=C,b},M)},a=function(g,I){return Object.keys(I).reduce(function(w,M){return w[M]=I[M],w},g)},l=function(v,g,I){var w=v.replace(/\+/g," ");if(I==="iso-8859-1")return w.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(w)}catch{return w}},u=1024,h=function(g,I,w,M,b){if(g.length===0)return g;var R=g;if(typeof g=="symbol"?R=Symbol.prototype.toString.call(g):typeof g!="string"&&(R=String(g)),w==="iso-8859-1")return escape(R).replace(/%u[0-9a-f]{4}/gi,function(J){return"%26%23"+parseInt(J.slice(2),16)+"%3B"});for(var C="",H=0;H<R.length;H+=u){for(var F=R.length>=u?R.slice(H,H+u):R,B=[],Y=0;Y<F.length;++Y){var D=F.charCodeAt(Y);if(D===45||D===46||D===95||D===126||D>=48&&D<=57||D>=65&&D<=90||D>=97&&D<=122||b===i.RFC1738&&(D===40||D===41)){B[B.length]=F.charAt(Y);continue}if(D<128){B[B.length]=r[D];continue}if(D<2048){B[B.length]=r[192|D>>6]+r[128|D&63];continue}if(D<55296||D>=57344){B[B.length]=r[224|D>>12]+r[128|D>>6&63]+r[128|D&63];continue}Y+=1,D=65536+((D&1023)<<10|F.charCodeAt(Y)&1023),B[B.length]=r[240|D>>18]+r[128|D>>12&63]+r[128|D>>6&63]+r[128|D&63]}C+=B.join("")}return C},f=function(g){for(var I=[{obj:{o:g},prop:"o"}],w=[],M=0;M<I.length;++M)for(var b=I[M],R=b.obj[b.prop],C=Object.keys(R),H=0;H<C.length;++H){var F=C[H],B=R[F];typeof B=="object"&&B!==null&&w.indexOf(B)===-1&&(I.push({obj:R,prop:F}),w.push(B))}return n(I),g},c=function(g){return Object.prototype.toString.call(g)==="[object RegExp]"},d=function(g){return!g||typeof g!="object"?!1:!!(g.constructor&&g.constructor.isBuffer&&g.constructor.isBuffer(g))},p=function(g,I){return[].concat(g,I)},m=function(g,I){if(t(g)){for(var w=[],M=0;M<g.length;M+=1)w.push(I(g[M]));return w}return I(g)};return Uo={arrayToObject:s,assign:a,combine:p,compact:f,decode:l,encode:h,isBuffer:d,isRegExp:c,maybeMap:m,merge:o},Uo}var Xo,Wh;function Dm(){if(Wh)return Xo;Wh=1;var i=Bm(),e=cd(),t=Nl(),r=Object.prototype.hasOwnProperty,n={brackets:function(v){return v+"[]"},comma:"comma",indices:function(v,g){return v+"["+g+"]"},repeat:function(v){return v}},s=Array.isArray,o=Array.prototype.push,a=function(m,v){o.apply(m,s(v)?v:[v])},l=Date.prototype.toISOString,u=t.default,h={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:e.encode,encodeValuesOnly:!1,filter:void 0,format:u,formatter:t.formatters[u],indices:!1,serializeDate:function(v){return l.call(v)},skipNulls:!1,strictNullHandling:!1},f=function(v){return typeof v=="string"||typeof v=="number"||typeof v=="boolean"||typeof v=="symbol"||typeof v=="bigint"},c={},d=function m(v,g,I,w,M,b,R,C,H,F,B,Y,D,J,Q,q,A,O){for(var y=v,_=O,x=0,T=!1;(_=_.get(c))!==void 0&&!T;){var S=_.get(v);if(x+=1,typeof S<"u"){if(S===x)throw new RangeError("Cyclic object value");T=!0}typeof _.get(c)>"u"&&(x=0)}if(typeof F=="function"?y=F(g,y):y instanceof Date?y=D(y):I==="comma"&&s(y)&&(y=e.maybeMap(y,function(et){return et instanceof Date?D(et):et})),y===null){if(b)return H&&!q?H(g,h.encoder,A,"key",J):g;y=""}if(f(y)||e.isBuffer(y)){if(H){var P=q?g:H(g,h.encoder,A,"key",J);return[Q(P)+"="+Q(H(y,h.encoder,A,"value",J))]}return[Q(g)+"="+Q(String(y))]}var L=[];if(typeof y>"u")return L;var N;if(I==="comma"&&s(y))q&&H&&(y=e.maybeMap(y,H)),N=[{value:y.length>0?y.join(",")||null:void 0}];else if(s(F))N=F;else{var k=Object.keys(y);N=B?k.sort(B):k}var U=C?String(g).replace(/\./g,"%2E"):String(g),$=w&&s(y)&&y.length===1?U+"[]":U;if(M&&s(y)&&y.length===0)return $+"[]";for(var W=0;W<N.length;++W){var z=N[W],Z=typeof z=="object"&&z&&typeof z.value<"u"?z.value:y[z];if(!(R&&Z===null)){var j=Y&&C?String(z).replace(/\./g,"%2E"):String(z),it=s(y)?typeof I=="function"?I($,j):$:$+(Y?"."+j:"["+j+"]");O.set(v,x);var at=i();at.set(c,O),a(L,m(Z,it,I,w,M,b,R,C,I==="comma"&&q&&s(y)?null:H,F,B,Y,D,J,Q,q,A,at))}}return L},p=function(v){if(!v)return h;if(typeof v.allowEmptyArrays<"u"&&typeof v.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof v.encodeDotInKeys<"u"&&typeof v.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(v.encoder!==null&&typeof v.encoder<"u"&&typeof v.encoder!="function")throw new TypeError("Encoder has to be a function.");var g=v.charset||h.charset;if(typeof v.charset<"u"&&v.charset!=="utf-8"&&v.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var I=t.default;if(typeof v.format<"u"){if(!r.call(t.formatters,v.format))throw new TypeError("Unknown format option provided.");I=v.format}var w=t.formatters[I],M=h.filter;(typeof v.filter=="function"||s(v.filter))&&(M=v.filter);var b;if(v.arrayFormat in n?b=v.arrayFormat:"indices"in v?b=v.indices?"indices":"repeat":b=h.arrayFormat,"commaRoundTrip"in v&&typeof v.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var R=typeof v.allowDots>"u"?v.encodeDotInKeys===!0?!0:h.allowDots:!!v.allowDots;return{addQueryPrefix:typeof v.addQueryPrefix=="boolean"?v.addQueryPrefix:h.addQueryPrefix,allowDots:R,allowEmptyArrays:typeof v.allowEmptyArrays=="boolean"?!!v.allowEmptyArrays:h.allowEmptyArrays,arrayFormat:b,charset:g,charsetSentinel:typeof v.charsetSentinel=="boolean"?v.charsetSentinel:h.charsetSentinel,commaRoundTrip:!!v.commaRoundTrip,delimiter:typeof v.delimiter>"u"?h.delimiter:v.delimiter,encode:typeof v.encode=="boolean"?v.encode:h.encode,encodeDotInKeys:typeof v.encodeDotInKeys=="boolean"?v.encodeDotInKeys:h.encodeDotInKeys,encoder:typeof v.encoder=="function"?v.encoder:h.encoder,encodeValuesOnly:typeof v.encodeValuesOnly=="boolean"?v.encodeValuesOnly:h.encodeValuesOnly,filter:M,format:I,formatter:w,serializeDate:typeof v.serializeDate=="function"?v.serializeDate:h.serializeDate,skipNulls:typeof v.skipNulls=="boolean"?v.skipNulls:h.skipNulls,sort:typeof v.sort=="function"?v.sort:null,strictNullHandling:typeof v.strictNullHandling=="boolean"?v.strictNullHandling:h.strictNullHandling}};return Xo=function(m,v){var g=m,I=p(v),w,M;typeof I.filter=="function"?(M=I.filter,g=M("",g)):s(I.filter)&&(M=I.filter,w=M);var b=[];if(typeof g!="object"||g===null)return"";var R=n[I.arrayFormat],C=R==="comma"&&I.commaRoundTrip;w||(w=Object.keys(g)),I.sort&&w.sort(I.sort);for(var H=i(),F=0;F<w.length;++F){var B=w[F],Y=g[B];I.skipNulls&&Y===null||a(b,d(Y,B,R,C,I.allowEmptyArrays,I.strictNullHandling,I.skipNulls,I.encodeDotInKeys,I.encode?I.encoder:null,I.filter,I.sort,I.allowDots,I.serializeDate,I.format,I.formatter,I.encodeValuesOnly,I.charset,H))}var D=b.join(I.delimiter),J=I.addQueryPrefix===!0?"?":"";return I.charsetSentinel&&(I.charset==="iso-8859-1"?J+="utf8=%26%2310003%3B&":J+="utf8=%E2%9C%93&"),D.length>0?J+D:""},Xo}var Ho,Kh;function km(){if(Kh)return Ho;Kh=1;var i=cd(),e=Object.prototype.hasOwnProperty,t=Array.isArray,r={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:i.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},n=function(c){return c.replace(/&#(\d+);/g,function(d,p){return String.fromCharCode(parseInt(p,10))})},s=function(c,d,p){if(c&&typeof c=="string"&&d.comma&&c.indexOf(",")>-1)return c.split(",");if(d.throwOnLimitExceeded&&p>=d.arrayLimit)throw new RangeError("Array limit exceeded. Only "+d.arrayLimit+" element"+(d.arrayLimit===1?"":"s")+" allowed in an array.");return c},o="utf8=%26%2310003%3B",a="utf8=%E2%9C%93",l=function(d,p){var m={__proto__:null},v=p.ignoreQueryPrefix?d.replace(/^\?/,""):d;v=v.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var g=p.parameterLimit===1/0?void 0:p.parameterLimit,I=v.split(p.delimiter,p.throwOnLimitExceeded?g+1:g);if(p.throwOnLimitExceeded&&I.length>g)throw new RangeError("Parameter limit exceeded. Only "+g+" parameter"+(g===1?"":"s")+" allowed.");var w=-1,M,b=p.charset;if(p.charsetSentinel)for(M=0;M<I.length;++M)I[M].indexOf("utf8=")===0&&(I[M]===a?b="utf-8":I[M]===o&&(b="iso-8859-1"),w=M,M=I.length);for(M=0;M<I.length;++M)if(M!==w){var R=I[M],C=R.indexOf("]="),H=C===-1?R.indexOf("="):C+1,F,B;H===-1?(F=p.decoder(R,r.decoder,b,"key"),B=p.strictNullHandling?null:""):(F=p.decoder(R.slice(0,H),r.decoder,b,"key"),B=i.maybeMap(s(R.slice(H+1),p,t(m[F])?m[F].length:0),function(D){return p.decoder(D,r.decoder,b,"value")})),B&&p.interpretNumericEntities&&b==="iso-8859-1"&&(B=n(String(B))),R.indexOf("[]=")>-1&&(B=t(B)?[B]:B);var Y=e.call(m,F);Y&&p.duplicates==="combine"?m[F]=i.combine(m[F],B):(!Y||p.duplicates==="last")&&(m[F]=B)}return m},u=function(c,d,p,m){var v=0;if(c.length>0&&c[c.length-1]==="[]"){var g=c.slice(0,-1).join("");v=Array.isArray(d)&&d[g]?d[g].length:0}for(var I=m?d:s(d,p,v),w=c.length-1;w>=0;--w){var M,b=c[w];if(b==="[]"&&p.parseArrays)M=p.allowEmptyArrays&&(I===""||p.strictNullHandling&&I===null)?[]:i.combine([],I);else{M=p.plainObjects?{__proto__:null}:{};var R=b.charAt(0)==="["&&b.charAt(b.length-1)==="]"?b.slice(1,-1):b,C=p.decodeDotInKeys?R.replace(/%2E/g,"."):R,H=parseInt(C,10);!p.parseArrays&&C===""?M={0:I}:!isNaN(H)&&b!==C&&String(H)===C&&H>=0&&p.parseArrays&&H<=p.arrayLimit?(M=[],M[H]=I):C!=="__proto__"&&(M[C]=I)}I=M}return I},h=function(d,p,m,v){if(d){var g=m.allowDots?d.replace(/\.([^.[]+)/g,"[$1]"):d,I=/(\[[^[\]]*])/,w=/(\[[^[\]]*])/g,M=m.depth>0&&I.exec(g),b=M?g.slice(0,M.index):g,R=[];if(b){if(!m.plainObjects&&e.call(Object.prototype,b)&&!m.allowPrototypes)return;R.push(b)}for(var C=0;m.depth>0&&(M=w.exec(g))!==null&&C<m.depth;){if(C+=1,!m.plainObjects&&e.call(Object.prototype,M[1].slice(1,-1))&&!m.allowPrototypes)return;R.push(M[1])}if(M){if(m.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+m.depth+" and strictDepth is true");R.push("["+g.slice(M.index)+"]")}return u(R,p,m,v)}},f=function(d){if(!d)return r;if(typeof d.allowEmptyArrays<"u"&&typeof d.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof d.decodeDotInKeys<"u"&&typeof d.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(d.decoder!==null&&typeof d.decoder<"u"&&typeof d.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof d.charset<"u"&&d.charset!=="utf-8"&&d.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof d.throwOnLimitExceeded<"u"&&typeof d.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var p=typeof d.charset>"u"?r.charset:d.charset,m=typeof d.duplicates>"u"?r.duplicates:d.duplicates;if(m!=="combine"&&m!=="first"&&m!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var v=typeof d.allowDots>"u"?d.decodeDotInKeys===!0?!0:r.allowDots:!!d.allowDots;return{allowDots:v,allowEmptyArrays:typeof d.allowEmptyArrays=="boolean"?!!d.allowEmptyArrays:r.allowEmptyArrays,allowPrototypes:typeof d.allowPrototypes=="boolean"?d.allowPrototypes:r.allowPrototypes,allowSparse:typeof d.allowSparse=="boolean"?d.allowSparse:r.allowSparse,arrayLimit:typeof d.arrayLimit=="number"?d.arrayLimit:r.arrayLimit,charset:p,charsetSentinel:typeof d.charsetSentinel=="boolean"?d.charsetSentinel:r.charsetSentinel,comma:typeof d.comma=="boolean"?d.comma:r.comma,decodeDotInKeys:typeof d.decodeDotInKeys=="boolean"?d.decodeDotInKeys:r.decodeDotInKeys,decoder:typeof d.decoder=="function"?d.decoder:r.decoder,delimiter:typeof d.delimiter=="string"||i.isRegExp(d.delimiter)?d.delimiter:r.delimiter,depth:typeof d.depth=="number"||d.depth===!1?+d.depth:r.depth,duplicates:m,ignoreQueryPrefix:d.ignoreQueryPrefix===!0,interpretNumericEntities:typeof d.interpretNumericEntities=="boolean"?d.interpretNumericEntities:r.interpretNumericEntities,parameterLimit:typeof d.parameterLimit=="number"?d.parameterLimit:r.parameterLimit,parseArrays:d.parseArrays!==!1,plainObjects:typeof d.plainObjects=="boolean"?d.plainObjects:r.plainObjects,strictDepth:typeof d.strictDepth=="boolean"?!!d.strictDepth:r.strictDepth,strictNullHandling:typeof d.strictNullHandling=="boolean"?d.strictNullHandling:r.strictNullHandling,throwOnLimitExceeded:typeof d.throwOnLimitExceeded=="boolean"?d.throwOnLimitExceeded:!1}};return Ho=function(c,d){var p=f(d);if(c===""||c===null||typeof c>"u")return p.plainObjects?{__proto__:null}:{};for(var m=typeof c=="string"?l(c,p):c,v=p.plainObjects?{__proto__:null}:{},g=Object.keys(m),I=0;I<g.length;++I){var w=g[I],M=h(w,m[w],p,typeof c=="string");v=i.merge(v,M,p)}return p.allowSparse===!0?v:i.compact(v)},Ho}var Go,Zh;function Um(){if(Zh)return Go;Zh=1;var i=Dm(),e=km(),t=Nl();return Go={formats:t,parse:e,stringify:i},Go}var Jh;function Xm(){if(Jh)return fr;Jh=1;var i=om();function e(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var t=/^([a-z0-9.+-]+:)/i,r=/:[0-9]*$/,n=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,s=["<",">",'"',"`"," ","\r",`
`,"	"],o=["{","}","|","\\","^","`"].concat(s),a=["'"].concat(o),l=["%","/","?",";","#"].concat(a),u=["/","?","#"],h=255,f=/^[+a-z0-9A-Z_-]{0,63}$/,c=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,d={javascript:!0,"javascript:":!0},p={javascript:!0,"javascript:":!0},m={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},v=Um();function g(b,R,C){if(b&&typeof b=="object"&&b instanceof e)return b;var H=new e;return H.parse(b,R,C),H}e.prototype.parse=function(b,R,C){if(typeof b!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof b);var H=b.indexOf("?"),F=H!==-1&&H<b.indexOf("#")?"?":"#",B=b.split(F),Y=/\\/g;B[0]=B[0].replace(Y,"/"),b=B.join(F);var D=b;if(D=D.trim(),!C&&b.split("#").length===1){var J=n.exec(D);if(J)return this.path=D,this.href=D,this.pathname=J[1],J[2]?(this.search=J[2],R?this.query=v.parse(this.search.substr(1)):this.query=this.search.substr(1)):R&&(this.search="",this.query={}),this}var Q=t.exec(D);if(Q){Q=Q[0];var q=Q.toLowerCase();this.protocol=q,D=D.substr(Q.length)}if(C||Q||D.match(/^\/\/[^@/]+@[^@/]+/)){var A=D.substr(0,2)==="//";A&&!(Q&&p[Q])&&(D=D.substr(2),this.slashes=!0)}if(!p[Q]&&(A||Q&&!m[Q])){for(var O=-1,y=0;y<u.length;y++){var _=D.indexOf(u[y]);_!==-1&&(O===-1||_<O)&&(O=_)}var x,T;O===-1?T=D.lastIndexOf("@"):T=D.lastIndexOf("@",O),T!==-1&&(x=D.slice(0,T),D=D.slice(T+1),this.auth=decodeURIComponent(x)),O=-1;for(var y=0;y<l.length;y++){var _=D.indexOf(l[y]);_!==-1&&(O===-1||_<O)&&(O=_)}O===-1&&(O=D.length),this.host=D.slice(0,O),D=D.slice(O),this.parseHost(),this.hostname=this.hostname||"";var S=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!S)for(var P=this.hostname.split(/\./),y=0,L=P.length;y<L;y++){var N=P[y];if(N&&!N.match(f)){for(var k="",U=0,$=N.length;U<$;U++)N.charCodeAt(U)>127?k+="x":k+=N[U];if(!k.match(f)){var W=P.slice(0,y),z=P.slice(y+1),Z=N.match(c);Z&&(W.push(Z[1]),z.unshift(Z[2])),z.length&&(D="/"+z.join(".")+D),this.hostname=W.join(".");break}}}this.hostname.length>h?this.hostname="":this.hostname=this.hostname.toLowerCase(),S||(this.hostname=i.toASCII(this.hostname));var j=this.port?":"+this.port:"",it=this.hostname||"";this.host=it+j,this.href+=this.host,S&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),D[0]!=="/"&&(D="/"+D))}if(!d[q])for(var y=0,L=a.length;y<L;y++){var at=a[y];if(D.indexOf(at)!==-1){var et=encodeURIComponent(at);et===at&&(et=escape(at)),D=D.split(at).join(et)}}var rt=D.indexOf("#");rt!==-1&&(this.hash=D.substr(rt),D=D.slice(0,rt));var xt=D.indexOf("?");if(xt!==-1?(this.search=D.substr(xt),this.query=D.substr(xt+1),R&&(this.query=v.parse(this.query)),D=D.slice(0,xt)):R&&(this.search="",this.query={}),D&&(this.pathname=D),m[q]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var j=this.pathname||"",bt=this.search||"";this.path=j+bt}return this.href=this.format(),this};function I(b){return typeof b=="string"&&(b=g(b)),b instanceof e?b.format():e.prototype.format.call(b)}e.prototype.format=function(){var b=this.auth||"";b&&(b=encodeURIComponent(b),b=b.replace(/%3A/i,":"),b+="@");var R=this.protocol||"",C=this.pathname||"",H=this.hash||"",F=!1,B="";this.host?F=b+this.host:this.hostname&&(F=b+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(F+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(B=v.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var Y=this.search||B&&"?"+B||"";return R&&R.substr(-1)!==":"&&(R+=":"),this.slashes||(!R||m[R])&&F!==!1?(F="//"+(F||""),C&&C.charAt(0)!=="/"&&(C="/"+C)):F||(F=""),H&&H.charAt(0)!=="#"&&(H="#"+H),Y&&Y.charAt(0)!=="?"&&(Y="?"+Y),C=C.replace(/[?#]/g,function(D){return encodeURIComponent(D)}),Y=Y.replace("#","%23"),R+F+C+Y+H};function w(b,R){return g(b,!1,!0).resolve(R)}e.prototype.resolve=function(b){return this.resolveObject(g(b,!1,!0)).format()};function M(b,R){return b?g(b,!1,!0).resolveObject(R):R}return e.prototype.resolveObject=function(b){if(typeof b=="string"){var R=new e;R.parse(b,!1,!0),b=R}for(var C=new e,H=Object.keys(this),F=0;F<H.length;F++){var B=H[F];C[B]=this[B]}if(C.hash=b.hash,b.href==="")return C.href=C.format(),C;if(b.slashes&&!b.protocol){for(var Y=Object.keys(b),D=0;D<Y.length;D++){var J=Y[D];J!=="protocol"&&(C[J]=b[J])}return m[C.protocol]&&C.hostname&&!C.pathname&&(C.pathname="/",C.path=C.pathname),C.href=C.format(),C}if(b.protocol&&b.protocol!==C.protocol){if(!m[b.protocol]){for(var Q=Object.keys(b),q=0;q<Q.length;q++){var A=Q[q];C[A]=b[A]}return C.href=C.format(),C}if(C.protocol=b.protocol,!b.host&&!p[b.protocol]){for(var L=(b.pathname||"").split("/");L.length&&!(b.host=L.shift()););b.host||(b.host=""),b.hostname||(b.hostname=""),L[0]!==""&&L.unshift(""),L.length<2&&L.unshift(""),C.pathname=L.join("/")}else C.pathname=b.pathname;if(C.search=b.search,C.query=b.query,C.host=b.host||"",C.auth=b.auth,C.hostname=b.hostname||b.host,C.port=b.port,C.pathname||C.search){var O=C.pathname||"",y=C.search||"";C.path=O+y}return C.slashes=C.slashes||b.slashes,C.href=C.format(),C}var _=C.pathname&&C.pathname.charAt(0)==="/",x=b.host||b.pathname&&b.pathname.charAt(0)==="/",T=x||_||C.host&&b.pathname,S=T,P=C.pathname&&C.pathname.split("/")||[],L=b.pathname&&b.pathname.split("/")||[],N=C.protocol&&!m[C.protocol];if(N&&(C.hostname="",C.port=null,C.host&&(P[0]===""?P[0]=C.host:P.unshift(C.host)),C.host="",b.protocol&&(b.hostname=null,b.port=null,b.host&&(L[0]===""?L[0]=b.host:L.unshift(b.host)),b.host=null),T=T&&(L[0]===""||P[0]==="")),x)C.host=b.host||b.host===""?b.host:C.host,C.hostname=b.hostname||b.hostname===""?b.hostname:C.hostname,C.search=b.search,C.query=b.query,P=L;else if(L.length)P||(P=[]),P.pop(),P=P.concat(L),C.search=b.search,C.query=b.query;else if(b.search!=null){if(N){C.host=P.shift(),C.hostname=C.host;var k=C.host&&C.host.indexOf("@")>0?C.host.split("@"):!1;k&&(C.auth=k.shift(),C.hostname=k.shift(),C.host=C.hostname)}return C.search=b.search,C.query=b.query,(C.pathname!==null||C.search!==null)&&(C.path=(C.pathname?C.pathname:"")+(C.search?C.search:"")),C.href=C.format(),C}if(!P.length)return C.pathname=null,C.search?C.path="/"+C.search:C.path=null,C.href=C.format(),C;for(var U=P.slice(-1)[0],$=(C.host||b.host||P.length>1)&&(U==="."||U==="..")||U==="",W=0,z=P.length;z>=0;z--)U=P[z],U==="."?P.splice(z,1):U===".."?(P.splice(z,1),W++):W&&(P.splice(z,1),W--);if(!T&&!S)for(;W--;W)P.unshift("..");T&&P[0]!==""&&(!P[0]||P[0].charAt(0)!=="/")&&P.unshift(""),$&&P.join("/").substr(-1)!=="/"&&P.push("");var Z=P[0]===""||P[0]&&P[0].charAt(0)==="/";if(N){C.hostname=Z?"":P.length?P.shift():"",C.host=C.hostname;var k=C.host&&C.host.indexOf("@")>0?C.host.split("@"):!1;k&&(C.auth=k.shift(),C.hostname=k.shift(),C.host=C.hostname)}return T=T||C.host&&P.length,T&&!Z&&P.unshift(""),P.length>0?C.pathname=P.join("/"):(C.pathname=null,C.path=null),(C.pathname!==null||C.search!==null)&&(C.path=(C.pathname?C.pathname:"")+(C.search?C.search:"")),C.auth=b.auth||C.auth,C.slashes=C.slashes||b.slashes,C.href=C.format(),C},e.prototype.parseHost=function(){var b=this.host,R=r.exec(b);R&&(R=R[0],R!==":"&&(this.port=R.substr(1)),b=b.substr(0,b.length-R.length)),b&&(this.hostname=b)},fr.parse=g,fr.resolve=w,fr.resolveObject=M,fr.format=I,fr.Url=e,fr}var dd=Xm();const pd=yi(dd);/*!
 * @pixi/constants - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Ae;(function(i){i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2"})(Ae||(Ae={}));var si;(function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.WEBGL=1]="WEBGL",i[i.CANVAS=2]="CANVAS"})(si||(si={}));var zi;(function(i){i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL"})(zi||(zi={}));var st;(function(i){i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR"})(st||(st={}));var ae;(function(i){i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(ae||(ae={}));var oi;(function(i){i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL"})(oi||(oi={}));var ir;(function(i){i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"})(ir||(ir={}));var Lt;(function(i){i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.FLOAT=5126]="FLOAT",i[i.HALF_FLOAT=36193]="HALF_FLOAT"})(Lt||(Lt={}));var be;(function(i){i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR"})(be||(be={}));var Ee;(function(i){i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"})(Ee||(Ee={}));var ai;(function(i){i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON"})(ai||(ai={}));var Xe;(function(i){i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"})(Xe||(Xe={}));var ge;(function(i){i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT"})(ge||(ge={}));var os;(function(i){i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL"})(os||(os={}));var xe;(function(i){i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp"})(xe||(xe={}));var Wt;(function(i){i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE"})(Wt||(Wt={}));var Ir;(function(i){i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH"})(Ir||(Ir={}));/*!
 * @pixi/utils - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */nt.RETINA_PREFIX=/@([0-9\.]+)x/;nt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var Ia=!1,Qh="5.3.12";function Hm(){Ia=!0}function yd(i){var e;if(!Ia){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var t=[`
 %c %c %c PixiJS `+Qh+" -  "+i+`   %c  %c  http://www.pixijs.com/  %c %c %c%c 

`,"background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(e=window.console).log.apply(e,t)}else window.console&&window.console.log("PixiJS "+Qh+" - "+i+" - http://www.pixijs.com/");Ia=!0}}var Yo;function vd(){return typeof Yo>"u"&&(Yo=(function(){var e={stencil:!0,failIfMajorPerformanceCaveat:nt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!window.WebGLRenderingContext)return!1;var t=document.createElement("canvas"),r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),n=!!(r&&r.getContextAttributes().stencil);if(r){var s=r.getExtension("WEBGL_lose_context");s&&s.loseContext()}return r=null,n}catch{return!1}})()),Yo}function Er(i,e){return e===void 0&&(e=[]),e[0]=(i>>16&255)/255,e[1]=(i>>8&255)/255,e[2]=(i&255)/255,e}function Bl(i){var e=i.toString(16);return e="000000".substr(0,6-e.length)+e,"#"+e}function Dl(i){return typeof i=="string"&&i[0]==="#"&&(i=i.substr(1)),parseInt(i,16)}function Gm(i){return(i[0]*255<<16)+(i[1]*255<<8)+(i[2]*255|0)}function Ym(){for(var i=[],e=[],t=0;t<32;t++)i[t]=t,e[t]=t;i[st.NORMAL_NPM]=st.NORMAL,i[st.ADD_NPM]=st.ADD,i[st.SCREEN_NPM]=st.SCREEN,e[st.NORMAL]=st.NORMAL_NPM,e[st.ADD]=st.ADD_NPM,e[st.SCREEN]=st.SCREEN_NPM;var r=[];return r.push(e),r.push(i),r}var kl=Ym();function Ul(i,e){return kl[e?1:0][i]}function md(i,e,t,r){return t=t||new Float32Array(4),r||r===void 0?(t[0]=i[0]*e,t[1]=i[1]*e,t[2]=i[2]*e):(t[0]=i[0],t[1]=i[1],t[2]=i[2]),t[3]=e,t}function bs(i,e){if(e===1)return(e*255<<24)+i;if(e===0)return 0;var t=i>>16&255,r=i>>8&255,n=i&255;return t=t*e+.5|0,r=r*e+.5|0,n=n*e+.5|0,(e*255<<24)+(t<<16)+(r<<8)+n}function Xl(i,e,t,r){return t=t||new Float32Array(4),t[0]=(i>>16&255)/255,t[1]=(i>>8&255)/255,t[2]=(i&255)/255,(r||r===void 0)&&(t[0]*=e,t[1]*=e,t[2]*=e),t[3]=e,t}function Hl(i,e){e===void 0&&(e=null);var t=i*6;if(e=e||new Uint16Array(t),e.length!==t)throw new Error("Out buffer length is incorrect, got "+e.length+" and expected "+t);for(var r=0,n=0;r<t;r+=6,n+=4)e[r+0]=n+0,e[r+1]=n+1,e[r+2]=n+2,e[r+3]=n+0,e[r+4]=n+2,e[r+5]=n+3;return e}function gd(i){if(i.BYTES_PER_ELEMENT===4)return i instanceof Float32Array?"Float32Array":i instanceof Uint32Array?"Uint32Array":"Int32Array";if(i.BYTES_PER_ELEMENT===2){if(i instanceof Uint16Array)return"Uint16Array"}else if(i.BYTES_PER_ELEMENT===1&&i instanceof Uint8Array)return"Uint8Array";return null}var zm={Float32Array,Uint32Array,Int32Array,Uint8Array};function Vm(i,e){for(var t=0,r=0,n={},s=0;s<i.length;s++)r+=e[s],t+=i[s].length;for(var o=new ArrayBuffer(t*4),a=null,l=0,s=0;s<i.length;s++){var u=e[s],h=i[s],f=gd(h);n[f]||(n[f]=new zm[f](o)),a=n[f];for(var c=0;c<h.length;c++){var d=(c/u|0)*r+l,p=c%u;a[d+p]=h[c]}l+=u}return new Float32Array(o)}function Vi(i){return i+=i===0?1:0,--i,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i+1}function Ea(i){return!(i&i-1)&&!!i}function Sa(i){var e=(i>65535?1:0)<<4;i>>>=e;var t=(i>255?1:0)<<3;return i>>>=t,e|=t,t=(i>15?1:0)<<2,i>>>=t,e|=t,t=(i>3?1:0)<<1,i>>>=t,e|=t,e|i>>1}function Tr(i,e,t){var r=i.length,n;if(!(e>=r||t===0)){t=e+t>r?r-e:t;var s=r-t;for(n=e;n<s;++n)i[n]=i[n+t];i.length=s}}function xr(i){return i===0?0:i<0?-1:1}var qm=0;function Sr(){return++qm}var tf={};function K(i,e,t){if(t===void 0&&(t=3),!tf[e]){var r=new Error().stack;typeof r>"u"?console.warn("PixiJS Deprecation Warning: ",e+`
Deprecated since v`+i):(r=r.split(`
`).splice(t).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+`
Deprecated since v`+i),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+`
Deprecated since v`+i),console.warn(r))),tf[e]=!0}}var Aa={},Kt=Object.create(null),ue=Object.create(null);function $m(){var i;for(i in Kt)Kt[i].destroy();for(i in ue)ue[i].destroy()}function jm(){var i;for(i in Kt)delete Kt[i];for(i in ue)delete ue[i]}var Ca=(function(){function i(e,t,r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||nt.RESOLUTION,this.resize(e,t)}return i.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},i.prototype.resize=function(e,t){this.canvas.width=e*this.resolution,this.canvas.height=t*this.resolution},i.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(i.prototype,"width",{get:function(){return this.canvas.width},set:function(e){this.canvas.width=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this.canvas.height},set:function(e){this.canvas.height=e},enumerable:!1,configurable:!0}),i})();function _d(i){var e=i.width,t=i.height,r=i.getContext("2d"),n=r.getImageData(0,0,e,t),s=n.data,o=s.length,a={top:null,left:null,right:null,bottom:null},l=null,u,h,f;for(u=0;u<o;u+=4)s[u+3]!==0&&(h=u/4%e,f=~~(u/4/e),a.top===null&&(a.top=f),(a.left===null||h<a.left)&&(a.left=h),(a.right===null||a.right<h)&&(a.right=h+1),(a.bottom===null||a.bottom<f)&&(a.bottom=f));return a.top!==null&&(e=a.right-a.left,t=a.bottom-a.top+1,l=r.getImageData(a.left,a.top,e,t)),{height:t,width:e,data:l}}var bd=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function Wm(i){var e=bd.exec(i);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}}var mn;function xd(i,e){if(e===void 0&&(e=window.location),i.indexOf("data:")===0)return"";e=e||window.location,mn||(mn=document.createElement("a")),mn.href=i;var t=dd.parse(mn.href),r=!t.port&&e.port===""||t.port===e.port;return t.hostname!==e.hostname||!r||t.protocol!==e.protocol?"anonymous":""}function qi(i,e){var t=nt.RETINA_PREFIX.exec(i);return t?parseFloat(t[1]):e!==void 0?e:1}const Km=Object.freeze(Object.defineProperty({__proto__:null,BaseTextureCache:ue,CanvasRenderTarget:Ca,DATA_URI:bd,EventEmitter:vi,ProgramCache:Aa,TextureCache:Kt,clearTextureCache:jm,correctBlendMode:Ul,createIndicesForQuads:Hl,decomposeDataUri:Wm,deprecation:K,destroyTextureCache:$m,determineCrossOrigin:xd,earcut:Fl,getBufferType:gd,getResolutionOfUrl:qi,hex2rgb:Er,hex2string:Bl,interleaveTypedArrays:Vm,isMobile:ce,isPow2:Ea,isWebGLSupported:vd,log2:Sa,nextPow2:Vi,premultiplyBlendMode:kl,premultiplyRgba:md,premultiplyTint:bs,premultiplyTintToRgba:Xl,removeItems:Tr,rgb2hex:Gm,sayHello:yd,sign:xr,skipHello:Hm,string2hex:Dl,trimCanvas:_d,uid:Sr,url:pd},Symbol.toStringTag,{value:"Module"}));/*!
 * @pixi/math - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var li=Math.PI*2,wd=180/Math.PI,Td=Math.PI/180,Ot;(function(i){i[i.POLY=0]="POLY",i[i.RECT=1]="RECT",i[i.CIRC=2]="CIRC",i[i.ELIP=3]="ELIP",i[i.RREC=4]="RREC"})(Ot||(Ot={}));var vt=(function(){function i(e,t,r,n){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),this.x=Number(e),this.y=Number(t),this.width=Number(r),this.height=Number(n),this.type=Ot.RECT}return Object.defineProperty(i.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(i,"EMPTY",{get:function(){return new i(0,0,0,0)},enumerable:!1,configurable:!0}),i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height)},i.prototype.copyFrom=function(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this},i.prototype.copyTo=function(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e},i.prototype.contains=function(e,t){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height},i.prototype.pad=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=e),this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2,this},i.prototype.fit=function(e){var t=Math.max(this.x,e.x),r=Math.min(this.x+this.width,e.x+e.width),n=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(r-t,0),this.y=n,this.height=Math.max(s-n,0),this},i.prototype.ceil=function(e,t){e===void 0&&(e=1),t===void 0&&(t=.001);var r=Math.ceil((this.x+this.width-t)*e)/e,n=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=r-this.x,this.height=n-this.y,this},i.prototype.enlarge=function(e){var t=Math.min(this.x,e.x),r=Math.max(this.x+this.width,e.x+e.width),n=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=r-t,this.y=n,this.height=s-n,this},i})(),Id=(function(){function i(e,t,r){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),this.x=e,this.y=t,this.radius=r,this.type=Ot.CIRC}return i.prototype.clone=function(){return new i(this.x,this.y,this.radius)},i.prototype.contains=function(e,t){if(this.radius<=0)return!1;var r=this.radius*this.radius,n=this.x-e,s=this.y-t;return n*=n,s*=s,n+s<=r},i.prototype.getBounds=function(){return new vt(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)},i})(),Ed=(function(){function i(e,t,r,n){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),this.x=e,this.y=t,this.width=r,this.height=n,this.type=Ot.ELIP}return i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height)},i.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;var r=(e-this.x)/this.width,n=(t-this.y)/this.height;return r*=r,n*=n,r+n<=1},i.prototype.getBounds=function(){return new vt(this.x-this.width,this.y-this.height,this.width,this.height)},i})(),ti=(function(){function i(){for(var e=arguments,t=[],r=0;r<arguments.length;r++)t[r]=e[r];var n=Array.isArray(t[0])?t[0]:t;if(typeof n[0]!="number"){for(var s=[],o=0,a=n.length;o<a;o++)s.push(n[o].x,n[o].y);n=s}this.points=n,this.type=Ot.POLY,this.closeStroke=!0}return i.prototype.clone=function(){var e=this.points.slice(),t=new i(e);return t.closeStroke=this.closeStroke,t},i.prototype.contains=function(e,t){for(var r=!1,n=this.points.length/2,s=0,o=n-1;s<n;o=s++){var a=this.points[s*2],l=this.points[s*2+1],u=this.points[o*2],h=this.points[o*2+1],f=l>t!=h>t&&e<(u-a)*((t-l)/(h-l))+a;f&&(r=!r)}return r},i})(),Sd=(function(){function i(e,t,r,n,s){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),s===void 0&&(s=20),this.x=e,this.y=t,this.width=r,this.height=n,this.radius=s,this.type=Ot.RREC}return i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.radius)},i.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){if(t>=this.y+this.radius&&t<=this.y+this.height-this.radius||e>=this.x+this.radius&&e<=this.x+this.width-this.radius)return!0;var r=e-(this.x+this.radius),n=t-(this.y+this.radius),s=this.radius*this.radius;if(r*r+n*n<=s||(r=e-(this.x+this.width-this.radius),r*r+n*n<=s)||(n=t-(this.y+this.height-this.radius),r*r+n*n<=s)||(r=e-(this.x+this.radius),r*r+n*n<=s))return!0}return!1},i})(),kt=(function(){function i(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this.x=e,this.y=t}return i.prototype.clone=function(){return new i(this.x,this.y)},i.prototype.copyFrom=function(e){return this.set(e.x,e.y),this},i.prototype.copyTo=function(e){return e.set(this.x,this.y),e},i.prototype.equals=function(e){return e.x===this.x&&e.y===this.y},i.prototype.set=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=e),this.x=e,this.y=t,this},i})(),wr=(function(){function i(e,t,r,n){r===void 0&&(r=0),n===void 0&&(n=0),this._x=r,this._y=n,this.cb=e,this.scope=t}return i.prototype.clone=function(e,t){return e===void 0&&(e=this.cb),t===void 0&&(t=this.scope),new i(e,t,this._x,this._y)},i.prototype.set=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=e),(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this.cb.call(this.scope)),this},i.prototype.copyFrom=function(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this},i.prototype.copyTo=function(e){return e.set(this._x,this._y),e},i.prototype.equals=function(e){return e.x===this._x&&e.y===this._y},Object.defineProperty(i.prototype,"x",{get:function(){return this._x},set:function(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"y",{get:function(){return this._y},set:function(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),i})(),Rt=(function(){function i(e,t,r,n,s,o){e===void 0&&(e=1),t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=1),s===void 0&&(s=0),o===void 0&&(o=0),this.array=null,this.a=e,this.b=t,this.c=r,this.d=n,this.tx=s,this.ty=o}return i.prototype.fromArray=function(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]},i.prototype.set=function(e,t,r,n,s,o){return this.a=e,this.b=t,this.c=r,this.d=n,this.tx=s,this.ty=o,this},i.prototype.toArray=function(e,t){this.array||(this.array=new Float32Array(9));var r=t||this.array;return e?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},i.prototype.apply=function(e,t){t=t||new kt;var r=e.x,n=e.y;return t.x=this.a*r+this.c*n+this.tx,t.y=this.b*r+this.d*n+this.ty,t},i.prototype.applyInverse=function(e,t){t=t||new kt;var r=1/(this.a*this.d+this.c*-this.b),n=e.x,s=e.y;return t.x=this.d*r*n+-this.c*r*s+(this.ty*this.c-this.tx*this.d)*r,t.y=this.a*r*s+-this.b*r*n+(-this.ty*this.a+this.tx*this.b)*r,t},i.prototype.translate=function(e,t){return this.tx+=e,this.ty+=t,this},i.prototype.scale=function(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this},i.prototype.rotate=function(e){var t=Math.cos(e),r=Math.sin(e),n=this.a,s=this.c,o=this.tx;return this.a=n*t-this.b*r,this.b=n*r+this.b*t,this.c=s*t-this.d*r,this.d=s*r+this.d*t,this.tx=o*t-this.ty*r,this.ty=o*r+this.ty*t,this},i.prototype.append=function(e){var t=this.a,r=this.b,n=this.c,s=this.d;return this.a=e.a*t+e.b*n,this.b=e.a*r+e.b*s,this.c=e.c*t+e.d*n,this.d=e.c*r+e.d*s,this.tx=e.tx*t+e.ty*n+this.tx,this.ty=e.tx*r+e.ty*s+this.ty,this},i.prototype.setTransform=function(e,t,r,n,s,o,a,l,u){return this.a=Math.cos(a+u)*s,this.b=Math.sin(a+u)*s,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(r*this.a+n*this.c),this.ty=t-(r*this.b+n*this.d),this},i.prototype.prepend=function(e){var t=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){var r=this.a,n=this.c;this.a=r*e.a+this.b*e.c,this.b=r*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this},i.prototype.decompose=function(e){var t=this.a,r=this.b,n=this.c,s=this.d,o=-Math.atan2(-n,s),a=Math.atan2(r,t),l=Math.abs(o+a);return l<1e-5||Math.abs(li-l)<1e-5?(e.rotation=a,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=o,e.skew.y=a),e.scale.x=Math.sqrt(t*t+r*r),e.scale.y=Math.sqrt(n*n+s*s),e.position.x=this.tx,e.position.y=this.ty,e},i.prototype.invert=function(){var e=this.a,t=this.b,r=this.c,n=this.d,s=this.tx,o=e*n-t*r;return this.a=n/o,this.b=-t/o,this.c=-r/o,this.d=e/o,this.tx=(r*this.ty-n*s)/o,this.ty=-(e*this.ty-t*s)/o,this},i.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},i.prototype.clone=function(){var e=new i;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},i.prototype.copyTo=function(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},i.prototype.copyFrom=function(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this},Object.defineProperty(i,"IDENTITY",{get:function(){return new i},enumerable:!1,configurable:!0}),Object.defineProperty(i,"TEMP_MATRIX",{get:function(){return new i},enumerable:!1,configurable:!0}),i})(),yr=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],vr=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],mr=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],gr=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Pa=[],Ad=[],gn=Math.sign;function Zm(){for(var i=0;i<16;i++){var e=[];Pa.push(e);for(var t=0;t<16;t++)for(var r=gn(yr[i]*yr[t]+mr[i]*vr[t]),n=gn(vr[i]*yr[t]+gr[i]*vr[t]),s=gn(yr[i]*mr[t]+mr[i]*gr[t]),o=gn(vr[i]*mr[t]+gr[i]*gr[t]),a=0;a<16;a++)if(yr[a]===r&&vr[a]===n&&mr[a]===s&&gr[a]===o){e.push(a);break}}for(var i=0;i<16;i++){var l=new Rt;l.set(yr[i],vr[i],mr[i],gr[i],0,0),Ad.push(l)}}Zm();var Ct={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(i){return yr[i]},uY:function(i){return vr[i]},vX:function(i){return mr[i]},vY:function(i){return gr[i]},inv:function(i){return i&8?i&15:-i&7},add:function(i,e){return Pa[i][e]},sub:function(i,e){return Pa[i][Ct.inv(e)]},rotate180:function(i){return i^4},isVertical:function(i){return(i&3)===2},byDirection:function(i,e){return Math.abs(i)*2<=Math.abs(e)?e>=0?Ct.S:Ct.N:Math.abs(e)*2<=Math.abs(i)?i>0?Ct.E:Ct.W:e>0?i>0?Ct.SE:Ct.SW:i>0?Ct.NE:Ct.NW},matrixAppendRotationInv:function(i,e,t,r){t===void 0&&(t=0),r===void 0&&(r=0);var n=Ad[Ct.inv(e)];n.tx=t,n.ty=r,i.append(n)}},Gl=(function(){function i(){this.worldTransform=new Rt,this.localTransform=new Rt,this.position=new wr(this.onChange,this,0,0),this.scale=new wr(this.onChange,this,1,1),this.pivot=new wr(this.onChange,this,0,0),this.skew=new wr(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return i.prototype.onChange=function(){this._localID++},i.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},i.prototype.updateLocalTransform=function(){var e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)},i.prototype.updateTransform=function(e){var t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){var r=e.worldTransform,n=this.worldTransform;n.a=t.a*r.a+t.b*r.c,n.b=t.a*r.b+t.b*r.d,n.c=t.c*r.a+t.d*r.c,n.d=t.c*r.b+t.d*r.d,n.tx=t.tx*r.a+t.ty*r.c+r.tx,n.ty=t.tx*r.b+t.ty*r.d+r.ty,this._parentID=e._worldID,this._worldID++}},i.prototype.setFromMatrix=function(e){e.decompose(this),this._localID++},Object.defineProperty(i.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())},enumerable:!1,configurable:!0}),i.IDENTITY=new i,i})();/*!
 * @pixi/display - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */nt.SORTABLE_CHILDREN=!1;var $i=(function(){function i(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return i.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},i.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},i.prototype.getRectangle=function(e){return this.minX>this.maxX||this.minY>this.maxY?vt.EMPTY:(e=e||new vt(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)},i.prototype.addPoint=function(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)},i.prototype.addQuad=function(e){var t=this.minX,r=this.minY,n=this.maxX,s=this.maxY,o=e[0],a=e[1];t=o<t?o:t,r=a<r?a:r,n=o>n?o:n,s=a>s?a:s,o=e[2],a=e[3],t=o<t?o:t,r=a<r?a:r,n=o>n?o:n,s=a>s?a:s,o=e[4],a=e[5],t=o<t?o:t,r=a<r?a:r,n=o>n?o:n,s=a>s?a:s,o=e[6],a=e[7],t=o<t?o:t,r=a<r?a:r,n=o>n?o:n,s=a>s?a:s,this.minX=t,this.minY=r,this.maxX=n,this.maxY=s},i.prototype.addFrame=function(e,t,r,n,s){this.addFrameMatrix(e.worldTransform,t,r,n,s)},i.prototype.addFrameMatrix=function(e,t,r,n,s){var o=e.a,a=e.b,l=e.c,u=e.d,h=e.tx,f=e.ty,c=this.minX,d=this.minY,p=this.maxX,m=this.maxY,v=o*t+l*r+h,g=a*t+u*r+f;c=v<c?v:c,d=g<d?g:d,p=v>p?v:p,m=g>m?g:m,v=o*n+l*r+h,g=a*n+u*r+f,c=v<c?v:c,d=g<d?g:d,p=v>p?v:p,m=g>m?g:m,v=o*t+l*s+h,g=a*t+u*s+f,c=v<c?v:c,d=g<d?g:d,p=v>p?v:p,m=g>m?g:m,v=o*n+l*s+h,g=a*n+u*s+f,c=v<c?v:c,d=g<d?g:d,p=v>p?v:p,m=g>m?g:m,this.minX=c,this.minY=d,this.maxX=p,this.maxY=m},i.prototype.addVertexData=function(e,t,r){for(var n=this.minX,s=this.minY,o=this.maxX,a=this.maxY,l=t;l<r;l+=2){var u=e[l],h=e[l+1];n=u<n?u:n,s=h<s?h:s,o=u>o?u:o,a=h>a?h:a}this.minX=n,this.minY=s,this.maxX=o,this.maxY=a},i.prototype.addVertices=function(e,t,r,n){this.addVerticesMatrix(e.worldTransform,t,r,n)},i.prototype.addVerticesMatrix=function(e,t,r,n,s,o){s===void 0&&(s=0),o===void 0&&(o=s);for(var a=e.a,l=e.b,u=e.c,h=e.d,f=e.tx,c=e.ty,d=this.minX,p=this.minY,m=this.maxX,v=this.maxY,g=r;g<n;g+=2){var I=t[g],w=t[g+1],M=a*I+u*w+f,b=h*w+l*I+c;d=Math.min(d,M-s),m=Math.max(m,M+s),p=Math.min(p,b-o),v=Math.max(v,b+o)}this.minX=d,this.minY=p,this.maxX=m,this.maxY=v},i.prototype.addBounds=function(e){var t=this.minX,r=this.minY,n=this.maxX,s=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<r?e.minY:r,this.maxX=e.maxX>n?e.maxX:n,this.maxY=e.maxY>s?e.maxY:s},i.prototype.addBoundsMask=function(e,t){var r=e.minX>t.minX?e.minX:t.minX,n=e.minY>t.minY?e.minY:t.minY,s=e.maxX<t.maxX?e.maxX:t.maxX,o=e.maxY<t.maxY?e.maxY:t.maxY;if(r<=s&&n<=o){var a=this.minX,l=this.minY,u=this.maxX,h=this.maxY;this.minX=r<a?r:a,this.minY=n<l?n:l,this.maxX=s>u?s:u,this.maxY=o>h?o:h}},i.prototype.addBoundsMatrix=function(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY)},i.prototype.addBoundsArea=function(e,t){var r=e.minX>t.x?e.minX:t.x,n=e.minY>t.y?e.minY:t.y,s=e.maxX<t.x+t.width?e.maxX:t.x+t.width,o=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(r<=s&&n<=o){var a=this.minX,l=this.minY,u=this.maxX,h=this.maxY;this.minX=r<a?r:a,this.minY=n<l?n:l,this.maxX=s>u?s:u,this.maxY=o>h?o:h}},i.prototype.pad=function(e,t){e===void 0&&(e=0),t===void 0&&(t=e),this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t)},i.prototype.addFramePad=function(e,t,r,n,s,o){e-=s,t-=o,r+=s,n+=o,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>n?this.maxY:n},i})();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Oa=function(i,e){return Oa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},Oa(i,e)};function Yl(i,e){Oa(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Bt=(function(i){Yl(e,i);function e(){var t=i.call(this)||this;return t.tempDisplayObjectParent=null,t.transform=new Gl,t.alpha=1,t.visible=!0,t.renderable=!0,t.parent=null,t.worldAlpha=1,t._lastSortedIndex=0,t._zIndex=0,t.filterArea=null,t.filters=null,t._enabledFilters=null,t._bounds=new $i,t._localBounds=null,t._boundsID=0,t._boundsRect=null,t._localBoundsRect=null,t._mask=null,t._destroyed=!1,t.isSprite=!1,t.isMask=!1,t}return e.mixin=function(t){for(var r=Object.keys(t),n=0;n<r.length;++n){var s=r[n];Object.defineProperty(e.prototype,s,Object.getOwnPropertyDescriptor(t,s))}},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.getBounds=function(t,r){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),r||(this._boundsRect||(this._boundsRect=new vt),r=this._boundsRect),this._bounds.getRectangle(r)},e.prototype.getLocalBounds=function(t){t||(this._localBoundsRect||(this._localBoundsRect=new vt),t=this._localBoundsRect),this._localBounds||(this._localBounds=new $i);var r=this.transform,n=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var s=this._bounds,o=this._boundsID;this._bounds=this._localBounds;var a=this.getBounds(!1,t);return this.parent=n,this.transform=r,this._bounds=s,this._bounds.updateID+=this._boundsID-o,a},e.prototype.toGlobal=function(t,r,n){return n===void 0&&(n=!1),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,r)},e.prototype.toLocal=function(t,r,n,s){return r&&(t=r.toGlobal(t,n,s)),s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,n)},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,r,n,s,o,a,l,u,h){return t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=1),s===void 0&&(s=1),o===void 0&&(o=0),a===void 0&&(a=0),l===void 0&&(l=0),u===void 0&&(u=0),h===void 0&&(h=0),this.position.x=t,this.position.y=r,this.scale.x=n||1,this.scale.y=s||1,this.rotation=o,this.skew.x=a,this.skew.y=l,this.pivot.x=u,this.pivot.y=h,this},e.prototype.destroy=function(t){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},Object.defineProperty(e.prototype,"_tempDisplayObjectParent",{get:function(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new zl),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),e.prototype.enableTempParent=function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t},e.prototype.disableTempParent=function(t){this.parent=t},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x},set:function(t){this.transform.position.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y},set:function(t){this.transform.position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position},set:function(t){this.transform.position.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale},set:function(t){this.transform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skew",{get:function(){return this.transform.skew},set:function(t){this.transform.skew.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.transform.rotation*wd},set:function(t){this.transform.rotation=t*Td},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){if(this._mask){var r=this._mask.maskObject||this._mask;r.renderable=!0,r.isMask=!1}if(this._mask=t,this._mask){var r=this._mask.maskObject||this._mask;r.renderable=!1,r.isMask=!0}},enumerable:!1,configurable:!0}),e})(vi),zl=(function(i){Yl(e,i);function e(){var t=i!==null&&i.apply(this,arguments)||this;return t.sortDirty=null,t}return e})(Bt);Bt.prototype.displayObjectUpdateTransform=Bt.prototype.updateTransform;function Jm(i,e){return i.zIndex===e.zIndex?i._lastSortedIndex-e._lastSortedIndex:i.zIndex-e.zIndex}var Jt=(function(i){Yl(e,i);function e(){var t=i.call(this)||this;return t.children=[],t.sortableChildren=nt.SORTABLE_CHILDREN,t.sortDirty=!1,t}return e.prototype.onChildrenChange=function(t){},e.prototype.addChild=function(){for(var t=arguments,r=[],n=0;n<arguments.length;n++)r[n]=t[n];if(r.length>1)for(var s=0;s<r.length;s++)this.addChild(r[s]);else{var o=r[0];o.parent&&o.parent.removeChild(o),o.parent=this,this.sortDirty=!0,o.transform._parentID=-1,this.children.push(o),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",o,this,this.children.length-1),o.emit("added",this)}return r[0]},e.prototype.addChildAt=function(t,r){if(r<0||r>this.children.length)throw new Error(t+"addChildAt: The index "+r+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(r,0,t),this._boundsID++,this.onChildrenChange(r),t.emit("added",this),this.emit("childAdded",t,this,r),t},e.prototype.swapChildren=function(t,r){if(t!==r){var n=this.getChildIndex(t),s=this.getChildIndex(r);this.children[n]=r,this.children[s]=t,this.onChildrenChange(n<s?n:s)}},e.prototype.getChildIndex=function(t){var r=this.children.indexOf(t);if(r===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return r},e.prototype.setChildIndex=function(t,r){if(r<0||r>=this.children.length)throw new Error("The index "+r+" supplied is out of bounds "+this.children.length);var n=this.getChildIndex(t);Tr(this.children,n,1),this.children.splice(r,0,t),this.onChildrenChange(r)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(){for(var t=arguments,r=[],n=0;n<arguments.length;n++)r[n]=t[n];if(r.length>1)for(var s=0;s<r.length;s++)this.removeChild(r[s]);else{var o=r[0],a=this.children.indexOf(o);if(a===-1)return null;o.parent=null,o.transform._parentID=-1,Tr(this.children,a,1),this._boundsID++,this.onChildrenChange(a),o.emit("removed",this),this.emit("childRemoved",o,this,a)}return r[0]},e.prototype.removeChildAt=function(t){var r=this.getChildAt(t);return r.parent=null,r.transform._parentID=-1,Tr(this.children,t,1),this._boundsID++,this.onChildrenChange(t),r.emit("removed",this),this.emit("childRemoved",r,this,t),r},e.prototype.removeChildren=function(t,r){t===void 0&&(t=0),r===void 0&&(r=this.children.length);var n=t,s=r,o=s-n,a;if(o>0&&o<=s){a=this.children.splice(n,o);for(var l=0;l<a.length;++l)a[l].parent=null,a[l].transform&&(a[l].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var l=0;l<a.length;++l)a[l].emit("removed",this),this.emit("childRemoved",a[l],this,l);return a}else if(o===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,r=0,n=this.children.length;r<n;++r){var s=this.children[r];s._lastSortedIndex=r,!t&&s.zIndex!==0&&(t=!0)}t&&this.children.length>1&&this.children.sort(Jm),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,r=this.children.length;t<r;++t){var n=this.children[t];n.visible&&n.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var r=this.children[t];if(!(!r.visible||!r.renderable))if(r.calculateBounds(),r._mask){var n=r._mask.maskObject||r._mask;n.calculateBounds(),this._bounds.addBoundsMask(r._bounds,n._bounds)}else r.filterArea?this._bounds.addBoundsArea(r._bounds,r.filterArea):this._bounds.addBounds(r._bounds)}this._bounds.updateID=this._boundsID},e.prototype.getLocalBounds=function(t,r){r===void 0&&(r=!1);var n=i.prototype.getLocalBounds.call(this,t);if(!r)for(var s=0,o=this.children.length;s<o;++s){var a=this.children[s];a.visible&&a.updateTransform()}return n},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var r=0,n=this.children.length;r<n;++r)this.children[r].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var r=this.filters,n=this._mask;if(r){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var s=0;s<r.length;s++)r[s].enabled&&this._enabledFilters.push(r[s]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}n&&t.mask.push(this,this._mask),this._render(t);for(var s=0,o=this.children.length;s<o;s++)this.children[s].render(t);t.batch.flush(),n&&t.mask.pop(this),r&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(t){i.prototype.destroy.call(this),this.sortDirty=!1;var r=typeof t=="boolean"?t:t&&t.children,n=this.removeChildren(0,this.children.length);if(r)for(var s=0;s<n.length;++s)n[s].destroy(t)},Object.defineProperty(e.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var r=this.getLocalBounds().width;r!==0?this.scale.x=t/r:this.scale.x=1,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var r=this.getLocalBounds().height;r!==0?this.scale.y=t/r:this.scale.y=1,this._height=t},enumerable:!1,configurable:!0}),e})(Bt);Jt.prototype.containerUpdateTransform=Jt.prototype.updateTransform;/*!
 * @pixi/accessibility - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/accessibility is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Cd={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Bt.mixin(Cd);var Qm=9,_n=100,tg=0,eg=0,ef=2,rf=1,rg=-1e3,ig=-1e3,ng=2,Pd=(function(){function i(e){this._hookDiv=null,(ce.tablet||ce.phone)&&this.createTouchHook();var t=document.createElement("div");t.style.width=_n+"px",t.style.height=_n+"px",t.style.position="absolute",t.style.top=tg+"px",t.style.left=eg+"px",t.style.zIndex=ef.toString(),this.div=t,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=e,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._isActive=!1,this._isMobileAccessibility=!1,this.androidUpdateCount=0,this.androidUpdateFrequency=500,window.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(i.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),i.prototype.createTouchHook=function(){var e=this,t=document.createElement("button");t.style.width=rf+"px",t.style.height=rf+"px",t.style.position="absolute",t.style.top=rg+"px",t.style.left=ig+"px",t.style.zIndex=ng.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessability for this content",t.addEventListener("focus",function(){e._isMobileAccessibility=!0,e.activate(),e.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t},i.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},i.prototype.activate=function(){this._isActive||(this._isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},i.prototype.deactivate=function(){!this._isActive||this._isMobileAccessibility||(this._isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},i.prototype.updateAccessibleObjects=function(e){if(!(!e.visible||!e.accessibleChildren)){e.accessible&&e.interactive&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);for(var t=e.children,r=0;r<t.length;r++)this.updateAccessibleObjects(t[r])}},i.prototype.update=function(){var e=performance.now();if(!(ce.android.device&&e<this.androidUpdateCount)&&(this.androidUpdateCount=e+this.androidUpdateFrequency,!!this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var t=this.renderer.view.getBoundingClientRect(),r=this.renderer.resolution,n=t.width/this.renderer.width*r,s=t.height/this.renderer.height*r,o=this.div;o.style.left=t.left+"px",o.style.top=t.top+"px",o.style.width=this.renderer.width+"px",o.style.height=this.renderer.height+"px";for(var a=0;a<this.children.length;a++){var l=this.children[a];if(l.renderId!==this.renderId)l._accessibleActive=!1,Tr(this.children,a,1),this.div.removeChild(l._accessibleDiv),this.pool.push(l._accessibleDiv),l._accessibleDiv=null,a--;else{o=l._accessibleDiv;var u=l.hitArea,h=l.worldTransform;l.hitArea?(o.style.left=(h.tx+u.x*h.a)*n+"px",o.style.top=(h.ty+u.y*h.d)*s+"px",o.style.width=u.width*h.a*n+"px",o.style.height=u.height*h.d*s+"px"):(u=l.getBounds(),this.capHitArea(u),o.style.left=u.x*n+"px",o.style.top=u.y*s+"px",o.style.width=u.width*n+"px",o.style.height=u.height*s+"px",o.title!==l.accessibleTitle&&l.accessibleTitle!==null&&(o.title=l.accessibleTitle),o.getAttribute("aria-label")!==l.accessibleHint&&l.accessibleHint!==null&&o.setAttribute("aria-label",l.accessibleHint)),(l.accessibleTitle!==o.title||l.tabIndex!==o.tabIndex)&&(o.title=l.accessibleTitle,o.tabIndex=l.tabIndex,this.debug&&this.updateDebugHTML(o))}}this.renderId++}},i.prototype.updateDebugHTML=function(e){e.innerHTML="type: "+e.type+"</br> title : "+e.title+"</br> tabIndex: "+e.tabIndex},i.prototype.capHitArea=function(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0),e.x+e.width>this.renderer.width&&(e.width=this.renderer.width-e.x),e.y+e.height>this.renderer.height&&(e.height=this.renderer.height-e.y)},i.prototype.addChild=function(e){var t=this.pool.pop();t||(t=document.createElement("button"),t.style.width=_n+"px",t.style.height=_n+"px",t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=ef.toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?t.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(t.title="displayObject "+e.tabIndex),e.accessibleHint&&e.accessibleHint!==null&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex},i.prototype._onClick=function(e){var t=this.renderer.plugins.interaction;t.dispatchEvent(e.target.displayObject,"click",t.eventData),t.dispatchEvent(e.target.displayObject,"pointertap",t.eventData),t.dispatchEvent(e.target.displayObject,"tap",t.eventData)},i.prototype._onFocus=function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive");var t=this.renderer.plugins.interaction;t.dispatchEvent(e.target.displayObject,"mouseover",t.eventData)},i.prototype._onFocusOut=function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite");var t=this.renderer.plugins.interaction;t.dispatchEvent(e.target.displayObject,"mouseout",t.eventData)},i.prototype._onKeyDown=function(e){e.keyCode===Qm&&this.activate()},i.prototype._onMouseMove=function(e){e.movementX===0&&e.movementY===0||this.deactivate()},i.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},i})();/*!
 * @pixi/ticker - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */nt.TARGET_FPMS=.06;var Ce;(function(i){i[i.INTERACTION=50]="INTERACTION",i[i.HIGH=25]="HIGH",i[i.NORMAL=0]="NORMAL",i[i.LOW=-25]="LOW",i[i.UTILITY=-50]="UTILITY"})(Ce||(Ce={}));var zo=(function(){function i(e,t,r,n){t===void 0&&(t=null),r===void 0&&(r=0),n===void 0&&(n=!1),this.fn=e,this.context=t,this.priority=r,this.once=n,this.next=null,this.previous=null,this._destroyed=!1}return i.prototype.match=function(e,t){return t===void 0&&(t=null),this.fn===e&&this.context===t},i.prototype.emit=function(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));var t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t},i.prototype.connect=function(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this},i.prototype.destroy=function(e){e===void 0&&(e=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var t=this.next;return this.next=e?null:t,this.previous=null,t},i})(),Dt=(function(){function i(){var e=this;this._head=new zo(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/nt.TARGET_FPMS,this.elapsedMS=1/nt.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),e.started&&e._requestId===null&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}return i.prototype._requestIfNeeded=function(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},i.prototype._cancelIfNeeded=function(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)},i.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},i.prototype.add=function(e,t,r){return r===void 0&&(r=Ce.NORMAL),this._addListener(new zo(e,t,r))},i.prototype.addOnce=function(e,t,r){return r===void 0&&(r=Ce.NORMAL),this._addListener(new zo(e,t,r,!0))},i.prototype._addListener=function(e){var t=this._head.next,r=this._head;if(!t)e.connect(r);else{for(;t;){if(e.priority>t.priority){e.connect(r);break}r=t,t=t.next}e.previous||e.connect(r)}return this._startIfPossible(),this},i.prototype.remove=function(e,t){for(var r=this._head.next;r;)r.match(e,t)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(i.prototype,"count",{get:function(){if(!this._head)return 0;for(var e=0,t=this._head;t=t.next;)e++;return e},enumerable:!1,configurable:!0}),i.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},i.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},i.prototype.destroy=function(){if(!this._protected){this.stop();for(var e=this._head.next;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}},i.prototype.update=function(e){e===void 0&&(e=performance.now());var t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){var r=e-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=e-r%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*nt.TARGET_FPMS;for(var n=this._head,s=n.next;s;)s=s.emit(this.deltaTime);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e},Object.defineProperty(i.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(e){var t=Math.min(this.maxFPS,e),r=Math.min(Math.max(0,t)/1e3,nt.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(e){if(e===0)this._minElapsedMS=0;else{var t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(i,"shared",{get:function(){if(!i._shared){var e=i._shared=new i;e.autoStart=!0,e._protected=!0}return i._shared},enumerable:!1,configurable:!0}),Object.defineProperty(i,"system",{get:function(){if(!i._system){var e=i._system=new i;e.autoStart=!0,e._protected=!0}return i._system},enumerable:!1,configurable:!0}),i})(),Od=(function(){function i(){}return i.init=function(e){var t=this;e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set:function(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,Ce.LOW)},get:function(){return this._ticker}}),this.stop=function(){t._ticker.stop()},this.start=function(){t._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Dt.shared:new Dt,e.autoStart&&this.start()},i.destroy=function(){if(this._ticker){var e=this._ticker;this.ticker=null,e.destroy()}},i})();/*!
 * @pixi/interaction - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/interaction is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Ra=(function(){function i(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new kt,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(i.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),i.prototype.getLocalPosition=function(e,t,r){return e.worldTransform.applyInverse(r||this.global,t)},i.prototype.copyEvent=function(e){"isPrimary"in e&&e.isPrimary&&(this.isPrimary=!0),this.button="button"in e&&e.button;var t="buttons"in e&&e.buttons;this.buttons=Number.isInteger(t)?t:"which"in e&&e.which,this.width="width"in e&&e.width,this.height="height"in e&&e.height,this.tiltX="tiltX"in e&&e.tiltX,this.tiltY="tiltY"in e&&e.tiltY,this.pointerType="pointerType"in e&&e.pointerType,this.pressure="pressure"in e&&e.pressure,this.rotationAngle="rotationAngle"in e&&e.rotationAngle,this.twist="twist"in e&&e.twist||0,this.tangentialPressure="tangentialPressure"in e&&e.tangentialPressure||0},i.prototype.reset=function(){this.isPrimary=!1},i})();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Fa=function(i,e){return Fa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},Fa(i,e)};function sg(i,e){Fa(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Rd=(function(){function i(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return i.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},i.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},i})(),zn=(function(){function i(e){this._pointerId=e,this._flags=i.FLAGS.NONE}return i.prototype._doSet=function(e,t){t?this._flags=this._flags|e:this._flags=this._flags&~e},Object.defineProperty(i.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"flags",{get:function(){return this._flags},set:function(e){this._flags=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"none",{get:function(){return this._flags===i.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"over",{get:function(){return(this._flags&i.FLAGS.OVER)!==0},set:function(e){this._doSet(i.FLAGS.OVER,e)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"rightDown",{get:function(){return(this._flags&i.FLAGS.RIGHT_DOWN)!==0},set:function(e){this._doSet(i.FLAGS.RIGHT_DOWN,e)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"leftDown",{get:function(){return(this._flags&i.FLAGS.LEFT_DOWN)!==0},set:function(e){this._doSet(i.FLAGS.LEFT_DOWN,e)},enumerable:!1,configurable:!0}),i.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),i})(),og=(function(){function i(){this._tempPoint=new kt}return i.prototype.recursiveFindHit=function(e,t,r,n,s){if(!t||!t.visible)return!1;var o=e.data.global;s=t.interactive||s;var a=!1,l=s,u=!0;if(t.hitArea?(n&&(t.worldTransform.applyInverse(o,this._tempPoint),t.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?a=!0:(n=!1,u=!1)),l=!1):t._mask&&n&&(t._mask.containsPoint&&t._mask.containsPoint(o)||(n=!1)),u&&t.interactiveChildren&&t.children)for(var h=t.children,f=h.length-1;f>=0;f--){var c=h[f],d=this.recursiveFindHit(e,c,r,n,l);if(d){if(!c.parent)continue;l=!1,d&&(e.target&&(n=!1),a=!0)}}return s&&(n&&!e.target&&!t.hitArea&&t.containsPoint&&t.containsPoint(o)&&(a=!0),t.interactive&&(a&&!e.target&&(e.target=t),r&&r(e,t,!!a))),a},i.prototype.findHit=function(e,t,r,n){this.recursiveFindHit(e,t,r,n,!1)},i})(),Fd={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return this.cursor==="pointer"},set buttonMode(i){i?this.cursor="pointer":this.cursor==="pointer"&&(this.cursor=null)},cursor:null,get trackedPointers(){return this._trackedPointers===void 0&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};Bt.mixin(Fd);var bn=1,xn={target:null,data:{global:null}},Md=(function(i){sg(e,i);function e(t,r){var n=i.call(this)||this;return r=r||{},n.renderer=t,n.autoPreventDefault=r.autoPreventDefault!==void 0?r.autoPreventDefault:!0,n.interactionFrequency=r.interactionFrequency||10,n.mouse=new Ra,n.mouse.identifier=bn,n.mouse.global.set(-999999),n.activeInteractionData={},n.activeInteractionData[bn]=n.mouse,n.interactionDataPool=[],n.eventData=new Rd,n.interactionDOMElement=null,n.moveWhenInside=!1,n.eventsAdded=!1,n.tickerAdded=!1,n.mouseOverRenderer=!1,n.supportsTouchEvents="ontouchstart"in window,n.supportsPointerEvents=!!window.PointerEvent,n.onPointerUp=n.onPointerUp.bind(n),n.processPointerUp=n.processPointerUp.bind(n),n.onPointerCancel=n.onPointerCancel.bind(n),n.processPointerCancel=n.processPointerCancel.bind(n),n.onPointerDown=n.onPointerDown.bind(n),n.processPointerDown=n.processPointerDown.bind(n),n.onPointerMove=n.onPointerMove.bind(n),n.processPointerMove=n.processPointerMove.bind(n),n.onPointerOut=n.onPointerOut.bind(n),n.processPointerOverOut=n.processPointerOverOut.bind(n),n.onPointerOver=n.onPointerOver.bind(n),n.cursorStyles={default:"inherit",pointer:"pointer"},n.currentCursorMode=null,n.cursor=null,n.resolution=1,n.delayedEvents=[],n.search=new og,n._tempDisplayObject=new zl,n._useSystemTicker=r.useSystemTicker!==void 0?r.useSystemTicker:!0,n.setTargetElement(n.renderer.view,n.renderer.resolution),n}return Object.defineProperty(e.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(t){this._useSystemTicker=t,t?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),e.prototype.hitTest=function(t,r){return xn.target=null,xn.data.global=t,r||(r=this.lastObjectRendered),this.processInteractive(xn,r,null,!0),xn.target},e.prototype.setTargetElement=function(t,r){r===void 0&&(r=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=r,this.addEvents(),this.addTickerListener()},e.prototype.addTickerListener=function(){this.tickerAdded||!this.interactionDOMElement||!this._useSystemTicker||(Dt.system.add(this.tickerUpdate,this,Ce.INTERACTION),this.tickerAdded=!0)},e.prototype.removeTickerListener=function(){this.tickerAdded&&(Dt.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},e.prototype.addEvents=function(){if(!(this.eventsAdded||!this.interactionDOMElement)){var t=this.interactionDOMElement.style;window.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0}},e.prototype.removeEvents=function(){if(!(!this.eventsAdded||!this.interactionDOMElement)){var t=this.interactionDOMElement.style;window.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1}},e.prototype.tickerUpdate=function(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())},e.prototype.update=function(){if(this.interactionDOMElement){if(this._didMove){this._didMove=!1;return}this.cursor=null;for(var t in this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var r=this.activeInteractionData[t];if(r.originalEvent&&r.pointerType!=="touch"){var n=this.configureInteractionEventForDOMEvent(this.eventData,r.originalEvent,r);this.processInteractive(n,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){if(t=t||"default",this.currentCursorMode!==t){this.currentCursorMode=t;var r=this.cursorStyles[t];if(r)switch(typeof r){case"string":this.interactionDOMElement.style.cursor=r;break;case"function":r(t);break;case"object":Object.assign(this.interactionDOMElement.style,r);break}else typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,r,n){(!n.stopPropagationHint||t===n.stopsPropagatingAt)&&(n.currentTarget=t,n.type=r,t.emit(r,n),t[r]&&t[r](n))},e.prototype.delayDispatchEvent=function(t,r,n){this.delayedEvents.push({displayObject:t,eventString:r,eventData:n})},e.prototype.mapPositionToPoint=function(t,r,n){var s;this.interactionDOMElement.parentElement?s=this.interactionDOMElement.getBoundingClientRect():s={x:0,y:0,width:0,height:0};var o=1/this.resolution;t.x=(r-s.left)*(this.interactionDOMElement.width/s.width)*o,t.y=(n-s.top)*(this.interactionDOMElement.height/s.height)*o},e.prototype.processInteractive=function(t,r,n,s){var o=this.search.findHit(t,r,n,s),a=this.delayedEvents;if(!a.length)return o;t.stopPropagationHint=!1;var l=a.length;this.delayedEvents=[];for(var u=0;u<l;u++){var h=a[u],f=h.displayObject,c=h.eventString,d=h.eventData;d.stopsPropagatingAt===f&&(d.stopPropagationHint=!0),this.dispatchEvent(f,c,d)}return o},e.prototype.onPointerDown=function(t){if(!(this.supportsTouchEvents&&t.pointerType==="touch")){var r=this.normalizeToPointerData(t);if(this.autoPreventDefault&&r[0].isNormalized){var n=t.cancelable||!("cancelable"in t);n&&t.preventDefault()}for(var s=r.length,o=0;o<s;o++){var a=r[o],l=this.getInteractionDataForPointerId(a),u=this.configureInteractionEventForDOMEvent(this.eventData,a,l);if(u.data.originalEvent=t,this.processInteractive(u,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",u),a.pointerType==="touch")this.emit("touchstart",u);else if(a.pointerType==="mouse"||a.pointerType==="pen"){var h=a.button===2;this.emit(h?"rightdown":"mousedown",this.eventData)}}}},e.prototype.processPointerDown=function(t,r,n){var s=t.data,o=t.data.identifier;if(n){if(r.trackedPointers[o]||(r.trackedPointers[o]=new zn(o)),this.dispatchEvent(r,"pointerdown",t),s.pointerType==="touch")this.dispatchEvent(r,"touchstart",t);else if(s.pointerType==="mouse"||s.pointerType==="pen"){var a=s.button===2;a?r.trackedPointers[o].rightDown=!0:r.trackedPointers[o].leftDown=!0,this.dispatchEvent(r,a?"rightdown":"mousedown",t)}}},e.prototype.onPointerComplete=function(t,r,n){for(var s=this.normalizeToPointerData(t),o=s.length,a=t.target!==this.interactionDOMElement?"outside":"",l=0;l<o;l++){var u=s[l],h=this.getInteractionDataForPointerId(u),f=this.configureInteractionEventForDOMEvent(this.eventData,u,h);if(f.data.originalEvent=t,this.processInteractive(f,this.lastObjectRendered,n,r||!a),this.emit(r?"pointercancel":"pointerup"+a,f),u.pointerType==="mouse"||u.pointerType==="pen"){var c=u.button===2;this.emit(c?"rightup"+a:"mouseup"+a,f)}else u.pointerType==="touch"&&(this.emit(r?"touchcancel":"touchend"+a,f),this.releaseInteractionDataForPointerId(u.pointerId))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&t.pointerType==="touch"||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,r){var n=t.data,s=t.data.identifier;r.trackedPointers[s]!==void 0&&(delete r.trackedPointers[s],this.dispatchEvent(r,"pointercancel",t),n.pointerType==="touch"&&this.dispatchEvent(r,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&t.pointerType==="touch"||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,r,n){var s=t.data,o=t.data.identifier,a=r.trackedPointers[o],l=s.pointerType==="touch",u=s.pointerType==="mouse"||s.pointerType==="pen",h=!1;if(u){var f=s.button===2,c=zn.FLAGS,d=f?c.RIGHT_DOWN:c.LEFT_DOWN,p=a!==void 0&&a.flags&d;n?(this.dispatchEvent(r,f?"rightup":"mouseup",t),p&&(this.dispatchEvent(r,f?"rightclick":"click",t),h=!0)):p&&this.dispatchEvent(r,f?"rightupoutside":"mouseupoutside",t),a&&(f?a.rightDown=!1:a.leftDown=!1)}n?(this.dispatchEvent(r,"pointerup",t),l&&this.dispatchEvent(r,"touchend",t),a&&((!u||h)&&this.dispatchEvent(r,"pointertap",t),l&&(this.dispatchEvent(r,"tap",t),a.over=!1))):a&&(this.dispatchEvent(r,"pointerupoutside",t),l&&this.dispatchEvent(r,"touchendoutside",t)),a&&a.none&&delete r.trackedPointers[o]},e.prototype.onPointerMove=function(t){if(!(this.supportsTouchEvents&&t.pointerType==="touch")){var r=this.normalizeToPointerData(t);(r[0].pointerType==="mouse"||r[0].pointerType==="pen")&&(this._didMove=!0,this.cursor=null);for(var n=r.length,s=0;s<n;s++){var o=r[s],a=this.getInteractionDataForPointerId(o),l=this.configureInteractionEventForDOMEvent(this.eventData,o,a);l.data.originalEvent=t,this.processInteractive(l,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",l),o.pointerType==="touch"&&this.emit("touchmove",l),(o.pointerType==="mouse"||o.pointerType==="pen")&&this.emit("mousemove",l)}r[0].pointerType==="mouse"&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,r,n){var s=t.data,o=s.pointerType==="touch",a=s.pointerType==="mouse"||s.pointerType==="pen";a&&this.processPointerOverOut(t,r,n),(!this.moveWhenInside||n)&&(this.dispatchEvent(r,"pointermove",t),o&&this.dispatchEvent(r,"touchmove",t),a&&this.dispatchEvent(r,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!(this.supportsTouchEvents&&t.pointerType==="touch")){var r=this.normalizeToPointerData(t),n=r[0];n.pointerType==="mouse"&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var s=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,s);o.data.originalEvent=n,this.processInteractive(o,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",o),n.pointerType==="mouse"||n.pointerType==="pen"?this.emit("mouseout",o):this.releaseInteractionDataForPointerId(s.identifier)}},e.prototype.processPointerOverOut=function(t,r,n){var s=t.data,o=t.data.identifier,a=s.pointerType==="mouse"||s.pointerType==="pen",l=r.trackedPointers[o];n&&!l&&(l=r.trackedPointers[o]=new zn(o)),l!==void 0&&(n&&this.mouseOverRenderer?(l.over||(l.over=!0,this.delayDispatchEvent(r,"pointerover",t),a&&this.delayDispatchEvent(r,"mouseover",t)),a&&this.cursor===null&&(this.cursor=r.cursor)):l.over&&(l.over=!1,this.dispatchEvent(r,"pointerout",this.eventData),a&&this.dispatchEvent(r,"mouseout",t),l.none&&delete r.trackedPointers[o]))},e.prototype.onPointerOver=function(t){var r=this.normalizeToPointerData(t),n=r[0],s=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,s);o.data.originalEvent=n,n.pointerType==="mouse"&&(this.mouseOverRenderer=!0),this.emit("pointerover",o),(n.pointerType==="mouse"||n.pointerType==="pen")&&this.emit("mouseover",o)},e.prototype.getInteractionDataForPointerId=function(t){var r=t.pointerId,n;return r===bn||t.pointerType==="mouse"?n=this.mouse:this.activeInteractionData[r]?n=this.activeInteractionData[r]:(n=this.interactionDataPool.pop()||new Ra,n.identifier=r,this.activeInteractionData[r]=n),n.copyEvent(t),n},e.prototype.releaseInteractionDataForPointerId=function(t){var r=this.activeInteractionData[t];r&&(delete this.activeInteractionData[t],r.reset(),this.interactionDataPool.push(r))},e.prototype.configureInteractionEventForDOMEvent=function(t,r,n){return t.data=n,this.mapPositionToPoint(n.global,r.clientX,r.clientY),r.pointerType==="touch"&&(r.globalX=n.global.x,r.globalY=n.global.y),n.originalEvent=r,t.reset(),t},e.prototype.normalizeToPointerData=function(t){var r=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var n=0,s=t.changedTouches.length;n<s;n++){var o=t.changedTouches[n];typeof o.button>"u"&&(o.button=t.touches.length?1:0),typeof o.buttons>"u"&&(o.buttons=t.touches.length?1:0),typeof o.isPrimary>"u"&&(o.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof o.width>"u"&&(o.width=o.radiusX||1),typeof o.height>"u"&&(o.height=o.radiusY||1),typeof o.tiltX>"u"&&(o.tiltX=0),typeof o.tiltY>"u"&&(o.tiltY=0),typeof o.pointerType>"u"&&(o.pointerType="touch"),typeof o.pointerId>"u"&&(o.pointerId=o.identifier||0),typeof o.pressure>"u"&&(o.pressure=o.force||.5),typeof o.twist>"u"&&(o.twist=0),typeof o.tangentialPressure>"u"&&(o.tangentialPressure=0),typeof o.layerX>"u"&&(o.layerX=o.offsetX=o.clientX),typeof o.layerY>"u"&&(o.layerY=o.offsetY=o.clientY),o.isNormalized=!0,r.push(o)}else if(t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof window.PointerEvent))){var a=t;typeof a.isPrimary>"u"&&(a.isPrimary=!0),typeof a.width>"u"&&(a.width=1),typeof a.height>"u"&&(a.height=1),typeof a.tiltX>"u"&&(a.tiltX=0),typeof a.tiltY>"u"&&(a.tiltY=0),typeof a.pointerType>"u"&&(a.pointerType="mouse"),typeof a.pointerId>"u"&&(a.pointerId=bn),typeof a.pressure>"u"&&(a.pressure=.5),typeof a.twist>"u"&&(a.twist=0),typeof a.tangentialPressure>"u"&&(a.tangentialPressure=0),a.isNormalized=!0,r.push(a)}else r.push(t);return r},e.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},e})(vi);/*!
 * @pixi/runner - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Ht=(function(){function i(e){this.items=[],this._name=e,this._aliasCount=0}return i.prototype.emit=function(e,t,r,n,s,o,a,l){if(arguments.length>8)throw new Error("max arguments reached");var u=this,h=u.name,f=u.items;this._aliasCount++;for(var c=0,d=f.length;c<d;c++)f[c][h](e,t,r,n,s,o,a,l);return f===this.items&&this._aliasCount--,this},i.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},i.prototype.add=function(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this},i.prototype.remove=function(e){var t=this.items.indexOf(e);return t!==-1&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this},i.prototype.contains=function(e){return this.items.indexOf(e)!==-1},i.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},i.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(i.prototype,"empty",{get:function(){return this.items.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),i})();Object.defineProperties(Ht.prototype,{dispatch:{value:Ht.prototype.emit},run:{value:Ht.prototype.emit}});/*!
 * @pixi/core - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */nt.PREFER_ENV=ce.any?Ae.WEBGL:Ae.WEBGL2;nt.STRICT_TEXTURE_CACHE=!1;var as=[];function Vl(i,e){if(!i)return null;var t="";if(typeof i=="string"){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(i);r&&(t=r[1].toLowerCase())}for(var n=as.length-1;n>=0;--n){var s=as[n];if(s.test&&s.test(i,t))return new s(i,e)}throw new Error("Unrecognized source type to auto-detect Resource")}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Ma=function(i,e){return Ma=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},Ma(i,e)};function ft(i,e){Ma(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ui=(function(){function i(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new Ht("setRealSize"),this.onUpdate=new Ht("update"),this.onError=new Ht("onError")}return i.prototype.bind=function(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},i.prototype.unbind=function(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)},i.prototype.resize=function(e,t){(e!==this._width||t!==this._height)&&(this._width=e,this._height=t,this.onResize.emit(e,t))},Object.defineProperty(i.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),i.prototype.update=function(){this.destroyed||this.onUpdate.emit()},i.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(i.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),i.prototype.style=function(e,t,r){return!1},i.prototype.dispose=function(){},i.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},i.test=function(e,t){return!1},i})(),xs=(function(i){ft(e,i);function e(t,r){var n=this,s=r||{},o=s.width,a=s.height;if(!o||!a)throw new Error("BufferResource width or height invalid");return n=i.call(this,o,a)||this,n.data=t,n}return e.prototype.upload=function(t,r,n){var s=t.gl;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Xe.UNPACK),n.width===r.width&&n.height===r.height?s.texSubImage2D(r.target,0,0,0,r.width,r.height,r.format,r.type,this.data):(n.width=r.width,n.height=r.height,s.texImage2D(r.target,0,n.internalFormat,r.width,r.height,0,r.format,n.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e})(ui),ag={scaleMode:be.NEAREST,format:oi.RGBA,alphaMode:Xe.NPM},Tt=(function(i){ft(e,i);function e(t,r){t===void 0&&(t=null),r===void 0&&(r=null);var n=i.call(this)||this;r=r||{};var s=r.alphaMode,o=r.mipmap,a=r.anisotropicLevel,l=r.scaleMode,u=r.width,h=r.height,f=r.wrapMode,c=r.format,d=r.type,p=r.target,m=r.resolution,v=r.resourceOptions;return t&&!(t instanceof ui)&&(t=Vl(t,v),t.internal=!0),n.width=u||0,n.height=h||0,n.resolution=m||nt.RESOLUTION,n.mipmap=o!==void 0?o:nt.MIPMAP_TEXTURES,n.anisotropicLevel=a!==void 0?a:nt.ANISOTROPIC_LEVEL,n.wrapMode=f||nt.WRAP_MODE,n.scaleMode=l!==void 0?l:nt.SCALE_MODE,n.format=c||oi.RGBA,n.type=d||Lt.UNSIGNED_BYTE,n.target=p||ir.TEXTURE_2D,n.alphaMode=s!==void 0?s:Xe.UNPACK,r.premultiplyAlpha!==void 0&&(n.premultiplyAlpha=r.premultiplyAlpha),n.uid=Sr(),n.touched=0,n.isPowerOfTwo=!1,n._refreshPOT(),n._glTextures={},n.dirtyId=0,n.dirtyStyleId=0,n.cacheId=null,n.valid=u>0&&h>0,n.textureCacheIds=[],n.destroyed=!1,n.resource=null,n._batchEnabled=0,n._batchLocation=0,n.parentTextureArray=null,n.setResource(t),n}return Object.defineProperty(e.prototype,"realWidth",{get:function(){return Math.ceil(this.width*this.resolution-1e-4)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"realHeight",{get:function(){return Math.ceil(this.height*this.resolution-1e-4)},enumerable:!1,configurable:!0}),e.prototype.setStyle=function(t,r){var n;return t!==void 0&&t!==this.scaleMode&&(this.scaleMode=t,n=!0),r!==void 0&&r!==this.mipmap&&(this.mipmap=r,n=!0),n&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,r,n){return this.resolution=n||this.resolution,this.width=t,this.height=r,this._refreshPOT(),this.update(),this},e.prototype.setRealSize=function(t,r,n){return this.resolution=n||this.resolution,this.width=t/this.resolution,this.height=r/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=Ea(this.realWidth)&&Ea(this.realHeight)},e.prototype.setResolution=function(t){var r=this.resolution;return r===t?this:(this.resolution=t,this.valid&&(this.width=this.width*r/t,this.height=this.height*r/t,this.emit("update",this)),this._refreshPOT(),this)},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete ue[this.cacheId],delete Kt[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.prototype.castToBaseTexture=function(){return this},e.from=function(t,r,n){n===void 0&&(n=nt.STRICT_TEXTURE_CACHE);var s=typeof t=="string",o=null;s?o=t:(t._pixiId||(t._pixiId="pixiid_"+Sr()),o=t._pixiId);var a=ue[o];if(s&&n&&!a)throw new Error('The cacheId "'+o+'" does not exist in BaseTextureCache.');return a||(a=new e(t,r),a.cacheId=o,e.addToCache(a,o)),a},e.fromBuffer=function(t,r,n,s){t=t||new Float32Array(r*n*4);var o=new xs(t,{width:r,height:n}),a=t instanceof Float32Array?Lt.FLOAT:Lt.UNSIGNED_BYTE;return new e(o,Object.assign(ag,s||{width:r,height:n,type:a}))},e.addToCache=function(t,r){r&&(t.textureCacheIds.indexOf(r)===-1&&t.textureCacheIds.push(r),ue[r]&&console.warn("BaseTexture added to the cache with an id ["+r+"] that already had an entry"),ue[r]=t)},e.removeFromCache=function(t){if(typeof t=="string"){var r=ue[t];if(r){var n=r.textureCacheIds.indexOf(t);return n>-1&&r.textureCacheIds.splice(n,1),delete ue[t],r}}else if(t&&t.textureCacheIds){for(var s=0;s<t.textureCacheIds.length;++s)delete ue[t.textureCacheIds[s]];return t.textureCacheIds.length=0,t}return null},e._globalBatch=0,e})(vi),ql=(function(i){ft(e,i);function e(t,r){var n=this,s=r||{},o=s.width,a=s.height;n=i.call(this,o,a)||this,n.items=[],n.itemDirtyIds=[];for(var l=0;l<t;l++){var u=new Tt;n.items.push(u),n.itemDirtyIds.push(-2)}return n.length=t,n._load=null,n.baseTexture=null,n}return e.prototype.initFromArray=function(t,r){for(var n=0;n<this.length;n++)t[n]&&(t[n].castToBaseTexture?this.addBaseTextureAt(t[n].castToBaseTexture(),n):t[n]instanceof ui?this.addResourceAt(t[n],n):this.addResourceAt(Vl(t[n],r),n))},e.prototype.dispose=function(){for(var t=0,r=this.length;t<r;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,r){if(!this.items[r])throw new Error("Index "+r+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[r].setResource(t),this},e.prototype.bind=function(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");i.prototype.bind.call(this,t);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=t,this.items[r].on("update",t.update,t)},e.prototype.unbind=function(t){i.prototype.unbind.call(this,t);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",t.update,t)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var r=this.items.map(function(s){return s.resource}).filter(function(s){return s}),n=r.map(function(s){return s.load()});return this._load=Promise.all(n).then(function(){var s=t.items[0],o=s.realWidth,a=s.realHeight;return t.resize(o,a),Promise.resolve(t)}),this._load},e})(ui),Ld=(function(i){ft(e,i);function e(t,r){var n=this,s=r||{},o=s.width,a=s.height,l,u;return Array.isArray(t)?(l=t,u=t.length):u=t,n=i.call(this,u,{width:o,height:a})||this,l&&n.initFromArray(l,r),n}return e.prototype.addBaseTextureAt=function(t,r){if(t.resource)this.addResourceAt(t.resource,r);else throw new Error("ArrayResource does not support RenderTexture");return this},e.prototype.bind=function(t){i.prototype.bind.call(this,t),t.target=ir.TEXTURE_2D_ARRAY},e.prototype.upload=function(t,r,n){var s=this,o=s.length,a=s.itemDirtyIds,l=s.items,u=t.gl;n.dirtyId<0&&u.texImage3D(u.TEXTURE_2D_ARRAY,0,r.format,this._width,this._height,o,0,r.format,r.type,null);for(var h=0;h<o;h++){var f=l[h];a[h]<f.dirtyId&&(a[h]=f.dirtyId,f.valid&&u.texSubImage3D(u.TEXTURE_2D_ARRAY,0,0,0,h,f.resource.width,f.resource.height,1,r.format,r.type,f.resource.source))}return!0},e})(ql),He=(function(i){ft(e,i);function e(t){var r=this,n=t,s=n.naturalWidth||n.videoWidth||n.width,o=n.naturalHeight||n.videoHeight||n.height;return r=i.call(this,s,o)||this,r.source=t,r.noSubImage=!1,r}return e.crossOrigin=function(t,r,n){n===void 0&&r.indexOf("data:")!==0?t.crossOrigin=xd(r):n!==!1&&(t.crossOrigin=typeof n=="string"?n:"anonymous")},e.prototype.upload=function(t,r,n,s){var o=t.gl,a=r.realWidth,l=r.realHeight;return s=s||this.source,o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Xe.UNPACK),!this.noSubImage&&r.target===o.TEXTURE_2D&&n.width===a&&n.height===l?o.texSubImage2D(o.TEXTURE_2D,0,0,0,r.format,r.type,s):(n.width=a,n.height=l,o.texImage2D(r.target,0,r.format,r.format,r.type,s)),!0},e.prototype.update=function(){if(!this.destroyed){var t=this.source,r=t.naturalWidth||t.videoWidth||t.width,n=t.naturalHeight||t.videoHeight||t.height;this.resize(r,n),i.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e})(ui),$l=(function(i){ft(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.test=function(t){var r=window.OffscreenCanvas;return r&&t instanceof r?!0:t instanceof HTMLCanvasElement},e})(He),Nd=(function(i){ft(e,i);function e(t,r){var n=this,s=r||{},o=s.width,a=s.height,l=s.autoLoad,u=s.linkBaseTexture;if(t&&t.length!==e.SIDES)throw new Error("Invalid length. Got "+t.length+", expected 6");n=i.call(this,6,{width:o,height:a})||this;for(var h=0;h<e.SIDES;h++)n.items[h].target=ir.TEXTURE_CUBE_MAP_POSITIVE_X+h;return n.linkBaseTexture=u!==!1,t&&n.initFromArray(t,r),l!==!1&&n.load(),n}return e.prototype.bind=function(t){i.prototype.bind.call(this,t),t.target=ir.TEXTURE_CUBE_MAP},e.prototype.addBaseTextureAt=function(t,r,n){if(n===void 0&&(n=this.linkBaseTexture),!this.items[r])throw new Error("Index "+r+" is out of bounds");if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0)if(t.resource)this.addResourceAt(t.resource,r);else throw new Error("CubeResource does not support copying of renderTexture.");else t.target=ir.TEXTURE_CUBE_MAP_POSITIVE_X+r,t.parentTextureArray=this.baseTexture,this.items[r]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[r]=t,this},e.prototype.upload=function(t,r,n){for(var s=this.itemDirtyIds,o=0;o<e.SIDES;o++){var a=this.items[o];s[o]<a.dirtyId&&(a.valid&&a.resource?(a.resource.upload(t,a,n),s[o]=a.dirtyId):s[o]<-1&&(t.gl.texImage2D(a.target,0,n.internalFormat,r.realWidth,r.realHeight,0,r.format,n.type,null),s[o]=-1))}return!0},e.test=function(t){return Array.isArray(t)&&t.length===e.SIDES},e.SIDES=6,e})(ql),jl=(function(i){ft(e,i);function e(t,r){var n=this;if(r=r||{},!(t instanceof HTMLImageElement)){var s=new Image;He.crossOrigin(s,t,r.crossorigin),s.src=t,t=s}return n=i.call(this,t)||this,!t.complete&&n._width&&n._height&&(n._width=0,n._height=0),n.url=t.src,n._process=null,n.preserveBitmap=!1,n.createBitmap=(r.createBitmap!==void 0?r.createBitmap:nt.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,n.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,r.premultiplyAlpha!==void 0&&(n.premultiplyAlpha=r.premultiplyAlpha),n.bitmap=null,n._load=null,r.autoLoad!==!1&&n.load(),n}return e.prototype.load=function(t){var r=this;return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise(function(n,s){var o=r.source;r.url=o.src;var a=function(){r.destroyed||(o.onload=null,o.onerror=null,r.resize(o.width,o.height),r._load=null,r.createBitmap?n(r.process()):n(r))};o.complete&&o.src?a():(o.onload=a,o.onerror=function(l){s(l),r.onError.emit(l)})}),this._load)},e.prototype.process=function(){var t=this,r=this.source;return this._process!==null?this._process:this.bitmap!==null||!window.createImageBitmap?Promise.resolve(this):(this._process=window.createImageBitmap(r,0,0,r.width,r.height,{premultiplyAlpha:this.alphaMode===Xe.UNPACK?"premultiply":"none"}).then(function(n){return t.destroyed?Promise.reject():(t.bitmap=n,t.update(),t._process=null,Promise.resolve(t))}),this._process)},e.prototype.upload=function(t,r,n){if(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),!this.createBitmap)return i.prototype.upload.call(this,t,r,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(i.prototype.upload.call(this,t,r,n,this.bitmap),!this.preserveBitmap){var s=!0,o=r._glTextures;for(var a in o){var l=o[a];if(l!==n&&l.dirtyId!==r.dirtyId){s=!1;break}}s&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,i.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e.test=function(t){return typeof t=="string"||t instanceof HTMLImageElement},e})(He),Bd=(function(i){ft(e,i);function e(t,r){var n=this;return r=r||{},n=i.call(this,document.createElement("canvas"))||this,n._width=0,n._height=0,n.svg=t,n.scale=r.scale||1,n._overrideWidth=r.width,n._overrideHeight=r.height,n._resolve=null,n._crossorigin=r.crossorigin,n._load=null,r.autoLoad!==!1&&n.load(),n}return e.prototype.load=function(){var t=this;return this._load?this._load:(this._load=new Promise(function(r){if(t._resolve=function(){t.resize(t.source.width,t.source.height),r(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()}),this._load)},e.prototype._loadSvg=function(){var t=this,r=new Image;He.crossOrigin(r,this.svg,this._crossorigin),r.src=this.svg,r.onerror=function(n){t._resolve&&(r.onerror=null,t.onError.emit(n))},r.onload=function(){if(t._resolve){var n=r.width,s=r.height;if(!n||!s)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var o=n*t.scale,a=s*t.scale;(t._overrideWidth||t._overrideHeight)&&(o=t._overrideWidth||t._overrideHeight/s*n,a=t._overrideHeight||t._overrideWidth/n*s),o=Math.round(o),a=Math.round(a);var l=t.source;l.width=o,l.height=a,l._pixiId="canvas_"+Sr(),l.getContext("2d").drawImage(r,0,0,n,s,0,0,o,a),t._resolve(),t._resolve=null}}},e.getSize=function(t){var r=e.SVG_SIZE.exec(t),n={};return r&&(n[r[1]]=Math.round(parseFloat(r[3])),n[r[5]]=Math.round(parseFloat(r[7]))),n},e.prototype.dispose=function(){i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,r){return r==="svg"||typeof t=="string"&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(t)||typeof t=="string"&&t.indexOf("<svg")===0},e.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,e})(He),Dd=(function(i){ft(e,i);function e(t,r){var n=this;if(r=r||{},!(t instanceof HTMLVideoElement)){var s=document.createElement("video");s.setAttribute("preload","auto"),s.setAttribute("webkit-playsinline",""),s.setAttribute("playsinline",""),typeof t=="string"&&(t=[t]);var o=t[0].src||t[0];He.crossOrigin(s,o,r.crossorigin);for(var a=0;a<t.length;++a){var l=document.createElement("source"),u=t[a],h=u.src,f=u.mime;h=h||t[a];var c=h.split("?").shift().toLowerCase(),d=c.substr(c.lastIndexOf(".")+1);f=f||e.MIME_TYPES[d]||"video/"+d,l.src=h,l.type=f,s.appendChild(l)}t=s}return n=i.call(this,t)||this,n.noSubImage=!0,n._autoUpdate=!0,n._isConnectedToTicker=!1,n._updateFPS=r.updateFPS||0,n._msToNextUpdate=0,n.autoPlay=r.autoPlay!==!1,n._load=null,n._resolve=null,n._onCanPlay=n._onCanPlay.bind(n),n._onError=n._onError.bind(n),r.autoLoad!==!1&&n.load(),n}return e.prototype.update=function(t){if(!this.destroyed){var r=Dt.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(i.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var r=this.source;return(r.readyState===r.HAVE_ENOUGH_DATA||r.readyState===r.HAVE_FUTURE_DATA)&&r.width&&r.height&&(r.complete=!0),r.addEventListener("play",this._onPlayStart.bind(this)),r.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(r.addEventListener("canplay",this._onCanPlay),r.addEventListener("canplaythrough",this._onCanPlay),r.addEventListener("error",this._onError,!0)),this._load=new Promise(function(n){t.valid?n(t):(t._resolve=n,r.load())}),this._load},e.prototype._onError=function(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&t.paused===!1&&t.ended===!1&&t.readyState>2},e.prototype._isSourceReady=function(){var t=this.source;return t.readyState===3||t.readyState===4},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Dt.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Dt.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var r=this.valid;this.resize(t.videoWidth,t.videoHeight),!r&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&Dt.shared.remove(this.update,this);var t=this.source;t&&(t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),i.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Dt.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Dt.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(t){t!==this._updateFPS&&(this._updateFPS=t)},enumerable:!1,configurable:!0}),e.test=function(t,r){return t instanceof HTMLVideoElement||e.TYPES.indexOf(r)>-1},e.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],e.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},e})(He),kd=(function(i){ft(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e})(He);as.push(jl,kd,$l,Dd,Bd,xs,Nd,Ld);var Ud={Resource:ui,BaseImageResource:He,INSTALLED:as,autoDetectResource:Vl,AbstractMultiResource:ql,ArrayResource:Ld,BufferResource:xs,CanvasResource:$l,CubeResource:Nd,ImageResource:jl,SVGResource:Bd,VideoResource:Dd,ImageBitmapResource:kd},ee=(function(){function i(e){this.renderer=e}return i.prototype.destroy=function(){this.renderer=null},i})(),lg=(function(i){ft(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.upload=function(t,r,n){var s=t.gl;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Xe.UNPACK),n.width===r.width&&n.height===r.height?s.texSubImage2D(r.target,0,0,0,r.width,r.height,r.format,r.type,this.data):(n.width=r.width,n.height=r.height,s.texImage2D(r.target,0,t.context.webGLVersion===1?s.DEPTH_COMPONENT:s.DEPTH_COMPONENT16,r.width,r.height,0,r.format,r.type,this.data)),!0},e})(xs),ls=(function(){function i(e,t){this.width=Math.ceil(e||100),this.height=Math.ceil(t||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Ht("disposeFramebuffer"),this.multisample=Ir.NONE}return Object.defineProperty(i.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),i.prototype.addColorTexture=function(e,t){return e===void 0&&(e=0),this.colorTextures[e]=t||new Tt(null,{scaleMode:be.NEAREST,resolution:1,mipmap:ai.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},i.prototype.addDepthTexture=function(e){return this.depthTexture=e||new Tt(new lg(null,{width:this.width,height:this.height}),{scaleMode:be.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:ai.OFF,format:oi.DEPTH_COMPONENT,type:Lt.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},i.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},i.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},i.prototype.resize=function(e,t){if(e=Math.ceil(e),t=Math.ceil(t),!(e===this.width&&t===this.height)){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var n=this.colorTextures[r],s=n.resolution;n.setSize(e/s,t/s)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(e/s,t/s)}}},i.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},i.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},i})(),Ui=(function(i){ft(e,i);function e(t){var r=this;if(typeof t=="number"){var n=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3];t={width:n,height:s,scaleMode:o,resolution:a}}r=i.call(this,null,t)||this;var l=t||{},u=l.width,h=l.height;return r.mipmap=0,r.width=Math.ceil(u)||100,r.height=Math.ceil(h)||100,r.valid=!0,r.clearColor=[0,0,0,0],r.framebuffer=new ls(r.width*r.resolution,r.height*r.resolution).addColorTexture(0,r),r.maskStack=[],r.filterStack=[{}],r}return e.prototype.resize=function(t,r){t=Math.ceil(t),r=Math.ceil(r),this.framebuffer.resize(t*this.resolution,r*this.resolution)},e.prototype.dispose=function(){this.framebuffer.dispose(),i.prototype.dispose.call(this)},e.prototype.destroy=function(){i.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},e})(Tt),Wl=(function(){function i(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return i.prototype.set=function(e,t,r){var n=t.width,s=t.height;if(r){var o=e.width/2/n,a=e.height/2/s,l=e.x/n+o,u=e.y/s+a;r=Ct.add(r,Ct.NW),this.x0=l+o*Ct.uX(r),this.y0=u+a*Ct.uY(r),r=Ct.add(r,2),this.x1=l+o*Ct.uX(r),this.y1=u+a*Ct.uY(r),r=Ct.add(r,2),this.x2=l+o*Ct.uX(r),this.y2=u+a*Ct.uY(r),r=Ct.add(r,2),this.x3=l+o*Ct.uX(r),this.y3=u+a*Ct.uY(r)}else this.x0=e.x/n,this.y0=e.y/s,this.x1=(e.x+e.width)/n,this.y1=e.y/s,this.x2=(e.x+e.width)/n,this.y2=(e.y+e.height)/s,this.x3=e.x/n,this.y3=(e.y+e.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},i})(),nf=new Wl,lt=(function(i){ft(e,i);function e(t,r,n,s,o,a){var l=i.call(this)||this;if(l.noFrame=!1,r||(l.noFrame=!0,r=new vt(0,0,1,1)),t instanceof e&&(t=t.baseTexture),l.baseTexture=t,l._frame=r,l.trim=s,l.valid=!1,l._uvs=nf,l.uvMatrix=null,l.orig=n||r,l._rotate=Number(o||0),o===!0)l._rotate=2;else if(l._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return l.defaultAnchor=a?new kt(a.x,a.y):new kt(0,0),l._updateID=0,l.textureCacheIds=[],t.valid?l.noFrame?t.valid&&l.onBaseTextureUpdated(t):l.frame=r:t.once("loaded",l.onBaseTextureUpdated,l),l.noFrame&&t.on("update",l.onBaseTextureUpdated,l),l}return e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var r=this.baseTexture;r&&r.url&&Kt[r.url]&&e.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},e.prototype.updateUvs=function(){this._uvs===nf&&(this._uvs=new Wl),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,r,n){r===void 0&&(r={}),n===void 0&&(n=nt.STRICT_TEXTURE_CACHE);var s=typeof t=="string",o=null;s?o=t:(t._pixiId||(t._pixiId="pixiid_"+Sr()),o=t._pixiId);var a=Kt[o];if(s&&n&&!a)throw new Error('The cacheId "'+o+'" does not exist in TextureCache.');return a||(r.resolution||(r.resolution=qi(t)),a=new e(new Tt(t,r)),a.baseTexture.cacheId=o,Tt.addToCache(a.baseTexture,o),e.addToCache(a,o)),a},e.fromURL=function(t,r){var n=Object.assign({autoLoad:!1},r?.resourceOptions),s=e.from(t,Object.assign({resourceOptions:n},r),!1),o=s.baseTexture.resource;return s.baseTexture.valid?Promise.resolve(s):o.load().then(function(){return Promise.resolve(s)})},e.fromBuffer=function(t,r,n,s){return new e(Tt.fromBuffer(t,r,n,s))},e.fromLoader=function(t,r,n){var s=new jl(t);s.url=r;var o=new Tt(s,{scaleMode:nt.SCALE_MODE,resolution:qi(r)}),a=new e(o);return n||(n=r),Tt.addToCache(a.baseTexture,n),e.addToCache(a,n),n!==r&&(Tt.addToCache(a.baseTexture,r),e.addToCache(a,r)),a},e.addToCache=function(t,r){r&&(t.textureCacheIds.indexOf(r)===-1&&t.textureCacheIds.push(r),Kt[r]&&console.warn("Texture added to the cache with an id ["+r+"] that already had an entry"),Kt[r]=t)},e.removeFromCache=function(t){if(typeof t=="string"){var r=Kt[t];if(r){var n=r.textureCacheIds.indexOf(t);return n>-1&&r.textureCacheIds.splice(n,1),delete Kt[t],r}}else if(t&&t.textureCacheIds){for(var s=0;s<t.textureCacheIds.length;++s)Kt[t.textureCacheIds[s]]===t&&delete Kt[t.textureCacheIds[s]];return t.textureCacheIds.length=0,t}return null},Object.defineProperty(e.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var r=t.x,n=t.y,s=t.width,o=t.height,a=r+s>this.baseTexture.width,l=n+o>this.baseTexture.height;if(a||l){var u=a&&l?"and":"or",h="X: "+r+" + "+s+" = "+(r+s)+" > "+this.baseTexture.width,f="Y: "+n+" + "+o+" = "+(n+o)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+(h+" "+u+" "+f))}this.valid=s&&o&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotate",{get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),e.prototype.castToBaseTexture=function(){return this.baseTexture},e})(vi);function ug(){var i=document.createElement("canvas");i.width=16,i.height=16;var e=i.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new lt(new Tt(new $l(i)))}function ws(i){i.destroy=function(){},i.on=function(){},i.once=function(){},i.emit=function(){}}lt.EMPTY=new lt(new Tt);ws(lt.EMPTY);ws(lt.EMPTY.baseTexture);lt.WHITE=ug();ws(lt.WHITE);ws(lt.WHITE.baseTexture);var Ar=(function(i){ft(e,i);function e(t,r){var n=this,s=null;if(!(t instanceof Ui)){var o=arguments[1],a=arguments[2],l=arguments[3],u=arguments[4];console.warn("Please use RenderTexture.create("+o+", "+a+") instead of the ctor directly."),s=arguments[0],r=null,t=new Ui({width:o,height:a,scaleMode:l,resolution:u})}return n=i.call(this,t,r)||this,n.legacyRenderer=s,n.valid=!0,n.filterFrame=null,n.filterPoolKey=null,n.updateUvs(),n}return Object.defineProperty(e.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,r,n){n===void 0&&(n=!0),t=Math.ceil(t),r=Math.ceil(r),this.valid=t>0&&r>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=r,n&&this.baseTexture.resize(t,r),this.updateUvs()},e.prototype.setResolution=function(t){var r=this.baseTexture;r.resolution!==t&&(r.setResolution(t),this.resize(r.width,r.height,!1))},e.create=function(t){return typeof t=="number"&&(t={width:t,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new e(new Ui(t))},e})(lt),Xd=(function(){function i(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return i.prototype.createTexture=function(e,t){var r=new Ui(Object.assign({width:e,height:t,resolution:1},this.textureOptions));return new Ar(r)},i.prototype.getOptimalTexture=function(e,t,r){r===void 0&&(r=1);var n=i.SCREEN_KEY;e*=r,t*=r,(!this.enableFullScreen||e!==this._pixelsWidth||t!==this._pixelsHeight)&&(e=Vi(e),t=Vi(t),n=(e&65535)<<16|t&65535),this.texturePool[n]||(this.texturePool[n]=[]);var s=this.texturePool[n].pop();return s||(s=this.createTexture(e,t)),s.filterPoolKey=n,s.setResolution(r),s},i.prototype.getFilterTexture=function(e,t){var r=this.getOptimalTexture(e.width,e.height,t||e.resolution);return r.filterFrame=e.filterFrame,r},i.prototype.returnTexture=function(e){var t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)},i.prototype.returnFilterTexture=function(e){this.returnTexture(e)},i.prototype.clear=function(e){if(e=e!==!1,e)for(var t in this.texturePool){var r=this.texturePool[t];if(r)for(var n=0;n<r.length;n++)r[n].destroy(!0)}this.texturePool={}},i.prototype.setScreenSize=function(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){var t=i.SCREEN_KEY,r=this.texturePool[t];if(this.enableFullScreen=e.width>0&&e.height>0,r)for(var n=0;n<r.length;n++)r[n].destroy(!0);this.texturePool[t]=[],this._pixelsWidth=e.width,this._pixelsHeight=e.height}},i.SCREEN_KEY="screen",i})(),La=(function(){function i(e,t,r,n,s,o,a){t===void 0&&(t=0),r===void 0&&(r=!1),n===void 0&&(n=5126),this.buffer=e,this.size=t,this.normalized=r,this.type=n,this.stride=s,this.start=o,this.instance=a}return i.prototype.destroy=function(){this.buffer=null},i.from=function(e,t,r,n,s){return new i(e,t,r,n,s)},i})(),hg=0,Mt=(function(){function i(e,t,r){t===void 0&&(t=!0),r===void 0&&(r=!1),this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=t,this.id=hg++,this.disposeRunner=new Ht("disposeBuffer")}return i.prototype.update=function(e){this.data=e||this.data,this._updateID++},i.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},i.prototype.destroy=function(){this.dispose(),this.data=null},i.from=function(e){return e instanceof Array&&(e=new Float32Array(e)),new i(e)},i})();function Hd(i){if(i.BYTES_PER_ELEMENT===4)return i instanceof Float32Array?"Float32Array":i instanceof Uint32Array?"Uint32Array":"Int32Array";if(i.BYTES_PER_ELEMENT===2){if(i instanceof Uint16Array)return"Uint16Array"}else if(i.BYTES_PER_ELEMENT===1&&i instanceof Uint8Array)return"Uint8Array";return null}var fg={Float32Array,Uint32Array,Int32Array,Uint8Array};function cg(i,e){for(var t=0,r=0,n={},s=0;s<i.length;s++)r+=e[s],t+=i[s].length;for(var o=new ArrayBuffer(t*4),a=null,l=0,s=0;s<i.length;s++){var u=e[s],h=i[s],f=Hd(h);n[f]||(n[f]=new fg[f](o)),a=n[f];for(var c=0;c<h.length;c++){var d=(c/u|0)*r+l,p=c%u;a[d+p]=h[c]}l+=u}return new Float32Array(o)}var sf={5126:4,5123:2,5121:1},dg=0,pg={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},Mr=(function(){function i(e,t){e===void 0&&(e=[]),t===void 0&&(t={}),this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=dg++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Ht("disposeGeometry"),this.refCount=0}return i.prototype.addAttribute=function(e,t,r,n,s,o,a,l){if(r===void 0&&(r=0),n===void 0&&(n=!1),l===void 0&&(l=!1),!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof Mt||(t instanceof Array&&(t=new Float32Array(t)),t=new Mt(t));var u=e.split("|");if(u.length>1){for(var h=0;h<u.length;h++)this.addAttribute(u[h],t,r,n,s);return this}var f=this.buffers.indexOf(t);return f===-1&&(this.buffers.push(t),f=this.buffers.length-1),this.attributes[e]=new La(f,r,n,s,o,a,l),this.instanced=this.instanced||l,this},i.prototype.getAttribute=function(e){return this.attributes[e]},i.prototype.getBuffer=function(e){return this.buffers[this.getAttribute(e).buffer]},i.prototype.addIndex=function(e){return e instanceof Mt||(e instanceof Array&&(e=new Uint16Array(e)),e=new Mt(e)),e.index=!0,this.indexBuffer=e,this.buffers.indexOf(e)===-1&&this.buffers.push(e),this},i.prototype.getIndex=function(){return this.indexBuffer},i.prototype.interleave=function(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;var e=[],t=[],r=new Mt,n;for(n in this.attributes){var s=this.attributes[n],o=this.buffers[s.buffer];e.push(o.data),t.push(s.size*sf[s.type]/4),s.buffer=0}for(r.data=cg(e,t),n=0;n<this.buffers.length;n++)this.buffers[n]!==this.indexBuffer&&this.buffers[n].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},i.prototype.getSize=function(){for(var e in this.attributes){var t=this.attributes[e],r=this.buffers[t.buffer];return r.data.length/(t.stride/4||t.size)}return 0},i.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},i.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},i.prototype.clone=function(){for(var e=new i,t=0;t<this.buffers.length;t++)e.buffers[t]=new Mt(this.buffers[t].data.slice(0));for(var t in this.attributes){var r=this.attributes[t];e.attributes[t]=new La(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.index=!0),e},i.merge=function(e){for(var t=new i,r=[],n=[],s=[],o,a=0;a<e.length;a++){o=e[a];for(var l=0;l<o.buffers.length;l++)n[l]=n[l]||0,n[l]+=o.buffers[l].data.length,s[l]=0}for(var a=0;a<o.buffers.length;a++)r[a]=new pg[Hd(o.buffers[a].data)](n[a]),t.buffers[a]=new Mt(r[a]);for(var a=0;a<e.length;a++){o=e[a];for(var l=0;l<o.buffers.length;l++)r[l].set(o.buffers[l].data,s[l]),s[l]+=o.buffers[l].data.length}if(t.attributes=o.attributes,o.indexBuffer){t.indexBuffer=t.buffers[o.buffers.indexOf(o.indexBuffer)],t.indexBuffer.index=!0;for(var u=0,h=0,f=0,c=0,a=0;a<o.buffers.length;a++)if(o.buffers[a]!==o.indexBuffer){c=a;break}for(var a in o.attributes){var d=o.attributes[a];(d.buffer|0)===c&&(h+=d.size*sf[d.type]/4)}for(var a=0;a<e.length;a++){for(var p=e[a].indexBuffer.data,l=0;l<p.length;l++)t.indexBuffer.data[l+f]+=u;u+=o.buffers[c].data.length/h,f+=p.length}}return t},i})(),Gd=(function(i){ft(e,i);function e(){var t=i.call(this)||this;return t.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),t}return e})(Mr),Kl=(function(i){ft(e,i);function e(){var t=i.call(this)||this;return t.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),t.uvs=new Float32Array([0,0,1,0,1,1,0,1]),t.vertexBuffer=new Mt(t.vertices),t.uvBuffer=new Mt(t.uvs),t.addAttribute("aVertexPosition",t.vertexBuffer).addAttribute("aTextureCoord",t.uvBuffer).addIndex([0,1,2,0,2,3]),t}return e.prototype.map=function(t,r){var n=0,s=0;return this.uvs[0]=n,this.uvs[1]=s,this.uvs[2]=n+r.width/t.width,this.uvs[3]=s,this.uvs[4]=n+r.width/t.width,this.uvs[5]=s+r.height/t.height,this.uvs[6]=n,this.uvs[7]=s+r.height/t.height,n=r.x,s=r.y,this.vertices[0]=n,this.vertices[1]=s,this.vertices[2]=n+r.width,this.vertices[3]=s,this.vertices[4]=n+r.width,this.vertices[5]=s+r.height,this.vertices[6]=n,this.vertices[7]=s+r.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e})(Mr),yg=0,nr=(function(){function i(e,t){this.uniforms=e,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=yg++,this.static=!!t}return i.prototype.update=function(){this.dirtyId++},i.prototype.add=function(e,t,r){this.uniforms[e]=new i(t,r)},i.from=function(e,t){return new i(e,t)},i})(),Yd=(function(){function i(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new vt,this.destinationFrame=new vt,this.filters=[]}return i.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},i})(),zd=(function(i){ft(e,i);function e(t){var r=i.call(this,t)||this;return r.defaultFilterStack=[{}],r.texturePool=new Xd,r.texturePool.setScreenSize(t.view),r.statePool=[],r.quad=new Gd,r.quadUv=new Kl,r.tempRect=new vt,r.activeState={},r.globalUniforms=new nr({outputFrame:r.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),r.forceClear=!1,r.useMaxPadding=!1,r}return e.prototype.push=function(t,r){for(var n=this.renderer,s=this.defaultFilterStack,o=this.statePool.pop()||new Yd,a=r[0].resolution,l=r[0].padding,u=r[0].autoFit,h=r[0].legacy,f=1;f<r.length;f++){var c=r[f];a=Math.min(a,c.resolution),l=this.useMaxPadding?Math.max(l,c.padding):l+c.padding,u=u&&c.autoFit,h=h||c.legacy}s.length===1&&(this.defaultFilterStack[0].renderTexture=n.renderTexture.current),s.push(o),o.resolution=a,o.legacy=h,o.target=t,o.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),o.sourceFrame.pad(l),u&&o.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),o.sourceFrame.ceil(a),o.renderTexture=this.getOptimalFilterTexture(o.sourceFrame.width,o.sourceFrame.height,a),o.filters=r,o.destinationFrame.width=o.renderTexture.width,o.destinationFrame.height=o.renderTexture.height;var d=this.tempRect;d.width=o.sourceFrame.width,d.height=o.sourceFrame.height,o.renderTexture.filterFrame=o.sourceFrame,n.renderTexture.bind(o.renderTexture,o.sourceFrame,d),n.renderTexture.clear()},e.prototype.pop=function(){var t=this.defaultFilterStack,r=t.pop(),n=r.filters;this.activeState=r;var s=this.globalUniforms.uniforms;s.outputFrame=r.sourceFrame,s.resolution=r.resolution;var o=s.inputSize,a=s.inputPixel,l=s.inputClamp;if(o[0]=r.destinationFrame.width,o[1]=r.destinationFrame.height,o[2]=1/o[0],o[3]=1/o[1],a[0]=o[0]*r.resolution,a[1]=o[1]*r.resolution,a[2]=1/a[0],a[3]=1/a[1],l[0]=.5*a[2],l[1]=.5*a[3],l[2]=r.sourceFrame.width*o[2]-.5*a[2],l[3]=r.sourceFrame.height*o[3]-.5*a[3],r.legacy){var u=s.filterArea;u[0]=r.destinationFrame.width,u[1]=r.destinationFrame.height,u[2]=r.sourceFrame.x,u[3]=r.sourceFrame.y,s.filterClamp=s.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(r.renderTexture.framebuffer.multisample>1&&this.renderer.framebuffer.blit(),n.length===1)n[0].apply(this,r.renderTexture,h.renderTexture,ge.BLEND,r),this.returnFilterTexture(r.renderTexture);else{var f=r.renderTexture,c=this.getOptimalFilterTexture(f.width,f.height,r.resolution);c.filterFrame=f.filterFrame;var d=0;for(d=0;d<n.length-1;++d){n[d].apply(this,f,c,ge.CLEAR,r);var p=f;f=c,c=p}n[d].apply(this,f,h.renderTexture,ge.BLEND,r),this.returnFilterTexture(f),this.returnFilterTexture(c)}r.clear(),this.statePool.push(r)},e.prototype.bindAndClear=function(t,r){if(r===void 0&&(r=ge.CLEAR),t&&t.filterFrame){var n=this.tempRect;n.width=t.filterFrame.width,n.height=t.filterFrame.height,this.renderer.renderTexture.bind(t,t.filterFrame,n)}else this.renderer.renderTexture.bind(t);typeof r=="boolean"&&(r=r?ge.CLEAR:ge.BLEND,K("5.2.1","Use CLEAR_MODES when using clear applyFilter option")),(r===ge.CLEAR||r===ge.BLIT&&this.forceClear)&&this.renderer.renderTexture.clear()},e.prototype.applyFilter=function(t,r,n,s){var o=this.renderer;this.bindAndClear(n,s),t.uniforms.uSampler=r,t.uniforms.filterGlobals=this.globalUniforms,o.state.set(t.state),o.shader.bind(t),t.legacy?(this.quadUv.map(r._frame,r.filterFrame),o.geometry.bind(this.quadUv),o.geometry.draw(ae.TRIANGLES)):(o.geometry.bind(this.quad),o.geometry.draw(ae.TRIANGLE_STRIP))},e.prototype.calculateSpriteMatrix=function(t,r){var n=this.activeState,s=n.sourceFrame,o=n.destinationFrame,a=r._texture.orig,l=t.set(o.width,0,0,o.height,s.x,s.y),u=r.worldTransform.copyTo(Rt.TEMP_MATRIX);return u.invert(),l.prepend(u),l.scale(1/a.width,1/a.height),l.translate(r.anchor.x,r.anchor.y),l},e.prototype.destroy=function(){this.texturePool.clear(!1)},e.prototype.getOptimalFilterTexture=function(t,r,n){return n===void 0&&(n=1),this.texturePool.getOptimalTexture(t,r,n)},e.prototype.getFilterTexture=function(t,r){if(typeof t=="number"){var n=t;t=r,r=n}t=t||this.activeState.renderTexture;var s=this.texturePool.getOptimalTexture(t.width,t.height,r||t.resolution);return s.filterFrame=t.filterFrame,s},e.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},e.prototype.emptyPool=function(){this.texturePool.clear(!0)},e.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},e})(ee),gi=(function(){function i(e){this.renderer=e}return i.prototype.flush=function(){},i.prototype.destroy=function(){this.renderer=null},i.prototype.start=function(){},i.prototype.stop=function(){this.flush()},i.prototype.render=function(e){},i})(),Vd=(function(i){ft(e,i);function e(t){var r=i.call(this,t)||this;return r.emptyRenderer=new gi(t),r.currentRenderer=r.emptyRenderer,r}return e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.copyBoundTextures=function(t,r){for(var n=this.renderer.texture.boundTextures,s=r-1;s>=0;--s)t[s]=n[s]||null,t[s]&&(t[s]._batchLocation=s)},e.prototype.boundArray=function(t,r,n,s){for(var o=t.elements,a=t.ids,l=t.count,u=0,h=0;h<l;h++){var f=o[h],c=f._batchLocation;if(c>=0&&c<s&&r[c]===f){a[h]=c;continue}for(;u<s;){var d=r[u];if(d&&d._batchEnabled===n&&d._batchLocation===u){u++;continue}a[h]=u,f._batchLocation=u,r[u]=f;break}}},e})(ee),of=0,qd=(function(i){ft(e,i);function e(t){var r=i.call(this,t)||this;return r.webGLVersion=1,r.extensions={},r.supports={uint32Indices:!1},r.handleContextLost=r.handleContextLost.bind(r),r.handleContextRestored=r.handleContextRestored.bind(r),t.view.addEventListener("webglcontextlost",r.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",r.handleContextRestored,!1),r}return Object.defineProperty(e.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),e.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=of++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},e.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=of++,this.renderer.runners.contextChange.emit(t)},e.prototype.initFromOptions=function(t){var r=this.createContext(this.renderer.view,t);this.initFromContext(r)},e.prototype.createContext=function(t,r){var n;if(nt.PREFER_ENV>=Ae.WEBGL2&&(n=t.getContext("webgl2",r)),n)this.webGLVersion=2;else if(this.webGLVersion=1,n=t.getContext("webgl",r)||t.getContext("experimental-webgl",r),!n)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl},e.prototype.getExtensions=function(){var t=this.gl;this.webGLVersion===1?Object.assign(this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},e.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},e.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},e.prototype.validateContext=function(t){var r=t.getContextAttributes(),n="WebGL2RenderingContext"in window&&t instanceof window.WebGL2RenderingContext;n&&(this.webGLVersion=2),r.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var s=n||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=s,s||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},e})(ee),$d=(function(){function i(e){this.framebuffer=e,this.stencil=null,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.multisample=Ir.NONE,this.msaaBuffer=null,this.blitFramebuffer=null}return i})(),vg=new vt,jd=(function(i){ft(e,i);function e(t){var r=i.call(this,t)||this;return r.managedFramebuffers=[],r.unknownFramebuffer=new ls(10,10),r.msaaSamples=null,r}return e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new vt,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),this.renderer.context.webGLVersion===1){var r=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;nt.PREFER_ENV===Ae.WEBGL_LEGACY&&(r=null,n=null),r?t.drawBuffers=function(s){return r.drawBuffersWEBGL(s)}:(this.hasMRT=!1,t.drawBuffers=function(){}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)},e.prototype.bind=function(t,r){var n=this.gl;if(t){var s=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,n.bindFramebuffer(n.FRAMEBUFFER,s.framebuffer)),s.dirtyId!==t.dirtyId&&(s.dirtyId=t.dirtyId,s.dirtyFormat!==t.dirtyFormat?(s.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):s.dirtySize!==t.dirtySize&&(s.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var o=0;o<t.colorTextures.length;o++){var a=t.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},e.prototype.setViewport=function(t,r,n,s){var o=this.viewport;(o.width!==n||o.height!==s||o.x!==t||o.y!==r)&&(o.x=t,o.y=r,o.width=n,o.height=s,this.gl.viewport(t,r,n,s))},Object.defineProperty(e.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),e.prototype.clear=function(t,r,n,s,o){o===void 0&&(o=zi.COLOR|zi.DEPTH);var a=this.gl;a.clearColor(t,r,n,s),a.clear(o)},e.prototype.initFramebuffer=function(t){var r=this.gl,n=new $d(r.createFramebuffer());return n.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(t),t.disposeRunner.add(this),n},e.prototype.resizeFramebuffer=function(t){var r=this.gl,n=t.glFramebuffers[this.CONTEXT_UID];n.stencil&&(r.bindRenderbuffer(r.RENDERBUFFER,n.stencil),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,t.width,t.height));for(var s=t.colorTextures,o=0;o<s.length;o++)this.renderer.texture.bind(s[o],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},e.prototype.updateFramebuffer=function(t){var r=this.gl,n=t.glFramebuffers[this.CONTEXT_UID],s=t.colorTextures,o=s.length;r.drawBuffers||(o=Math.min(o,1)),n.multisample>1&&(n.msaaBuffer=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,n.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,r.RGBA8,t.width,t.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,n.msaaBuffer));for(var a=[],l=0;l<o;l++)if(!(l===0&&n.multisample>1)){var u=t.colorTextures[l],h=u.parentTextureArray||u;this.renderer.texture.bind(h,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+l,u.target,h._glTextures[this.CONTEXT_UID].texture,0),a.push(r.COLOR_ATTACHMENT0+l)}if(a.length>1&&r.drawBuffers(a),t.depthTexture){var f=this.writeDepthTexture;if(f){var c=t.depthTexture;this.renderer.texture.bind(c,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,c._glTextures[this.CONTEXT_UID].texture,0)}}!n.stencil&&(t.stencil||t.depth)&&(n.stencil=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,n.stencil),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,t.width,t.height),t.depthTexture||r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,n.stencil))},e.prototype.detectSamples=function(t){var r=this.msaaSamples,n=Ir.NONE;if(t<=1||r===null)return n;for(var s=0;s<r.length;s++)if(r[s]<=t){n=r[s];break}return n===1&&(n=Ir.NONE),n},e.prototype.blit=function(t,r,n){var s=this,o=s.current,a=s.renderer,l=s.gl,u=s.CONTEXT_UID;if(a.context.webGLVersion===2&&o){var h=o.glFramebuffers[u];if(h){if(!t){if(h.multisample<=1)return;h.blitFramebuffer||(h.blitFramebuffer=new ls(o.width,o.height),h.blitFramebuffer.addColorTexture(0,o.colorTextures[0])),t=h.blitFramebuffer,t.width=o.width,t.height=o.height}r||(r=vg,r.width=o.width,r.height=o.height),n||(n=r);var f=r.width===n.width&&r.height===n.height;this.bind(t),l.bindFramebuffer(l.READ_FRAMEBUFFER,h.framebuffer),l.blitFramebuffer(r.x,r.y,r.width,r.height,n.x,n.y,n.width,n.height,l.COLOR_BUFFER_BIT,f?l.NEAREST:l.LINEAR)}}},e.prototype.disposeFramebuffer=function(t,r){var n=t.glFramebuffers[this.CONTEXT_UID],s=this.gl;if(n){delete t.glFramebuffers[this.CONTEXT_UID];var o=this.managedFramebuffers.indexOf(t);o>=0&&this.managedFramebuffers.splice(o,1),t.disposeRunner.remove(this),r||(s.deleteFramebuffer(n.framebuffer),n.stencil&&s.deleteRenderbuffer(n.stencil))}},e.prototype.disposeAll=function(t){var r=this.managedFramebuffers;this.managedFramebuffers=[];for(var n=0;n<r.length;n++)this.disposeFramebuffer(r[n],t)},e.prototype.forceStencil=function(){var t=this.current;if(t){var r=t.glFramebuffers[this.CONTEXT_UID];if(!(!r||r.stencil)){t.enableStencil();var n=t.width,s=t.height,o=this.gl,a=o.createRenderbuffer();o.bindRenderbuffer(o.RENDERBUFFER,a),o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,n,s),r.stencil=a,o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,a)}}},e.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new vt},e})(ee),mg=(function(){function i(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}return i})(),Vo={5126:4,5123:2,5121:1},Wd=(function(i){ft(e,i);function e(t){var r=i.call(this,t)||this;return r._activeGeometry=null,r._activeVao=null,r.hasVao=!0,r.hasInstance=!0,r.canUseUInt32ElementIndex=!1,r.managedGeometries={},r.managedBuffers={},r}return e.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,r=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,r.webGLVersion!==2){var n=this.renderer.context.extensions.vertexArrayObject;nt.PREFER_ENV===Ae.WEBGL_LEGACY&&(n=null),n?(t.createVertexArray=function(){return n.createVertexArrayOES()},t.bindVertexArray=function(o){return n.bindVertexArrayOES(o)},t.deleteVertexArray=function(o){return n.deleteVertexArrayOES(o)}):(this.hasVao=!1,t.createVertexArray=function(){return null},t.bindVertexArray=function(){return null},t.deleteVertexArray=function(){return null})}if(r.webGLVersion!==2){var s=t.getExtension("ANGLE_instanced_arrays");s?(t.vertexAttribDivisor=function(o,a){return s.vertexAttribDivisorANGLE(o,a)},t.drawElementsInstanced=function(o,a,l,u,h){return s.drawElementsInstancedANGLE(o,a,l,u,h)},t.drawArraysInstanced=function(o,a,l,u){return s.drawArraysInstancedANGLE(o,a,l,u)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=r.webGLVersion===2||!!r.extensions.uint32ElementIndex},e.prototype.bind=function(t,r){r=r||this.renderer.shader.shader;var n=this.gl,s=t.glVertexArrayObjects[this.CONTEXT_UID],o=!1;s||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=s={},o=!0);var a=s[r.program.id]||this.initGeometryVao(t,r.program,o);this._activeGeometry=t,this._activeVao!==a&&(this._activeVao=a,this.hasVao?n.bindVertexArray(a):this.activateVao(t,r.program)),this.updateBuffers()},e.prototype.reset=function(){this.unbind()},e.prototype.updateBuffers=function(){for(var t=this._activeGeometry,r=this.gl,n=0;n<t.buffers.length;n++){var s=t.buffers[n],o=s._glBuffers[this.CONTEXT_UID];if(s._updateID!==o.updateID){o.updateID=s._updateID;var a=s.index?r.ELEMENT_ARRAY_BUFFER:r.ARRAY_BUFFER;if(r.bindBuffer(a,o.buffer),this._boundBuffer=o,o.byteLength>=s.data.byteLength)r.bufferSubData(a,0,s.data);else{var l=s.static?r.STATIC_DRAW:r.DYNAMIC_DRAW;o.byteLength=s.data.byteLength,r.bufferData(a,s.data,l)}}}},e.prototype.checkCompatibility=function(t,r){var n=t.attributes,s=r.attributeData;for(var o in s)if(!n[o])throw new Error('shader and geometry incompatible, geometry missing the "'+o+'" attribute')},e.prototype.getSignature=function(t,r){var n=t.attributes,s=r.attributeData,o=["g",t.id];for(var a in n)s[a]&&o.push(a);return o.join("-")},e.prototype.initGeometryVao=function(t,r,n){n===void 0&&(n=!0),this.checkCompatibility(t,r);var s=this.gl,o=this.CONTEXT_UID,a=this.getSignature(t,r),l=t.glVertexArrayObjects[this.CONTEXT_UID],u=l[a];if(u)return l[r.id]=u,u;var h=t.buffers,f=t.attributes,c={},d={};for(var p in h)c[p]=0,d[p]=0;for(var p in f)!f[p].size&&r.attributeData[p]?f[p].size=r.attributeData[p].size:f[p].size||console.warn("PIXI Geometry attribute '"+p+"' size cannot be determined (likely the bound shader does not have the attribute)"),c[f[p].buffer]+=f[p].size*Vo[f[p].type];for(var p in f){var m=f[p],v=m.size;m.stride===void 0&&(c[m.buffer]===v*Vo[m.type]?m.stride=0:m.stride=c[m.buffer]),m.start===void 0&&(m.start=d[m.buffer],d[m.buffer]+=v*Vo[m.type])}u=s.createVertexArray(),s.bindVertexArray(u);for(var g=0;g<h.length;g++){var I=h[g];I._glBuffers[o]||(I._glBuffers[o]=new mg(s.createBuffer()),this.managedBuffers[I.id]=I,I.disposeRunner.add(this)),n&&I._glBuffers[o].refCount++}return this.activateVao(t,r),this._activeVao=u,l[r.id]=u,l[a]=u,u},e.prototype.disposeBuffer=function(t,r){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var n=t._glBuffers[this.CONTEXT_UID],s=this.gl;t.disposeRunner.remove(this),n&&(r||s.deleteBuffer(n.buffer),delete t._glBuffers[this.CONTEXT_UID])}},e.prototype.disposeGeometry=function(t,r){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var n=t.glVertexArrayObjects[this.CONTEXT_UID],s=this.gl,o=t.buffers;if(t.disposeRunner.remove(this),!!n){for(var a=0;a<o.length;a++){var l=o[a]._glBuffers[this.CONTEXT_UID];l.refCount--,l.refCount===0&&!r&&this.disposeBuffer(o[a],r)}if(!r){for(var u in n)if(u[0]==="g"){var h=n[u];this._activeVao===h&&this.unbind(),s.deleteVertexArray(h)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},e.prototype.disposeAll=function(t){for(var r=Object.keys(this.managedGeometries),n=0;n<r.length;n++)this.disposeGeometry(this.managedGeometries[r[n]],t);r=Object.keys(this.managedBuffers);for(var n=0;n<r.length;n++)this.disposeBuffer(this.managedBuffers[r[n]],t)},e.prototype.activateVao=function(t,r){var n=this.gl,s=this.CONTEXT_UID,o=t.buffers,a=t.attributes;t.indexBuffer&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[s].buffer);var l=null;for(var u in a){var h=a[u],f=o[h.buffer],c=f._glBuffers[s];if(r.attributeData[u]){l!==c&&(n.bindBuffer(n.ARRAY_BUFFER,c.buffer),l=c);var d=r.attributeData[u].location;if(n.enableVertexAttribArray(d),n.vertexAttribPointer(d,h.size,h.type||n.FLOAT,h.normalized,h.stride,h.start),h.instance)if(this.hasInstance)n.vertexAttribDivisor(d,1);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}},e.prototype.draw=function(t,r,n,s){var o=this.gl,a=this._activeGeometry;if(a.indexBuffer){var l=a.indexBuffer.data.BYTES_PER_ELEMENT,u=l===2?o.UNSIGNED_SHORT:o.UNSIGNED_INT;l===2||l===4&&this.canUseUInt32ElementIndex?a.instanced?o.drawElementsInstanced(t,r||a.indexBuffer.data.length,u,(n||0)*l,s||1):o.drawElements(t,r||a.indexBuffer.data.length,u,(n||0)*l):console.warn("unsupported index buffer type: uint32")}else a.instanced?o.drawArraysInstanced(t,n,r||a.getSize(),s||1):o.drawArrays(t,n,r||a.getSize());return this},e.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},e})(ee),Kd=(function(){function i(e){e===void 0&&(e=null),this.type=Wt.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null}return i.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=Wt.NONE,this.autoDetect=!0),this._target=null},i.prototype.copyCountersOrReset=function(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},i})();function af(i,e,t){var r=i.createShader(e);return i.shaderSource(r,t),i.compileShader(r),r}function Zd(i,e,t,r){var n=af(i,i.VERTEX_SHADER,e),s=af(i,i.FRAGMENT_SHADER,t),o=i.createProgram();if(i.attachShader(o,n),i.attachShader(o,s),r)for(var a in r)i.bindAttribLocation(o,r[a],a);return i.linkProgram(o),i.getProgramParameter(o,i.LINK_STATUS)||(i.getShaderParameter(n,i.COMPILE_STATUS)||(console.warn(e),console.error(i.getShaderInfoLog(n))),i.getShaderParameter(s,i.COMPILE_STATUS)||(console.warn(t),console.error(i.getShaderInfoLog(s))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",i.getProgramParameter(o,i.VALIDATE_STATUS)),console.error("gl.getError()",i.getError()),i.getProgramInfoLog(o)!==""&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",i.getProgramInfoLog(o)),i.deleteProgram(o),o=null),i.deleteShader(n),i.deleteShader(s),o}function qo(i){for(var e=new Array(i),t=0;t<e.length;t++)e[t]=!1;return e}function Jd(i,e){switch(i){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return qo(2*e);case"bvec3":return qo(3*e);case"bvec4":return qo(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var Qd={},Si=Qd;function tp(){if(Si===Qd||Si&&Si.isContextLost()){var i=document.createElement("canvas"),e=void 0;nt.PREFER_ENV>=Ae.WEBGL2&&(e=i.getContext("webgl2",{})),e||(e=i.getContext("webgl",{})||i.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),Si=e}return Si}var wn;function gg(){if(!wn){wn=xe.MEDIUM;var i=tp();if(i&&i.getShaderPrecisionFormat){var e=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT);wn=e.precision?xe.HIGH:xe.MEDIUM}}return wn}function lf(i,e,t){if(i.substring(0,9)!=="precision"){var r=e;return e===xe.HIGH&&t!==xe.HIGH&&(r=xe.MEDIUM),"precision "+r+` float;
`+i}else if(t!==xe.HIGH&&i.substring(0,15)==="precision highp")return i.replace("precision highp","precision mediump");return i}var _g={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function bg(i){return _g[i]}var Tn=null,uf={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function hf(i,e){if(!Tn){var t=Object.keys(uf);Tn={};for(var r=0;r<t.length;++r){var n=t[r];Tn[i[n]]=uf[n]}}return Tn[e]}var Vn=[{test:function(i){return i.type==="float"&&i.size===1},code:function(i){return`
            if(uv["`+i+'"] !== ud["'+i+`"].value)
            {
                ud["`+i+'"].value = uv["'+i+`"]
                gl.uniform1f(ud["`+i+'"].location, uv["'+i+`"])
            }
            `}},{test:function(i){return(i.type==="sampler2D"||i.type==="samplerCube"||i.type==="sampler2DArray")&&i.size===1&&!i.isArray},code:function(i){return`t = syncData.textureCount++;

            renderer.texture.bind(uv["`+i+`"], t);

            if(ud["`+i+`"].value !== t)
            {
                ud["`+i+`"].value = t;
                gl.uniform1i(ud["`+i+`"].location, t);
; // eslint-disable-line max-len
            }`}},{test:function(i,e){return i.type==="mat3"&&i.size===1&&e.a!==void 0},code:function(i){return`
            gl.uniformMatrix3fv(ud["`+i+'"].location, false, uv["'+i+`"].toArray(true));
            `}},{test:function(i,e){return i.type==="vec2"&&i.size===1&&e.x!==void 0},code:function(i){return`
                cv = ud["`+i+`"].value;
                v = uv["`+i+`"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["`+i+`"].location, v.x, v.y);
                }`}},{test:function(i){return i.type==="vec2"&&i.size===1},code:function(i){return`
                cv = ud["`+i+`"].value;
                v = uv["`+i+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["`+i+`"].location, v[0], v[1]);
                }
            `}},{test:function(i,e){return i.type==="vec4"&&i.size===1&&e.width!==void 0},code:function(i){return`
                cv = ud["`+i+`"].value;
                v = uv["`+i+`"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["`+i+`"].location, v.x, v.y, v.width, v.height)
                }`}},{test:function(i){return i.type==="vec4"&&i.size===1},code:function(i){return`
                cv = ud["`+i+`"].value;
                v = uv["`+i+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["`+i+`"].location, v[0], v[1], v[2], v[3])
                }`}}],xg={float:`
    if(cv !== v)
    {
        cv.v = v;
        gl.uniform1f(location, v)
    }`,vec2:`
    if(cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},wg={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function Tg(i,e){var t=[`
        var v = null;
        var cv = null
        var t = 0;
        var gl = renderer.gl
    `];for(var r in i.uniforms){var n=e[r];if(!n){i.uniforms[r].group&&t.push(`
                    renderer.shader.syncUniformGroup(uv["`+r+`"], syncData);
                `);continue}for(var s=i.uniforms[r],o=!1,a=0;a<Vn.length;a++)if(Vn[a].test(n,s)){t.push(Vn[a].code(r,s)),o=!0;break}if(!o){var l=n.size===1?xg:wg,u=l[n.type].replace("location",'ud["'+r+'"].location');t.push(`
            cv = ud["`+r+`"].value;
            v = uv["`+r+`"];
            `+u+";")}}return new Function("ud","uv","renderer","syncData",t.join(`
`))}var Ig=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Eg(i){for(var e="",t=0;t<i;++t)t>0&&(e+=`
else `),t<i-1&&(e+="if(test == "+t+".0){}");return e}function ep(i,e){if(i===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var t=e.createShader(e.FRAGMENT_SHADER);;){var r=Ig.replace(/%forloop%/gi,Eg(i));if(e.shaderSource(t,r),e.compileShader(t),!e.getShaderParameter(t,e.COMPILE_STATUS))i=i/2|0;else break}return i}var Ai;function Sg(){if(typeof Ai=="boolean")return Ai;try{var i=new Function("param1","param2","param3","return param1[param2] === param3;");Ai=i({a:"b"},"a","b")===!0}catch{Ai=!1}return Ai}var Ag=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,Cg=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`,Pg=0,In={},_i=(function(){function i(e,t,r){r===void 0&&(r="pixi-shader"),this.id=Pg++,this.vertexSrc=e||i.defaultVertexSrc,this.fragmentSrc=t||i.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.vertexSrc.substring(0,8)!=="#version"&&(r=r.replace(/\s+/g,"-"),In[r]?(In[r]++,r+="-"+In[r]):In[r]=1,this.vertexSrc="#define SHADER_NAME "+r+`
`+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+r+`
`+this.fragmentSrc,this.vertexSrc=lf(this.vertexSrc,nt.PRECISION_VERTEX,xe.HIGH),this.fragmentSrc=lf(this.fragmentSrc,nt.PRECISION_FRAGMENT,gg())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null}return i.prototype.extractData=function(e,t){var r=tp();if(r){var n=Zd(r,e,t);this.attributeData=this.getAttributeData(n,r),this.uniformData=this.getUniformData(n,r),r.deleteProgram(n)}else this.uniformData={},this.attributeData={}},i.prototype.getAttributeData=function(e,t){for(var r={},n=[],s=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),o=0;o<s;o++){var a=t.getActiveAttrib(e,o),l=hf(t,a.type),u={type:l,name:a.name,size:bg(l),location:0};r[a.name]=u,n.push(u)}n.sort(function(h,f){return h.name>f.name?1:-1});for(var o=0;o<n.length;o++)n[o].location=o;return r},i.prototype.getUniformData=function(e,t){for(var r={},n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),s=0;s<n;s++){var o=t.getActiveUniform(e,s),a=o.name.replace(/\[.*?\]$/,""),l=o.name.match(/\[.*?\]$/),u=hf(t,o.type);r[a]={type:u,size:o.size,isArray:l,value:Jd(u,o.size)}}return r},Object.defineProperty(i,"defaultVertexSrc",{get:function(){return Cg},enumerable:!1,configurable:!0}),Object.defineProperty(i,"defaultFragmentSrc",{get:function(){return Ag},enumerable:!1,configurable:!0}),i.from=function(e,t,r){var n=e+t,s=Aa[n];return s||(Aa[n]=s=new i(e,t,r)),s},i})(),Ge=(function(){function i(e,t){this.program=e,t?t instanceof nr?this.uniformGroup=t:this.uniformGroup=new nr(t):this.uniformGroup=new nr({});for(var r in e.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))}return i.prototype.checkUniformExists=function(e,t){if(t.uniforms[e])return!0;for(var r in t.uniforms){var n=t.uniforms[r];if(n.group&&this.checkUniformExists(e,n))return!0}return!1},i.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(i.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),i.from=function(e,t,r){var n=_i.from(e,t);return new i(n,r)},i})(),$o=0,jo=1,Wo=2,Ko=3,Zo=4,lr=(function(){function i(){this.data=0,this.blendMode=st.NORMAL,this.polygonOffset=0,this.blend=!0}return Object.defineProperty(i.prototype,"blend",{get:function(){return!!(this.data&1<<$o)},set:function(e){!!(this.data&1<<$o)!==e&&(this.data^=1<<$o)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"offsets",{get:function(){return!!(this.data&1<<jo)},set:function(e){!!(this.data&1<<jo)!==e&&(this.data^=1<<jo)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"culling",{get:function(){return!!(this.data&1<<Wo)},set:function(e){!!(this.data&1<<Wo)!==e&&(this.data^=1<<Wo)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"depthTest",{get:function(){return!!(this.data&1<<Ko)},set:function(e){!!(this.data&1<<Ko)!==e&&(this.data^=1<<Ko)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"clockwiseFrontFace",{get:function(){return!!(this.data&1<<Zo)},set:function(e){!!(this.data&1<<Zo)!==e&&(this.data^=1<<Zo)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"blendMode",{get:function(){return this._blendMode},set:function(e){this.blend=e!==st.NONE,this._blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(e){this.offsets=!!e,this._polygonOffset=e},enumerable:!1,configurable:!0}),i.for2d=function(){var e=new i;return e.depthTest=!1,e.blend=!0,e},i})(),Og=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,Rg=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,ze=(function(i){ft(e,i);function e(t,r,n){var s=this,o=_i.from(t||e.defaultVertexSrc,r||e.defaultFragmentSrc);return s=i.call(this,o,n)||this,s.padding=0,s.resolution=nt.FILTER_RESOLUTION,s.enabled=!0,s.autoFit=!0,s.legacy=!!s.program.attributeData.aTextureCoord,s.state=new lr,s}return e.prototype.apply=function(t,r,n,s,o){t.applyFilter(this,r,n,s)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultVertexSrc",{get:function(){return Og},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return Rg},enumerable:!1,configurable:!0}),e})(Ge),Fg=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`,Mg=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,ff=new Rt,Ts=(function(){function i(e,t){this._texture=e,this.mapCoord=new Rt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof t>"u"?.5:t,this.isSimple=!1}return Object.defineProperty(i.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture=e,this._textureID=-1},enumerable:!1,configurable:!0}),i.prototype.multiplyUvs=function(e,t){t===void 0&&(t=e);for(var r=this.mapCoord,n=0;n<e.length;n+=2){var s=e[n],o=e[n+1];t[n]=s*r.a+o*r.c+r.tx,t[n+1]=s*r.b+o*r.d+r.ty}return t},i.prototype.update=function(e){var t=this._texture;if(!t||!t.valid||!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;var r=t._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var n=t.orig,s=t.trim;s&&(ff.set(n.width/s.width,0,0,n.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(ff));var o=t.baseTexture,a=this.uClampFrame,l=this.clampMargin/o.resolution,u=this.clampOffset;return a[0]=(t._frame.x+l+u)/o.width,a[1]=(t._frame.y+l+u)/o.height,a[2]=(t._frame.x+t._frame.width-l+u)/o.width,a[3]=(t._frame.y+t._frame.height-l+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=t._frame.width===o.width&&t._frame.height===o.height&&t.rotate===0,!0},i})(),rp=(function(i){ft(e,i);function e(t){var r=this,n=new Rt;return r=i.call(this,Fg,Mg)||this,t.renderable=!1,r.maskSprite=t,r.maskMatrix=n,r}return e.prototype.apply=function(t,r,n,s){var o=this.maskSprite,a=o._texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new Ts(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,o).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=o.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,t.applyFilter(this,r,n,s))},e})(ze),ip=(function(i){ft(e,i);function e(t){var r=i.call(this,t)||this;return r.enableScissor=!1,r.alphaMaskPool=[],r.maskDataPool=[],r.maskStack=[],r.alphaMaskIndex=0,r}return e.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},e.prototype.push=function(t,r){var n=r;if(!n.isMaskData){var s=this.maskDataPool.pop()||new Kd;s.pooled=!0,s.maskObject=r,n=s}switch(n.autoDetect&&this.detect(n),n.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),n._target=t,n.type){case Wt.SCISSOR:this.maskStack.push(n),this.renderer.scissor.push(n);break;case Wt.STENCIL:this.maskStack.push(n),this.renderer.stencil.push(n);break;case Wt.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n),this.maskStack.push(n);break}},e.prototype.pop=function(t){var r=this.maskStack.pop();if(!(!r||r._target!==t)){switch(r.type){case Wt.SCISSOR:this.renderer.scissor.pop();break;case Wt.STENCIL:this.renderer.stencil.pop(r.maskObject);break;case Wt.SPRITE:this.popSpriteMask();break}r.reset(),r.pooled&&this.maskDataPool.push(r)}},e.prototype.detect=function(t){var r=t.maskObject;if(r.isSprite){t.type=Wt.SPRITE;return}if(t.type=Wt.STENCIL,this.enableScissor&&r.isFastRect&&r.isFastRect()){var n=r.worldTransform,s=Math.atan2(n.b,n.a),o=Math.atan2(n.d,n.c);s=Math.round(s*(180/Math.PI)*100),o=Math.round(o*(180/Math.PI)*100)-s,s=(s%9e3+9e3)%9e3,o=(o%18e3+18e3)%18e3,s===0&&o===9e3&&(t.type=Wt.SCISSOR)}},e.prototype.pushSpriteMask=function(t){var r=t.maskObject,n=t._target,s=this.alphaMaskPool[this.alphaMaskIndex];s||(s=this.alphaMaskPool[this.alphaMaskIndex]=[new rp(r)]),s[0].resolution=this.renderer.resolution,s[0].maskSprite=r;var o=n.filterArea;n.filterArea=r.getBounds(!0),this.renderer.filter.push(n,s),n.filterArea=o,this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},e})(ee),np=(function(i){ft(e,i);function e(t){var r=i.call(this,t)||this;return r.maskStack=[],r.glConst=0,r}return e.prototype.getStackLength=function(){return this.maskStack.length},e.prototype.setMaskStack=function(t){var r=this.renderer.gl,n=this.getStackLength();this.maskStack=t;var s=this.getStackLength();s!==n&&(s===0?r.disable(this.glConst):(r.enable(this.glConst),this._useCurrent()))},e.prototype._useCurrent=function(){},e.prototype.destroy=function(){i.prototype.destroy.call(this),this.maskStack=null},e})(ee),sp=(function(i){ft(e,i);function e(t){var r=i.call(this,t)||this;return r.glConst=WebGLRenderingContext.SCISSOR_TEST,r}return e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.push=function(t){var r=t.maskObject;r.renderable=!0;var n=t._scissorRect,s=r.getBounds(!0),o=this.renderer.gl;r.renderable=!1,n?s.fit(n):o.enable(o.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=s,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,r=this.renderer.renderTexture.current,n=this.renderer.projection,s=n.transform,o=n.sourceFrame,a=n.destinationFrame,l=r?r.resolution:this.renderer.resolution,u=(t.x-o.x)*l+a.x,h=(t.y-o.y)*l+a.y,f=t.width*l,c=t.height*l;s&&(u+=s.tx*l,h+=s.ty*l),r||(h=this.renderer.height-c-h),this.renderer.gl.scissor(u,h,f,c)},e})(np),op=(function(i){ft(e,i);function e(t){var r=i.call(this,t)||this;return r.glConst=WebGLRenderingContext.STENCIL_TEST,r}return e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var r=t.maskObject,n=this.renderer.gl,s=t._stencilCounter;s===0&&(this.renderer.framebuffer.forceStencil(),n.enable(n.STENCIL_TEST)),t._stencilCounter++,n.colorMask(!1,!1,!1,!1),n.stencilFunc(n.EQUAL,s,this._getBitwiseMask()),n.stencilOp(n.KEEP,n.KEEP,n.INCR),r.renderable=!0,r.render(this.renderer),this.renderer.batch.flush(),r.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var r=this.renderer.gl;this.getStackLength()===0?(r.disable(r.STENCIL_TEST),r.clear(r.STENCIL_BUFFER_BIT),r.clearStencil(0)):(r.colorMask(!1,!1,!1,!1),r.stencilOp(r.KEEP,r.KEEP,r.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},e})(np),ap=(function(i){ft(e,i);function e(t){var r=i.call(this,t)||this;return r.destinationFrame=null,r.sourceFrame=null,r.defaultFrame=null,r.projectionMatrix=new Rt,r.transform=null,r}return e.prototype.update=function(t,r,n,s){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=r||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,s),this.transform&&this.projectionMatrix.append(this.transform);var o=this.renderer;o.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,o.globalUniforms.update(),o.shader.shader&&o.shader.syncUniformGroup(o.shader.shader.uniforms.globals)},e.prototype.calculateProjection=function(t,r,n,s){var o=this.projectionMatrix,a=s?-1:1;o.identity(),o.a=1/r.width*2,o.d=a*(1/r.height*2),o.tx=-1-r.x*o.a,o.ty=-a-r.y*o.d},e.prototype.setTransform=function(t){},e})(ee),cr=new vt,Ci=new vt,Pi=new vt,lp=(function(i){ft(e,i);function e(t){var r=i.call(this,t)||this;return r.clearColor=t._backgroundColorRgba,r.defaultMaskStack=[],r.current=null,r.sourceFrame=new vt,r.destinationFrame=new vt,r}return e.prototype.bind=function(t,r,n){t===void 0&&(t=null);var s=this.renderer;this.current=t;var o,a,l;t?(o=t.baseTexture,l=o.resolution,r||(cr.width=t.frame.width,cr.height=t.frame.height,r=cr),n||(Ci.x=t.frame.x,Ci.y=t.frame.y,Ci.width=r.width,Ci.height=r.height,n=Ci),a=o.framebuffer):(l=s.resolution,r||(cr.width=s.screen.width,cr.height=s.screen.height,r=cr),n||(n=cr,n.width=r.width,n.height=r.height)),Pi.x=n.x*l,Pi.y=n.y*l,Pi.width=n.width*l,Pi.height=n.height*l,this.renderer.framebuffer.bind(a,Pi),this.renderer.projection.update(n,r,l,!a),t?this.renderer.mask.setMaskStack(o.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(r),this.destinationFrame.copyFrom(n)},e.prototype.clear=function(t,r){this.current?t=t||this.current.baseTexture.clearColor:t=t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],r)},e.prototype.resize=function(){this.bind(null)},e.prototype.reset=function(){this.bind(null)},e})(ee),Lg=(function(){function i(){}return i})(),up=(function(){function i(e,t){this.program=e,this.uniformData=t,this.uniformGroups={}}return i.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null},i})(),Ng=0,cf={textureCount:0},hp=(function(i){ft(e,i);function e(t){var r=i.call(this,t)||this;return r.destroyed=!1,r.systemCheck(),r.gl=null,r.shader=null,r.program=null,r.cache={},r.id=Ng++,r}return e.prototype.systemCheck=function(){if(!Sg())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},e.prototype.contextChange=function(t){this.gl=t,this.reset()},e.prototype.bind=function(t,r){t.uniforms.globals=this.renderer.globalUniforms;var n=t.program,s=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==n&&(this.program=n,this.gl.useProgram(s.program)),r||(cf.textureCount=0,this.syncUniformGroup(t.uniformGroup,cf)),s},e.prototype.setUniforms=function(t){var r=this.shader.program,n=r.glPrograms[this.renderer.CONTEXT_UID];r.syncUniforms(n.uniformData,t,this.renderer)},e.prototype.syncUniformGroup=function(t,r){var n=this.getglProgram();(!t.static||t.dirtyId!==n.uniformGroups[t.id])&&(n.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,n,r))},e.prototype.syncUniforms=function(t,r,n){var s=t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t);s(r.uniformData,t.uniforms,this.renderer,n)},e.prototype.createSyncGroups=function(t){var r=this.getSignature(t,this.shader.program.uniformData);return this.cache[r]||(this.cache[r]=Tg(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[r],t.syncUniforms[this.shader.program.id]},e.prototype.getSignature=function(t,r){var n=t.uniforms,s=[];for(var o in n)s.push(o),r[o]&&s.push(r[o].type);return s.join("-")},e.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},e.prototype.generateShader=function(t){var r=this.gl,n=t.program,s={};for(var o in n.attributeData)s[o]=n.attributeData[o].location;var a=Zd(r,n.vertexSrc,n.fragmentSrc,s),l={};for(var o in n.uniformData){var u=n.uniformData[o];l[o]={location:r.getUniformLocation(a,o),value:Jd(u.type,u.size)}}var h=new up(a,l);return n.glPrograms[this.renderer.CONTEXT_UID]=h,h},e.prototype.reset=function(){this.program=null,this.shader=null},e.prototype.destroy=function(){this.destroyed=!0},e})(ee);function Bg(i,e){return e===void 0&&(e=[]),e[st.NORMAL]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],e[st.ADD]=[i.ONE,i.ONE],e[st.MULTIPLY]=[i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA],e[st.SCREEN]=[i.ONE,i.ONE_MINUS_SRC_COLOR,i.ONE,i.ONE_MINUS_SRC_ALPHA],e[st.OVERLAY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],e[st.DARKEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],e[st.LIGHTEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],e[st.COLOR_DODGE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],e[st.COLOR_BURN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],e[st.HARD_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],e[st.SOFT_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],e[st.DIFFERENCE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],e[st.EXCLUSION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],e[st.HUE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],e[st.SATURATION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],e[st.COLOR]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],e[st.LUMINOSITY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],e[st.NONE]=[0,0],e[st.NORMAL_NPM]=[i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA],e[st.ADD_NPM]=[i.SRC_ALPHA,i.ONE,i.ONE,i.ONE],e[st.SCREEN_NPM]=[i.SRC_ALPHA,i.ONE_MINUS_SRC_COLOR,i.ONE,i.ONE_MINUS_SRC_ALPHA],e[st.SRC_IN]=[i.DST_ALPHA,i.ZERO],e[st.SRC_OUT]=[i.ONE_MINUS_DST_ALPHA,i.ZERO],e[st.SRC_ATOP]=[i.DST_ALPHA,i.ONE_MINUS_SRC_ALPHA],e[st.DST_OVER]=[i.ONE_MINUS_DST_ALPHA,i.ONE],e[st.DST_IN]=[i.ZERO,i.SRC_ALPHA],e[st.DST_OUT]=[i.ZERO,i.ONE_MINUS_SRC_ALPHA],e[st.DST_ATOP]=[i.ONE_MINUS_DST_ALPHA,i.SRC_ALPHA],e[st.XOR]=[i.ONE_MINUS_DST_ALPHA,i.ONE_MINUS_SRC_ALPHA],e[st.SUBTRACT]=[i.ONE,i.ONE,i.ONE,i.ONE,i.FUNC_REVERSE_SUBTRACT,i.FUNC_ADD],e}var Dg=0,kg=1,Ug=2,Xg=3,Hg=4,fp=(function(i){ft(e,i);function e(t){var r=i.call(this,t)||this;return r.gl=null,r.stateId=0,r.polygonOffset=0,r.blendMode=st.NONE,r._blendEq=!1,r.map=[],r.map[Dg]=r.setBlend,r.map[kg]=r.setOffset,r.map[Ug]=r.setCullFace,r.map[Xg]=r.setDepthTest,r.map[Hg]=r.setFrontFace,r.checks=[],r.defaultState=new lr,r.defaultState.blend=!0,r}return e.prototype.contextChange=function(t){this.gl=t,this.blendModes=Bg(t),this.set(this.defaultState),this.reset()},e.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var r=this.stateId^t.data,n=0;r;)r&1&&this.map[n].call(this,!!(t.data&1<<n)),r=r>>1,n++;this.stateId=t.data}for(var n=0;n<this.checks.length;n++)this.checks[n](this,t)},e.prototype.forceState=function(t){t=t||this.defaultState;for(var r=0;r<this.map.length;r++)this.map[r].call(this,!!(t.data&1<<r));for(var r=0;r<this.checks.length;r++)this.checks[r](this,t);this.stateId=t.data},e.prototype.setBlend=function(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},e.prototype.setOffset=function(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},e.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},e.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},e.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},e.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var r=this.blendModes[t],n=this.gl;r.length===2?n.blendFunc(r[0],r[1]):n.blendFuncSeparate(r[0],r[1],r[2],r[3]),r.length===6?(this._blendEq=!0,n.blendEquationSeparate(r[4],r[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}},e.prototype.setPolygonOffset=function(t,r){this.gl.polygonOffset(t,r)},e.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},e.prototype.updateCheck=function(t,r){var n=this.checks.indexOf(t);r&&n===-1?this.checks.push(t):!r&&n!==-1&&this.checks.splice(n,1)},e.checkBlendMode=function(t,r){t.setBlendMode(r.blendMode)},e.checkPolygonOffset=function(t,r){t.setPolygonOffset(1,r.polygonOffset)},e})(ee),cp=(function(i){ft(e,i);function e(t){var r=i.call(this,t)||this;return r.count=0,r.checkCount=0,r.maxIdle=nt.GC_MAX_IDLE,r.checkCountMax=nt.GC_MAX_CHECK_COUNT,r.mode=nt.GC_MODE,r}return e.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==os.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},e.prototype.run=function(){for(var t=this.renderer.texture,r=t.managedTextures,n=!1,s=0;s<r.length;s++){var o=r[s];!o.framebuffer&&this.count-o.touched>this.maxIdle&&(t.destroyTexture(o,!0),r[s]=null,n=!0)}if(n){for(var a=0,s=0;s<r.length;s++)r[s]!==null&&(r[a++]=r[s]);r.length=a}},e.prototype.unload=function(t){var r=this.renderer.texture,n=t._texture;n&&!n.framebuffer&&r.destroyTexture(n);for(var s=t.children.length-1;s>=0;s--)this.unload(t.children[s])},e})(ee),qn=(function(){function i(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}return i})(),dp=(function(i){ft(e,i);function e(t){var r=i.call(this,t)||this;return r.boundTextures=[],r.currentLocation=-1,r.managedTextures=[],r._unknownBoundTextures=!1,r.unknownTexture=new Tt,r}return e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var r=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=r;for(var n=0;n<r;n++)this.boundTextures[n]=null;this.emptyTextures={};var s=new qn(t.createTexture());t.bindTexture(t.TEXTURE_2D,s.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=s,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new qn(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var n=0;n<this.boundTextures.length;n++)this.bind(null,n)},e.prototype.bind=function(t,r){r===void 0&&(r=0);var n=this.gl;if(t){if(t=t.castToBaseTexture(),t.parentTextureArray)return;if(t.valid){t.touched=this.renderer.textureGC.count;var s=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[r]!==t&&(this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),n.bindTexture(t.target,s.texture)),s.dirtyId!==t.dirtyId&&(this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),this.updateTexture(t)),this.boundTextures[r]=t}}else this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[r]=null},e.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},e.prototype.unbind=function(t){var r=this,n=r.gl,s=r.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var o=0;o<s.length;o++)s[o]===this.unknownTexture&&this.bind(null,o)}for(var o=0;o<s.length;o++)s[o]===t&&(this.currentLocation!==o&&(n.activeTexture(n.TEXTURE0+o),this.currentLocation=o),n.bindTexture(t.target,this.emptyTextures[t.target].texture),s[o]=null)},e.prototype.initTexture=function(t){var r=new qn(this.gl.createTexture());return r.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=r,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),r},e.prototype.initTextureType=function(t,r){if(r.internalFormat=t.format,r.type=t.type,this.webGLVersion===2){var n=this.renderer.gl;t.type===n.FLOAT&&t.format===n.RGBA&&(r.internalFormat=n.RGBA32F),t.type===Lt.HALF_FLOAT&&(r.type=n.HALF_FLOAT),r.type===n.HALF_FLOAT&&t.format===n.RGBA&&(r.internalFormat=n.RGBA16F)}},e.prototype.updateTexture=function(t){var r=t._glTextures[this.CONTEXT_UID];if(r){var n=this.renderer;if(this.initTextureType(t,r),!(t.resource&&t.resource.upload(n,t,r))){var s=t.realWidth,o=t.realHeight,a=n.gl;(r.width!==s||r.height!==o||r.dirtyId<0)&&(r.width=s,r.height=o,a.texImage2D(t.target,0,r.internalFormat,s,o,0,t.format,r.type,null))}t.dirtyStyleId!==r.dirtyStyleId&&this.updateTextureStyle(t),r.dirtyId=t.dirtyId}},e.prototype.destroyTexture=function(t,r){var n=this.gl;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),n.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!r)){var s=this.managedTextures.indexOf(t);s!==-1&&Tr(this.managedTextures,s,1)}},e.prototype.updateTextureStyle=function(t){var r=t._glTextures[this.CONTEXT_UID];r&&((t.mipmap===ai.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?r.mipmap=!1:r.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?r.wrapMode=Ee.CLAMP:r.wrapMode=t.wrapMode,t.resource&&t.resource.style(this.renderer,t,r)||this.setStyle(t,r),r.dirtyStyleId=t.dirtyStyleId)},e.prototype.setStyle=function(t,r){var n=this.gl;if(r.mipmap&&n.generateMipmap(t.target),n.texParameteri(t.target,n.TEXTURE_WRAP_S,r.wrapMode),n.texParameteri(t.target,n.TEXTURE_WRAP_T,r.wrapMode),r.mipmap){n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===be.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);var s=this.renderer.context.extensions.anisotropicFiltering;if(s&&t.anisotropicLevel>0&&t.scaleMode===be.LINEAR){var o=Math.min(t.anisotropicLevel,n.getParameter(s.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(t.target,s.TEXTURE_MAX_ANISOTROPY_EXT,o)}}else n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===be.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(t.target,n.TEXTURE_MAG_FILTER,t.scaleMode===be.LINEAR?n.LINEAR:n.NEAREST)},e})(ee),Gg={FilterSystem:zd,BatchSystem:Vd,ContextSystem:qd,FramebufferSystem:jd,GeometrySystem:Wd,MaskSystem:ip,ScissorSystem:sp,StencilSystem:op,ProjectionSystem:ap,RenderTextureSystem:lp,ShaderSystem:hp,StateSystem:fp,TextureGCSystem:cp,TextureSystem:dp},Jo=new Rt,pp=(function(i){ft(e,i);function e(t,r){t===void 0&&(t=si.UNKNOWN);var n=i.call(this)||this;return r=Object.assign({},nt.RENDER_OPTIONS,r),r.roundPixels&&(nt.ROUND_PIXELS=r.roundPixels,K("5.0.0","Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS",2)),n.options=r,n.type=t,n.screen=new vt(0,0,r.width,r.height),n.view=r.view||document.createElement("canvas"),n.resolution=r.resolution||nt.RESOLUTION,n.transparent=r.transparent,n.autoDensity=r.autoDensity||r.autoResize||!1,n.preserveDrawingBuffer=r.preserveDrawingBuffer,n.clearBeforeRender=r.clearBeforeRender,n._backgroundColor=0,n._backgroundColorRgba=[0,0,0,0],n._backgroundColorString="#000000",n.backgroundColor=r.backgroundColor||n._backgroundColor,n._lastObjectRendered=null,n.plugins={},n}return e.prototype.initPlugins=function(t){for(var r in t)this.plugins[r]=new t[r](this)},Object.defineProperty(e.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,r){this.screen.width=t,this.screen.height=r,this.view.width=t*this.resolution,this.view.height=r*this.resolution,this.autoDensity&&(this.view.style.width=t+"px",this.view.style.height=r+"px"),this.emit("resize",t,r)},e.prototype.generateTexture=function(t,r,n,s){s=s||t.getLocalBounds(null,!0),s.width===0&&(s.width=1),s.height===0&&(s.height=1);var o=Ar.create({width:s.width|0,height:s.height|0,scaleMode:r,resolution:n});return Jo.tx=-s.x,Jo.ty=-s.y,this.render(t,o,!1,Jo,!!t.parent),o},e.prototype.destroy=function(t){for(var r in this.plugins)this.plugins[r].destroy(),this.plugins[r]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var n=this;n.plugins=null,n.type=si.UNKNOWN,n.view=null,n.screen=null,n._tempDisplayObjectParent=null,n.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=Bl(t),Er(t,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),e})(vi),Oe=(function(i){ft(e,i);function e(t){var r=i.call(this,si.WEBGL,t)||this;return t=r.options,r.gl=null,r.CONTEXT_UID=0,r.runners={destroy:new Ht("destroy"),contextChange:new Ht("contextChange"),reset:new Ht("reset"),update:new Ht("update"),postrender:new Ht("postrender"),prerender:new Ht("prerender"),resize:new Ht("resize")},r.globalUniforms=new nr({projectionMatrix:new Rt},!0),r.addSystem(ip,"mask").addSystem(qd,"context").addSystem(fp,"state").addSystem(hp,"shader").addSystem(dp,"texture").addSystem(Wd,"geometry").addSystem(jd,"framebuffer").addSystem(sp,"scissor").addSystem(op,"stencil").addSystem(ap,"projection").addSystem(cp,"textureGC").addSystem(zd,"filter").addSystem(lp,"renderTexture").addSystem(Vd,"batch"),r.initPlugins(e.__plugins),t.context?r.context.initFromContext(t.context):r.context.initFromOptions({alpha:!!r.transparent,antialias:t.antialias,premultipliedAlpha:r.transparent&&r.transparent!=="notMultiplied",stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:r.options.powerPreference}),r.renderingToScreen=!0,yd(r.context.webGLVersion===2?"WebGL 2":"WebGL 1"),r.resize(r.options.width,r.options.height),r}return e.create=function(t){if(vd())return new e(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},e.prototype.addSystem=function(t,r){r||(r=t.name);var n=new t(this);if(this[r])throw new Error('Whoops! The name "'+r+'" is already in use');this[r]=n;for(var s in this.runners)this.runners[s].add(n);return this},e.prototype.render=function(t,r,n,s,o){if(this.renderingToScreen=!r,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=s,!this.context.isLost){if(r||(this._lastObjectRendered=t),!o){var a=t.enableTempParent();t.updateTransform(),t.disableTempParent(a)}this.renderTexture.bind(r),this.batch.currentRenderer.start(),(n!==void 0?n:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),r&&r.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},e.prototype.resize=function(t,r){i.prototype.resize.call(this,t,r),this.runners.resize.emit(t,r)},e.prototype.reset=function(){return this.runners.reset.emit(),this},e.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},e.prototype.destroy=function(t){this.runners.destroy.emit();for(var r in this.runners)this.runners[r].destroy();i.prototype.destroy.call(this,t),this.gl=null},e.registerPlugin=function(t,r){e.__plugins=e.__plugins||{},e.__plugins[t]=r},e})(pp);function yp(i){return Oe.create(i)}var vp=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Zl=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,us=(function(){function i(){this.texArray=null,this.blend=0,this.type=ae.TRIANGLES,this.start=0,this.size=0,this.data=null}return i})(),hs=(function(){function i(){this.elements=[],this.ids=[],this.count=0}return i.prototype.clear=function(){for(var e=0;e<this.count;e++)this.elements[e]=null;this.count=0},i})(),mp=(function(){function i(e){this.rawBinaryData=new ArrayBuffer(e),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(i.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),i.prototype.view=function(e){return this[e+"View"]},i.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},i.sizeOf=function(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(e+" isn't a valid view type")}},i})(),gp=(function(i){ft(e,i);function e(t){var r=i.call(this,t)||this;return r.shaderGenerator=null,r.geometryClass=null,r.vertexSize=null,r.state=lr.for2d(),r.size=nt.SPRITE_BATCH_SIZE*4,r._vertexCount=0,r._indexCount=0,r._bufferedElements=[],r._bufferedTextures=[],r._bufferSize=0,r._shader=null,r._packedGeometries=[],r._packedGeometryPoolSize=2,r._flushId=0,r._aBuffers={},r._iBuffers={},r.MAX_TEXTURES=1,r.renderer.on("prerender",r.onPrerender,r),t.runners.contextChange.add(r),r._dcIndex=0,r._aIndex=0,r._iIndex=0,r._attributeBuffer=null,r._indexBuffer=null,r._tempBoundTextures=[],r}return e.prototype.contextChange=function(){var t=this.renderer.gl;nt.PREFER_ENV===Ae.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),nt.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=ep(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var r=0;r<this._packedGeometryPoolSize;r++)this._packedGeometries[r]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,r=e._textureArrayPool,n=this.size/4,s=Math.floor(n/this.MAX_TEXTURES)+1;t.length<n;)t.push(new us);for(;r.length<s;)r.push(new hs);for(var o=0;o<this.MAX_TEXTURES;o++)this._tempBoundTextures[o]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this,r=t._bufferedTextures,n=t.MAX_TEXTURES,s=e._textureArrayPool,o=this.renderer.batch,a=this._tempBoundTextures,l=this.renderer.textureGC.count,u=++Tt._globalBatch,h=0,f=s[0],c=0;o.copyBoundTextures(a,n);for(var d=0;d<this._bufferSize;++d){var p=r[d];r[d]=null,p._batchEnabled!==u&&(f.count>=n&&(o.boundArray(f,a,u,n),this.buildDrawCalls(f,c,d),c=d,f=s[++h],++u),p._batchEnabled=u,p.touched=l,f.elements[f.count++]=p)}f.count>0&&(o.boundArray(f,a,u,n),this.buildDrawCalls(f,c,this._bufferSize),++h,++u);for(var d=0;d<a.length;d++)a[d]=null;Tt._globalBatch=u},e.prototype.buildDrawCalls=function(t,r,n){var s=this,o=s._bufferedElements,a=s._attributeBuffer,l=s._indexBuffer,u=s.vertexSize,h=e._drawCallPool,f=this._dcIndex,c=this._aIndex,d=this._iIndex,p=h[f];p.start=this._iIndex,p.texArray=t;for(var m=r;m<n;++m){var v=o[m],g=v._texture.baseTexture,I=kl[g.alphaMode?1:0][v.blendMode];o[m]=null,r<m&&p.blend!==I&&(p.size=d-p.start,r=m,p=h[++f],p.texArray=t,p.start=d),this.packInterleavedGeometry(v,a,l,c,d),c+=v.vertexData.length/2*u,d+=v.indices.length,p.blend=I}r<n&&(p.size=d-p.start,++f),this._dcIndex=f,this._aIndex=c,this._iIndex=d},e.prototype.bindAndClearTexArray=function(t){for(var r=this.renderer.texture,n=0;n<t.count;n++)r.bind(t.elements[n],t.ids[n]),t.elements[n]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this,r=t._packedGeometries,n=t._attributeBuffer,s=t._indexBuffer;nt.CAN_UPLOAD_SAME_BUFFER?(r[this._flushId]._buffer.update(n.rawBinaryData),r[this._flushId]._indexBuffer.update(s),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,r[this._flushId]=new this.geometryClass),r[this._flushId]._buffer.update(n.rawBinaryData),r[this._flushId]._indexBuffer.update(s),this.renderer.geometry.bind(r[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,r=this.renderer,n=r.gl,s=r.state,o=e._drawCallPool,a=null,l=0;l<t;l++){var u=o[l],h=u.texArray,f=u.type,c=u.size,d=u.start,p=u.blend;a!==h&&(a=h,this.bindAndClearTexArray(h)),this.state.blendMode=p,s.set(this.state),n.drawElements(f,c,n.UNSIGNED_SHORT,d*2)}},e.prototype.flush=function(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),nt.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),i.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var r=Vi(Math.ceil(t/8)),n=Sa(r),s=r*8;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);var o=this._aBuffers[s];return o||(this._aBuffers[s]=o=new mp(s*this.vertexSize*4)),o},e.prototype.getIndexBuffer=function(t){var r=Vi(Math.ceil(t/12)),n=Sa(r),s=r*12;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);var o=this._iBuffers[n];return o||(this._iBuffers[n]=o=new Uint16Array(s)),o},e.prototype.packInterleavedGeometry=function(t,r,n,s,o){for(var a=r.uint32View,l=r.float32View,u=s/this.vertexSize,h=t.uvs,f=t.indices,c=t.vertexData,d=t._texture.baseTexture._batchLocation,p=Math.min(t.worldAlpha,1),m=p<1&&t._texture.baseTexture.alphaMode?bs(t._tintRGB,p):t._tintRGB+(p*255<<24),v=0;v<c.length;v+=2)l[s++]=c[v],l[s++]=c[v+1],l[s++]=h[v],l[s++]=h[v+1],a[s++]=m,l[s++]=d;for(var v=0;v<f.length;v++)n[o++]=u+f[v]},e._drawCallPool=[],e._textureArrayPool=[],e})(gi),_p=(function(){function i(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},t.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(t.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return i.prototype.generateShader=function(e){if(!this.programCache[e]){for(var t=new Int32Array(e),r=0;r<e;r++)t[r]=r;this.defaultGroupCache[e]=nr.from({uSamplers:t},!0);var n=this.fragTemplate;n=n.replace(/%count%/gi,""+e),n=n.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new _i(this.vertexSrc,n)}var s={tint:new Float32Array([1,1,1,1]),translationMatrix:new Rt,default:this.defaultGroupCache[e]};return new Ge(this.programCache[e],s)},i.prototype.generateSampleSrc=function(e){var t="";t+=`
`,t+=`
`;for(var r=0;r<e;r++)r>0&&(t+=`
else `),r<e-1&&(t+="if(vTextureId < "+r+".5)"),t+=`
{`,t+=`
	color = texture2D(uSamplers[`+r+"], vTextureCoord);",t+=`
}`;return t+=`
`,t+=`
`,t},i})(),Jl=(function(i){ft(e,i);function e(t){t===void 0&&(t=!1);var r=i.call(this)||this;return r._buffer=new Mt(null,t,!1),r._indexBuffer=new Mt(null,t,!0),r.addAttribute("aVertexPosition",r._buffer,2,!1,Lt.FLOAT).addAttribute("aTextureCoord",r._buffer,2,!1,Lt.FLOAT).addAttribute("aColor",r._buffer,4,!0,Lt.UNSIGNED_BYTE).addAttribute("aTextureId",r._buffer,1,!0,Lt.FLOAT).addIndex(r._indexBuffer),r}return e})(Mr),df=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`,pf=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,bp=(function(){function i(){}return i.create=function(e){var t=Object.assign({vertex:df,fragment:pf,geometryClass:Jl,vertexSize:6},e),r=t.vertex,n=t.fragment,s=t.vertexSize,o=t.geometryClass;return(function(a){ft(l,a);function l(u){var h=a.call(this,u)||this;return h.shaderGenerator=new _p(r,n),h.geometryClass=o,h.vertexSize=s,h}return l})(gp)},Object.defineProperty(i,"defaultVertexSrc",{get:function(){return df},enumerable:!1,configurable:!0}),Object.defineProperty(i,"defaultFragmentTemplate",{get:function(){return pf},enumerable:!1,configurable:!0}),i})(),xp=bp.create();/*!
 * @pixi/app - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/app is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var en=(function(){function i(e){var t=this;e=Object.assign({forceCanvas:!1},e),this.renderer=yp(e),this.stage=new Jt,i._plugins.forEach(function(r){r.init.call(t,e)})}return i.registerPlugin=function(e){i._plugins.push(e)},i.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(i.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),i.prototype.destroy=function(e,t){var r=this,n=i._plugins.slice(0);n.reverse(),n.forEach(function(s){s.destroy.call(r)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null},i})();en._plugins=[];var Yg=(function(){function i(){}return i.init=function(e){var t=this;Object.defineProperty(this,"resizeTo",{set:function(r){window.removeEventListener("resize",this.queueResize),this._resizeTo=r,r&&(window.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){t._resizeTo&&(t.cancelResize(),t._resizeId=requestAnimationFrame(function(){return t.resize()}))},this.cancelResize=function(){t._resizeId&&(cancelAnimationFrame(t._resizeId),t._resizeId=null)},this.resize=function(){if(t._resizeTo){t.cancelResize();var r,n;if(t._resizeTo===window)r=window.innerWidth,n=window.innerHeight;else{var s=t._resizeTo,o=s.clientWidth,a=s.clientHeight;r=o,n=a}t.renderer.resize(r,n)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null},i.destroy=function(){window.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},i})();en.registerPlugin(Yg);/*!
 * @pixi/extract - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var yf=new vt,vf=4,wp=(function(){function i(e){this.renderer=e,e.extract=this}return i.prototype.image=function(e,t,r){var n=new Image;return n.src=this.base64(e,t,r),n},i.prototype.base64=function(e,t,r){return this.canvas(e).toDataURL(t,r)},i.prototype.canvas=function(e){var t=this.renderer,r,n,s=!1,o,a=!1;e&&(e instanceof Ar?o=e:(o=this.renderer.generateTexture(e),a=!0)),o?(r=o.baseTexture.resolution,n=o.frame,s=!1,t.renderTexture.bind(o)):(r=this.renderer.resolution,s=!0,n=yf,n.width=this.renderer.width,n.height=this.renderer.height,t.renderTexture.bind(null));var l=Math.floor(n.width*r+1e-4),u=Math.floor(n.height*r+1e-4),h=new Ca(l,u,1),f=new Uint8Array(vf*l*u),c=t.gl;c.readPixels(n.x*r,n.y*r,l,u,c.RGBA,c.UNSIGNED_BYTE,f);var d=h.context.getImageData(0,0,l,u);if(i.arrayPostDivide(f,d.data),h.context.putImageData(d,0,0),s){var p=new Ca(h.width,h.height,1);p.context.scale(1,-1),p.context.drawImage(h.canvas,0,-u),h.destroy(),h=p}return a&&o.destroy(!0),h.canvas},i.prototype.pixels=function(e){var t=this.renderer,r,n,s,o=!1;e&&(e instanceof Ar?s=e:(s=this.renderer.generateTexture(e),o=!0)),s?(r=s.baseTexture.resolution,n=s.frame,t.renderTexture.bind(s)):(r=t.resolution,n=yf,n.width=t.width,n.height=t.height,t.renderTexture.bind(null));var a=n.width*r,l=n.height*r,u=new Uint8Array(vf*a*l),h=t.gl;return h.readPixels(n.x*r,n.y*r,a,l,h.RGBA,h.UNSIGNED_BYTE,u),o&&s.destroy(!0),i.arrayPostDivide(u,u),u},i.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},i.arrayPostDivide=function(e,t){for(var r=0;r<e.length;r+=4){var n=t[r+3]=e[r+3];n!==0?(t[r]=Math.round(Math.min(e[r]*255/n,255)),t[r+1]=Math.round(Math.min(e[r+1]*255/n,255)),t[r+2]=Math.round(Math.min(e[r+2]*255/n,255))):(t[r]=e[r],t[r+1]=e[r+1],t[r+2]=e[r+2])}},i})(),Qo,mf;function zg(){return mf||(mf=1,Qo=(i,e={})=>{if(!i)return;const t=/(?:^|&)([^&=]*)=?([^&]*)/g,r={strict:/^(?:([^:/?#]+):)?(?:\/\/([^/?#]*)|([^?#]*?))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/,loose:/^(?:([^:/?#.]+):)?(?:\/\/([^/?#]*)|([^?#]*?))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},s=(e.strictMode?r.strict:r.loose).exec(i);if(!s)return;const[,o="",a="",l="",u="",h="",f=""]=s,c=a||"",d=a?u:l+u,p={source:i,protocol:o,authority:c,relative:d,query:h,anchor:f,userInfo:"",user:"",password:"",host:"",port:"",path:d,directory:"",file:"",queryKey:{}};if(c){const v=/^(?:(([^:@]*)(?::([^:@]*))?)?@)?([^:/?#]*)(?::(\d*))?/.exec(c);if(v){const[,g="",I="",w="",M="",b=""]=v;Object.assign(p,{userInfo:g,user:I,password:w,host:M,port:b})}}if(d){const m=d.lastIndexOf("/");m>-1?(p.directory=d.substring(0,m+1),p.file=d.substring(m+1)):p.file=d}if(h)for(const[,m,v]of h.matchAll(t))m&&(p.queryKey[m]=v);return p}),Qo}var Vg=zg();const Tp=yi(Vg);class En{constructor(e,t=!1,r){this._fn=e,this._once=t,this._thisArg=r,this._next=this._prev=this._owner=null}detach(){return this._owner===null?!1:(this._owner.detach(this),!0)}}function gf(i,e){return i._head?(i._tail._next=e,e._prev=i._tail,i._tail=e):(i._head=e,i._tail=e),e._owner=i,e}class Fe{constructor(){this._head=this._tail=void 0}handlers(e=!1){let t=this._head;if(e)return!!t;const r=[];for(;t;)r.push(t),t=t._next;return r}has(e){if(!(e instanceof En))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return e._owner===this}dispatch(){let e=this._head;if(!e)return!1;for(;e;)e._once&&this.detach(e),e._fn.apply(e._thisArg,arguments),e=e._next;return!0}add(e,t=null){if(typeof e!="function")throw new Error("MiniSignal#add(): First arg must be a Function.");return gf(this,new En(e,!1,t))}once(e,t=null){if(typeof e!="function")throw new Error("MiniSignal#once(): First arg must be a Function.");return gf(this,new En(e,!0,t))}detach(e){if(!(e instanceof En))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return e._owner!==this?this:(e._prev&&(e._prev._next=e._next),e._next&&(e._next._prev=e._prev),e===this._head?(this._head=e._next,e._next===null&&(this._tail=null)):e===this._tail&&(this._tail=e._prev,this._tail._next=null),e._owner=null,this)}detachAll(){let e=this._head;if(!e)return this;for(this._head=this._tail=null;e;)e._owner=null,e=e._next;return this}}/*!
 * resource-loader - v3.0.1
 * https://github.com/pixijs/pixi-sound
 * Compiled Tue, 02 Jul 2019 14:06:18 UTC
 *
 * resource-loader is licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license
 */function dr(){}function _f(i,e,t,r){var n=0,s=i.length;(function o(a){if(a||n===s){t&&t(a);return}r?setTimeout(function(){e(i[n++],o)},1):e(i[n++],o)})()}function qg(i){return function(){if(i===null)throw new Error("Callback was already called.");var t=i;i=null,t.apply(this,arguments)}}function $g(i,e){if(e==null)e=1;else if(e===0)throw new Error("Concurrency must not be zero");var t=0,r={_tasks:[],concurrency:e,saturated:dr,unsaturated:dr,buffer:e/4,empty:dr,drain:dr,error:dr,started:!1,paused:!1,push:function(a,l){n(a,!1,l)},kill:function(){t=0,r.drain=dr,r.started=!1,r._tasks=[]},unshift:function(a,l){n(a,!0,l)},process:function(){for(;!r.paused&&t<r.concurrency&&r._tasks.length;){var a=r._tasks.shift();r._tasks.length===0&&r.empty(),t+=1,t===r.concurrency&&r.saturated(),i(a.data,qg(s(a)))}},length:function(){return r._tasks.length},running:function(){return t},idle:function(){return r._tasks.length+t===0},pause:function(){r.paused!==!0&&(r.paused=!0)},resume:function(){if(r.paused!==!1){r.paused=!1;for(var a=1;a<=r.concurrency;a++)r.process()}}};function n(o,a,l){if(l!=null&&typeof l!="function")throw new Error("task callback must be a function");if(r.started=!0,o==null&&r.idle()){setTimeout(function(){return r.drain()},1);return}var u={data:o,callback:typeof l=="function"?l:dr};a?r._tasks.unshift(u):r._tasks.push(u),setTimeout(function(){return r.process()},1)}function s(o){return function(){t-=1,o.callback.apply(o,arguments),arguments[0]!=null&&r.error(arguments[0],o.data),t<=r.concurrency-r.buffer&&r.unsaturated(),r.idle()&&r.drain(),r.process()}}return r}function jg(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,r.key,r)}}function Ip(i,e,t){return e&&jg(i.prototype,e),i}var Wg=!!(window.XDomainRequest&&!("withCredentials"in new XMLHttpRequest)),Sn=null,Kg=0,bf=200,Zg=204,Jg=1223,Qg=2;function t0(){}var ot=(function(){i.setExtensionLoadType=function(r,n){xf(i._loadTypeMap,r,n)},i.setExtensionXhrType=function(r,n){xf(i._xhrTypeMap,r,n)};function i(t,r,n){if(typeof t!="string"||typeof r!="string")throw new Error("Both name and url are required for constructing a resource.");n=n||{},this._flags=0,this._setFlag(i.STATUS_FLAGS.DATA_URL,r.indexOf("data:")===0),this.name=t,this.url=r,this.extension=this._getExtension(),this.data=null,this.crossOrigin=n.crossOrigin===!0?"anonymous":n.crossOrigin,this.timeout=n.timeout||0,this.loadType=n.loadType||this._determineLoadType(),this.xhrType=n.xhrType,this.metadata=n.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=i.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=t0,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new Fe,this.onProgress=new Fe,this.onComplete=new Fe,this.onAfterMiddleware=new Fe}var e=i.prototype;return e.complete=function(){this._clearEvents(),this._finish()},e.abort=function(r){if(!this.error){if(this.error=new Error(r),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=i.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},e.load=function(r){var n=this;if(!this.isLoading){if(this.isComplete){r&&setTimeout(function(){return r(n)},1);return}else r&&this.onComplete.once(r);switch(this._setFlag(i.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),(this.crossOrigin===!1||typeof this.crossOrigin!="string")&&(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case i.LOAD_TYPE.IMAGE:this.type=i.TYPE.IMAGE,this._loadElement("image");break;case i.LOAD_TYPE.AUDIO:this.type=i.TYPE.AUDIO,this._loadSourceElement("audio");break;case i.LOAD_TYPE.VIDEO:this.type=i.TYPE.VIDEO,this._loadSourceElement("video");break;case i.LOAD_TYPE.XHR:default:Wg&&this.crossOrigin?this._loadXdr():this._loadXhr();break}}},e._hasFlag=function(r){return(this._flags&r)!==0},e._setFlag=function(r,n){this._flags=n?this._flags|r:this._flags&~r},e._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},e._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(i.STATUS_FLAGS.COMPLETE,!0),this._setFlag(i.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},e._loadElement=function(r){this.metadata.loadElement?this.data=this.metadata.loadElement:r==="image"&&typeof window.Image<"u"?this.data=new Image:this.data=document.createElement(r),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},e._loadSourceElement=function(r){if(this.metadata.loadElement?this.data=this.metadata.loadElement:r==="audio"&&typeof window.Audio<"u"?this.data=new Audio:this.data=document.createElement(r),this.data===null){this.abort("Unsupported element: "+r);return}if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var n=this.metadata.mimeType,s=0;s<this.url.length;++s)this.data.appendChild(this._createSource(r,this.url[s],Array.isArray(n)?n[s]:n));else{var o=this.metadata.mimeType;this.data.appendChild(this._createSource(r,this.url,Array.isArray(o)?o[0]:o))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},e._loadXhr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var r=this.xhr=new XMLHttpRequest;r.open("GET",this.url,!0),r.timeout=this.timeout,this.xhrType===i.XHR_RESPONSE_TYPE.JSON||this.xhrType===i.XHR_RESPONSE_TYPE.DOCUMENT?r.responseType=i.XHR_RESPONSE_TYPE.TEXT:r.responseType=this.xhrType,r.addEventListener("error",this._boundXhrOnError,!1),r.addEventListener("timeout",this._boundXhrOnTimeout,!1),r.addEventListener("abort",this._boundXhrOnAbort,!1),r.addEventListener("progress",this._boundOnProgress,!1),r.addEventListener("load",this._boundXhrOnLoad,!1),r.send()},e._loadXdr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var r=this.xhr=new XDomainRequest;r.timeout=this.timeout||5e3,r.onerror=this._boundXhrOnError,r.ontimeout=this._boundXhrOnTimeout,r.onprogress=this._boundOnProgress,r.onload=this._boundXhrOnLoad,r.open("GET",this.url,!0),setTimeout(function(){return r.send()},1)},e._createSource=function(r,n,s){s||(s=r+"/"+this._getExtension(n));var o=document.createElement("source");return o.src=n,o.type=s,o},e._onError=function(r){this.abort("Failed to load element using: "+r.target.nodeName)},e._onProgress=function(r){r&&r.lengthComputable&&this.onProgress.dispatch(this,r.loaded/r.total)},e._onTimeout=function(){this.abort("Load timed out.")},e._xhrOnError=function(){var r=this.xhr;this.abort(ta(r)+" Request failed. Status: "+r.status+', text: "'+r.statusText+'"')},e._xhrOnTimeout=function(){var r=this.xhr;this.abort(ta(r)+" Request timed out.")},e._xhrOnAbort=function(){var r=this.xhr;this.abort(ta(r)+" Request was aborted by the user.")},e._xhrOnLoad=function(){var r=this.xhr,n="",s=typeof r.status>"u"?bf:r.status;(r.responseType===""||r.responseType==="text"||typeof r.responseType>"u")&&(n=r.responseText),s===Kg&&(n.length>0||r.responseType===i.XHR_RESPONSE_TYPE.BUFFER)?s=bf:s===Jg&&(s=Zg);var o=s/100|0;if(o===Qg)if(this.xhrType===i.XHR_RESPONSE_TYPE.TEXT)this.data=n,this.type=i.TYPE.TEXT;else if(this.xhrType===i.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(n),this.type=i.TYPE.JSON}catch(u){this.abort("Error trying to parse loaded json: "+u);return}else if(this.xhrType===i.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var a=new DOMParser;this.data=a.parseFromString(n,"text/xml")}else{var l=document.createElement("div");l.innerHTML=n,this.data=l}this.type=i.TYPE.XML}catch(u){this.abort("Error trying to parse loaded xml: "+u);return}else this.data=r.response||n;else{this.abort("["+r.status+"] "+r.statusText+": "+r.responseURL);return}this.complete()},e._determineCrossOrigin=function(r,n){if(r.indexOf("data:")===0)return"";if(window.origin!==window.location.origin)return"anonymous";n=n||window.location,Sn||(Sn=document.createElement("a")),Sn.href=r,r=Tp(Sn.href,{strictMode:!0});var s=!r.port&&n.port===""||r.port===n.port,o=r.protocol?r.protocol+":":"";return r.host!==n.hostname||!s||o!==n.protocol?"anonymous":""},e._determineXhrType=function(){return i._xhrTypeMap[this.extension]||i.XHR_RESPONSE_TYPE.TEXT},e._determineLoadType=function(){return i._loadTypeMap[this.extension]||i.LOAD_TYPE.XHR},e._getExtension=function(){var r=this.url,n="";if(this.isDataUrl){var s=r.indexOf("/");n=r.substring(s+1,r.indexOf(";",s))}else{var o=r.indexOf("?"),a=r.indexOf("#"),l=Math.min(o>-1?o:r.length,a>-1?a:r.length);r=r.substring(0,l),n=r.substring(r.lastIndexOf(".")+1)}return n.toLowerCase()},e._getMimeFromXhrType=function(r){switch(r){case i.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case i.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case i.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case i.XHR_RESPONSE_TYPE.JSON:return"application/json";case i.XHR_RESPONSE_TYPE.DEFAULT:case i.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},Ip(i,[{key:"isDataUrl",get:function(){return this._hasFlag(i.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(i.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(i.STATUS_FLAGS.LOADING)}}]),i})();ot.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4};ot.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6};ot.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4};ot.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"};ot._loadTypeMap={gif:ot.LOAD_TYPE.IMAGE,png:ot.LOAD_TYPE.IMAGE,bmp:ot.LOAD_TYPE.IMAGE,jpg:ot.LOAD_TYPE.IMAGE,jpeg:ot.LOAD_TYPE.IMAGE,tif:ot.LOAD_TYPE.IMAGE,tiff:ot.LOAD_TYPE.IMAGE,webp:ot.LOAD_TYPE.IMAGE,tga:ot.LOAD_TYPE.IMAGE,svg:ot.LOAD_TYPE.IMAGE,"svg+xml":ot.LOAD_TYPE.IMAGE,mp3:ot.LOAD_TYPE.AUDIO,ogg:ot.LOAD_TYPE.AUDIO,wav:ot.LOAD_TYPE.AUDIO,mp4:ot.LOAD_TYPE.VIDEO,webm:ot.LOAD_TYPE.VIDEO};ot._xhrTypeMap={xhtml:ot.XHR_RESPONSE_TYPE.DOCUMENT,html:ot.XHR_RESPONSE_TYPE.DOCUMENT,htm:ot.XHR_RESPONSE_TYPE.DOCUMENT,xml:ot.XHR_RESPONSE_TYPE.DOCUMENT,tmx:ot.XHR_RESPONSE_TYPE.DOCUMENT,svg:ot.XHR_RESPONSE_TYPE.DOCUMENT,tsx:ot.XHR_RESPONSE_TYPE.DOCUMENT,gif:ot.XHR_RESPONSE_TYPE.BLOB,png:ot.XHR_RESPONSE_TYPE.BLOB,bmp:ot.XHR_RESPONSE_TYPE.BLOB,jpg:ot.XHR_RESPONSE_TYPE.BLOB,jpeg:ot.XHR_RESPONSE_TYPE.BLOB,tif:ot.XHR_RESPONSE_TYPE.BLOB,tiff:ot.XHR_RESPONSE_TYPE.BLOB,webp:ot.XHR_RESPONSE_TYPE.BLOB,tga:ot.XHR_RESPONSE_TYPE.BLOB,json:ot.XHR_RESPONSE_TYPE.JSON,text:ot.XHR_RESPONSE_TYPE.TEXT,txt:ot.XHR_RESPONSE_TYPE.TEXT,ttf:ot.XHR_RESPONSE_TYPE.BUFFER,otf:ot.XHR_RESPONSE_TYPE.BUFFER};ot.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";function xf(i,e,t){e&&e.indexOf(".")===0&&(e=e.substring(1)),e&&(i[e]=t)}function ta(i){return i.toString().replace("object ","")}var e0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function r0(i){for(var e="",t=0;t<i.length;){for(var r=[0,0,0],n=[0,0,0,0],s=0;s<r.length;++s)t<i.length?r[s]=i.charCodeAt(t++)&255:r[s]=0;n[0]=r[0]>>2,n[1]=(r[0]&3)<<4|r[1]>>4,n[2]=(r[1]&15)<<2|r[2]>>6,n[3]=r[2]&63;var o=t-(i.length-1);switch(o){case 2:n[3]=64,n[2]=64;break;case 1:n[3]=64;break}for(var a=0;a<n.length;++a)e+=e0.charAt(n[a])}return e}var wf=window.URL||window.webkitURL;function i0(i,e){if(!i.data){e();return}if(i.xhr&&i.xhrType===ot.XHR_RESPONSE_TYPE.BLOB){if(!window.Blob||typeof i.data=="string"){var t=i.xhr.getResponseHeader("content-type");if(t&&t.indexOf("image")===0){i.data=new Image,i.data.src="data:"+t+";base64,"+r0(i.xhr.responseText),i.type=ot.TYPE.IMAGE,i.data.onload=function(){i.data.onload=null,e()};return}}else if(i.data.type.indexOf("image")===0){var r=wf.createObjectURL(i.data);i.blob=i.data,i.data=new Image,i.data.src=r,i.type=ot.TYPE.IMAGE,i.data.onload=function(){wf.revokeObjectURL(r),i.data.onload=null,e()};return}}e()}var n0={parsing:i0},ea=100,s0=/(#[\w-]+)?$/,De=(function(){function i(t,r){var n=this;t===void 0&&(t=""),r===void 0&&(r=10),this.baseUrl=t,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(a,l){return n._loadResource(a,l)},this._queue=$g(this._boundLoadResource,r),this._queue.pause(),this.resources={},this.onProgress=new Fe,this.onError=new Fe,this.onLoad=new Fe,this.onStart=new Fe,this.onComplete=new Fe;for(var s=0;s<i._defaultBeforeMiddleware.length;++s)this.pre(i._defaultBeforeMiddleware[s]);for(var o=0;o<i._defaultAfterMiddleware.length;++o)this.use(i._defaultAfterMiddleware[o])}var e=i.prototype;return e.add=function(r,n,s,o){if(Array.isArray(r)){for(var a=0;a<r.length;++a)this.add(r[a]);return this}if(typeof r=="object"&&(o=n||r.callback||r.onComplete,s=r,n=r.url,r=r.name||r.key||r.url),typeof n!="string"&&(o=s,s=n,n=r),typeof n!="string")throw new Error("No url passed to add resource to loader.");if(typeof s=="function"&&(o=s,s=null),this.loading&&(!s||!s.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[r])throw new Error('Resource named "'+r+'" already exists.');if(n=this._prepareUrl(n),this.resources[r]=new ot(r,n,s),typeof o=="function"&&this.resources[r].onAfterMiddleware.once(o),this.loading){for(var l=s.parentResource,u=[],h=0;h<l.children.length;++h)l.children[h].isComplete||u.push(l.children[h]);var f=l.progressChunk*(u.length+1),c=f/(u.length+2);l.children.push(this.resources[r]),l.progressChunk=c;for(var d=0;d<u.length;++d)u[d].progressChunk=c;this.resources[r].progressChunk=c}return this._queue.push(this.resources[r]),this},e.pre=function(r){return this._beforeMiddleware.push(r),this},e.use=function(r){return this._afterMiddleware.push(r),this},e.reset=function(){this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause();for(var r in this.resources){var n=this.resources[r];n._onLoadBinding&&n._onLoadBinding.detach(),n.isLoading&&n.abort()}return this.resources={},this},e.load=function(r){if(typeof r=="function"&&this.onComplete.once(r),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var n=this._queue._tasks.length,s=ea/n,o=0;o<this._queue._tasks.length;++o)this._queue._tasks[o].data.progressChunk=s;this._onStart(),this._queue.resume()}return this},e._prepareUrl=function(r){var n=Tp(r,{strictMode:!0}),s;if(n.protocol||!n.path||r.indexOf("//")===0?s=r:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&r.charAt(0)!=="/"?s=this.baseUrl+"/"+r:s=this.baseUrl+r,this.defaultQueryString){var o=s0.exec(s)[0];s=s.substr(0,s.length-o.length),s.indexOf("?")!==-1?s+="&"+this.defaultQueryString:s+="?"+this.defaultQueryString,s+=o}return s},e._loadResource=function(r,n){var s=this;r._dequeue=n,_f(this._beforeMiddleware,function(o,a){o.call(s,r,function(){a(r.isComplete?{}:null)})},function(){r.isComplete?s._onLoad(r):(r._onLoadBinding=r.onComplete.once(s._onLoad,s),r.load())},!0)},e._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},e._onComplete=function(){this.progress=ea,this.loading=!1,this.onComplete.dispatch(this,this.resources)},e._onLoad=function(r){var n=this;r._onLoadBinding=null,this._resourcesParsing.push(r),r._dequeue(),_f(this._afterMiddleware,function(s,o){s.call(n,r,o)},function(){r.onAfterMiddleware.dispatch(r),n.progress=Math.min(ea,n.progress+r.progressChunk),n.onProgress.dispatch(n,r),r.error?n.onError.dispatch(r.error,n,r):n.onLoad.dispatch(n,r),n._resourcesParsing.splice(n._resourcesParsing.indexOf(r),1),n._queue.idle()&&n._resourcesParsing.length===0&&n._onComplete()},!0)},Ip(i,[{key:"concurrency",get:function(){return this._queue.concurrency},set:function(r){this._queue.concurrency=r}}]),i})();De._defaultBeforeMiddleware=[];De._defaultAfterMiddleware=[];De.pre=function(e){return De._defaultBeforeMiddleware.push(e),De};De.use=function(e){return De._defaultAfterMiddleware.push(e),De};/*!
 * @pixi/loaders - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/loaders is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Xi=ot;/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Na=function(i,e){return Na=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},Na(i,e)};function o0(i,e){Na(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Ep=(function(){function i(){}return i.use=function(e,t){e.data&&e.type===ot.TYPE.IMAGE&&(e.texture=lt.fromLoader(e.data,e.url,e.name)),t()},i})(),Cr=(function(i){o0(e,i);function e(t,r){for(var n=i.call(this,t,r)||this,s=0;s<e._plugins.length;++s){var o=e._plugins[s],a=o.pre,l=o.use;a&&n.pre(a),l&&n.use(l)}return n._protected=!1,n}return e.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(e,"shared",{get:function(){var t=e._shared;return t||(t=new e,t._protected=!0,e._shared=t),t},enumerable:!1,configurable:!0}),e.registerPlugin=function(t){return e._plugins.push(t),t.add&&t.add(),e},e._plugins=[],e})(De);Cr.registerPlugin({use:n0.parsing});Cr.registerPlugin(Ep);var Sp=(function(){function i(){}return i.init=function(e){e=Object.assign({sharedLoader:!1},e),this.loader=e.sharedLoader?Cr.shared:new Cr},i.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},i})();/*!
 * @pixi/particles - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/particles is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Ba=function(i,e){return Ba=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},Ba(i,e)};function Ap(i,e){Ba(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var a0=(function(i){Ap(e,i);function e(t,r,n,s){t===void 0&&(t=1500),n===void 0&&(n=16384),s===void 0&&(s=!1);var o=i.call(this)||this,a=16384;return n>a&&(n=a),o._properties=[!1,!0,!1,!1,!1],o._maxSize=t,o._batchSize=n,o._buffers=null,o._bufferUpdateIDs=[],o._updateID=0,o.interactiveChildren=!1,o.blendMode=st.NORMAL,o.autoResize=s,o.roundPixels=!0,o.baseTexture=null,o.setProperties(r),o._tint=0,o.tintRgb=new Float32Array(4),o.tint=16777215,o}return e.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},e.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,Er(t,this.tintRgb)},enumerable:!1,configurable:!0}),e.prototype.render=function(t){var r=this;!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",function(){return r.onChildrenChange(0)})),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},e.prototype.onChildrenChange=function(t){for(var r=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<r;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[r]=++this._updateID},e.prototype.dispose=function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}},e.prototype.destroy=function(t){i.prototype.destroy.call(this,t),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},e})(Jt),Tf=(function(){function i(e,t,r){this.geometry=new Mr,this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(var n=0;n<e.length;++n){var s=e[n];s={attributeName:s.attributeName,size:s.size,uploadFunction:s.uploadFunction,type:s.type||Lt.FLOAT,offset:s.offset},t[n]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return i.prototype.initBuffers=function(){var e=this.geometry,t=0;this.indexBuffer=new Mt(Hl(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(var r=0;r<this.dynamicProperties.length;++r){var n=this.dynamicProperties[r];n.offset=t,t+=n.size,this.dynamicStride+=n.size}var s=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(s),this.dynamicDataUint32=new Uint32Array(s),this.dynamicBuffer=new Mt(this.dynamicData,!1,!1);var o=0;this.staticStride=0;for(var r=0;r<this.staticProperties.length;++r){var n=this.staticProperties[r];n.offset=o,o+=n.size,this.staticStride+=n.size}var a=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(a),this.staticDataUint32=new Uint32Array(a),this.staticBuffer=new Mt(this.staticData,!0,!1);for(var r=0;r<this.dynamicProperties.length;++r){var n=this.dynamicProperties[r];e.addAttribute(n.attributeName,this.dynamicBuffer,0,n.type===Lt.UNSIGNED_BYTE,n.type,this.dynamicStride*4,n.offset*4)}for(var r=0;r<this.staticProperties.length;++r){var n=this.staticProperties[r];e.addAttribute(n.attributeName,this.staticBuffer,0,n.type===Lt.UNSIGNED_BYTE,n.type,this.staticStride*4,n.offset*4)}},i.prototype.uploadDynamic=function(e,t,r){for(var n=0;n<this.dynamicProperties.length;n++){var s=this.dynamicProperties[n];s.uploadFunction(e,t,r,s.type===Lt.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer._updateID++},i.prototype.uploadStatic=function(e,t,r){for(var n=0;n<this.staticProperties.length;n++){var s=this.staticProperties[n];s.uploadFunction(e,t,r,s.type===Lt.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer._updateID++},i.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},i})(),l0=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,u0=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`,Cp=(function(i){Ap(e,i);function e(t){var r=i.call(this,t)||this;return r.shader=null,r.properties=null,r.tempMatrix=new Rt,r.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:r.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:r.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:r.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:r.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:Lt.UNSIGNED_BYTE,uploadFunction:r.uploadTint,offset:0}],r.shader=Ge.from(u0,l0,{}),r.state=lr.for2d(),r}return e.prototype.render=function(t){var r=t.children,n=t._maxSize,s=t._batchSize,o=this.renderer,a=r.length;if(a!==0){a>n&&!t.autoResize&&(a=n);var l=t._buffers;l||(l=t._buffers=this.generateBuffers(t));var u=r[0]._texture.baseTexture;this.state.blendMode=Ul(t.blendMode,u.alphaMode),o.state.set(this.state);var h=o.gl,f=t.worldTransform.copyTo(this.tempMatrix);f.prepend(o.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=f.toArray(!0),this.shader.uniforms.uColor=md(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,u.alphaMode),this.shader.uniforms.uSampler=u,this.renderer.shader.bind(this.shader);for(var c=!1,d=0,p=0;d<a;d+=s,p+=1){var m=a-d;m>s&&(m=s),p>=l.length&&l.push(this._generateOneMoreBuffer(t));var v=l[p];v.uploadDynamic(r,d,m);var g=t._bufferUpdateIDs[p]||0;c=c||v._updateID<g,c&&(v._updateID=t._updateID,v.uploadStatic(r,d,m)),o.geometry.bind(v.geometry),h.drawElements(h.TRIANGLES,m*6,h.UNSIGNED_SHORT,0)}}},e.prototype.generateBuffers=function(t){for(var r=[],n=t._maxSize,s=t._batchSize,o=t._properties,a=0;a<n;a+=s)r.push(new Tf(this.properties,o,s));return r},e.prototype._generateOneMoreBuffer=function(t){var r=t._batchSize,n=t._properties;return new Tf(this.properties,n,r)},e.prototype.uploadVertices=function(t,r,n,s,o,a){for(var l=0,u=0,h=0,f=0,c=0;c<n;++c){var d=t[r+c],p=d._texture,m=d.scale.x,v=d.scale.y,g=p.trim,I=p.orig;g?(u=g.x-d.anchor.x*I.width,l=u+g.width,f=g.y-d.anchor.y*I.height,h=f+g.height):(l=I.width*(1-d.anchor.x),u=I.width*-d.anchor.x,h=I.height*(1-d.anchor.y),f=I.height*-d.anchor.y),s[a]=u*m,s[a+1]=f*v,s[a+o]=l*m,s[a+o+1]=f*v,s[a+o*2]=l*m,s[a+o*2+1]=h*v,s[a+o*3]=u*m,s[a+o*3+1]=h*v,a+=o*4}},e.prototype.uploadPosition=function(t,r,n,s,o,a){for(var l=0;l<n;l++){var u=t[r+l].position;s[a]=u.x,s[a+1]=u.y,s[a+o]=u.x,s[a+o+1]=u.y,s[a+o*2]=u.x,s[a+o*2+1]=u.y,s[a+o*3]=u.x,s[a+o*3+1]=u.y,a+=o*4}},e.prototype.uploadRotation=function(t,r,n,s,o,a){for(var l=0;l<n;l++){var u=t[r+l].rotation;s[a]=u,s[a+o]=u,s[a+o*2]=u,s[a+o*3]=u,a+=o*4}},e.prototype.uploadUvs=function(t,r,n,s,o,a){for(var l=0;l<n;++l){var u=t[r+l]._texture._uvs;u?(s[a]=u.x0,s[a+1]=u.y0,s[a+o]=u.x1,s[a+o+1]=u.y1,s[a+o*2]=u.x2,s[a+o*2+1]=u.y2,s[a+o*3]=u.x3,s[a+o*3+1]=u.y3,a+=o*4):(s[a]=0,s[a+1]=0,s[a+o]=0,s[a+o+1]=0,s[a+o*2]=0,s[a+o*2+1]=0,s[a+o*3]=0,s[a+o*3+1]=0,a+=o*4)}},e.prototype.uploadTint=function(t,r,n,s,o,a){for(var l=0;l<n;++l){var u=t[r+l],h=u._texture.baseTexture.alphaMode>0,f=u.alpha,c=f<1&&h?bs(u._tintRGB,f):u._tintRGB+(f*255<<24);s[a]=c,s[a+o]=c,s[a+o*2]=c,s[a+o*3]=c,a+=o*4}},e.prototype.destroy=function(){i.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},e})(gi);/*!
 * @pixi/graphics - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/graphics is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Le;(function(i){i.MITER="miter",i.BEVEL="bevel",i.ROUND="round"})(Le||(Le={}));var Ne;(function(i){i.BUTT="butt",i.ROUND="round",i.SQUARE="square"})(Ne||(Ne={}));var hi={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(i,e){if(e===void 0&&(e=20),!this.adaptive||!i||isNaN(i))return e;var t=Math.ceil(i/this.maxLength);return t<this.minSegments?t=this.minSegments:t>this.maxSegments&&(t=this.maxSegments),t}},Ql=(function(){function i(){this.color=16777215,this.alpha=1,this.texture=lt.WHITE,this.matrix=null,this.visible=!1,this.reset()}return i.prototype.clone=function(){var e=new i;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e},i.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=lt.WHITE,this.matrix=null,this.visible=!1},i.prototype.destroy=function(){this.texture=null,this.matrix=null},i})();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Da=function(i,e){return Da=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},Da(i,e)};function Is(i,e){Da(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var tu={build:function(i){i.points=i.shape.points.slice()},triangulate:function(i,e){var t=i.points,r=i.holes,n=e.points,s=e.indices;if(t.length>=6){for(var o=[],a=0;a<r.length;a++){var l=r[a];o.push(t.length/2),t=t.concat(l.points)}var u=Fl(t,o,2);if(!u)return;for(var h=n.length/2,a=0;a<u.length;a+=3)s.push(u[a]+h),s.push(u[a+1]+h),s.push(u[a+2]+h);for(var a=0;a<t.length;a++)n.push(t[a])}}},ka={build:function(i){var e=i.shape,t=i.points,r=e.x,n=e.y,s,o;if(t.length=0,i.type===Ot.CIRC)s=e.radius,o=e.radius;else{var a=i.shape;s=a.width,o=a.height}if(!(s===0||o===0)){var l=Math.floor(30*Math.sqrt(e.radius))||Math.floor(15*Math.sqrt(s+o));l/=2.3;for(var u=Math.PI*2/l,h=0;h<l-.5;h++)t.push(r+Math.sin(-u*h)*s,n+Math.cos(-u*h)*o);t.push(t[0],t[1])}},triangulate:function(i,e){var t=i.points,r=e.points,n=e.indices,s=r.length/2,o=s,a=i.shape,l=i.matrix,u=a.x,h=a.y;r.push(i.matrix?l.a*u+l.c*h+l.tx:u,i.matrix?l.b*u+l.d*h+l.ty:h);for(var f=0;f<t.length;f+=2)r.push(t[f],t[f+1]),n.push(s++,o,s)}},Pp={build:function(i){var e=i.shape,t=e.x,r=e.y,n=e.width,s=e.height,o=i.points;o.length=0,o.push(t,r,t+n,r,t+n,r+s,t,r+s)},triangulate:function(i,e){var t=i.points,r=e.points,n=r.length/2;r.push(t[0],t[1],t[2],t[3],t[6],t[7],t[4],t[5]),e.indices.push(n,n+1,n+2,n+1,n+2,n+3)}};function zr(i,e,t){var r=e-i;return i+r*t}function An(i,e,t,r,n,s,o){o===void 0&&(o=[]);for(var a=20,l=o,u=0,h=0,f=0,c=0,d=0,p=0,m=0,v=0;m<=a;++m)v=m/a,u=zr(i,t,v),h=zr(e,r,v),f=zr(t,n,v),c=zr(r,s,v),d=zr(u,f,v),p=zr(h,c,v),l.push(d,p);return l}var Op={build:function(i){var e=i.shape,t=i.points,r=e.x,n=e.y,s=e.width,o=e.height,a=Math.max(0,Math.min(e.radius,Math.min(s,o)/2));t.length=0,a?(An(r,n+a,r,n,r+a,n,t),An(r+s-a,n,r+s,n,r+s,n+a,t),An(r+s,n+o-a,r+s,n+o,r+s-a,n+o,t),An(r+a,n+o,r,n+o,r,n+o-a,t)):t.push(r,n,r+s,n,r+s,n+o,r,n+o)},triangulate:function(i,e){for(var t=i.points,r=e.points,n=e.indices,s=r.length/2,o=Fl(t,null,2),a=0,l=o.length;a<l;a+=3)n.push(o[a]+s),n.push(o[a+1]+s),n.push(o[a+2]+s);for(var a=0,l=t.length;a<l;a++)r.push(t[a],t[++a])}};function If(i,e,t,r,n,s,o,a){var l=i-t*n,u=e-r*n,h=i+t*s,f=e+r*s,c,d;o?(c=r,d=-t):(c=-r,d=t);var p=l+c,m=u+d,v=h+c,g=f+d;return a.push(p,m),a.push(v,g),2}function Vr(i,e,t,r,n,s,o,a){var l=t-i,u=r-e,h=Math.atan2(l,u),f=Math.atan2(n-i,s-e);a&&h<f?h+=Math.PI*2:!a&&h>f&&(f+=Math.PI*2);var c=h,d=f-h,p=Math.abs(d),m=Math.sqrt(l*l+u*u),v=(15*p*Math.sqrt(m)/Math.PI>>0)+1,g=d/v;if(c+=g,a){o.push(i,e),o.push(t,r);for(var I=1,w=c;I<v;I++,w+=g)o.push(i,e),o.push(i+Math.sin(w)*m,e+Math.cos(w)*m);o.push(i,e),o.push(n,s)}else{o.push(t,r),o.push(i,e);for(var I=1,w=c;I<v;I++,w+=g)o.push(i+Math.sin(w)*m,e+Math.cos(w)*m),o.push(i,e);o.push(n,s),o.push(i,e)}return v*2}function h0(i,e){var t=i.shape,r=i.points||t.points.slice(),n=e.closePointEps;if(r.length!==0){var s=i.lineStyle,o=new kt(r[0],r[1]),a=new kt(r[r.length-2],r[r.length-1]),l=t.type!==Ot.POLY||t.closeStroke,u=Math.abs(o.x-a.x)<n&&Math.abs(o.y-a.y)<n;if(l){r=r.slice(),u&&(r.pop(),r.pop(),a.set(r[r.length-2],r[r.length-1]));var h=(o.x+a.x)*.5,f=(a.y+o.y)*.5;r.unshift(h,f),r.push(h,f)}var c=e.points,d=r.length/2,p=r.length,m=c.length/2,v=s.width/2,g=v*v,I=s.miterLimit*s.miterLimit,w=r[0],M=r[1],b=r[2],R=r[3],C=0,H=0,F=-(M-R),B=w-b,Y=0,D=0,J=Math.sqrt(F*F+B*B);F/=J,B/=J,F*=v,B*=v;var Q=s.alignment,q=(1-Q)*2,A=Q*2;l||(s.cap===Ne.ROUND?p+=Vr(w-F*(q-A)*.5,M-B*(q-A)*.5,w-F*q,M-B*q,w+F*A,M+B*A,c,!0)+2:s.cap===Ne.SQUARE&&(p+=If(w,M,F,B,q,A,!0,c))),c.push(w-F*q,M-B*q),c.push(w+F*A,M+B*A);for(var O=1;O<d-1;++O){w=r[(O-1)*2],M=r[(O-1)*2+1],b=r[O*2],R=r[O*2+1],C=r[(O+1)*2],H=r[(O+1)*2+1],F=-(M-R),B=w-b,J=Math.sqrt(F*F+B*B),F/=J,B/=J,F*=v,B*=v,Y=-(R-H),D=b-C,J=Math.sqrt(Y*Y+D*D),Y/=J,D/=J,Y*=v,D*=v;var y=b-w,_=M-R,x=b-C,T=H-R,S=_*x-T*y,P=S<0;if(Math.abs(S)<.1){c.push(b-F*q,R-B*q),c.push(b+F*A,R+B*A);continue}var L=(-F+w)*(-B+R)-(-F+b)*(-B+M),N=(-Y+C)*(-D+R)-(-Y+b)*(-D+H),k=(y*N-x*L)/S,U=(T*L-_*N)/S,$=(k-b)*(k-b)+(U-R)*(U-R),W=b+(k-b)*q,z=R+(U-R)*q,Z=b-(k-b)*A,j=R-(U-R)*A,it=Math.min(y*y+_*_,x*x+T*T),at=P?q:A,et=it+at*at*g,rt=$<=et;rt?s.join===Le.BEVEL||$/g>I?(P?(c.push(W,z),c.push(b+F*A,R+B*A),c.push(W,z),c.push(b+Y*A,R+D*A)):(c.push(b-F*q,R-B*q),c.push(Z,j),c.push(b-Y*q,R-D*q),c.push(Z,j)),p+=2):s.join===Le.ROUND?P?(c.push(W,z),c.push(b+F*A,R+B*A),p+=Vr(b,R,b+F*A,R+B*A,b+Y*A,R+D*A,c,!0)+4,c.push(W,z),c.push(b+Y*A,R+D*A)):(c.push(b-F*q,R-B*q),c.push(Z,j),p+=Vr(b,R,b-F*q,R-B*q,b-Y*q,R-D*q,c,!1)+4,c.push(b-Y*q,R-D*q),c.push(Z,j)):(c.push(W,z),c.push(Z,j)):(c.push(b-F*q,R-B*q),c.push(b+F*A,R+B*A),s.join===Le.BEVEL||$/g>I||(s.join===Le.ROUND?P?p+=Vr(b,R,b+F*A,R+B*A,b+Y*A,R+D*A,c,!0)+2:p+=Vr(b,R,b-F*q,R-B*q,b-Y*q,R-D*q,c,!1)+2:(P?(c.push(Z,j),c.push(Z,j)):(c.push(W,z),c.push(W,z)),p+=2)),c.push(b-Y*q,R-D*q),c.push(b+Y*A,R+D*A),p+=2)}w=r[(d-2)*2],M=r[(d-2)*2+1],b=r[(d-1)*2],R=r[(d-1)*2+1],F=-(M-R),B=w-b,J=Math.sqrt(F*F+B*B),F/=J,B/=J,F*=v,B*=v,c.push(b-F*q,R-B*q),c.push(b+F*A,R+B*A),l||(s.cap===Ne.ROUND?p+=Vr(b-F*(q-A)*.5,R-B*(q-A)*.5,b-F*q,R-B*q,b+F*A,R+B*A,c,!1)+2:s.cap===Ne.SQUARE&&(p+=If(b,R,F,B,q,A,!1,c)));for(var xt=e.indices,bt=hi.epsilon*hi.epsilon,O=m;O<p+m-2;++O)w=c[O*2],M=c[O*2+1],b=c[(O+1)*2],R=c[(O+1)*2+1],C=c[(O+2)*2],H=c[(O+2)*2+1],!(Math.abs(w*(R-H)+b*(H-M)+C*(M-R))<bt)&&xt.push(O,O+1,O+2)}}function f0(i,e){var t=0,r=i.shape,n=i.points||r.points,s=r.type!==Ot.POLY||r.closeStroke;if(n.length!==0){var o=e.points,a=e.indices,l=n.length/2,u=o.length/2,h=u;for(o.push(n[0],n[1]),t=1;t<l;t++)o.push(n[t*2],n[t*2+1]),a.push(h,h+1),h++;s&&a.push(h,u)}}function Ua(i,e){i.lineStyle.native?f0(i,e):h0(i,e)}var Rp=(function(i){Is(e,i);function e(t,r,n,s,o,a){a===void 0&&(a=0);var l=this;o=o||s/2;for(var u=-1*Math.PI/2+a,h=n*2,f=li/h,c=[],d=0;d<h;d++){var p=d%2?o:s,m=d*f+u;c.push(t+p*Math.cos(m),r+p*Math.sin(m))}return l=i.call(this,c)||this,l}return e})(ti),Xa=(function(){function i(){}return i.curveTo=function(e,t,r,n,s,o){var a=o[o.length-2],l=o[o.length-1],u=l-t,h=a-e,f=n-t,c=r-e,d=Math.abs(u*c-h*f);if(d<1e-8||s===0)return(o[o.length-2]!==e||o[o.length-1]!==t)&&o.push(e,t),null;var p=u*u+h*h,m=f*f+c*c,v=u*f+h*c,g=s*Math.sqrt(p)/d,I=s*Math.sqrt(m)/d,w=g*v/p,M=I*v/m,b=g*c+I*h,R=g*f+I*u,C=h*(I+w),H=u*(I+w),F=c*(g+M),B=f*(g+M),Y=Math.atan2(H-R,C-b),D=Math.atan2(B-R,F-b);return{cx:b+e,cy:R+t,radius:s,startAngle:Y,endAngle:D,anticlockwise:h*f>c*u}},i.arc=function(e,t,r,n,s,o,a,l,u){for(var h=a-o,f=hi._segmentsCount(Math.abs(h)*s,Math.ceil(Math.abs(h)/li)*40),c=h/(f*2),d=c*2,p=Math.cos(c),m=Math.sin(c),v=f-1,g=v%1/v,I=0;I<=v;++I){var w=I+g*I,M=c+o+d*w,b=Math.cos(M),R=-Math.sin(M);u.push((p*b+m*R)*s+r,(p*-R+m*b)*s+n)}},i})(),Fp=(function(){function i(){}return i.curveLength=function(e,t,r,n,s,o,a,l){for(var u=10,h=0,f=0,c=0,d=0,p=0,m=0,v=0,g=0,I=0,w=0,M=0,b=e,R=t,C=1;C<=u;++C)f=C/u,c=f*f,d=c*f,p=1-f,m=p*p,v=m*p,g=v*e+3*m*f*r+3*p*c*s+d*a,I=v*t+3*m*f*n+3*p*c*o+d*l,w=b-g,M=R-I,b=g,R=I,h+=Math.sqrt(w*w+M*M);return h},i.curveTo=function(e,t,r,n,s,o,a){var l=a[a.length-2],u=a[a.length-1];a.length-=2;var h=hi._segmentsCount(i.curveLength(l,u,e,t,r,n,s,o)),f=0,c=0,d=0,p=0,m=0;a.push(l,u);for(var v=1,g=0;v<=h;++v)g=v/h,f=1-g,c=f*f,d=c*f,p=g*g,m=p*g,a.push(d*l+3*c*g*e+3*f*p*r+m*s,d*u+3*c*g*t+3*f*p*n+m*o)},i})(),Mp=(function(){function i(){}return i.curveLength=function(e,t,r,n,s,o){var a=e-2*r+s,l=t-2*n+o,u=2*r-2*e,h=2*n-2*t,f=4*(a*a+l*l),c=4*(a*u+l*h),d=u*u+h*h,p=2*Math.sqrt(f+c+d),m=Math.sqrt(f),v=2*f*m,g=2*Math.sqrt(d),I=c/m;return(v*p+m*c*(p-g)+(4*d*f-c*c)*Math.log((2*m+I+p)/(I+g)))/(4*v)},i.curveTo=function(e,t,r,n,s){for(var o=s[s.length-2],a=s[s.length-1],l=hi._segmentsCount(i.curveLength(o,a,e,t,r,n)),u=0,h=0,f=1;f<=l;++f){var c=f/l;u=o+(e-o)*c,h=a+(t-a)*c,s.push(u+(e+(r-e)*c-u)*c,h+(t+(n-t)*c-h)*c)}},i})(),Lp=(function(){function i(){this.reset()}return i.prototype.begin=function(e,t,r){this.reset(),this.style=e,this.start=t,this.attribStart=r},i.prototype.end=function(e,t){this.attribSize=t-this.attribStart,this.size=e-this.start},i.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},i})(),pr,$n=(pr={},pr[Ot.POLY]=tu,pr[Ot.CIRC]=ka,pr[Ot.ELIP]=ka,pr[Ot.RECT]=Pp,pr[Ot.RREC]=Op,pr),Ha=[],Ni=[],c0={buildPoly:tu,buildCircle:ka,buildRectangle:Pp,buildRoundedRectangle:Op,FILL_COMMANDS:$n,BATCH_POOL:Ha,DRAW_CALL_POOL:Ni,buildLine:Ua,Star:Rp,ArcUtils:Xa,BezierUtils:Fp,QuadraticUtils:Mp,BatchPart:Lp},Ga=(function(){function i(e,t,r,n){t===void 0&&(t=null),r===void 0&&(r=null),n===void 0&&(n=null),this.shape=e,this.lineStyle=r,this.fillStyle=t,this.matrix=n,this.type=e.type,this.points=[],this.holes=[]}return i.prototype.clone=function(){return new i(this.shape,this.fillStyle,this.lineStyle,this.matrix)},i.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},i})(),qr=new kt,d0=new $i,Np=(function(i){Is(e,i);function e(){var t=i.call(this)||this;return t.uvsFloat32=null,t.indicesUint16=null,t.points=[],t.colors=[],t.uvs=[],t.indices=[],t.textureIds=[],t.graphicsData=[],t.dirty=0,t.batchDirty=-1,t.cacheDirty=-1,t.clearDirty=0,t.drawCalls=[],t.batches=[],t.shapeIndex=0,t._bounds=new $i,t.boundsDirty=-1,t.boundsPadding=0,t.batchable=!1,t.indicesUint16=null,t.uvsFloat32=null,t.closePointEps=1e-4,t}return Object.defineProperty(e.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),Ni.push(this.drawCalls[t]);this.drawCalls.length=0;for(var t=0;t<this.batches.length;t++){var r=this.batches[t];r.reset(),Ha.push(r)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,r,n,s){r===void 0&&(r=null),n===void 0&&(n=null),s===void 0&&(s=null);var o=new Ga(t,r,n,s);return this.graphicsData.push(o),this.dirty++,this},e.prototype.drawHole=function(t,r){if(r===void 0&&(r=null),!this.graphicsData.length)return null;var n=new Ga(t,null,null,r),s=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=s.lineStyle,s.holes.push(n),this.dirty++,this},e.prototype.destroy=function(){i.prototype.destroy.call(this);for(var t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var r=this.graphicsData,n=0;n<r.length;++n){var s=r[n];if(s.fillStyle.visible&&s.shape&&(s.matrix?s.matrix.applyInverse(t,qr):qr.copyFrom(t),s.shape.contains(qr.x,qr.y))){var o=!1;if(s.holes)for(var a=0;a<s.holes.length;a++){var l=s.holes[a];if(l.shape.contains(qr.x,qr.y)){o=!0;break}}if(!o)return!0}}return!1},e.prototype.updateBatches=function(t){if(!this.graphicsData.length){this.batchable=!0;return}if(this.validateBatching()){this.cacheDirty=this.dirty;var r=this.uvs,n=this.graphicsData,s=null,o=null;this.batches.length>0&&(s=this.batches[this.batches.length-1],o=s.style);for(var a=this.shapeIndex;a<n.length;a++){this.shapeIndex++;var l=n[a],u=l.fillStyle,h=l.lineStyle,f=$n[l.type];f.build(l),l.matrix&&this.transformPoints(l.points,l.matrix);for(var c=0;c<2;c++){var d=c===0?u:h;if(d.visible){var p=d.texture.baseTexture,m=this.indices.length,v=this.points.length/2;p.wrapMode=Ee.REPEAT,c===0?this.processFill(l):this.processLine(l);var g=this.points.length/2-v;g!==0&&(s&&!this._compareStyles(o,d)&&(s.end(m,v),s=null),s||(s=Ha.pop()||new Lp,s.begin(d,m,v),this.batches.push(s),o=d),this.addUvs(this.points,r,d.texture,v,g,d.matrix))}}}var I=this.indices.length,w=this.points.length/2;if(s&&s.end(I,w),this.batches.length===0){this.batchable=!0;return}if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var M=w>65535&&t;this.indicesUint16=M?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}},e.prototype._compareStyles=function(t,r){return!(!t||!r||t.texture.baseTexture!==r.texture.baseTexture||t.color+t.alpha!==r.color+r.alpha||!!t.native!=!!r.native)},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,r=this.graphicsData.length;t<r;t++){var n=this.graphicsData[t],s=n.fillStyle,o=n.lineStyle;if(s&&!s.texture.baseTexture.valid||o&&!o.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,r=0,n=t.length;r<n;r++)for(var s=t[r],o=0;o<s.size;o++){var a=s.start+o;this.indicesUint16[a]=this.indicesUint16[a]-s.attribStart}},e.prototype.isBatchable=function(){if(this.points.length>65535*2)return!1;for(var t=this.batches,r=0;r<t.length;r++)if(t[r].style.native)return!1;return this.points.length<e.BATCHABLE_SIZE*2},e.prototype.buildDrawCalls=function(){for(var t=++Tt._globalBatch,r=0;r<this.drawCalls.length;r++)this.drawCalls[r].texArray.clear(),Ni.push(this.drawCalls[r]);this.drawCalls.length=0;var n=this.colors,s=this.textureIds,o=Ni.pop();o||(o=new us,o.texArray=new hs),o.texArray.count=0,o.start=0,o.size=0,o.type=ae.TRIANGLES;var a=0,l=null,u=0,h=!1,f=ae.TRIANGLES,c=0;this.drawCalls.push(o);for(var r=0;r<this.batches.length;r++){var d=this.batches[r],p=8,m=d.style,v=m.texture.baseTexture;h!==!!m.native&&(h=!!m.native,f=h?ae.LINES:ae.TRIANGLES,l=null,a=p,t++),l!==v&&(l=v,v._batchEnabled!==t&&(a===p&&(t++,a=0,o.size>0&&(o=Ni.pop(),o||(o=new us,o.texArray=new hs),this.drawCalls.push(o)),o.start=c,o.size=0,o.texArray.count=0,o.type=f),v.touched=1,v._batchEnabled=t,v._batchLocation=a,v.wrapMode=10497,o.texArray.elements[o.texArray.count++]=v,a++)),o.size+=d.size,c+=d.size,u=v._batchLocation,this.addColors(n,m.color,m.alpha,d.attribSize,d.attribStart),this.addTextureIds(s,u,d.attribSize,d.attribStart)}Tt._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,r=this.uvs,n=this.colors,s=this.textureIds,o=new ArrayBuffer(t.length*3*4),a=new Float32Array(o),l=new Uint32Array(o),u=0,h=0;h<t.length/2;h++)a[u++]=t[h*2],a[u++]=t[h*2+1],a[u++]=r[h*2],a[u++]=r[h*2+1],l[u++]=n[h],a[u++]=s[h];this._buffer.update(o),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){if(t.holes.length)this.processHoles(t.holes),tu.triangulate(t,this);else{var r=$n[t.type];r.triangulate(t,this)}},e.prototype.processLine=function(t){Ua(t,this);for(var r=0;r<t.holes.length;r++)Ua(t.holes[r],this)},e.prototype.processHoles=function(t){for(var r=0;r<t.length;r++){var n=t[r],s=$n[n.type];s.build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds,r=d0,n=Rt.IDENTITY;this._bounds.clear(),r.clear();for(var s=0;s<this.graphicsData.length;s++){var o=this.graphicsData[s],a=o.shape,l=o.type,u=o.lineStyle,h=o.matrix||Rt.IDENTITY,f=0;if(u&&u.visible){var c=u.alignment;f=u.width,l===Ot.POLY?f=f*(.5+Math.abs(.5-c)):f=f*Math.max(0,c)}if(n!==h&&(r.isEmpty()||(t.addBoundsMatrix(r,n),r.clear()),n=h),l===Ot.RECT||l===Ot.RREC){var d=a;r.addFramePad(d.x,d.y,d.x+d.width,d.y+d.height,f,f)}else if(l===Ot.CIRC){var p=a;r.addFramePad(p.x,p.y,p.x,p.y,p.radius+f,p.radius+f)}else if(l===Ot.ELIP){var m=a;r.addFramePad(m.x,m.y,m.x,m.y,m.width+f,m.height+f)}else{var v=a;t.addVerticesMatrix(n,v.points,0,v.points.length,f,f)}}r.isEmpty()||t.addBoundsMatrix(r,n),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,r){for(var n=0;n<t.length/2;n++){var s=t[n*2],o=t[n*2+1];t[n*2]=r.a*s+r.c*o+r.tx,t[n*2+1]=r.b*s+r.d*o+r.ty}},e.prototype.addColors=function(t,r,n,s,o){o===void 0&&(o=0);var a=(r>>16)+(r&65280)+((r&255)<<16),l=bs(a,n);t.length=Math.max(t.length,o+s);for(var u=0;u<s;u++)t[o+u]=l},e.prototype.addTextureIds=function(t,r,n,s){s===void 0&&(s=0),t.length=Math.max(t.length,s+n);for(var o=0;o<n;o++)t[s+o]=r},e.prototype.addUvs=function(t,r,n,s,o,a){a===void 0&&(a=null);for(var l=0,u=r.length,h=n.frame;l<o;){var f=t[(s+l)*2],c=t[(s+l)*2+1];if(a){var d=a.a*f+a.c*c+a.tx;c=a.b*f+a.d*c+a.ty,f=d}l++,r.push(f/h.width,c/h.height)}var p=n.baseTexture;(h.width<p.width||h.height<p.height)&&this.adjustUvs(r,n,u,o)},e.prototype.adjustUvs=function(t,r,n,s){for(var o=r.baseTexture,a=1e-6,l=n+s*2,u=r.frame,h=u.width/o.width,f=u.height/o.height,c=u.x/u.width,d=u.y/u.height,p=Math.floor(t[n]+a),m=Math.floor(t[n+1]+a),v=n+2;v<l;v+=2)p=Math.min(p,Math.floor(t[v]+a)),m=Math.min(m,Math.floor(t[v+1]+a));c-=p,d-=m;for(var v=n;v<l;v+=2)t[v]=(t[v]+c)*h,t[v+1]=(t[v+1]+d)*f},e.BATCHABLE_SIZE=100,e})(Jl),Bp=(function(i){Is(e,i);function e(){var t=i!==null&&i.apply(this,arguments)||this;return t.width=0,t.alignment=.5,t.native=!1,t.cap=Ne.BUTT,t.join=Le.MITER,t.miterLimit=10,t}return e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t},e.prototype.reset=function(){i.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},e})(Ql),p0=new Float32Array(3),ra={},Es=(function(i){Is(e,i);function e(t){t===void 0&&(t=null);var r=i.call(this)||this;return r._geometry=t||new Np,r._geometry.refCount++,r.shader=null,r.state=lr.for2d(),r._fillStyle=new Ql,r._lineStyle=new Bp,r._matrix=null,r._holeMode=!1,r.currentPath=null,r.batches=[],r.batchTint=-1,r.batchDirty=-1,r.vertexData=null,r.pluginName="batch",r._transformID=-1,r.tint=16777215,r.blendMode=st.NORMAL,r}return Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return this.finishPoly(),new e(this._geometry)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),e.prototype.lineStyle=function(t){if(t===void 0&&(t=null),typeof t=="number"){var r=arguments;t={width:r[0]||0,color:r[1]||0,alpha:r[2]!==void 0?r[2]:1,alignment:r[3]!==void 0?r[3]:.5,native:!!r[4]}}return this.lineTextureStyle(t)},e.prototype.lineTextureStyle=function(t){if(typeof t=="number"){K("v5.2.0","Please use object-based options for Graphics#lineTextureStyle");var r=arguments,n=r[0],s=r[1],o=r[2],a=r[3],l=r[4],u=r[5],h=r[6];t={width:n,texture:s,color:o,alpha:a,matrix:l,alignment:u,native:h},Object.keys(t).forEach(function(c){return t[c]===void 0&&delete t[c]})}t=Object.assign({width:0,texture:lt.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:Ne.BUTT,join:Le.MITER,miterLimit:10},t),this.currentPath&&this.startPoly();var f=t.width>0&&t.alpha>0;return f?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:f},t)):this._lineStyle.reset(),this},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,r=this.currentPath.points.length;r>2&&(this.drawShape(this.currentPath),this.currentPath=new ti,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[r-2],t[r-1]))}else this.currentPath=new ti,this.currentPath.closeStroke=!1},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},e.prototype.moveTo=function(t,r){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=r,this},e.prototype.lineTo=function(t,r){this.currentPath||this.moveTo(0,0);var n=this.currentPath.points,s=n[n.length-2],o=n[n.length-1];return(s!==t||o!==r)&&n.push(t,r),this},e.prototype._initCurve=function(t,r){t===void 0&&(t=0),r===void 0&&(r=0),this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[t,r]):this.moveTo(t,r)},e.prototype.quadraticCurveTo=function(t,r,n,s){this._initCurve();var o=this.currentPath.points;return o.length===0&&this.moveTo(0,0),Mp.curveTo(t,r,n,s,o),this},e.prototype.bezierCurveTo=function(t,r,n,s,o,a){return this._initCurve(),Fp.curveTo(t,r,n,s,o,a,this.currentPath.points),this},e.prototype.arcTo=function(t,r,n,s,o){this._initCurve(t,r);var a=this.currentPath.points,l=Xa.curveTo(t,r,n,s,o,a);if(l){var u=l.cx,h=l.cy,f=l.radius,c=l.startAngle,d=l.endAngle,p=l.anticlockwise;this.arc(u,h,f,c,d,p)}return this},e.prototype.arc=function(t,r,n,s,o,a){if(a===void 0&&(a=!1),s===o)return this;!a&&o<=s?o+=li:a&&s<=o&&(s+=li);var l=o-s;if(l===0)return this;var u=t+Math.cos(s)*n,h=r+Math.sin(s)*n,f=this._geometry.closePointEps,c=this.currentPath?this.currentPath.points:null;if(c){var d=Math.abs(c[c.length-2]-u),p=Math.abs(c[c.length-1]-h);d<f&&p<f||c.push(u,h)}else this.moveTo(u,h),c=this.currentPath.points;return Xa.arc(u,h,t,r,n,s,o,a,c),this},e.prototype.beginFill=function(t,r){return t===void 0&&(t=0),r===void 0&&(r=1),this.beginTextureFill({texture:lt.WHITE,color:t,alpha:r})},e.prototype.beginTextureFill=function(t){if(t instanceof lt){K("v5.2.0","Please use object-based options for Graphics#beginTextureFill");var r=arguments,n=r[0],s=r[1],o=r[2],a=r[3];t={texture:n,color:s,alpha:o,matrix:a},Object.keys(t).forEach(function(u){return t[u]===void 0&&delete t[u]})}t=Object.assign({texture:lt.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var l=t.alpha>0;return l?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:l},t)):this._fillStyle.reset(),this},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},e.prototype.drawRect=function(t,r,n,s){return this.drawShape(new vt(t,r,n,s))},e.prototype.drawRoundedRect=function(t,r,n,s,o){return this.drawShape(new Sd(t,r,n,s,o))},e.prototype.drawCircle=function(t,r,n){return this.drawShape(new Id(t,r,n))},e.prototype.drawEllipse=function(t,r,n,s){return this.drawShape(new Ed(t,r,n,s))},e.prototype.drawPolygon=function(){for(var t=arguments,r=[],n=0;n<arguments.length;n++)r[n]=t[n];var s,o=!0,a=r[0];a.points?(o=a.closeStroke,s=a.points):Array.isArray(r[0])?s=r[0]:s=r;var l=new ti(s);return l.closeStroke=o,this.drawShape(l),this},e.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},e.prototype.drawStar=function(t,r,n,s,o,a){return a===void 0&&(a=0),this.drawPolygon(new Rp(t,r,n,s,o,a))},e.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},e.prototype.isFastRect=function(){var t=this._geometry.graphicsData;return t.length===1&&t[0].shape.type===Ot.RECT&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)},e.prototype._render=function(t){this.finishPoly();var r=this._geometry,n=t.context.supports.uint32Indices;r.updateBatches(n),r.batchable?(this.batchDirty!==r.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},e.prototype._populateBatches=function(){var t=this._geometry,r=this.blendMode,n=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(t.points);for(var s=0;s<n;s++){var o=t.batches[s],a=o.style.color,l=new Float32Array(this.vertexData.buffer,o.attribStart*4*2,o.attribSize*2),u=new Float32Array(t.uvsFloat32.buffer,o.attribStart*4*2,o.attribSize*2),h=new Uint16Array(t.indicesUint16.buffer,o.start*2,o.size),f={vertexData:l,blendMode:r,indices:h,uvs:u,_batchRGB:Er(a),_tintRGB:a,_texture:o.style.texture,alpha:o.style.alpha,worldAlpha:1};this.batches[s]=f}},e.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var r=0,n=this.batches.length;r<n;r++){var s=this.batches[r];s.worldAlpha=this.worldAlpha*s.alpha,t.plugins[this.pluginName].render(s)}}},e.prototype._renderDirect=function(t){var r=this._resolveDirectShader(t),n=this._geometry,s=this.tint,o=this.worldAlpha,a=r.uniforms,l=n.drawCalls;a.translationMatrix=this.transform.worldTransform,a.tint[0]=(s>>16&255)/255*o,a.tint[1]=(s>>8&255)/255*o,a.tint[2]=(s&255)/255*o,a.tint[3]=o,t.shader.bind(r),t.geometry.bind(n,r),t.state.set(this.state);for(var u=0,h=l.length;u<h;u++)this._renderDrawCallDirect(t,n.drawCalls[u])},e.prototype._renderDrawCallDirect=function(t,r){for(var n=r.texArray,s=r.type,o=r.size,a=r.start,l=n.count,u=0;u<l;u++)t.texture.bind(n.elements[u],u);t.geometry.draw(s,o,a)},e.prototype._resolveDirectShader=function(t){var r=this.shader,n=this.pluginName;if(!r){if(!ra[n]){for(var s=t.plugins.batch.MAX_TEXTURES,o=new Int32Array(s),a=0;a<s;a++)o[a]=a;var l={tint:new Float32Array([1,1,1,1]),translationMatrix:new Rt,default:nr.from({uSamplers:o},!0)},u=t.plugins[n]._shader.program;ra[n]=new Ge(u,l)}r=ra[n]}return r},e.prototype._calculateBounds=function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var r=t.bounds,n=r.minX,s=r.minY,o=r.maxX,a=r.maxY;this._bounds.addFrame(this.transform,n,s,o,a)}},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this._geometry.containsPoint(e._TEMP_POINT)},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=Er(this.tint,p0),r=0;r<this.batches.length;r++){var n=this.batches[r],s=n._batchRGB,o=t[0]*s[0]*255,a=t[1]*s[1]*255,l=t[2]*s[2]*255,u=(o<<16)+(a<<8)+(l|0);n._tintRGB=(u>>16)+(u&65280)+((u&255)<<16)}}},e.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var r=this.transform.worldTransform,n=r.a,s=r.b,o=r.c,a=r.d,l=r.tx,u=r.ty,h=this._geometry.points,f=this.vertexData,c=0,d=0;d<h.length;d+=2){var p=h[d],m=h[d+1];f[c++]=n*p+o*m+l,f[c++]=a*m+s*p+u}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0),this},e.prototype.setMatrix=function(t){return this._matrix=t,this},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},e.prototype.destroy=function(t){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,i.prototype.destroy.call(this,t)},e._TEMP_POINT=new kt,e})(Jt);/*!
 * @pixi/sprite - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/sprite is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Ya=function(i,e){return Ya=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},Ya(i,e)};function y0(i,e){Ya(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Oi=new kt,v0=new Uint16Array([0,1,2,0,2,3]),Lr=(function(i){y0(e,i);function e(t){var r=i.call(this)||this;return r._anchor=new wr(r._onAnchorUpdate,r,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),r._texture=null,r._width=0,r._height=0,r._tint=null,r._tintRGB=null,r.tint=16777215,r.blendMode=st.NORMAL,r._cachedTint=16777215,r.uvs=null,r.texture=t||lt.EMPTY,r.vertexData=new Float32Array(8),r.vertexTrimmedData=null,r._transformID=-1,r._textureID=-1,r._transformTrimmedID=-1,r._textureTrimmedID=-1,r.indices=v0,r.pluginName="batch",r.isSprite=!0,r._roundPixels=nt.ROUND_PIXELS,r}return e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=xr(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=xr(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(!(this._transformID===this.transform._worldID&&this._textureID===t._updateID)){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var r=this.transform.worldTransform,n=r.a,s=r.b,o=r.c,a=r.d,l=r.tx,u=r.ty,h=this.vertexData,f=t.trim,c=t.orig,d=this._anchor,p=0,m=0,v=0,g=0;if(f?(m=f.x-d._x*c.width,p=m+f.width,g=f.y-d._y*c.height,v=g+f.height):(m=-d._x*c.width,p=m+c.width,g=-d._y*c.height,v=g+c.height),h[0]=n*m+o*g+l,h[1]=a*g+s*m+u,h[2]=n*p+o*g+l,h[3]=a*g+s*p+u,h[4]=n*p+o*v+l,h[5]=a*v+s*p+u,h[6]=n*m+o*v+l,h[7]=a*v+s*m+u,this._roundPixels)for(var I=nt.RESOLUTION,w=0;w<h.length;++w)h[w]=Math.round((h[w]*I|0)/I)}},e.prototype.calculateTrimmedVertices=function(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,r=this.vertexTrimmedData,n=t.orig,s=this._anchor,o=this.transform.worldTransform,a=o.a,l=o.b,u=o.c,h=o.d,f=o.tx,c=o.ty,d=-s._x*n.width,p=d+n.width,m=-s._y*n.height,v=m+n.height;r[0]=a*d+u*m+f,r[1]=h*m+l*d+c,r[2]=a*p+u*m+f,r[3]=h*m+l*p+c,r[4]=a*p+u*v+f,r[5]=h*v+l*p+c,r[6]=a*d+u*v+f,r[7]=h*v+l*d+c},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,r=this._texture.orig;!t||t.width===r.width&&t.height===r.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(t){return this.children.length===0?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new vt),t=this._localBoundsRect),this._bounds.getRectangle(t)):i.prototype.getLocalBounds.call(this,t)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,Oi);var r=this._texture.orig.width,n=this._texture.orig.height,s=-r*this.anchor.x,o=0;return Oi.x>=s&&Oi.x<s+r&&(o=-n*this.anchor.y,Oi.y>=o&&Oi.y<o+n)},e.prototype.destroy=function(t){i.prototype.destroy.call(this,t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null;var r=typeof t=="boolean"?t:t&&t.texture;if(r){var n=typeof t=="boolean"?t:t&&t.baseTexture;this._texture.destroy(!!n)}this._texture=null},e.from=function(t,r){var n=t instanceof lt?t:lt.from(t,r);return new e(n)},Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var r=xr(this.scale.x)||1;this.scale.x=r*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var r=xr(this.scale.y)||1;this.scale.y=r*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||lt.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),e})(Jt);/*!
 * @pixi/text - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/text is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var za=function(i,e){return za=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},za(i,e)};function m0(i,e){za(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var fi;(function(i){i[i.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",i[i.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"})(fi||(fi={}));var ia={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:fi.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},g0=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Pr=(function(){function i(e){this.styleID=0,this.reset(),sa(this,e,e)}return i.prototype.clone=function(){var e={};return sa(e,this,ia),new i(e)},i.prototype.reset=function(){sa(this,ia,ia)},Object.defineProperty(i.prototype,"align",{get:function(){return this._align},set:function(e){this._align!==e&&(this._align=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"breakWords",{get:function(){return this._breakWords},set:function(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(e){var t=na(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fill",{get:function(){return this._fill},set:function(e){var t=na(e);this._fill!==t&&(this._fill=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(e){_0(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"leading",{get:function(){return this._leading},set:function(e){this._leading!==e&&(this._leading=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"padding",{get:function(){return this._padding},set:function(e){this._padding!==e&&(this._padding=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"stroke",{get:function(){return this._stroke},set:function(e){var t=na(e);this._stroke!==t&&(this._stroke=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"trim",{get:function(){return this._trim},set:function(e){this._trim!==e&&(this._trim=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)},enumerable:!1,configurable:!0}),i.prototype.toFontString=function(){var e=typeof this.fontSize=="number"?this.fontSize+"px":this.fontSize,t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(var r=t.length-1;r>=0;r--){var n=t[r].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&g0.indexOf(n)<0&&(n='"'+n+'"'),t[r]=n}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+e+" "+t.join(",")},i})();function Ef(i){return typeof i=="number"?Bl(i):(typeof i=="string"&&i.indexOf("0x")===0&&(i=i.replace("0x","#")),i)}function na(i){if(Array.isArray(i)){for(var e=0;e<i.length;++e)i[e]=Ef(i[e]);return i}else return Ef(i)}function _0(i,e){if(!Array.isArray(i)||!Array.isArray(e)||i.length!==e.length)return!1;for(var t=0;t<i.length;++t)if(i[t]!==e[t])return!1;return!0}function sa(i,e,t){for(var r in t)Array.isArray(e[r])?i[r]=e[r].slice():i[r]=e[r]}var ye=(function(){function i(e,t,r,n,s,o,a,l,u){this.text=e,this.style=t,this.width=r,this.height=n,this.lines=s,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=u}return i.measureText=function(e,t,r,n){n===void 0&&(n=i._canvas),r=r??t.wordWrap;var s=t.toFontString(),o=i.measureFont(s);o.fontSize===0&&(o.fontSize=t.fontSize,o.ascent=t.fontSize);var a=n.getContext("2d");a.font=s;for(var l=r?i.wordWrap(e,t,n):e,u=l.split(/(?:\r\n|\r|\n)/),h=new Array(u.length),f=0,c=0;c<u.length;c++){var d=a.measureText(u[c]).width+(u[c].length-1)*t.letterSpacing;h[c]=d,f=Math.max(f,d)}var p=f+t.strokeThickness;t.dropShadow&&(p+=t.dropShadowDistance);var m=t.lineHeight||o.fontSize+t.strokeThickness,v=Math.max(m,o.fontSize+t.strokeThickness)+(u.length-1)*(m+t.leading);return t.dropShadow&&(v+=t.dropShadowDistance),new i(e,t,p,v,u,h,m+t.leading,f,o)},i.wordWrap=function(e,t,r){r===void 0&&(r=i._canvas);for(var n=r.getContext("2d"),s=0,o="",a="",l=Object.create(null),u=t.letterSpacing,h=t.whiteSpace,f=i.collapseSpaces(h),c=i.collapseNewlines(h),d=!f,p=t.wordWrapWidth+u,m=i.tokenize(e),v=0;v<m.length;v++){var g=m[v];if(i.isNewline(g)){if(!c){a+=i.addLine(o),d=!f,o="",s=0;continue}g=" "}if(f){var I=i.isBreakingSpace(g),w=i.isBreakingSpace(o[o.length-1]);if(I&&w)continue}var M=i.getFromCache(g,u,l,n);if(M>p)if(o!==""&&(a+=i.addLine(o),o="",s=0),i.canBreakWords(g,t.breakWords))for(var b=i.wordWrapSplit(g),R=0;R<b.length;R++){for(var C=b[R],H=1;b[R+H];){var F=b[R+H],B=C[C.length-1];if(!i.canBreakChars(B,F,g,R,t.breakWords))C+=F;else break;H++}R+=C.length-1;var Y=i.getFromCache(C,u,l,n);Y+s>p&&(a+=i.addLine(o),d=!1,o="",s=0),o+=C,s+=Y}else{o.length>0&&(a+=i.addLine(o),o="",s=0);var D=v===m.length-1;a+=i.addLine(g,!D),d=!1,o="",s=0}else M+s>p&&(d=!1,a+=i.addLine(o),o="",s=0),(o.length>0||!i.isBreakingSpace(g)||d)&&(o+=g,s+=M)}return a+=i.addLine(o,!1),a},i.addLine=function(e,t){return t===void 0&&(t=!0),e=i.trimRight(e),e=t?e+`
`:e,e},i.getFromCache=function(e,t,r,n){var s=r[e];if(typeof s!="number"){var o=e.length*t;s=n.measureText(e).width+o,r[e]=s}return s},i.collapseSpaces=function(e){return e==="normal"||e==="pre-line"},i.collapseNewlines=function(e){return e==="normal"},i.trimRight=function(e){if(typeof e!="string")return"";for(var t=e.length-1;t>=0;t--){var r=e[t];if(!i.isBreakingSpace(r))break;e=e.slice(0,-1)}return e},i.isNewline=function(e){return typeof e!="string"?!1:i._newlines.indexOf(e.charCodeAt(0))>=0},i.isBreakingSpace=function(e){return typeof e!="string"?!1:i._breakingSpaces.indexOf(e.charCodeAt(0))>=0},i.tokenize=function(e){var t=[],r="";if(typeof e!="string")return t;for(var n=0;n<e.length;n++){var s=e[n];if(i.isBreakingSpace(s)||i.isNewline(s)){r!==""&&(t.push(r),r=""),t.push(s);continue}r+=s}return r!==""&&t.push(r),t},i.canBreakWords=function(e,t){return t},i.canBreakChars=function(e,t,r,n,s){return!0},i.wordWrapSplit=function(e){return e.split("")},i.measureFont=function(e){if(i._fonts[e])return i._fonts[e];var t={ascent:0,descent:0,fontSize:0},r=i._canvas,n=i._context;n.font=e;var s=i.METRICS_STRING+i.BASELINE_SYMBOL,o=Math.ceil(n.measureText(s).width),a=Math.ceil(n.measureText(i.BASELINE_SYMBOL).width),l=2*a;a=a*i.BASELINE_MULTIPLIER|0,r.width=o,r.height=l,n.fillStyle="#f00",n.fillRect(0,0,o,l),n.font=e,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(s,0,a);var u=n.getImageData(0,0,o,l).data,h=u.length,f=o*4,c=0,d=0,p=!1;for(c=0;c<a;++c){for(var m=0;m<f;m+=4)if(u[d+m]!==255){p=!0;break}if(!p)d+=f;else break}for(t.ascent=a-c,d=h-f,p=!1,c=l;c>a;--c){for(var m=0;m<f;m+=4)if(u[d+m]!==255){p=!0;break}if(!p)d-=f;else break}return t.descent=c-a,t.fontSize=t.ascent+t.descent,i._fonts[e]=t,t},i.clearMetrics=function(e){e===void 0&&(e=""),e?delete i._fonts[e]:i._fonts={}},i})(),fs=(function(){try{var i=new OffscreenCanvas(0,0),e=i.getContext("2d");return e&&e.measureText?i:document.createElement("canvas")}catch{return document.createElement("canvas")}})();fs.width=fs.height=10;ye._canvas=fs;ye._context=fs.getContext("2d");ye._fonts={};ye.METRICS_STRING="|q";ye.BASELINE_SYMBOL="M";ye.BASELINE_MULTIPLIER=1.4;ye._newlines=[10,13];ye._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var b0={texture:!0,children:!1,baseTexture:!0},eu=(function(i){m0(e,i);function e(t,r,n){var s=this,o=!1;n||(n=document.createElement("canvas"),o=!0),n.width=3,n.height=3;var a=lt.from(n);return a.orig=new vt,a.trim=new vt,s=i.call(this,a)||this,s._ownCanvas=o,s.canvas=n,s.context=s.canvas.getContext("2d"),s._resolution=nt.RESOLUTION,s._autoResolution=!0,s._text=null,s._style=null,s._styleListener=null,s._font="",s.text=t,s.style=r,s.localStyleID=-1,s}return e.prototype.updateText=function(t){var r=this._style;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),!(!this.dirty&&t)){this._font=this._style.toFontString();var n=this.context,s=ye.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),o=s.width,a=s.height,l=s.lines,u=s.lineHeight,h=s.lineWidths,f=s.maxLineWidth,c=s.fontProperties;this.canvas.width=Math.ceil((Math.max(1,o)+r.padding*2)*this._resolution),this.canvas.height=Math.ceil((Math.max(1,a)+r.padding*2)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=r.strokeThickness,n.textBaseline=r.textBaseline,n.lineJoin=r.lineJoin,n.miterLimit=r.miterLimit;for(var d,p,m=r.dropShadow?2:1,v=0;v<m;++v){var g=r.dropShadow&&v===0,I=g?Math.ceil(Math.max(1,a)+r.padding*2):0,w=I*this._resolution;if(g){n.fillStyle="black",n.strokeStyle="black";var M=r.dropShadowColor,b=Er(typeof M=="number"?M:Dl(M)),R=r.dropShadowBlur*this._resolution,C=r.dropShadowDistance*this._resolution;n.shadowColor="rgba("+b[0]*255+","+b[1]*255+","+b[2]*255+","+r.dropShadowAlpha+")",n.shadowBlur=R,n.shadowOffsetX=Math.cos(r.dropShadowAngle)*C,n.shadowOffsetY=Math.sin(r.dropShadowAngle)*C+w}else n.fillStyle=this._generateFillStyle(r,l,s),n.strokeStyle=r.stroke,n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;for(var H=0;H<l.length;H++)d=r.strokeThickness/2,p=r.strokeThickness/2+H*u+c.ascent,r.align==="right"?d+=f-h[H]:r.align==="center"&&(d+=(f-h[H])/2),r.stroke&&r.strokeThickness&&this.drawLetterSpacing(l[H],d+r.padding,p+r.padding-I,!0),r.fill&&this.drawLetterSpacing(l[H],d+r.padding,p+r.padding-I)}this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,r,n,s){s===void 0&&(s=!1);var o=this._style,a=o.letterSpacing;if(a===0){s?this.context.strokeText(t,r,n):this.context.fillText(t,r,n);return}for(var l=r,u=Array.from?Array.from(t):t.split(""),h=this.context.measureText(t).width,f=0,c=0;c<u.length;++c){var d=u[c];s?this.context.strokeText(d,l,n):this.context.fillText(d,l,n),f=this.context.measureText(t.substring(c+1)).width,l+=h-f+a,h=f}},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var r=_d(t);r.data&&(t.width=r.width,t.height=r.height,this.context.putImageData(r.data,0,0))}var n=this._texture,s=this._style,o=s.trim?0:s.padding,a=n.baseTexture;n.trim.width=n._frame.width=Math.ceil(t.width/this._resolution),n.trim.height=n._frame.height=Math.ceil(t.height/this._resolution),n.trim.x=-o,n.trim.y=-o,n.orig.width=n._frame.width-o*2,n.orig.height=n._frame.height-o*2,this._onTextureUpdate(),a.setRealSize(t.width,t.height,this._resolution),this._recursivePostUpdateTransform(),this.dirty=!1},e.prototype._render=function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),i.prototype._render.call(this,t)},e.prototype.getLocalBounds=function(t){return this.updateText(!0),i.prototype.getLocalBounds.call(this,t)},e.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._generateFillStyle=function(t,r,n){var s=t.fill;if(Array.isArray(s)){if(s.length===1)return s[0]}else return s;var o,a=t.dropShadow?t.dropShadowDistance:0,l=t.padding||0,u=Math.ceil(this.canvas.width/this._resolution)-a-l*2,h=Math.ceil(this.canvas.height/this._resolution)-a-l*2,f=s.slice(),c=t.fillGradientStops.slice();if(!c.length)for(var d=f.length+1,p=1;p<d;++p)c.push(p/d);if(f.unshift(s[0]),c.unshift(0),f.push(s[s.length-1]),c.push(1),t.fillGradientType===fi.LINEAR_VERTICAL){o=this.context.createLinearGradient(u/2,l,u/2,h+l);for(var m=0,v=n.fontProperties.fontSize+t.strokeThickness,g=v/h,p=0;p<r.length;p++)for(var I=n.lineHeight*p,w=0;w<f.length;w++){var M=0;typeof c[w]=="number"?M=c[w]:M=w/f.length;var b=I/h+M*g,R=Math.max(m,b);R=Math.min(R,1),o.addColorStop(R,f[w]),m=R}}else{o=this.context.createLinearGradient(l,h/2,u+l,h/2);for(var C=f.length+1,H=1,p=0;p<f.length;p++){var F=void 0;typeof c[p]=="number"?F=c[p]:F=H/C,o.addColorStop(F,f[p]),H++}}return o},e.prototype.destroy=function(t){typeof t=="boolean"&&(t={children:t}),t=Object.assign({},b0,t),i.prototype.destroy.call(this,t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(e.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var r=xr(this.scale.x)||1;this.scale.x=r*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var r=xr(this.scale.y)||1;this.scale.y=r*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(t){t=t||{},t instanceof Pr?this._style=t:this._style=new Pr(t),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),e})(Lr);/*!
 * @pixi/prepare - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/prepare is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */nt.UPLOADS_PER_FRAME=4;/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Va=function(i,e){return Va=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},Va(i,e)};function x0(i,e){Va(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Dp=(function(){function i(e){this.maxItemsPerFrame=e,this.itemsLeft=0}return i.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},i.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},i})();function w0(i,e){var t=!1;if(i&&i._textures&&i._textures.length){for(var r=0;r<i._textures.length;r++)if(i._textures[r]instanceof lt){var n=i._textures[r].baseTexture;e.indexOf(n)===-1&&(e.push(n),t=!0)}}return t}function T0(i,e){if(i.baseTexture instanceof Tt){var t=i.baseTexture;return e.indexOf(t)===-1&&e.push(t),!0}return!1}function I0(i,e){if(i._texture&&i._texture instanceof lt){var t=i._texture.baseTexture;return e.indexOf(t)===-1&&e.push(t),!0}return!1}function E0(i,e){return e instanceof eu?(e.updateText(!0),!0):!1}function S0(i,e){if(e instanceof Pr){var t=e.toFontString();return ye.measureFont(t),!0}return!1}function A0(i,e){if(i instanceof eu){e.indexOf(i.style)===-1&&e.push(i.style),e.indexOf(i)===-1&&e.push(i);var t=i._texture.baseTexture;return e.indexOf(t)===-1&&e.push(t),!0}return!1}function C0(i,e){return i instanceof Pr?(e.indexOf(i)===-1&&e.push(i),!0):!1}var kp=(function(){function i(e){var t=this;this.limiter=new Dp(nt.UPLOADS_PER_FRAME),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){t.queue&&t.prepareItems()},this.registerFindHook(A0),this.registerFindHook(C0),this.registerFindHook(w0),this.registerFindHook(T0),this.registerFindHook(I0),this.registerUploadHook(E0),this.registerUploadHook(S0)}return i.prototype.upload=function(e,t){typeof e=="function"&&(t=e,e=null),e&&this.add(e),this.queue.length?(t&&this.completes.push(t),this.ticking||(this.ticking=!0,Dt.system.addOnce(this.tick,this,Ce.UTILITY))):t&&t()},i.prototype.tick=function(){setTimeout(this.delayedTick,0)},i.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var e=this.queue[0],t=!1;if(e&&!e._destroyed){for(var r=0,n=this.uploadHooks.length;r<n;r++)if(this.uploadHooks[r](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)Dt.system.addOnce(this.tick,this,Ce.UTILITY);else{this.ticking=!1;var s=this.completes.slice(0);this.completes.length=0;for(var r=0,n=s.length;r<n;r++)s[r]()}},i.prototype.registerFindHook=function(e){return e&&this.addHooks.push(e),this},i.prototype.registerUploadHook=function(e){return e&&this.uploadHooks.push(e),this},i.prototype.add=function(e){for(var t=0,r=this.addHooks.length;t<r&&!this.addHooks[t](e,this.queue);t++);if(e instanceof Jt)for(var t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this},i.prototype.destroy=function(){this.ticking&&Dt.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},i})();function Up(i,e){return e instanceof Tt?(e._glTextures[i.CONTEXT_UID]||i.texture.bind(e),!0):!1}function P0(i,e){if(!(e instanceof Es))return!1;var t=e.geometry;e.finishPoly(),t.updateBatches();for(var r=t.batches,n=0;n<r.length;n++){var s=r[n].style.texture;s&&Up(i,s.baseTexture)}return t.batchable||i.geometry.bind(t,e._resolveDirectShader(i)),!0}function O0(i,e){return i instanceof Es?(e.push(i),!0):!1}var Xp=(function(i){x0(e,i);function e(t){var r=i.call(this,t)||this;return r.uploadHookHelper=r.renderer,r.registerFindHook(O0),r.registerUploadHook(Up),r.registerUploadHook(P0),r}return e})(kp),R0=(function(){function i(e){this.maxMilliseconds=e,this.frameStart=0}return i.prototype.beginFrame=function(){this.frameStart=Date.now()},i.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},i})();/*!
 * @pixi/spritesheet - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/spritesheet is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Hp=(function(){function i(e,t,r){r===void 0&&(r=null),this._texture=e instanceof lt?e:null,this.baseTexture=e instanceof Tt?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;var n=this.baseTexture.resource;this.resolution=this._updateResolution(r||(n?n.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return i.prototype._updateResolution=function(e){e===void 0&&(e=null);var t=this.data.meta.scale,r=qi(e,null);return r===null&&(r=t!==void 0?parseFloat(t):1),r!==1&&this.baseTexture.setResolution(r),r},i.prototype.parse=function(e){this._batchIndex=0,this._callback=e,this._frameKeys.length<=i.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},i.prototype._processFrames=function(e){for(var t=e,r=i.BATCH_SIZE;t-e<r&&t<this._frameKeys.length;){var n=this._frameKeys[t],s=this._frames[n],o=s.frame;if(o){var a=null,l=null,u=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,h=new vt(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);s.rotated?a=new vt(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new vt(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(l=new vt(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[n]=new lt(this.baseTexture,a,h,l,s.rotated?2:0,s.anchor),lt.addToCache(this.textures[n],n)}t++}},i.prototype._processAnimations=function(){var e=this.data.animations||{};for(var t in e){this.animations[t]=[];for(var r=0;r<e[t].length;r++){var n=e[t][r];this.animations[t].push(this.textures[n])}}},i.prototype._parseComplete=function(){var e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)},i.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*i.BATCH_SIZE),this._batchIndex++,setTimeout(function(){e._batchIndex*i.BATCH_SIZE<e._frameKeys.length?e._nextBatch():(e._processAnimations(),e._parseComplete())},0)},i.prototype.destroy=function(e){var t;e===void 0&&(e=!1);for(var r in this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((t=this._texture)===null||t===void 0||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null},i.BATCH_SIZE=1e3,i})(),Gp=(function(){function i(){}return i.use=function(e,t){var r=this,n=e.name+"_image";if(!e.data||e.type!==Xi.TYPE.JSON||!e.data.frames||r.resources[n]){t();return}var s={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},o=i.getResourcePath(e,r.baseUrl);r.add(n,o,s,function(l){if(l.error){t(l.error);return}var u=new Hp(l.texture,e.data,e.url);u.parse(function(){e.spritesheet=u,e.textures=u.textures,t()})})},i.getResourcePath=function(e,t){return e.isDataUrl?e.data.meta.image:pd.resolve(e.url.replace(t,""),e.data.meta.image)},i})();/*!
 * @pixi/sprite-tiling - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/sprite-tiling is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var qa=function(i,e){return qa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},qa(i,e)};function Yp(i,e){qa(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Ri=new kt,F0=(function(i){Yp(e,i);function e(t,r,n){r===void 0&&(r=100),n===void 0&&(n=100);var s=i.call(this,t)||this;return s.tileTransform=new Gl,s._width=r,s._height=n,s.uvMatrix=s.texture.uvMatrix||new Ts(t),s.pluginName="tilingSprite",s.uvRespectAnchor=!1,s}return Object.defineProperty(e.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copyFrom(t)},enumerable:!1,configurable:!0}),e.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},e.prototype._render=function(t){var r=this._texture;!r||!r.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,r=this._height*-this._anchor._y,n=this._width*(1-this._anchor._x),s=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,r,n,s)},e.prototype.getLocalBounds=function(t){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new vt),t=this._localBoundsRect),this._bounds.getRectangle(t)):i.prototype.getLocalBounds.call(this,t)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,Ri);var r=this._width,n=this._height,s=-r*this.anchor._x;if(Ri.x>=s&&Ri.x<s+r){var o=-n*this.anchor._y;if(Ri.y>=o&&Ri.y<o+n)return!0}return!1},e.prototype.destroy=function(t){i.prototype.destroy.call(this,t),this.tileTransform=null,this.uvMatrix=null},e.from=function(t,r){return typeof r=="number"&&(K("5.3.0","TilingSprite.from use options instead of width and height args"),r={width:r,height:arguments[2]}),new e(lt.from(t,r),r.width,r.height)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!1,configurable:!0}),e})(Lr),Sf=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,M0=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture2D(uSampler, coord);
    gl_FragColor = texSample * uColor;
}
`,L0=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`,Cn=new Rt,zp=(function(i){Yp(e,i);function e(t){var r=i.call(this,t)||this,n={globals:r.renderer.globalUniforms};return r.shader=Ge.from(Sf,M0,n),r.simpleShader=Ge.from(Sf,L0,n),r.quad=new Kl,r.state=lr.for2d(),r}return e.prototype.render=function(t){var r=this.renderer,n=this.quad,s=n.vertices;s[0]=s[6]=t._width*-t.anchor.x,s[1]=s[3]=t._height*-t.anchor.y,s[2]=s[4]=t._width*(1-t.anchor.x),s[5]=s[7]=t._height*(1-t.anchor.y),t.uvRespectAnchor&&(s=n.uvs,s[0]=s[6]=-t.anchor.x,s[1]=s[3]=-t.anchor.y,s[2]=s[4]=1-t.anchor.x,s[5]=s[7]=1-t.anchor.y),n.invalidate();var o=t._texture,a=o.baseTexture,l=t.tileTransform.localTransform,u=t.uvMatrix,h=a.isPowerOfTwo&&o.frame.width===a.width&&o.frame.height===a.height;h&&(a._glTextures[r.CONTEXT_UID]?h=a.wrapMode!==Ee.CLAMP:a.wrapMode===Ee.CLAMP&&(a.wrapMode=Ee.REPEAT));var f=h?this.simpleShader:this.shader,c=o.width,d=o.height,p=t._width,m=t._height;Cn.set(l.a*c/p,l.b*c/m,l.c*d/p,l.d*d/m,l.tx/p,l.ty/m),Cn.invert(),h?Cn.prepend(u.mapCoord):(f.uniforms.uMapCoord=u.mapCoord.toArray(!0),f.uniforms.uClampFrame=u.uClampFrame,f.uniforms.uClampOffset=u.uClampOffset),f.uniforms.uTransform=Cn.toArray(!0),f.uniforms.uColor=Xl(t.tint,t.worldAlpha,f.uniforms.uColor,a.alphaMode),f.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),f.uniforms.uSampler=o,r.shader.bind(f),r.geometry.bind(n),this.state.blendMode=Ul(t.blendMode,a.alphaMode),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},e})(gi);/*!
 * @pixi/mesh - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/mesh is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var $a=function(i,e){return $a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},$a(i,e)};function ru(i,e){$a(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Vp=(function(){function i(e,t){this.uvBuffer=e,this.uvMatrix=t,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return i.prototype.update=function(e){if(!(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var t=this.uvBuffer.data;(!this.data||this.data.length!==t.length)&&(this.data=new Float32Array(t.length)),this.uvMatrix.multiplyUvs(t,this.data),this._updateID++}},i})(),oa=new kt,Af=new ti,ci=(function(i){ru(e,i);function e(t,r,n,s){s===void 0&&(s=ae.TRIANGLES);var o=i.call(this)||this;return o.geometry=t,t.refCount++,o.shader=r,o.state=n||lr.for2d(),o.drawMode=s,o.start=0,o.size=0,o.uvs=null,o.indices=null,o.vertexData=new Float32Array(1),o.vertexDirty=0,o._transformID=-1,o._roundPixels=nt.ROUND_PIXELS,o.batchUvs=null,o}return Object.defineProperty(e.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this.shader},set:function(t){this.shader=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this.shader.tint},set:function(t){this.shader.tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture=t},enumerable:!1,configurable:!0}),e.prototype._render=function(t){var r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===ae.TRIANGLES&&r.length<e.BATCHABLE_SIZE*2?this._renderToBatch(t):this._renderDefault(t)},e.prototype._renderDefault=function(t){var r=this.shader;r.alpha=this.worldAlpha,r.update&&r.update(),t.batch.flush(),r.program.uniformData.translationMatrix&&(r.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0)),t.shader.bind(r),t.state.set(this.state),t.geometry.bind(this.geometry,r),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},e.prototype._renderToBatch=function(t){var r=this.geometry;this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=r.indexBuffer.data,this._tintRGB=this.shader._tintRGB,this._texture=this.shader.texture;var n=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[n]),t.plugins[n].render(this)},e.prototype.calculateVertices=function(){var t=this.geometry,r=t.buffers[0].data;if(!(t.vertexDirtyId===this.vertexDirty&&this._transformID===this.transform._worldID)){this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length));for(var n=this.transform.worldTransform,s=n.a,o=n.b,a=n.c,l=n.d,u=n.tx,h=n.ty,f=this.vertexData,c=0;c<f.length/2;c++){var d=r[c*2],p=r[c*2+1];f[c*2]=s*d+a*p+u,f[c*2+1]=o*d+l*p+h}if(this._roundPixels)for(var m=nt.RESOLUTION,c=0;c<f.length;++c)f[c]=Math.round((f[c]*m|0)/m);this.vertexDirty=t.vertexDirtyId}},e.prototype.calculateUvs=function(){var t=this.geometry.buffers[1];this.shader.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new Vp(t,this.shader.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,oa);for(var r=this.geometry.getBuffer("aVertexPosition").data,n=Af.points,s=this.geometry.getIndex().data,o=s.length,a=this.drawMode===4?3:1,l=0;l+2<o;l+=a){var u=s[l]*2,h=s[l+1]*2,f=s[l+2]*2;if(n[0]=r[u],n[1]=r[u+1],n[2]=r[h],n[3]=r[h+1],n[4]=r[f],n[5]=r[f+1],Af.contains(oa.x,oa.y))return!0}return!1},e.prototype.destroy=function(t){i.prototype.destroy.call(this,t),this.geometry.refCount--,this.geometry.refCount===0&&this.geometry.dispose(),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},e.BATCHABLE_SIZE=100,e})(Jt),N0=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,B0=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`,rn=(function(i){ru(e,i);function e(t,r){var n=this,s={uSampler:t,alpha:1,uTextureMatrix:Rt.IDENTITY,uColor:new Float32Array([1,1,1,1])};return r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r),r.uniforms&&Object.assign(s,r.uniforms),n=i.call(this,r.program||_i.from(B0,N0),s)||this,n._colorDirty=!1,n.uvMatrix=new Ts(t),n.batchable=r.program===void 0,n.pluginName=r.pluginName,n.tint=r.tint,n.alpha=r.alpha,n}return Object.defineProperty(e.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(t){this.uniforms.uSampler!==t&&(this.uniforms.uSampler=t,this.uvMatrix.texture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;Xl(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},e})(Ge),nn=(function(i){ru(e,i);function e(t,r,n){var s=i.call(this)||this,o=new Mt(t),a=new Mt(r,!0),l=new Mt(n,!0,!0);return s.addAttribute("aVertexPosition",o,2,!1,Lt.FLOAT).addAttribute("aTextureCoord",a,2,!1,Lt.FLOAT).addIndex(l),s._updateId=-1,s}return Object.defineProperty(e.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),e})(Mr);/*!
 * @pixi/text-bitmap - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/text-bitmap is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var ja=function(i,e){return ja=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},ja(i,e)};function D0(i,e){ja(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ji=(function(){function i(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[]}return i})(),k0=(function(){function i(){}return i.test=function(e){return typeof e=="string"&&e.indexOf("info face=")===0},i.parse=function(e){var t=e.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[]};for(var n in t){var s=t[n].match(/^[a-z]+/gm)[0],o=t[n].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),a={};for(var l in o){var u=o[l].split("="),h=u[0],f=u[1].replace(/"/gm,""),c=parseFloat(f),d=isNaN(c)?f:c;a[h]=d}r[s].push(a)}var p=new ji;return r.info.forEach(function(m){return p.info.push({face:m.face,size:parseInt(m.size,10)})}),r.common.forEach(function(m){return p.common.push({lineHeight:parseInt(m.lineHeight,10)})}),r.page.forEach(function(m){return p.page.push({id:parseInt(m.id,10),file:m.file})}),r.char.forEach(function(m){return p.char.push({id:parseInt(m.id,10),page:parseInt(m.page,10),x:parseInt(m.x,10),y:parseInt(m.y,10),width:parseInt(m.width,10),height:parseInt(m.height,10),xoffset:parseInt(m.xoffset,10),yoffset:parseInt(m.yoffset,10),xadvance:parseInt(m.xadvance,10)})}),r.kerning.forEach(function(m){return p.kerning.push({first:parseInt(m.first,10),second:parseInt(m.second,10),amount:parseInt(m.amount,10)})}),p},i})(),Wa=(function(){function i(){}return i.test=function(e){return e instanceof XMLDocument&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null},i.parse=function(e){for(var t=new ji,r=e.getElementsByTagName("info"),n=e.getElementsByTagName("common"),s=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning"),l=0;l<r.length;l++)t.info.push({face:r[l].getAttribute("face"),size:parseInt(r[l].getAttribute("size"),10)});for(var l=0;l<n.length;l++)t.common.push({lineHeight:parseInt(n[l].getAttribute("lineHeight"),10)});for(var l=0;l<s.length;l++)t.page.push({id:parseInt(s[l].getAttribute("id"),10)||0,file:s[l].getAttribute("file")});for(var l=0;l<o.length;l++){var u=o[l];t.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)})}for(var l=0;l<a.length;l++)t.kerning.push({first:parseInt(a[l].getAttribute("first"),10),second:parseInt(a[l].getAttribute("second"),10),amount:parseInt(a[l].getAttribute("amount"),10)});return t},i})(),U0=(function(){function i(){}return i.test=function(e){if(typeof e=="string"&&e.indexOf("<font>")>-1){var t=new self.DOMParser().parseFromString(e,"text/xml");return Wa.test(t)}return!1},i.parse=function(e){var t=new window.DOMParser().parseFromString(e,"text/xml");return Wa.parse(t)},i})(),aa=[k0,Wa,U0];function qp(i){for(var e=0;e<aa.length;e++)if(aa[e].test(i))return aa[e];return null}function X0(i,e,t,r,n,s){var o=t.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;var a,l=t.dropShadow?t.dropShadowDistance:0,u=t.padding||0,h=Math.ceil(i.width/r)-l-u*2,f=Math.ceil(i.height/r)-l-u*2,c=o.slice(),d=t.fillGradientStops.slice();if(!d.length)for(var p=c.length+1,m=1;m<p;++m)d.push(m/p);if(c.unshift(o[0]),d.unshift(0),c.push(o[o.length-1]),d.push(1),t.fillGradientType===fi.LINEAR_VERTICAL){a=e.createLinearGradient(h/2,u,h/2,f+u);for(var v=0,g=s.fontProperties.fontSize+t.strokeThickness,I=g/f,m=0;m<n.length;m++)for(var w=s.lineHeight*m,M=0;M<c.length;M++){var b=0;typeof d[M]=="number"?b=d[M]:b=M/c.length;var R=w/f+b*I,C=Math.max(v,R);C=Math.min(C,1),a.addColorStop(C,c[M]),v=C}}else{a=e.createLinearGradient(u,f/2,h+u,f/2);for(var H=c.length+1,F=1,m=0;m<c.length;m++){var B=void 0;typeof d[m]=="number"?B=d[m]:B=F/H,a.addColorStop(B,c[m]),F++}}return a}function H0(i,e,t,r,n,s,o){var a=t.text,l=t.fontProperties;e.translate(r,n),e.scale(s,s);var u=o.strokeThickness/2,h=-(o.strokeThickness/2);if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=X0(i,e,o,s,[a],t),e.strokeStyle=o.stroke,o.dropShadow){var f=o.dropShadowColor,c=Er(typeof f=="number"?f:Dl(f)),d=o.dropShadowBlur*s,p=o.dropShadowDistance*s;e.shadowColor="rgba("+c[0]*255+","+c[1]*255+","+c[2]*255+","+o.dropShadowAlpha+")",e.shadowBlur=d,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*p,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*p}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(a,u,h+t.lineHeight-l.descent),o.fill&&e.fillText(a,u,h+t.lineHeight-l.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function G0(i){typeof i=="string"&&(i=[i]);for(var e=[],t=0,r=i.length;t<r;t++){var n=i[t];if(Array.isArray(n)){if(n.length!==2)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+n.length+".");var s=n[0].charCodeAt(0),o=n[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(var a=s,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push.apply(e,n.split(""))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}var Je=(function(){function i(e,t,r){var n=e.info[0],s=e.common[0],o=e.page[0],a=qi(o.file),l={};this._ownsTextures=r,this.font=n.face,this.size=n.size,this.lineHeight=s.lineHeight/a,this.chars={},this.pageTextures=l;for(var u=0;u<e.page.length;u++){var h=e.page[u],f=h.id,c=h.file;l[f]=t instanceof Array?t[u]:t[c]}for(var u=0;u<e.char.length;u++){var d=e.char[u],f=d.id,p=d.page,m=e.char[u],v=m.x,g=m.y,I=m.width,w=m.height,M=m.xoffset,b=m.yoffset,R=m.xadvance;v/=a,g/=a,I/=a,w/=a,M/=a,b/=a,R/=a;var C=new vt(v+l[p].frame.x/a,g+l[p].frame.y/a,I,w);this.chars[f]={xOffset:M,yOffset:b,xAdvance:R,kerning:{},texture:new lt(l[p].baseTexture,C),page:p}}for(var u=0;u<e.kerning.length;u++){var H=e.kerning[u],F=H.first,B=H.second,Y=H.amount;F/=a,B/=a,Y/=a,this.chars[B]&&(this.chars[B].kerning[F]=Y)}}return i.prototype.destroy=function(){for(var e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(var e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null},i.install=function(e,t,r){var n;if(e instanceof ji)n=e;else{var s=qp(e);if(!s)throw new Error("Unrecognized data format for font.");n=s.parse(e)}t instanceof lt&&(t=[t]);var o=new i(n,t,r);return i.available[o.font]=o,o},i.uninstall=function(e){var t=i.available[e];if(!t)throw new Error("No font found named '"+e+"'");t.destroy(),delete i.available[e]},i.from=function(e,t,r){if(!e)throw new Error("[BitmapFont] Property `name` is required.");var n=Object.assign({},i.defaultOptions,r),s=n.chars,o=n.padding,a=n.resolution,l=n.textureWidth,u=n.textureHeight,h=G0(s),f=t instanceof Pr?t:new Pr(t),c=l,d=new ji;d.info[0]={face:f.fontFamily,size:f.fontSize},d.common[0]={lineHeight:f.fontSize};for(var p=0,m=0,v,g,I,w=0,M=[],b=0;b<h.length;b++){v||(v=document.createElement("canvas"),v.width=l,v.height=u,g=v.getContext("2d"),I=new Tt(v,{resolution:a}),M.push(new lt(I)),d.page.push({id:M.length-1,file:""}));var R=ye.measureText(h[b],f,!1,v),C=R.width,H=Math.ceil(R.height),F=Math.ceil((f.fontStyle==="italic"?2:1)*C);if(m>=u-H*a){if(m===0)throw new Error("[BitmapFont] textureHeight "+u+"px is "+("too small for "+f.fontSize+"px fonts"));--b,v=null,g=null,I=null,m=0,p=0,w=0;continue}if(w=Math.max(H+R.fontProperties.descent,w),F*a+p>=c){--b,m+=w*a,m=Math.ceil(m),p=0,w=0;continue}H0(v,g,R,p,m,a,f);var B=R.text.charCodeAt(0);d.char.push({id:B,page:M.length-1,x:p/a,y:m/a,width:F,height:H,xoffset:0,yoffset:0,xadvance:Math.ceil(C-(f.dropShadow?f.dropShadowDistance:0)-(f.stroke?f.strokeThickness:0))}),p+=(F+2*o)*a,p=Math.ceil(p)}var Y=new i(d,M,!0);return i.available[e]!==void 0&&i.uninstall(e),i.available[e]=Y,Y},i.ALPHA=[["a","z"],["A","Z"]," "],i.NUMERIC=[["0","9"]],i.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],i.ASCII=[[" ","~"]],i.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:i.ALPHANUMERIC},i.available={},i})(),Cf=[],Pf=[],Y0=(function(i){D0(e,i);function e(t,r){r===void 0&&(r={});var n=i.call(this)||this;n._tint=16777215,r.font&&(K("5.3.0","PIXI.BitmapText constructor style.font property is deprecated."),n._upgradeStyle(r));var s=Object.assign({},e.styleDefaults,r),o=s.align,a=s.tint,l=s.maxWidth,u=s.letterSpacing,h=s.fontName,f=s.fontSize;if(!Je.available[h])throw new Error('Missing BitmapFont "'+h+'"');return n._activePagesMeshData=[],n._textWidth=0,n._textHeight=0,n._align=o,n._tint=a,n._fontName=h,n._fontSize=f||Je.available[h].size,n._text=t,n._maxWidth=l,n._maxLineHeight=0,n._letterSpacing=u,n._anchor=new wr(function(){n.dirty=!0},n,0,0),n._roundPixels=nt.ROUND_PIXELS,n.dirty=!0,n._textureCache={},n}return e.prototype.updateText=function(){for(var t,r=Je.available[this._fontName],n=this._fontSize/r.size,s=new kt,o=[],a=[],l=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",u=l.length,h=this._maxWidth*r.size/this._fontSize,f=null,c=0,d=0,p=0,m=-1,v=0,g=0,I=0,w=0;w<u;w++){var M=l.charCodeAt(w),b=l.charAt(w);if(/(?:\s)/.test(b)&&(m=w,v=c),b==="\r"||b===`
`){a.push(c),d=Math.max(d,c),++p,++g,s.x=0,s.y+=r.lineHeight,f=null;continue}var R=r.chars[M];if(R){f&&R.kerning[f]&&(s.x+=R.kerning[f]);var C=Pf.pop()||{texture:lt.EMPTY,line:0,charCode:0,position:new kt};C.texture=R.texture,C.line=p,C.charCode=M,C.position.x=s.x+R.xOffset+this._letterSpacing/2,C.position.y=s.y+R.yOffset,o.push(C),s.x+=R.xAdvance+this._letterSpacing,c=s.x,I=Math.max(I,R.yOffset+R.texture.height),f=M,m!==-1&&h>0&&s.x>h&&(++g,Tr(o,1+m-g,1+w-m),w=m,m=-1,a.push(v),d=Math.max(d,v),p++,s.x=0,s.y+=r.lineHeight,f=null)}}var H=l.charAt(l.length-1);H!=="\r"&&H!==`
`&&(/(?:\s)/.test(H)&&(c=v),a.push(c),d=Math.max(d,c));for(var F=[],w=0;w<=p;w++){var B=0;this._align==="right"?B=d-a[w]:this._align==="center"&&(B=(d-a[w])/2),F.push(B)}for(var Y=o.length,D={},J=[],Q=this._activePagesMeshData,w=0;w<Q.length;w++)Cf.push(Q[w]);for(var w=0;w<Y;w++){var q=o[w].texture,A=q.baseTexture.uid;if(!D[A]){var O=Cf.pop();if(!O){var y=new nn,_=new rn(lt.EMPTY),x=new ci(y,_);O={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:x,vertices:null,uvs:null,indices:null}}O.index=0,O.indexCount=0,O.vertexCount=0,O.uvsCount=0,O.total=0;var T=this._textureCache;T[A]=T[A]||new lt(q.baseTexture),O.mesh.texture=T[A],O.mesh.tint=this._tint,J.push(O),D[A]=O}D[A].total++}for(var w=0;w<Q.length;w++)J.indexOf(Q[w])===-1&&this.removeChild(Q[w].mesh);for(var w=0;w<J.length;w++)J[w].mesh.parent!==this&&this.addChild(J[w].mesh);this._activePagesMeshData=J;for(var w in D){var O=D[w],S=O.total;if(!(((t=O.indices)===null||t===void 0?void 0:t.length)>6*S)||O.vertices.length<ci.BATCHABLE_SIZE*2)O.vertices=new Float32Array(8*S),O.uvs=new Float32Array(8*S),O.indices=new Uint16Array(6*S);else for(var P=O.total,L=O.vertices,N=P*4*2;N<L.length;N++)L[N]=0;O.mesh.size=6*S}for(var w=0;w<Y;w++){var b=o[w],k=b.position.x+F[b.line];this._roundPixels&&(k=Math.round(k));var U=k*n,$=b.position.y*n,q=b.texture,W=D[q.baseTexture.uid],z=q.frame,Z=q._uvs,j=W.index++;W.indices[j*6+0]=0+j*4,W.indices[j*6+1]=1+j*4,W.indices[j*6+2]=2+j*4,W.indices[j*6+3]=0+j*4,W.indices[j*6+4]=2+j*4,W.indices[j*6+5]=3+j*4,W.vertices[j*8+0]=U,W.vertices[j*8+1]=$,W.vertices[j*8+2]=U+z.width*n,W.vertices[j*8+3]=$,W.vertices[j*8+4]=U+z.width*n,W.vertices[j*8+5]=$+z.height*n,W.vertices[j*8+6]=U,W.vertices[j*8+7]=$+z.height*n,W.uvs[j*8+0]=Z.x0,W.uvs[j*8+1]=Z.y0,W.uvs[j*8+2]=Z.x1,W.uvs[j*8+3]=Z.y1,W.uvs[j*8+4]=Z.x2,W.uvs[j*8+5]=Z.y2,W.uvs[j*8+6]=Z.x3,W.uvs[j*8+7]=Z.y3}this._textWidth=d*n,this._textHeight=(s.y+r.lineHeight)*n;for(var w in D){var O=D[w];if(this.anchor.x!==0||this.anchor.y!==0)for(var it=0,at=this._textWidth*this.anchor.x,et=this._textHeight*this.anchor.y,rt=0;rt<O.total;rt++)O.vertices[it++]-=at,O.vertices[it++]-=et,O.vertices[it++]-=at,O.vertices[it++]-=et,O.vertices[it++]-=at,O.vertices[it++]-=et,O.vertices[it++]-=at,O.vertices[it++]-=et;this._maxLineHeight=I*n;var xt=O.mesh.geometry.getBuffer("aVertexPosition"),bt=O.mesh.geometry.getBuffer("aTextureCoord"),St=O.mesh.geometry.getIndex();xt.data=O.vertices,bt.data=O.uvs,St.data=O.indices,xt.update(),bt.update(),St.update()}for(var w=0;w<o.length;w++)Pf.push(o[w])},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype.getLocalBounds=function(){return this.validate(),i.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){if(this._tint!==t){this._tint=t;for(var r=0;r<this._activePagesMeshData.length;r++)this._activePagesMeshData[r].mesh.tint=t}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{get:function(){return this._fontName},set:function(t){if(!Je.available[t])throw new Error('Missing BitmapFont "'+t+'"');this._fontName!==t&&(this._fontName=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),e.prototype._upgradeStyle=function(t){if(typeof t.font=="string"){var r=t.font.split(" ");t.fontName=r.length===1?r[0]:r.slice(1).join(" "),r.length>=2&&(t.fontSize=parseInt(r[0],10))}else t.fontName=t.font.name,t.fontSize=typeof t.font.size=="number"?t.font.size:parseInt(t.font.size,10)},e.prototype.destroy=function(t){var r=this._textureCache;for(var n in r){var s=r[n];s.destroy(),delete r[n]}this._textureCache=null,i.prototype.destroy.call(this,t)},e.registerFont=function(t,r){return K("5.3.0","PIXI.BitmapText.registerFont is deprecated, use PIXI.BitmapFont.install"),Je.install(t,r)},Object.defineProperty(e,"fonts",{get:function(){return K("5.3.0","PIXI.BitmapText.fonts is deprecated, use PIXI.BitmapFont.available"),Je.available},enumerable:!1,configurable:!0}),e.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0},e})(Jt),$p=(function(){function i(){}return i.add=function(){Xi.setExtensionXhrType("fnt",Xi.XHR_RESPONSE_TYPE.TEXT)},i.use=function(e,t){var r=qp(e.data);if(!r){t();return}for(var n=i.getBaseUrl(this,e),s=r.parse(e.data),o={},a=function(m){o[m.metadata.pageFile]=m.texture,Object.keys(o).length===s.page.length&&(e.bitmapFont=Je.install(s,o,!0),t())},l=0;l<s.page.length;++l){var u=s.page[l].file,h=n+u,f=!1;for(var c in this.resources){var d=this.resources[c];if(d.url===h){d.metadata.pageFile=u,d.texture?a(d):d.onAfterMiddleware.add(a),f=!0;break}}if(!f){var p={crossOrigin:e.crossOrigin,loadType:Xi.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:u},e.metadata.imageMetadata),parentResource:e};this.add(h,p,a)}}},i.getBaseUrl=function(e,t){var r=t.isDataUrl?"":i.dirname(t.url);return t.isDataUrl&&(r==="."&&(r=""),e.baseUrl&&r&&e.baseUrl.charAt(e.baseUrl.length-1)==="/"&&(r+="/")),r=r.replace(e.baseUrl,""),r&&r.charAt(r.length-1)!=="/"&&(r+="/"),r},i.dirname=function(e){var t=e.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return t===e?".":t===""?"/":t},i})();/*!
 * @pixi/filter-alpha - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/filter-alpha is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Ka=function(i,e){return Ka=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},Ka(i,e)};function z0(i,e){Ka(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var V0=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`,q0=(function(i){z0(e,i);function e(t){t===void 0&&(t=1);var r=i.call(this,vp,V0,{uAlpha:1})||this;return r.alpha=t,r}return Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e})(ze);/*!
 * @pixi/filter-blur - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/filter-blur is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Za=function(i,e){return Za=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},Za(i,e)};function jp(i,e){Za(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var $0=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function j0(i,e){var t=Math.ceil(i/2),r=$0,n="",s;e?s="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":s="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var o=0;o<i;o++){var a=s.replace("%index%",o.toString());a=a.replace("%sampleIndex%",o-(t-1)+".0"),n+=a,n+=`
`}return r=r.replace("%blur%",n),r=r.replace("%size%",i.toString()),r}var W0={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},K0=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function Z0(i){for(var e=W0[i],t=e.length,r=K0,n="",s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;",o,a=0;a<i;a++){var l=s.replace("%index%",a.toString());o=a,a>=t&&(o=i-a-1),l=l.replace("%value%",e[o].toString()),n+=l,n+=`
`}return r=r.replace("%blur%",n),r=r.replace("%size%",i.toString()),r}var Of;(function(i){i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2"})(Of||(Of={}));var Rf;(function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.WEBGL=1]="WEBGL",i[i.CANVAS=2]="CANVAS"})(Rf||(Rf={}));var Ff;(function(i){i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL"})(Ff||(Ff={}));var Mf;(function(i){i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR"})(Mf||(Mf={}));var Lf;(function(i){i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(Lf||(Lf={}));var Nf;(function(i){i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL"})(Nf||(Nf={}));var Bf;(function(i){i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"})(Bf||(Bf={}));var Df;(function(i){i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.FLOAT=5126]="FLOAT",i[i.HALF_FLOAT=36193]="HALF_FLOAT"})(Df||(Df={}));var kf;(function(i){i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR"})(kf||(kf={}));var Uf;(function(i){i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"})(Uf||(Uf={}));var Xf;(function(i){i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON"})(Xf||(Xf={}));var Hf;(function(i){i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"})(Hf||(Hf={}));var Wi;(function(i){i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT"})(Wi||(Wi={}));var Gf;(function(i){i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL"})(Gf||(Gf={}));var Yf;(function(i){i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp"})(Yf||(Yf={}));var zf;(function(i){i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE"})(zf||(zf={}));var Vf;(function(i){i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH"})(Vf||(Vf={}));var Ja=(function(i){jp(e,i);function e(t,r,n,s,o){r===void 0&&(r=8),n===void 0&&(n=4),s===void 0&&(s=nt.FILTER_RESOLUTION),o===void 0&&(o=5);var a=this,l=j0(o,t),u=Z0(o);return a=i.call(this,l,u)||this,a.horizontal=t,a.resolution=s,a._quality=0,a.quality=n,a.blur=r,a}return e.prototype.apply=function(t,r,n,s){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/r.width):this.uniforms.strength=1/n.height*(n.height/r.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/r.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/r.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,r,n,s);else{var o=t.getFilterTexture(),a=t.renderer,l=r,u=o;this.state.blend=!1,t.applyFilter(this,l,u,Wi.CLEAR);for(var h=1;h<this.passes-1;h++){t.bindAndClear(l,Wi.BLIT),this.uniforms.uSampler=u;var f=u;u=l,l=f,a.shader.bind(this),a.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,u,n,s),t.returnFilterTexture(o)}},Object.defineProperty(e.prototype,"blur",{get:function(){return this.strength},set:function(t){this.padding=1+Math.abs(t)*2,this.strength=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t},enumerable:!1,configurable:!0}),e})(ze),J0=(function(i){jp(e,i);function e(t,r,n,s){t===void 0&&(t=8),r===void 0&&(r=4),n===void 0&&(n=nt.FILTER_RESOLUTION),s===void 0&&(s=5);var o=i.call(this)||this;return o.blurXFilter=new Ja(!0,t,r,n,s),o.blurYFilter=new Ja(!1,t,r,n,s),o.resolution=n,o.quality=r,o.blur=t,o.repeatEdgePixels=!1,o}return e.prototype.apply=function(t,r,n,s){var o=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(o&&a){var l=t.getFilterTexture();this.blurXFilter.apply(t,r,l,Wi.CLEAR),this.blurYFilter.apply(t,l,n,s),t.returnFilterTexture(l)}else a?this.blurYFilter.apply(t,r,n,s):this.blurXFilter.apply(t,r,n,s)},e.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2},Object.defineProperty(e.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(t){this.blurYFilter.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(t){this._repeatEdgePixels=t,this.updatePadding()},enumerable:!1,configurable:!0}),e})(ze);/*!
 * @pixi/filter-color-matrix - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/filter-color-matrix is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Qa=function(i,e){return Qa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},Qa(i,e)};function Q0(i,e){Qa(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var t_=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`,tl=(function(i){Q0(e,i);function e(){var t=this,r={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return t=i.call(this,Zl,t_,r)||this,t.alpha=1,t}return e.prototype._loadMatrix=function(t,r){r===void 0&&(r=!1);var n=t;r&&(this._multiply(n,this.uniforms.m,t),n=this._colorMatrix(n)),this.uniforms.m=n},e.prototype._multiply=function(t,r,n){return t[0]=r[0]*n[0]+r[1]*n[5]+r[2]*n[10]+r[3]*n[15],t[1]=r[0]*n[1]+r[1]*n[6]+r[2]*n[11]+r[3]*n[16],t[2]=r[0]*n[2]+r[1]*n[7]+r[2]*n[12]+r[3]*n[17],t[3]=r[0]*n[3]+r[1]*n[8]+r[2]*n[13]+r[3]*n[18],t[4]=r[0]*n[4]+r[1]*n[9]+r[2]*n[14]+r[3]*n[19]+r[4],t[5]=r[5]*n[0]+r[6]*n[5]+r[7]*n[10]+r[8]*n[15],t[6]=r[5]*n[1]+r[6]*n[6]+r[7]*n[11]+r[8]*n[16],t[7]=r[5]*n[2]+r[6]*n[7]+r[7]*n[12]+r[8]*n[17],t[8]=r[5]*n[3]+r[6]*n[8]+r[7]*n[13]+r[8]*n[18],t[9]=r[5]*n[4]+r[6]*n[9]+r[7]*n[14]+r[8]*n[19]+r[9],t[10]=r[10]*n[0]+r[11]*n[5]+r[12]*n[10]+r[13]*n[15],t[11]=r[10]*n[1]+r[11]*n[6]+r[12]*n[11]+r[13]*n[16],t[12]=r[10]*n[2]+r[11]*n[7]+r[12]*n[12]+r[13]*n[17],t[13]=r[10]*n[3]+r[11]*n[8]+r[12]*n[13]+r[13]*n[18],t[14]=r[10]*n[4]+r[11]*n[9]+r[12]*n[14]+r[13]*n[19]+r[14],t[15]=r[15]*n[0]+r[16]*n[5]+r[17]*n[10]+r[18]*n[15],t[16]=r[15]*n[1]+r[16]*n[6]+r[17]*n[11]+r[18]*n[16],t[17]=r[15]*n[2]+r[16]*n[7]+r[17]*n[12]+r[18]*n[17],t[18]=r[15]*n[3]+r[16]*n[8]+r[17]*n[13]+r[18]*n[18],t[19]=r[15]*n[4]+r[16]*n[9]+r[17]*n[14]+r[18]*n[19]+r[19],t},e.prototype._colorMatrix=function(t){var r=new Float32Array(t);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r},e.prototype.brightness=function(t,r){var n=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(n,r)},e.prototype.greyscale=function(t,r){var n=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(n,r)},e.prototype.blackAndWhite=function(t){var r=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(r,t)},e.prototype.hue=function(t,r){t=(t||0)/180*Math.PI;var n=Math.cos(t),s=Math.sin(t),o=Math.sqrt,a=1/3,l=o(a),u=n+(1-n)*a,h=a*(1-n)-l*s,f=a*(1-n)+l*s,c=a*(1-n)+l*s,d=n+a*(1-n),p=a*(1-n)-l*s,m=a*(1-n)-l*s,v=a*(1-n)+l*s,g=n+a*(1-n),I=[u,h,f,0,0,c,d,p,0,0,m,v,g,0,0,0,0,0,1,0];this._loadMatrix(I,r)},e.prototype.contrast=function(t,r){var n=(t||0)+1,s=-.5*(n-1),o=[n,0,0,0,s,0,n,0,0,s,0,0,n,0,s,0,0,0,1,0];this._loadMatrix(o,r)},e.prototype.saturate=function(t,r){t===void 0&&(t=0);var n=t*2/3+1,s=(n-1)*-.5,o=[n,s,s,0,0,s,n,s,0,0,s,s,n,0,0,0,0,0,1,0];this._loadMatrix(o,r)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){var r=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(r,t)},e.prototype.sepia=function(t){var r=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(r,t)},e.prototype.technicolor=function(t){var r=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(r,t)},e.prototype.polaroid=function(t){var r=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(r,t)},e.prototype.toBGR=function(t){var r=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(r,t)},e.prototype.kodachrome=function(t){var r=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(r,t)},e.prototype.browni=function(t){var r=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(r,t)},e.prototype.vintage=function(t){var r=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(r,t)},e.prototype.colorTone=function(t,r,n,s,o){t=t||.2,r=r||.15,n=n||16770432,s=s||3375104;var a=(n>>16&255)/255,l=(n>>8&255)/255,u=(n&255)/255,h=(s>>16&255)/255,f=(s>>8&255)/255,c=(s&255)/255,d=[.3,.59,.11,0,0,a,l,u,t,0,h,f,c,r,0,a-h,l-f,u-c,0,0];this._loadMatrix(d,o)},e.prototype.night=function(t,r){t=t||.1;var n=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(n,r)},e.prototype.predator=function(t,r){var n=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(n,r)},e.prototype.lsd=function(t){var r=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(r,t)},e.prototype.reset=function(){var t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)},Object.defineProperty(e.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e})(ze);tl.prototype.grayscale=tl.prototype.greyscale;/*!
 * @pixi/filter-displacement - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/filter-displacement is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var el=function(i,e){return el=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},el(i,e)};function e_(i,e){el(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var r_=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,i_=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`,n_=(function(i){e_(e,i);function e(t,r){var n=this,s=new Rt;return t.renderable=!1,n=i.call(this,i_,r_,{mapSampler:t._texture,filterMatrix:s,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this,n.maskSprite=t,n.maskMatrix=s,r==null&&(r=20),n.scale=new kt(r,r),n}return e.prototype.apply=function(t,r,n,s){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var o=this.maskSprite.worldTransform,a=Math.sqrt(o.a*o.a+o.b*o.b),l=Math.sqrt(o.c*o.c+o.d*o.d);a!==0&&l!==0&&(this.uniforms.rotation[0]=o.a/a,this.uniforms.rotation[1]=o.b/a,this.uniforms.rotation[2]=o.c/l,this.uniforms.rotation[3]=o.d/l),t.applyFilter(this,r,n,s)},Object.defineProperty(e.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t},enumerable:!1,configurable:!0}),e})(ze);/*!
 * @pixi/filter-fxaa - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/filter-fxaa is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var rl=function(i,e){return rl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},rl(i,e)};function s_(i,e){rl(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var o_=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputPixel;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`,a_=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputPixel;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,l_=(function(i){s_(e,i);function e(){return i.call(this,o_,a_)||this}return e})(ze);/*!
 * @pixi/filter-noise - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/filter-noise is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var il=function(i,e){return il=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},il(i,e)};function u_(i,e){il(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var h_=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`,f_=(function(i){u_(e,i);function e(t,r){t===void 0&&(t=.5),r===void 0&&(r=Math.random());var n=i.call(this,Zl,h_,{uNoise:0,uSeed:0})||this;return n.noise=t,n.seed=r,n}return Object.defineProperty(e.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(t){this.uniforms.uNoise=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(t){this.uniforms.uSeed=t},enumerable:!1,configurable:!0}),e})(ze);/*!
 * @pixi/mixin-cache-as-bitmap - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/mixin-cache-as-bitmap is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Wp=new Rt;Bt.prototype._cacheAsBitmap=!1;Bt.prototype._cacheData=null;var c_=(function(){function i(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}return i})();Object.defineProperties(Bt.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(i){if(this._cacheAsBitmap!==i){this._cacheAsBitmap=i;var e;i?(this._cacheData||(this._cacheData=new c_),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}}});Bt.prototype._renderCached=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(e),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(e))};Bt.prototype._initCachedDisplayObject=function(e){if(!(this._cacheData&&this._cacheData.sprite)){var t=this.alpha;this.alpha=1,e.batch.flush();var r=this.getLocalBounds(null,!0).clone();if(this.filters){var n=this.filters[0].padding;r.pad(n)}r.ceil(nt.RESOLUTION);var s=e.renderTexture.current,o=e.renderTexture.sourceFrame.clone(),a=e.renderTexture.destinationFrame.clone(),l=e.projection.transform,u=Ar.create({width:r.width,height:r.height}),h="cacheAsBitmap_"+Sr();this._cacheData.textureCacheId=h,Tt.addToCache(u.baseTexture,h),lt.addToCache(u,h);var f=this.transform.localTransform.copyTo(Wp).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,e.render(this,u,!0,f,!1),e.projection.transform=l,e.renderTexture.bind(s,o,a),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var c=new Lr(u);c.transform.worldTransform=this.transform.worldTransform,c.anchor.x=-(r.x/r.width),c.anchor.y=-(r.y/r.height),c.alpha=t,c._bounds=this._bounds,this._cacheData.sprite=c,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=c.containsPoint.bind(c)}};Bt.prototype._renderCachedCanvas=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(e))};Bt.prototype._initCachedDisplayObjectCanvas=function(e){if(!(this._cacheData&&this._cacheData.sprite)){var t=this.getLocalBounds(null,!0),r=this.alpha;this.alpha=1;var n=e.context,s=e._projTransform;t.ceil(nt.RESOLUTION);var o=Ar.create({width:t.width,height:t.height}),a="cacheAsBitmap_"+Sr();this._cacheData.textureCacheId=a,Tt.addToCache(o.baseTexture,a),lt.addToCache(o,a);var l=Wp;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=t.x,l.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,o,!0,l,!1),e.context=n,e._projTransform=s,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var u=new Lr(o);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(t.x/t.width),u.anchor.y=-(t.y/t.height),u.alpha=r,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)}};Bt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};Bt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};Bt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,Tt.removeFromCache(this._cacheData.textureCacheId),lt.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};Bt.prototype._cacheAsBitmapDestroy=function(e){this.cacheAsBitmap=!1,this.destroy(e)};/*!
 * @pixi/mixin-get-child-by-name - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/mixin-get-child-by-name is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Bt.prototype.name=null;Jt.prototype.getChildByName=function(e,t){for(var r=0,n=this.children.length;r<n;r++)if(this.children[r].name===e)return this.children[r];if(t)for(var r=0,n=this.children.length;r<n;r++){var s=this.children[r];if(s.getChildByName){var o=this.children[r].getChildByName(e,!0);if(o)return o}}return null};/*!
 * @pixi/mixin-get-global-position - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/mixin-get-global-position is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Bt.prototype.getGlobalPosition=function(e,t){return e===void 0&&(e=new kt),t===void 0&&(t=!1),this.parent?this.parent.toGlobal(this.position,e,t):(e.x=this.position.x,e.y=this.position.y),e};/*!
 * @pixi/mesh-extras - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/mesh-extras is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var nl=function(i,e){return nl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},nl(i,e)};function bi(i,e){nl(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Kp=(function(i){bi(e,i);function e(t,r,n,s){t===void 0&&(t=100),r===void 0&&(r=100),n===void 0&&(n=10),s===void 0&&(s=10);var o=i.call(this)||this;return o.segWidth=n,o.segHeight=s,o.width=t,o.height=r,o.build(),o}return e.prototype.build=function(){for(var t=this.segWidth*this.segHeight,r=[],n=[],s=[],o=this.segWidth-1,a=this.segHeight-1,l=this.width/o,u=this.height/a,h=0;h<t;h++){var f=h%this.segWidth,c=h/this.segWidth|0;r.push(f*l,c*u),n.push(f/o,c/a)}for(var d=o*a,h=0;h<d;h++){var p=h%o,m=h/o|0,v=m*this.segWidth+p,g=m*this.segWidth+p+1,I=(m+1)*this.segWidth+p,w=(m+1)*this.segWidth+p+1;s.push(v,g,I,g,w,I)}this.buffers[0].data=new Float32Array(r),this.buffers[1].data=new Float32Array(n),this.indexBuffer.data=new Uint16Array(s),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},e})(nn),Zp=(function(i){bi(e,i);function e(t,r,n){t===void 0&&(t=200),n===void 0&&(n=0);var s=i.call(this,new Float32Array(r.length*4),new Float32Array(r.length*4),new Uint16Array((r.length-1)*6))||this;return s.points=r,s._width=t,s.textureScale=n,s.build(),s}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),e.prototype.build=function(){var t=this.points;if(t){var r=this.getBuffer("aVertexPosition"),n=this.getBuffer("aTextureCoord"),s=this.getIndex();if(!(t.length<1)){r.data.length/4!==t.length&&(r.data=new Float32Array(t.length*4),n.data=new Float32Array(t.length*4),s.data=new Uint16Array((t.length-1)*6));var o=n.data,a=s.data;o[0]=0,o[1]=0,o[2]=0,o[3]=1;for(var l=0,u=t[0],h=this._width*this.textureScale,f=t.length,c=0;c<f;c++){var d=c*4;if(this.textureScale>0){var p=u.x-t[c].x,m=u.y-t[c].y,v=Math.sqrt(p*p+m*m);u=t[c],l+=v/h}else l=c/(f-1);o[d]=l,o[d+1]=0,o[d+2]=l,o[d+3]=1}for(var g=0,c=0;c<f-1;c++){var d=c*2;a[g++]=d,a[g++]=d+1,a[g++]=d+2,a[g++]=d+2,a[g++]=d+1,a[g++]=d+3}n.update(),s.update(),this.updateVertices()}}},e.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var r=t[0],n,s=0,o=0,a=this.buffers[0].data,l=t.length,u=0;u<l;u++){var h=t[u],f=u*4;u<t.length-1?n=t[u+1]:n=h,o=-(n.x-r.x),s=n.y-r.y;var c=Math.sqrt(s*s+o*o),d=this.textureScale>0?this.textureScale*this._width/2:this._width/2;s/=c,o/=c,s*=d,o*=d,a[f]=h.x+s,a[f+1]=h.y+o,a[f+2]=h.x-s,a[f+3]=h.y-o,r=h}this.buffers[0].update()}},e.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},e})(nn),d_=(function(i){bi(e,i);function e(t,r,n){n===void 0&&(n=0);var s=this,o=new Zp(t.height,r,n),a=new rn(t);return n>0&&(t.baseTexture.wrapMode=Ee.REPEAT),s=i.call(this,o,a)||this,s.autoUpdate=!0,s}return e.prototype._render=function(t){var r=this.geometry;(this.autoUpdate||r._width!==this.shader.texture.height)&&(r._width=this.shader.texture.height,r.update()),i.prototype._render.call(this,t)},e})(ci),Jp=(function(i){bi(e,i);function e(t,r,n){var s=this,o=new Kp(t.width,t.height,r,n),a=new rn(lt.WHITE);return s=i.call(this,o,a)||this,s.texture=t,s}return e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var t=this.geometry;t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build()},Object.defineProperty(e.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),e.prototype._render=function(t){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),i.prototype._render.call(this,t)},e.prototype.destroy=function(t){this.shader.texture.off("update",this.textureUpdated,this),i.prototype.destroy.call(this,t)},e})(ci),p_=(function(i){bi(e,i);function e(t,r,n,s,o){t===void 0&&(t=lt.EMPTY);var a=this,l=new nn(r,n,s);l.getBuffer("aVertexPosition").static=!1;var u=new rn(t);return a=i.call(this,l,u,null,o)||this,a.autoUpdate=!0,a}return Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype._render=function(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),i.prototype._render.call(this,t)},e})(ci),Pn=10,y_=(function(i){bi(e,i);function e(t,r,n,s,o){r===void 0&&(r=Pn),n===void 0&&(n=Pn),s===void 0&&(s=Pn),o===void 0&&(o=Pn);var a=i.call(this,lt.WHITE,4,4)||this;return a._origWidth=t.orig.width,a._origHeight=t.orig.height,a._width=a._origWidth,a._height=a._origHeight,a._leftWidth=r,a._rightWidth=s,a._topHeight=n,a._bottomHeight=o,a.texture=t,a}return e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype.updateHorizontalVertices=function(){var t=this.vertices,r=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*r,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*r,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices,r=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*r,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*r,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._getMinScale=function(){var t=this._leftWidth+this._rightWidth,r=this._width>t?1:this._width/t,n=this._topHeight+this._bottomHeight,s=this._height>n?1:this._height/n,o=Math.min(r,s);return o},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topHeight",{get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()},enumerable:!1,configurable:!0}),e.prototype._refresh=function(){var t=this.texture,r=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var n=1/this._origWidth,s=1/this._origHeight;r[0]=r[8]=r[16]=r[24]=0,r[1]=r[3]=r[5]=r[7]=0,r[6]=r[14]=r[22]=r[30]=1,r[25]=r[27]=r[29]=r[31]=1,r[2]=r[10]=r[18]=r[26]=n*this._leftWidth,r[4]=r[12]=r[20]=r[28]=1-n*this._rightWidth,r[9]=r[11]=r[13]=r[15]=s*this._topHeight,r[17]=r[19]=r[21]=r[23]=1-s*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},e})(Jp);/*!
 * @pixi/sprite-animated - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/sprite-animated is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var sl=function(i,e){return sl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},sl(i,e)};function v_(i,e){sl(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var m_=(function(i){v_(e,i);function e(t,r){r===void 0&&(r=!0);var n=i.call(this,t[0]instanceof lt?t[0]:t[0].texture)||this;return n._textures=null,n._durations=null,n._autoUpdate=r,n._isConnectedToTicker=!1,n.animationSpeed=1,n.loop=!0,n.updateAnchor=!1,n.onComplete=null,n.onFrameChange=null,n.onLoop=null,n._currentTime=0,n._playing=!1,n._previousFrame=null,n.textures=t,n}return e.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Dt.shared.remove(this.update,this),this._isConnectedToTicker=!1))},e.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Dt.shared.add(this.update,this,Ce.HIGH),this._isConnectedToTicker=!0))},e.prototype.gotoAndStop=function(t){this.stop();var r=this.currentFrame;this._currentTime=t,r!==this.currentFrame&&this.updateTexture()},e.prototype.gotoAndPlay=function(t){var r=this.currentFrame;this._currentTime=t,r!==this.currentFrame&&this.updateTexture(),this.play()},e.prototype.update=function(t){if(this._playing){var r=this.animationSpeed*t,n=this.currentFrame;if(this._durations!==null){var s=this._currentTime%1*this._durations[this.currentFrame];for(s+=r/60*1e3;s<0;)this._currentTime--,s+=this._durations[this.currentFrame];var o=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);s>=this._durations[this.currentFrame];)s-=this._durations[this.currentFrame]*o,this._currentTime+=o;this._currentTime+=s/this._durations[this.currentFrame]}else this._currentTime+=r;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):n!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<n?this.onLoop():this.animationSpeed<0&&this.currentFrame>n&&this.onLoop()),this.updateTexture())}},e.prototype.updateTexture=function(){var t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},e.prototype.destroy=function(t){this.stop(),i.prototype.destroy.call(this,t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},e.fromFrames=function(t){for(var r=[],n=0;n<t.length;++n)r.push(lt.from(t[n]));return new e(r)},e.fromImages=function(t){for(var r=[],n=0;n<t.length;++n)r.push(lt.from(t[n]));return new e(r)},Object.defineProperty(e.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textures",{get:function(){return this._textures},set:function(t){if(t[0]instanceof lt)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var r=0;r<t.length;r++)this._textures.push(t[r].texture),this._durations.push(t[r].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Dt.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Dt.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),e})(Lr);/*!
 * pixi.js - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * pixi.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var ol=function(i,e){return ol=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},ol(i,e)};function qf(i,e){ol(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var tt="5.0.0";function g_(){var i=this;Object.defineProperties(i,{SVG_SIZE:{get:function(){return K(tt,"PIXI.utils.SVG_SIZE property has moved to PIXI.resources.SVGResource.SVG_SIZE"),i.SVGResource.SVG_SIZE}},TransformStatic:{get:function(){return K(tt,"PIXI.TransformStatic class has been removed, use PIXI.Transform"),i.Transform}},TransformBase:{get:function(){return K(tt,"PIXI.TransformBase class has been removed, use PIXI.Transform"),i.Transform}},TRANSFORM_MODE:{get:function(){return K(tt,"PIXI.TRANSFORM_MODE property has been removed"),{STATIC:0,DYNAMIC:1}}},WebGLRenderer:{get:function(){return K(tt,"PIXI.WebGLRenderer class has moved to PIXI.Renderer"),i.Renderer}},CanvasRenderTarget:{get:function(){return K(tt,"PIXI.CanvasRenderTarget class has moved to PIXI.utils.CanvasRenderTarget"),i.utils.CanvasRenderTarget}},loader:{get:function(){return K(tt,"PIXI.loader instance has moved to PIXI.Loader.shared"),i.Loader.shared}},FilterManager:{get:function(){return K(tt,"PIXI.FilterManager class has moved to PIXI.systems.FilterSystem"),i.systems.FilterSystem}},CanvasTinter:{get:function(){return K("5.2.0","PIXI.CanvasTinter namespace has moved to PIXI.canvasUtils"),i.canvasUtils}},GroupD8:{get:function(){return K("5.2.0","PIXI.GroupD8 namespace has moved to PIXI.groupD8"),i.groupD8}}}),i.accessibility={},Object.defineProperties(i.accessibility,{AccessibilityManager:{get:function(){return K("5.3.0","PIXI.accessibility.AccessibilityManager moved to PIXI.AccessibilityManager"),i.AccessibilityManager}}}),i.interaction={},Object.defineProperties(i.interaction,{InteractionManager:{get:function(){return K("5.3.0","PIXI.interaction.InteractionManager moved to PIXI.InteractionManager"),i.InteractionManager}},InteractionData:{get:function(){return K("5.3.0","PIXI.interaction.InteractionData moved to PIXI.InteractionData"),i.InteractionData}},InteractionEvent:{get:function(){return K("5.3.0","PIXI.interaction.InteractionEvent moved to PIXI.InteractionEvent"),i.InteractionEvent}}}),i.prepare={},Object.defineProperties(i.prepare,{BasePrepare:{get:function(){return K("5.2.1","PIXI.prepare.BasePrepare moved to PIXI.BasePrepare"),i.BasePrepare}},Prepare:{get:function(){return K("5.2.1","PIXI.prepare.Prepare moved to PIXI.Prepare"),i.Prepare}},CanvasPrepare:{get:function(){return K("5.2.1","PIXI.prepare.CanvasPrepare moved to PIXI.CanvasPrepare"),i.CanvasPrepare}}}),i.extract={},Object.defineProperties(i.extract,{Extract:{get:function(){return K("5.2.1","PIXI.extract.Extract moved to PIXI.Extract"),i.Extract}},CanvasExtract:{get:function(){return K("5.2.1","PIXI.extract.CanvasExtract moved to PIXI.CanvasExtract"),i.CanvasExtract}}}),i.extras={},Object.defineProperties(i.extras,{TilingSprite:{get:function(){return K(tt,"PIXI.extras.TilingSprite class has moved to PIXI.TilingSprite"),i.TilingSprite}},TilingSpriteRenderer:{get:function(){return K(tt,"PIXI.extras.TilingSpriteRenderer class has moved to PIXI.TilingSpriteRenderer"),i.TilingSpriteRenderer}},AnimatedSprite:{get:function(){return K(tt,"PIXI.extras.AnimatedSprite class has moved to PIXI.AnimatedSprite"),i.AnimatedSprite}},BitmapText:{get:function(){return K(tt,"PIXI.extras.BitmapText class has moved to PIXI.BitmapText"),i.BitmapText}}}),i.TilingSprite.fromFrame=function(c,d,p){return K("5.3.0","TilingSprite.fromFrame is deprecated, use TilingSprite.from"),i.TilingSprite.from(c,{width:d,height:p})},i.TilingSprite.fromImage=function(c,d,p,m){return m===void 0&&(m={}),K("5.3.0","TilingSprite.fromImage is deprecated, use TilingSprite.from"),m&&typeof m!="object"&&(m={scaleMode:arguments[4],resourceOptions:{crossorigin:arguments[3]}}),m.width=d,m.height=p,i.TilingSprite.from(c,m)},Object.defineProperties(i.utils,{getSvgSize:{get:function(){return K(tt,"PIXI.utils.getSvgSize function has moved to PIXI.resources.SVGResource.getSize"),i.resources.SVGResource.getSize}}}),i.mesh={},Object.defineProperties(i.mesh,{Mesh:{get:function(){return K(tt,"PIXI.mesh.Mesh class has moved to PIXI.SimpleMesh"),i.SimpleMesh}},NineSlicePlane:{get:function(){return K(tt,"PIXI.mesh.NineSlicePlane class has moved to PIXI.NineSlicePlane"),i.NineSlicePlane}},Plane:{get:function(){return K(tt,"PIXI.mesh.Plane class has moved to PIXI.SimplePlane"),i.SimplePlane}},Rope:{get:function(){return K(tt,"PIXI.mesh.Rope class has moved to PIXI.SimpleRope"),i.SimpleRope}},RawMesh:{get:function(){return K(tt,"PIXI.mesh.RawMesh class has moved to PIXI.Mesh"),i.Mesh}},CanvasMeshRenderer:{get:function(){return K(tt,"PIXI.mesh.CanvasMeshRenderer class has moved to PIXI.CanvasMeshRenderer"),i.CanvasMeshRenderer}},MeshRenderer:{get:function(){return K(tt,"PIXI.mesh.MeshRenderer class has moved to PIXI.MeshRenderer"),i.MeshRenderer}}}),i.particles={},Object.defineProperties(i.particles,{ParticleContainer:{get:function(){return K(tt,"PIXI.particles.ParticleContainer class has moved to PIXI.ParticleContainer"),i.ParticleContainer}},ParticleRenderer:{get:function(){return K(tt,"PIXI.particles.ParticleRenderer class has moved to PIXI.ParticleRenderer"),i.ParticleRenderer}}}),i.ticker={},Object.defineProperties(i.ticker,{Ticker:{get:function(){return K(tt,"PIXI.ticker.Ticker class has moved to PIXI.Ticker"),i.Ticker}},shared:{get:function(){return K(tt,"PIXI.ticker.shared instance has moved to PIXI.Ticker.shared"),i.Ticker.shared}}}),i.loaders={},Object.defineProperties(i.loaders,{Loader:{get:function(){return K(tt,"PIXI.loaders.Loader class has moved to PIXI.Loader"),i.Loader}},Resource:{get:function(){return K(tt,"PIXI.loaders.Resource class has moved to PIXI.LoaderResource"),i.LoaderResource}},bitmapFontParser:{get:function(){return K(tt,"PIXI.loaders.bitmapFontParser function has moved to PIXI.BitmapFontLoader.use"),i.BitmapFontLoader.use}},parseBitmapFontData:{get:function(){K(tt,"PIXI.loaders.parseBitmapFontData function has removed")}},spritesheetParser:{get:function(){return K(tt,"PIXI.loaders.spritesheetParser function has moved to PIXI.SpritesheetLoader.use"),i.SpritesheetLoader.use}},getResourcePath:{get:function(){return K(tt,"PIXI.loaders.getResourcePath property has moved to PIXI.SpritesheetLoader.getResourcePath"),i.SpritesheetLoader.getResourcePath}}}),i.Loader.addPixiMiddleware=function(c){return K(tt,"PIXI.loaders.Loader.addPixiMiddleware function is deprecated, use PIXI.loaders.Loader.registerPlugin"),i.loaders.Loader.registerPlugin({use:c()})};var e=function(f){return"on"+f.charAt(0).toUpperCase()+f.slice(1)};Object.assign(i.Loader.prototype,{on:function(f){var c=e(f);K(tt,"PIXI.Loader#on is completely deprecated, use PIXI.Loader#"+c+".add")},once:function(f){var c=e(f);K(tt,"PIXI.Loader#once is completely deprecated, use PIXI.Loader#"+c+".once")},off:function(f){var c=e(f);K(tt,"PIXI.Loader#off is completely deprecated, use PIXI.Loader#"+c+".detach")}}),Object.defineProperty(i.extract,"WebGLExtract",{get:function(){return K(tt,"PIXI.extract.WebGLExtract method has moved to PIXI.Extract"),i.Extract}}),Object.defineProperty(i.prepare,"WebGLPrepare",{get:function(){return K(tt,"PIXI.prepare.WebGLPrepare class has moved to PIXI.Prepare"),i.Prepare}}),i.Container.prototype._renderWebGL=function(c){K(tt,"PIXI.Container._renderWebGL method has moved to PIXI.Container._render"),this._render(c)},i.Container.prototype.renderWebGL=function(c){K(tt,"PIXI.Container.renderWebGL method has moved to PIXI.Container.render"),this.render(c)},i.DisplayObject.prototype.renderWebGL=function(c){K(tt,"PIXI.DisplayObject.renderWebGL method has moved to PIXI.DisplayObject.render"),this.render(c)},i.Container.prototype.renderAdvancedWebGL=function(c){K(tt,"PIXI.Container.renderAdvancedWebGL method has moved to PIXI.Container.renderAdvanced"),this.renderAdvanced(c)},Object.defineProperties(i.settings,{TRANSFORM_MODE:{get:function(){return K(tt,"PIXI.settings.TRANSFORM_MODE property has been removed"),0},set:function(){K(tt,"PIXI.settings.TRANSFORM_MODE property has been removed")}}});var t=i.BaseTexture;t.prototype.loadSource=function(c){K(tt,"PIXI.BaseTexture.loadSource method has been deprecated");var d=i.resources.autoDetectResource(c);d.internal=!0,this.setResource(d),this.update()};var r=!1;Object.defineProperties(t.prototype,{hasLoaded:{get:function(){return K(tt,"PIXI.BaseTexture.hasLoaded property has been removed, use PIXI.BaseTexture.valid"),this.valid}},imageUrl:{get:function(){var f;return K(tt,"PIXI.BaseTexture.imageUrl property has been removed, use PIXI.BaseTexture.resource.url"),(f=this.resource)===null||f===void 0?void 0:f.url},set:function(f){K(tt,"PIXI.BaseTexture.imageUrl property has been removed, use PIXI.BaseTexture.resource.url"),this.resource&&(this.resource.url=f)}},source:{get:function(){return K(tt,"PIXI.BaseTexture.source property has been moved, use `PIXI.BaseTexture.resource.source`"),this.resource.source},set:function(f){K(tt,"PIXI.BaseTexture.source property has been moved, use `PIXI.BaseTexture.resource.source` if you want to set HTMLCanvasElement. Otherwise, create new BaseTexture."),this.resource&&(this.resource.source=f)}},premultiplyAlpha:{get:function(){return K("5.2.0","PIXI.BaseTexture.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),this.alphaMode!==0},set:function(f){K("5.2.0","PIXI.BaseTexture.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),this.alphaMode=Number(f)}},_id:{get:function(){return r||(K("5.2.0","PIXI.BaseTexture._id batch local field has been changed to `_batchLocation`"),r=!0),this._batchLocation},set:function(f){this._batchLocation=f}}}),t.fromImage=function(c,d,p,m){K(tt,"PIXI.BaseTexture.fromImage method has been replaced with PIXI.BaseTexture.from");var v={scale:m,crossorigin:d};return t.from(c,{scaleMode:p,resourceOptions:v})},t.fromCanvas=function(c,d){return K(tt,"PIXI.BaseTexture.fromCanvas method has been replaced with PIXI.BaseTexture.from"),t.from(c,{scaleMode:d})},t.fromSVG=function(c,d,p,m){K(tt,"PIXI.BaseTexture.fromSVG method has been replaced with PIXI.BaseTexture.from");var v={scale:m,crossorigin:d};return t.from(c,{scaleMode:p,resourceOptions:v})},Object.defineProperties(i.resources.ImageResource.prototype,{premultiplyAlpha:{get:function(){return K("5.2.0","PIXI.resources.ImageResource.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),this.alphaMode!==0},set:function(f){K("5.2.0","PIXI.resources.ImageResource.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),this.alphaMode=Number(f)}}}),i.Point.prototype.copy=function(c){return K(tt,"PIXI.Point.copy method has been replaced with PIXI.Point.copyFrom"),this.copyFrom(c)},i.ObservablePoint.prototype.copy=function(c){return K(tt,"PIXI.ObservablePoint.copy method has been replaced with PIXI.ObservablePoint.copyFrom"),this.copyFrom(c)},i.Rectangle.prototype.copy=function(c){return K(tt,"PIXI.Rectangle.copy method has been replaced with PIXI.Rectangle.copyFrom"),this.copyFrom(c)},i.Matrix.prototype.copy=function(c){return K(tt,"PIXI.Matrix.copy method has been replaced with PIXI.Matrix.copyTo"),this.copyTo(c)},i.systems.StateSystem.prototype.setState=function(c){return K("v5.1.0","StateSystem.setState has been renamed to StateSystem.set"),this.set(c)},Object.assign(i.systems.FilterSystem.prototype,{getRenderTarget:function(f,c){return K(tt,"PIXI.FilterManager.getRenderTarget method has been replaced with PIXI.systems.FilterSystem#getFilterTexture"),this.getFilterTexture(null,c)},returnRenderTarget:function(f){K(tt,"PIXI.FilterManager.returnRenderTarget method has been replaced with PIXI.systems.FilterSystem.returnFilterTexture"),this.returnFilterTexture(f)},calculateScreenSpaceMatrix:function(f){K(tt,"PIXI.systems.FilterSystem.calculateScreenSpaceMatrix method is removed, use `(vTextureCoord * inputSize.xy) + outputFrame.xy` instead");var c=f.identity(),d=this.activeState,p=d.sourceFrame,m=d.destinationFrame;return c.translate(p.x/m.width,p.y/m.height),c.scale(m.width,m.height),c},calculateNormalizedScreenSpaceMatrix:function(f){K(tt,"PIXI.systems.FilterManager.calculateNormalizedScreenSpaceMatrix method is removed, use `((vTextureCoord * inputSize.xy) + outputFrame.xy) / outputFrame.zw` instead.");var c=this.activeState,d=c.sourceFrame,p=c.destinationFrame,m=f.identity();m.translate(d.x/p.width,d.y/p.height);var v=p.width/d.width,g=p.height/d.height;return m.scale(v,g),m}}),Object.defineProperties(i.RenderTexture.prototype,{sourceFrame:{get:function(){return K(tt,"PIXI.RenderTexture.sourceFrame property has been removed"),this.filterFrame}},size:{get:function(){return K(tt,"PIXI.RenderTexture.size property has been removed"),this._frame}}});var n=(function(f){qf(c,f);function c(d,p,m,v){var g=this;return K(tt,"PIXI.filters.BlurXFilter class is deprecated, use PIXI.filters.BlurFilterPass"),g=f.call(this,!0,d,p,m,v)||this,g}return c})(i.filters.BlurFilterPass),s=(function(f){qf(c,f);function c(d,p,m,v){var g=this;return K(tt,"PIXI.filters.BlurYFilter class is deprecated, use PIXI.filters.BlurFilterPass"),g=f.call(this,!1,d,p,m,v)||this,g}return c})(i.filters.BlurFilterPass);Object.assign(i.filters,{BlurXFilter:n,BlurYFilter:s});var o=i.Sprite,a=i.Texture,l=i.Graphics;l.prototype.generateCanvasTexture||(l.prototype.generateCanvasTexture=function(){K(tt,'PIXI.Graphics.generateCanvasTexture method is only available in "pixi.js-legacy"')}),Object.defineProperty(l.prototype,"graphicsData",{get:function(){return K(tt,"PIXI.Graphics.graphicsData property is deprecated, use PIXI.Graphics.geometry.graphicsData"),this.geometry.graphicsData}});function u(f,c,d,p){return K(tt,"PIXI.Sprite."+f+" method is deprecated, use PIXI.Sprite.from"),o.from(c,{resourceOptions:{scale:p,crossorigin:d}})}o.fromImage=u.bind(null,"fromImage"),o.fromSVG=u.bind(null,"fromSVG"),o.fromCanvas=u.bind(null,"fromCanvas"),o.fromVideo=u.bind(null,"fromVideo"),o.fromFrame=u.bind(null,"fromFrame");function h(f,c,d,p){return K(tt,"PIXI.Texture."+f+" method is deprecated, use PIXI.Texture.from"),a.from(c,{resourceOptions:{scale:p,crossorigin:d}})}a.fromImage=h.bind(null,"fromImage"),a.fromSVG=h.bind(null,"fromSVG"),a.fromCanvas=h.bind(null,"fromCanvas"),a.fromVideo=h.bind(null,"fromVideo"),a.fromFrame=h.bind(null,"fromFrame"),Object.defineProperty(i.AbstractRenderer.prototype,"autoResize",{get:function(){return K(tt,"PIXI.AbstractRenderer.autoResize property is deprecated, use PIXI.AbstractRenderer.autoDensity"),this.autoDensity},set:function(f){K(tt,"PIXI.AbstractRenderer.autoResize property is deprecated, use PIXI.AbstractRenderer.autoDensity"),this.autoDensity=f}}),Object.defineProperty(i.Renderer.prototype,"textureManager",{get:function(){return K(tt,"PIXI.Renderer.textureManager property is deprecated, use PIXI.Renderer.texture"),this.texture}}),i.utils.mixins={mixin:function(){K(tt,"PIXI.utils.mixins.mixin function is no longer available")},delayMixin:function(){K(tt,"PIXI.utils.mixins.delayMixin function is no longer available")},performMixins:function(){K(tt,"PIXI.utils.mixins.performMixins function is no longer available")}},Object.defineProperty(i.BitmapText.prototype,"font",{get:function(){return K("5.3.0","PIXI.BitmapText.font property is deprecated, use fontName, fontSize, tint or align properties"),{name:this._fontName,size:this._fontSize,tint:this._tint,align:this._align}},set:function(f){if(K("5.3.0","PIXI.BitmapText.font property is deprecated, use fontName, fontSize, tint or align properties"),!!f){var c={font:f};this._upgradeStyle(c),c.fontSize=c.fontSize||i.BitmapFont.available[c.fontName].size,this._fontName=c.fontName,this._fontSize=c.fontSize,this.dirty=!0}}})}Oe.registerPlugin("accessibility",Pd);Oe.registerPlugin("extract",wp);Oe.registerPlugin("interaction",Md);Oe.registerPlugin("particle",Cp);Oe.registerPlugin("prepare",Xp);Oe.registerPlugin("batch",xp);Oe.registerPlugin("tilingSprite",zp);Cr.registerPlugin($p);Cr.registerPlugin(Gp);en.registerPlugin(Od);en.registerPlugin(Sp);var __="5.3.12",b_={AlphaFilter:q0,BlurFilter:J0,BlurFilterPass:Ja,ColorMatrixFilter:tl,DisplacementFilter:n_,FXAAFilter:l_,NoiseFilter:f_};const x_=Object.freeze(Object.defineProperty({__proto__:null,get ALPHA_MODES(){return Xe},AbstractBatchRenderer:gp,AbstractRenderer:pp,AccessibilityManager:Pd,AnimatedSprite:m_,AppLoaderPlugin:Sp,Application:en,Attribute:La,get BLEND_MODES(){return st},get BUFFER_BITS(){return zi},BasePrepare:kp,BaseRenderTexture:Ui,BaseTexture:Tt,BatchDrawCall:us,BatchGeometry:Jl,BatchPluginFactory:bp,BatchRenderer:xp,BatchShaderGenerator:_p,BatchTextureArray:hs,BitmapFont:Je,BitmapFontData:ji,BitmapFontLoader:$p,BitmapText:Y0,Bounds:$i,Buffer:Mt,get CLEAR_MODES(){return ge},Circle:Id,Container:Jt,CountLimiter:Dp,DEG_TO_RAD:Td,get DRAW_MODES(){return ae},DisplayObject:Bt,get ENV(){return Ae},Ellipse:Ed,Extract:wp,get FORMATS(){return oi},FillStyle:Ql,Filter:ze,FilterState:Yd,Framebuffer:ls,get GC_MODES(){return os},GLFramebuffer:$d,GLProgram:up,GLTexture:qn,GRAPHICS_CURVES:hi,Geometry:Mr,Graphics:Es,GraphicsData:Ga,GraphicsGeometry:Np,IGLUniformData:Lg,InteractionData:Ra,InteractionEvent:Rd,InteractionManager:Md,InteractionTrackingData:zn,get LINE_CAP(){return Ne},get LINE_JOIN(){return Le},LineStyle:Bp,Loader:Cr,LoaderResource:Xi,get MASK_TYPES(){return Wt},get MIPMAP_MODES(){return ai},get MSAA_QUALITY(){return Ir},MaskData:Kd,Matrix:Rt,Mesh:ci,MeshBatchUvs:Vp,MeshGeometry:nn,MeshMaterial:rn,NineSlicePlane:y_,ObjectRenderer:gi,ObservablePoint:wr,PI_2:li,get PRECISION(){return xe},ParticleContainer:a0,ParticleRenderer:Cp,PlaneGeometry:Kp,Point:kt,Polygon:ti,Prepare:Xp,Program:_i,Quad:Gd,QuadUv:Kl,RAD_TO_DEG:wd,get RENDERER_TYPE(){return si},Rectangle:vt,RenderTexture:Ar,RenderTexturePool:Xd,Renderer:Oe,RopeGeometry:Zp,RoundedRectangle:Sd,Runner:Ht,get SCALE_MODES(){return be},get SHAPES(){return Ot},Shader:Ge,SimpleMesh:p_,SimplePlane:Jp,SimpleRope:d_,Sprite:Lr,SpriteMaskFilter:rp,Spritesheet:Hp,SpritesheetLoader:Gp,State:lr,System:ee,get TARGETS(){return ir},get TEXT_GRADIENT(){return fi},get TYPES(){return Lt},TemporaryDisplayObject:zl,Text:eu,TextMetrics:ye,TextStyle:Pr,Texture:lt,TextureLoader:Ep,TextureMatrix:Ts,TextureUvs:Wl,Ticker:Dt,TickerPlugin:Od,TilingSprite:F0,TilingSpriteRenderer:zp,TimeLimiter:R0,Transform:Gl,get UPDATE_PRIORITY(){return Ce},UniformGroup:nr,VERSION:__,ViewableBuffer:mp,get WRAP_MODES(){return Ee},accessibleTarget:Cd,autoDetectRenderer:yp,checkMaxIfStatementsInShader:ep,defaultFilterVertex:Zl,defaultVertex:vp,filters:b_,graphicsUtils:c0,groupD8:Ct,interactiveTarget:Fd,isMobile:ce,resources:Ud,settings:nt,systems:Gg,uniformParsers:Vn,useDeprecated:g_,utils:Km},Symbol.toStringTag,{value:"Module"}));var mt;(function(i){var e=(function(){function t(r){this.tileAnim=[0,0],this.dontUseTransform=!1,this.renderer=r,this.tileAnim=[0,0]}return t})();i.CanvasTileRenderer=e})(mt||(mt={}));var ke=(function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),mt;(function(i){var e=(function(t){ke(r,t);function r(n,s,o){var a=t.call(this)||this;return a.modificationMarker=0,a.shadowColor=new Float32Array([0,0,0,.5]),a._globalMat=null,a.initialize.apply(a,arguments),a}return r.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},r.prototype.initialize=function(n,s,o){o===!0&&(o=0),this.z=this.zIndex=n,this.texPerChild=o||i.Constant.boundCountPerBuffer*i.Constant.maxTextures,s&&this.setBitmaps(s)},r.prototype.setBitmaps=function(n){var s=this.texPerChild,o=this.children.length,a=Math.ceil(n.length/s),l;for(l=0;l<o;l++)this.children[l].textures=n.slice(l*s,(l+1)*s);for(l=o;l<a;l++){var u=new i.RectTileLayer(this.zIndex,n.slice(l*s,(l+1)*s));u.compositeParent=!0,u.offsetX=i.Constant.boundSize,u.offsetY=i.Constant.boundSize,this.addChild(u)}},r.prototype.clear=function(){for(var n=0;n<this.children.length;n++)this.children[n].clear();this.modificationMarker=0},r.prototype.addRect=function(n,s,o,a,l,u,h){var f=n/this.texPerChild>>0,c=n%this.texPerChild;this.children[f]&&this.children[f].textures&&this.children[f].addRect(c,s,o,a,l,u,h)},r.prototype.addFrame=function(n,s,o,a,l){var u,h=null,f=0,c=this.children;if(typeof n=="number"){var d=n/this.texPerChild>>0;if(h=c[d],h)f=n%this.texPerChild;else{if(h=c[0],!h)return!1;f=0}u=h.textures[f]}else{typeof n=="string"?u=lt.from(n):u=n;for(var p=0;p<c.length;p++){for(var m=c[p],v=m.textures,g=0;g<v.length;g++)if(v[g].baseTexture===u.baseTexture){h=m,f=g;break}if(h)break}if(!h){for(var p=0;p<c.length;p++){var m=c[p];if(m.textures.length<this.texPerChild){h=m,f=m.textures.length,m.textures.push(u);break}}h||(h=new i.RectTileLayer(this.zIndex,u),h.compositeParent=!0,h.offsetX=i.Constant.boundSize,h.offsetY=i.Constant.boundSize,c.push(h),f=0)}}return h.addRect(f,u.frame.x,u.frame.y,s,o,u.frame.width,u.frame.height,a,l),!0},r.prototype.renderCanvas=function(n){if(!(!this.visible||this.worldAlpha<=0||!this.renderable)){var s=n.plugins.tilemap;if(!s.dontUseTransform){var o=this.worldTransform;n.context.setTransform(o.a,o.b,o.c,o.d,o.tx*n.resolution,o.ty*n.resolution)}for(var a=this.children,l=0;l<a.length;l++)a[l].renderCanvasCore(n)}},r.prototype.render=function(n){if(!(!this.visible||this.worldAlpha<=0||!this.renderable)){var s=n.plugins.tilemap,o=s.getShader();n.batch.setObjectRenderer(s),this._globalMat=o.uniforms.projTransMatrix,n.globalUniforms.uniforms.projectionMatrix.copyTo(this._globalMat).append(this.worldTransform),o.uniforms.shadowColor=this.shadowColor,o.uniforms.animationFrame=s.tileAnim,n.shader.bind(o,!1);for(var a=this.children,l=0;l<a.length;l++)a[l].renderWebGLCore(n,s)}},r.prototype.isModified=function(n){var s=this.children;if(this.modificationMarker!==s.length)return!0;for(var o=0;o<s.length;o++)if(s[o].isModified(n))return!0;return!1},r.prototype.clearModify=function(){var n=this.children;this.modificationMarker=n.length;for(var s=0;s<n.length;s++)n[s].clearModify()},r})(Jt);i.CompositeRectTileLayer=e})(mt||(mt={}));var mt;(function(i){i.Constant={maxTextures:4,bufferSize:2048,boundSize:1024,boundCountPerBuffer:4,use32bitIndex:!1,SCALE_MODE:be.LINEAR,DO_CLEAR:!0}})(mt||(mt={}));var mt;(function(i){(function(e){ke(t,e);function t(r){var n=e.call(this)||this;return n.zIndex=r,n}return t.prototype.renderCanvas=function(r){var n=null;r.plugins.tilemap.dontUseTransform&&(n=this.transform.worldTransform,this.transform.worldTransform=Rt.IDENTITY),r.plugins.graphics.render(this),r.plugins.tilemap.dontUseTransform&&(this.transform.worldTransform=n),r.context.globalAlpha=1},t.prototype.isModified=function(r){return!1},t.prototype.clearModify=function(){},t})(Es)})(mt||(mt={}));var mt;(function(i){var e=(function(t){ke(r,t);function r(n){var s=t.call(this,n.bufferSize,n.bufferSize)||this;s.DO_CLEAR=!1,s.boundSize=0,s._clearBuffer=null,s.baseTex=null,s.boundSprites=[],s.dirties=[];var o=s.boundSprites,a=s.dirties;s.boundSize=n.boundSize;for(var l=0;l<n.boundCountPerBuffer;l++){var u=new Lr;u.position.x=n.boundSize*(l&1),u.position.y=n.boundSize*(l>>1),o.push(u),a.push(0)}return s.DO_CLEAR=!!n.DO_CLEAR,s}return r.prototype.bind=function(n){if(this.baseTex)throw new Error("Only one baseTexture is allowed for this resource!");this.baseTex=n,t.prototype.bind.call(this,n)},r.prototype.setTexture=function(n,s){var o=this.boundSprites[n];o.texture.baseTexture!==s.baseTexture&&(o.texture=s,this.baseTex.update(),this.dirties[n]=this.baseTex.dirtyId)},r.prototype.upload=function(n,s,o){var a=n.gl,l=this,u=l.width,h=l.height;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultiplyAlpha),o.dirtyId<0&&(o.width=u,o.height=h,a.texImage2D(s.target,0,s.format,u,h,0,s.format,s.type,null));var f=this.DO_CLEAR;f&&!this._clearBuffer&&(this._clearBuffer=new Uint8Array(i.Constant.boundSize*i.Constant.boundSize*4));for(var c=this.boundSprites,d=0;d<c.length;d++){var p=c[d],m=p.texture.baseTexture;if(!(o.dirtyId>=this.dirties[d])){var v=m.resource;!m.valid||!v||!v.source||(f&&(m.width<this.boundSize||m.height<this.boundSize)&&a.texSubImage2D(s.target,0,p.position.x,p.position.y,this.boundSize,this.boundSize,s.format,s.type,this._clearBuffer),a.texSubImage2D(s.target,0,p.position.x,p.position.y,s.format,s.type,v.source))}}return!0},r})(Ud.Resource);i.MultiTextureResource=e})(mt||(mt={}));var mt;(function(i){var e=(function(t){ke(r,t);function r(n,s){var o=t.call(this)||this;return o.zIndex=0,o.modificationMarker=0,o.shadowColor=new Float32Array([0,0,0,.5]),o._globalMat=null,o.pointsBuf=[],o.hasAnim=!1,o.offsetX=0,o.offsetY=0,o.compositeParent=!1,o.vbId=0,o.vb=null,o.vbBuffer=null,o.vbArray=null,o.vbInts=null,o.initialize(n,s),o}return r.prototype.initialize=function(n,s){s?!(s instanceof Array)&&s.baseTexture&&(s=[s]):s=[],this.textures=s,this.zIndex=n},r.prototype.clear=function(){this.pointsBuf.length=0,this.modificationMarker=0,this.hasAnim=!1},r.prototype.addFrame=function(n,s,o,a,l){var u,h=0;if(typeof n=="number")h=n,u=this.textures[h];else{typeof n=="string"?u=lt.from(n):u=n;for(var f=!1,c=this.textures,d=0;d<c.length;d++)if(c[d].baseTexture===u.baseTexture){h=d,f=!0;break}if(!f)return!1}return this.addRect(h,u.frame.x,u.frame.y,s,o,u.frame.width,u.frame.height,a,l),!0},r.prototype.addRect=function(n,s,o,a,l,u,h,f,c){f===void 0&&(f=0),c===void 0&&(c=0);var d=this.pointsBuf;if(this.hasAnim=this.hasAnim||f>0||c>0,u===h)d.push(s),d.push(o),d.push(a),d.push(l),d.push(u),d.push(h),d.push(f|0),d.push(c|0),d.push(n);else{var p=void 0;if(u%h===0)for(p=0;p<u/h;p++)d.push(s+p*h),d.push(o),d.push(a+p*h),d.push(l),d.push(h),d.push(h),d.push(f|0),d.push(c|0),d.push(n);else if(h%u===0)for(p=0;p<h/u;p++)d.push(s),d.push(o+p*u),d.push(a),d.push(l+p*u),d.push(u),d.push(u),d.push(f|0),d.push(c|0),d.push(n);else d.push(s),d.push(o),d.push(a),d.push(l),d.push(u),d.push(h),d.push(f|0),d.push(c|0),d.push(n)}},r.prototype.renderCanvas=function(n){var s=n.plugins.tilemap;if(!s.dontUseTransform){var o=this.worldTransform;n.context.setTransform(o.a,o.b,o.c,o.d,o.tx*n.resolution,o.ty*n.resolution)}this.renderCanvasCore(n)},r.prototype.renderCanvasCore=function(n){if(this.textures.length!==0){var s=this.pointsBuf;n.context.fillStyle="#000000";for(var o=0,a=s.length;o<a;o+=9){var l=s[o],u=s[o+1],h=s[o+2],f=s[o+3],c=s[o+4],d=s[o+5];l+=s[o+6]*n.plugins.tilemap.tileAnim[0],u+=s[o+7]*n.plugins.tilemap.tileAnim[1];var p=s[o+8];p>=0?n.context.drawImage(this.textures[p].baseTexture.source,l,u,c,d,h,f,c,d):(n.context.globalAlpha=.5,n.context.fillRect(h,f,c,d),n.context.globalAlpha=1)}}},r.prototype.destroyVb=function(){this.vb&&(this.vb.destroy(),this.vb=null)},r.prototype.render=function(n){var s=n.plugins.tilemap,o=s.getShader();n.batch.setObjectRenderer(s),this._globalMat=o.uniforms.projTransMatrix,n.globalUniforms.uniforms.projectionMatrix.copyTo(this._globalMat).append(this.worldTransform),o.uniforms.shadowColor=this.shadowColor,o.uniforms.animationFrame=s.tileAnim,n.shader.bind(o,!1),this.renderWebGLCore(n,s)},r.prototype.renderWebGLCore=function(n,s){var o=this.pointsBuf;if(o.length!==0){var a=o.length/9,l=s.getShader(),u=this.textures;if(u.length!==0){s.bindTextures(n,l,u);var h=this.vb;h||(h=s.createVb(),this.vb=h,this.vbId=h.id,this.vbBuffer=null,this.modificationMarker=0),s.checkIndexBuffer(a,h);var f=i.Constant.boundCountPerBuffer,c=h.getBuffer("aVertexPosition"),d=a*h.vertPerQuad;if(d!==0){if(this.modificationMarker!==d){this.modificationMarker=d;var p=h.stride*d;if(!this.vbBuffer||this.vbBuffer.byteLength<p){for(var m=h.stride;m<p;)m*=2;this.vbBuffer=new ArrayBuffer(m),this.vbArray=new Float32Array(this.vbBuffer),this.vbInts=new Uint32Array(this.vbBuffer),c.update(this.vbBuffer)}var v=this.vbArray;this.vbInts;for(var g=0,I=0,w=this.offsetX,M=this.offsetY,b=0;b<o.length;b+=9){var R=.5;this.compositeParent&&(f>1?(I=o[b+8]>>2,w=this.offsetX*(o[b+8]&1),M=this.offsetY*(o[b+8]>>1&1)):(I=o[b+8],w=0,M=0));var C=o[b+2],H=o[b+3],F=o[b+4],B=o[b+5],Y=o[b]+w,D=o[b+1]+M,J=o[b+6],Q=o[b+7];v[g++]=C,v[g++]=H,v[g++]=Y,v[g++]=D,v[g++]=Y+R,v[g++]=D+R,v[g++]=Y+F-R,v[g++]=D+B-R,v[g++]=J,v[g++]=Q,v[g++]=I,v[g++]=C+F,v[g++]=H,v[g++]=Y+F,v[g++]=D,v[g++]=Y+R,v[g++]=D+R,v[g++]=Y+F-R,v[g++]=D+B-R,v[g++]=J,v[g++]=Q,v[g++]=I,v[g++]=C+F,v[g++]=H+B,v[g++]=Y+F,v[g++]=D+B,v[g++]=Y+R,v[g++]=D+R,v[g++]=Y+F-R,v[g++]=D+B-R,v[g++]=J,v[g++]=Q,v[g++]=I,v[g++]=C,v[g++]=H+B,v[g++]=Y,v[g++]=D+B,v[g++]=Y+R,v[g++]=D+R,v[g++]=Y+F-R,v[g++]=D+B-R,v[g++]=J,v[g++]=Q,v[g++]=I}c.update(v)}n.geometry.bind(h,l),n.geometry.draw(ae.TRIANGLES,a*6,0)}}}},r.prototype.isModified=function(n){return!!(this.modificationMarker!==this.pointsBuf.length||n&&this.hasAnim)},r.prototype.clearModify=function(){this.modificationMarker=this.pointsBuf.length},r.prototype.destroy=function(n){t.prototype.destroy.call(this,n),this.destroyVb()},r})(Jt);i.RectTileLayer=e})(mt||(mt={}));var mt;(function(i){var e=`
varying vec2 vTextureCoord;
varying vec4 vFrame;
varying float vTextureId;
uniform vec4 shadowColor;
uniform sampler2D uSamplers[%count%];
uniform vec2 uSamplerSize[%count%];

void main(void){
   vec2 textureCoord = clamp(vTextureCoord, vFrame.xy, vFrame.zw);
   float textureId = floor(vTextureId + 0.5);

   vec4 color;
   %forloop%
   gl_FragColor = color;
}
`,t=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aFrame;
attribute vec2 aAnim;
attribute float aTextureId;

uniform mat3 projTransMatrix;
uniform vec2 animationFrame;

varying vec2 vTextureCoord;
varying float vTextureId;
varying vec4 vFrame;

void main(void){
   gl_Position = vec4((projTransMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vec2 anim = aAnim * animationFrame;
   vTextureCoord = aTextureCoord + anim;
   vFrame = aFrame + vec4(anim, anim);
   vTextureId = aTextureId;
}
`,r=(function(o){ke(a,o);function a(l,u,h){var f=o.call(this,new _i(u,h),{animationFrame:new Float32Array(2),uSamplers:[],uSamplerSize:[],projTransMatrix:new Rt})||this;return f.maxTextures=0,f.maxTextures=l,i.shaderGenerator.fillSamplers(f,f.maxTextures),f}return a})(Ge);i.TilemapShader=r;var n=(function(o){ke(a,o);function a(l){var u=o.call(this,l,t,i.shaderGenerator.generateFragmentSrc(l,e))||this;return i.shaderGenerator.fillSamplers(u,u.maxTextures),u}return a})(r);i.RectTileShader=n;var s=(function(o){ke(a,o);function a(){var l=o.call(this)||this;l.vertSize=11,l.vertPerQuad=4,l.stride=l.vertSize*4,l.lastTimeAccess=0;var u=l.buf=new Mt(new Float32Array(2),!0,!1);return l.addAttribute("aVertexPosition",u,0,!1,0,l.stride,0).addAttribute("aTextureCoord",u,0,!1,0,l.stride,8).addAttribute("aFrame",u,0,!1,0,l.stride,16).addAttribute("aAnim",u,0,!1,0,l.stride,32).addAttribute("aTextureId",u,0,!1,0,l.stride,40),l}return a})(Mr);i.RectTileGeom=s})(mt||(mt={}));var mt;(function(i){var e=(function(t){ke(r,t);function r(n){var s=t.call(this,n)||this;return s.sn=-1,s.indexBuffer=null,s.ibLen=0,s.tileAnim=[0,0],s.texLoc=[],s.texResources=[],s.rectShader=new i.RectTileShader(i.Constant.maxTextures),s.indexBuffer=new Mt(void 0,!0,!0),s.checkIndexBuffer(2e3),s.initBounds(),s}return r.prototype.initBounds=function(){if(!(i.Constant.boundCountPerBuffer<=1))for(var n=i.Constant.maxTextures,s=0;s<n;s++){var o=new i.MultiTextureResource(i.Constant),a=new Tt(o);a.scaleMode=i.Constant.SCALE_MODE,a.wrapMode=Ee.CLAMP,this.texResources.push(o)}},r.prototype.bindTexturesWithoutRT=function(n,s,o){var a=s.uniforms.uSamplerSize;this.texLoc.length=0;for(var l=0;l<o.length;l++){var u=o[l];if(!u||!u.valid)return;n.texture.bind(o[l],l),a[l*2]=1/o[l].baseTexture.width,a[l*2+1]=1/o[l].baseTexture.height}s.uniforms.uSamplerSize=a},r.prototype.bindTextures=function(n,s,o){var a=o.length,l=i.Constant.maxTextures;if(!(a>i.Constant.boundCountPerBuffer*l)){if(i.Constant.boundCountPerBuffer<=1){this.bindTexturesWithoutRT(n,s,o);return}for(var u=0;u<a;u++){var h=o[u];if(!(!h||!h.valid)){var f=this.texResources[u>>2];f.setTexture(u&3,h)}}var c=u+3>>2;for(u=0;u<c;u++)n.texture.bind(this.texResources[u].baseTex,u)}},r.prototype.start=function(){},r.prototype.createVb=function(){var n=new i.RectTileGeom;return n.addIndex(this.indexBuffer),n.lastTimeAccess=Date.now(),n},r.prototype.checkIndexBuffer=function(n,s){var o=n*6;o<=this.ibLen||(this.ibLen=o,this.indexBuffer.update(Hl(n,i.Constant.use32bitIndex)))},r.prototype.getShader=function(){return this.rectShader},r.prototype.destroy=function(){t.prototype.destroy.call(this),this.rectShader=null},r})(gi);i.TileRenderer=e,Oe.registerPlugin("tilemap",e)})(mt||(mt={}));var mt;(function(i){var e=(function(t){ke(r,t);function r(n,s){var o=t.call(this)||this;return o._lastAnimationFrame=-1,o.tilemap=n,o.z=s,o}return r.prototype.clear=function(){for(var n=this.children,s=0;s<n.length;s++)n[s].clear();this._previousLayers=0},r.prototype.cacheIfDirty=function(){var n=this.tilemap,s=this.children,o=this._previousLayers!==s.length;this._previousLayers=s.length;var a=this.canvasBuffer,l=this._tempRender;a||(a=this.canvasBuffer=document.createElement("canvas"),l=this._tempRender=new(void 0)(100,100,{view:a}),l.context=l.rootContext,l.plugins.tilemap.dontUseTransform=!0),(a.width!==n._layerWidth||a.height!==n._layerHeight)&&(a.width=n._layerWidth,a.height=n._layerHeight,o=!0);var u;if(!o){for(u=0;u<s.length;u++)if(s[u].isModified(this._lastAnimationFrame!==n.animationFrame)){o=!0;break}}if(this._lastAnimationFrame=n.animationFrame,o)for(n._hackRenderer&&n._hackRenderer(l),l.context.clearRect(0,0,a.width,a.height),u=0;u<s.length;u++)s[u].clearModify(),s[u].renderCanvas(l);for(this.layerTransform=this.worldTransform,u=0;u<s.length;u++){this.layerTransform=s[u].worldTransform;break}},r.prototype.renderCanvas=function(n){this.cacheIfDirty();var s=this.layerTransform;n.context.setTransform(s.a,s.b,s.c,s.d,s.tx*n.resolution,s.ty*n.resolution),this.tilemap,n.context.drawImage(this.canvasBuffer,0,0)},r})(Jt);i.ZLayer=e})(mt||(mt={}));const w_=i=>(i&&Object.isExtensible(i)&&!i.tilemap&&(i.tilemap=mt),mt);var mt;(function(i){(function(e){function t(s,o){for(var a=[],l=0;l<o;l++)a[l]=l;s.uniforms.uSamplers=a;for(var u=[],l=0;l<o;l++)u.push(1/i.Constant.bufferSize),u.push(1/i.Constant.bufferSize);s.uniforms.uSamplerSize=u}e.fillSamplers=t;function r(s,o){return o.replace(/%count%/gi,s+"").replace(/%forloop%/gi,this.generateSampleSrc(s))}e.generateFragmentSrc=r;function n(s){var o="";o+=`
`,o+=`
`,o+="if(vTextureId <= -1.0) {",o+=`
	color = shadowColor;`,o+=`
}`;for(var a=0;a<s;a++)o+=`
else `,a<s-1&&(o+="if(textureId == "+a+".0)"),o+=`
{`,o+=`
	color = texture2D(uSamplers[`+a+"], textureCoord * uSamplerSize["+a+"]);",o+=`
}`;return o+=`
`,o+=`
`,o}e.generateSampleSrc=n})(i.shaderGenerator||(i.shaderGenerator={}))})(mt||(mt={}));const V={...x_};w_(V);V.settings&&(V.settings.CREATE_IMAGE_BITMAP=!1,V.SCALE_MODES&&(V.settings.SCALE_MODE=V.SCALE_MODES.NEAREST));typeof window<"u"&&(window.PIXI=V);var jn={exports:{}},T_=jn.exports,$f;function I_(){return $f||($f=1,(function(i,e){(function(t,r){i.exports=r()})(T_,function(){var t=function(){function r(d){return o.appendChild(d.dom),d}function n(d){for(var p=0;p<o.children.length;p++)o.children[p].style.display=p===d?"block":"none";s=d}var s=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",function(d){d.preventDefault(),n(++s%o.children.length)},!1);var a=(performance||Date).now(),l=a,u=0,h=r(new t.Panel("FPS","#0ff","#002")),f=r(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=r(new t.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:o,addPanel:r,showPanel:n,begin:function(){a=(performance||Date).now()},end:function(){u++;var d=(performance||Date).now();if(f.update(d-a,200),d>l+1e3&&(h.update(1e3*u/(d-l),100),l=d,u=0,c)){var p=performance.memory;c.update(p.usedJSHeapSize/1048576,p.jsHeapSizeLimit/1048576)}return d},update:function(){a=this.end()},domElement:o,setMode:n}};return t.Panel=function(r,n,s){var o=1/0,a=0,l=Math.round,u=l(window.devicePixelRatio||1),h=80*u,f=48*u,c=3*u,d=2*u,p=3*u,m=15*u,v=74*u,g=30*u,I=document.createElement("canvas");I.width=h,I.height=f,I.style.cssText="width:80px;height:48px";var w=I.getContext("2d");return w.font="bold "+9*u+"px Helvetica,Arial,sans-serif",w.textBaseline="top",w.fillStyle=s,w.fillRect(0,0,h,f),w.fillStyle=n,w.fillText(r,c,d),w.fillRect(p,m,v,g),w.fillStyle=s,w.globalAlpha=.9,w.fillRect(p,m,v,g),{dom:I,update:function(M,b){o=Math.min(o,M),a=Math.max(a,M),w.fillStyle=s,w.globalAlpha=1,w.fillRect(0,0,h,m),w.fillStyle=n,w.fillText(l(M)+" "+r+" ("+l(o)+"-"+l(a)+")",c,d),w.drawImage(I,p+u,m,v-u,g,p,m,v-u,g),w.fillRect(p+v-u,m,u,g),w.fillStyle=s,w.globalAlpha=.9,w.fillRect(p+v-u,m,u,l((1-M/b)*g))}}},t})})(jn)),jn.exports}var E_=I_();const S_=yi(E_),Wn=1024,Kn=768,A_=2400,jf=24,C_=100,P_=80,O_=Object.freeze({offsetX:28,offsetY:8,width:138,height:138}),R_=70,F_=69,al=.5,ll=.8,Be=2,Ie=101,iu=200,nu=201,su=202,ou=203,Qe=103,M_=1,We=-1,L_=650,N_=650,B_=500,Wf=5e3,D_=5e3,Qp=5,k_=8,U_=5,cs=40,X_=95e6,Bi=5e5,Kf=2,Zf=1,ty=1,au=2,sn=3,H_=.1,or=0,Xt=1,ey=2,ul=3,qt=4,G_=2,Y_=100,z_=50,Et=0,er=1,Jf=2,V_=200,Kr=300,Qf=412,q_=112,On=401,$_=101,Rn=409,j_=109,Fn=400,W_=100,la=402,K_=102,Mn=411,Z_=111,ua=404,J_=104,ha=405,Q_=105,tc=403,tb=103,ec=410,eb=110,rc=408,rb=108,ic=407,ib=107,nc=406,nb=106,Ki=0,Ss=1,ei=2,Pt=3,oe=4,ri=5,As=6,de=7,Ve=8,Zt=9,we=10,pe=11,lu=12,sc=Object.freeze({[Ve]:40,[Zt]:32,[we]:16,[pe]:40}),oc=Object.freeze({[Ve]:20,[Zt]:8,[we]:16,[pe]:20}),sb={[Ki]:4,[Ss]:4,[ei]:5,[Pt]:20,[oe]:10,[ri]:1,[As]:4,[de]:5,[Ve]:20,[Zt]:10,[we]:5,[pe]:5,[lu]:4},uu=[{key:"CAN_BUILD_HOSPITAL",type:V_,label:"Hospital",icon:12,image:ey,parent:la,initial:Et},{key:"CAN_BUILD_HOUSE",type:Kr,label:"Housing",icon:0,image:ul,parent:0,initial:er},{key:"CAN_BUILD_LASER_RESEARCH",type:Qf,label:"Laser Research",icon:1,image:qt,parent:Kr,initial:er},{key:"CAN_BUILD_LASER_FACTORY",type:q_,label:"Laser Factory",icon:1,image:Xt,parent:Qf,initial:Et},{key:"CAN_BUILD_BAZOOKA_RESEARCH",type:On,label:"Bazooka Research",icon:2,image:qt,parent:Kr,initial:er},{key:"CAN_BUILD_BAZOOKA_FACTORY",type:$_,label:"Bazooka Factory",icon:2,image:Xt,parent:On,initial:Et},{key:"CAN_BUILD_TURRET_RESEARCH",type:Rn,label:"Turret Research",icon:9,image:qt,parent:Kr,initial:er},{key:"CAN_BUILD_TURRET_FACTORY",type:j_,label:"Turret Factory",icon:9,image:Xt,parent:Rn,initial:Et},{key:"CAN_BUILD_CLOAK_RESEARCH",type:Fn,label:"Cloak Research",icon:1,image:qt,parent:On,initial:Et},{key:"CAN_BUILD_CLOAK_FACTORY",type:W_,label:"Cloak Factory",icon:1,image:Xt,parent:Fn,initial:Et},{key:"CAN_BUILD_MEDKIT_RESEARCH",type:la,label:"MedKit Research",icon:3,image:qt,parent:On,initial:Et},{key:"CAN_BUILD_MEDKIT_FACTORY",type:K_,label:"MedKit Factory",icon:3,image:Xt,parent:la,initial:Et},{key:"CAN_BUILD_PLASMA_RESEARCH",type:Mn,label:"Plasma Turret Research",icon:10,image:qt,parent:Rn,initial:Et},{key:"CAN_BUILD_PLASMA_FACTORY",type:Z_,label:"Plasma Turret Factory",icon:10,image:Xt,parent:Mn,initial:Et},{key:"CAN_BUILD_MINE_RESEARCH",type:ua,label:"Mine Research",icon:5,image:qt,parent:Rn,initial:Et},{key:"CAN_BUILD_MINE_FACTORY",type:J_,label:"Mine Factory",icon:5,image:Xt,parent:ua,initial:Et},{key:"CAN_BUILD_ORB_RESEARCH",type:ha,label:"Orb Research",icon:6,image:qt,parent:Fn,initial:Et},{key:"CAN_BUILD_ORB_FACTORY",type:Q_,label:"Orb Factory",icon:6,image:Xt,parent:ha,initial:Et},{key:"CAN_BUILD_BOMB_RESEARCH",type:tc,label:"Time Bomb Research",icon:4,image:qt,parent:Fn,initial:Et},{key:"CAN_BUILD_BOMB_FACTORY",type:tb,label:"Time Bomb Factory",icon:4,image:Xt,parent:tc,initial:Et},{key:"CAN_BUILD_SLEEPER_RESEARCH",type:ec,label:"Sleeper Research",icon:8,image:qt,parent:Mn,initial:Et},{key:"CAN_BUILD_SLEEPER_FACTORY",type:eb,label:"Sleeper Factory",icon:8,image:Xt,parent:ec,initial:Et},{key:"CAN_BUILD_WALL_RESEARCH",type:rc,label:"Wall Research",icon:11,image:qt,parent:Mn,initial:Et},{key:"CAN_BUILD_WALL_FACTORY",type:rb,label:"Wall Factory",icon:11,image:Xt,parent:rc,initial:Et},{key:"CAN_BUILD_DFG_RESEARCH",type:ic,label:"DFG Research",icon:8,image:qt,parent:ua,initial:Et},{key:"CAN_BUILD_DFG_FACTORY",type:ib,label:"DFG Factory",icon:8,image:Xt,parent:ic,initial:Et},{key:"CAN_BUILD_FLARE_RESEARCH",type:nc,label:"Flare Gun Research",icon:7,image:qt,parent:ha,initial:Et},{key:"CAN_BUILD_FLARE_FACTORY",type:nb,label:"Flare Gun Factory",icon:7,image:Xt,parent:nc,initial:Et}],ob=uu.map(i=>({id:i.type,parentid:i.parent??0})),rr=uu.reduce((i,e)=>(i[e.key]={ICON:e.icon,IMAGE:e.image,TYPE:e.type,LABEL:e.label},i),{}),ab=Object.freeze(uu.reduce((i,e)=>(i[e.key]=e.initial??Et,i),{})),di={0:{name:"Balkh",tileX:415,tileY:479},1:{name:"Iqaluit",tileX:351,tileY:479},2:{name:"Reykjavik",tileX:287,tileY:479},3:{name:"Jumarity",tileX:223,tileY:479},4:{name:"Helsinki",tileX:159,tileY:479},5:{name:"Copenhagen",tileX:95,tileY:479},6:{name:"Kiev",tileX:31,tileY:479},7:{name:"Barentsburg",tileX:479,tileY:478},8:{name:"Nunivak",tileX:415,tileY:415},9:{name:"Algiers",tileX:351,tileY:415},10:{name:"Paga Pago",tileX:287,tileY:415},11:{name:"St. Johns",tileX:223,tileY:415},12:{name:"Parana",tileX:159,tileY:415},13:{name:"San Salvador de Jujuy",tileX:95,tileY:415},14:{name:"Tallinn",tileX:31,tileY:415},15:{name:"Bergen",tileX:479,tileY:414},16:{name:"Bangui",tileX:415,tileY:351},17:{name:"Annaba",tileX:351,tileY:351},18:{name:"Andorra-la-Vella",tileX:287,tileY:351},19:{name:"Bahia Blanca",tileX:223,tileY:351},20:{name:"Posadas",tileX:159,tileY:351},21:{name:"Santa Fe",tileX:95,tileY:351},22:{name:"Buckland",tileX:31,tileY:351},23:{name:"Kabul",tileX:479,tileY:350},24:{name:"Lahij",tileX:415,tileY:287},25:{name:"Banta",tileX:351,tileY:287},26:{name:"Benguela",tileX:287,tileY:287},27:{name:"Buenos Aires",tileX:223,tileY:287},28:{name:"Resistencia",tileX:159,tileY:287},29:{name:"Santiago del Estero",tileX:95,tileY:287},30:{name:"Armidale",tileX:31,tileY:287},31:{name:"Harbin",tileX:479,tileY:286},32:{name:"Fajardo",tileX:415,tileY:223},33:{name:"Blida",tileX:351,tileY:223},34:{name:"Huambo",tileX:287,tileY:223},35:{name:"Cordoba",tileX:223,tileY:223},36:{name:"Rio Cuarto",tileX:159,tileY:223},37:{name:"Kumayari",tileX:95,tileY:223},38:{name:"Kuala Lumpur",tileX:31,tileY:223},39:{name:"Mango",tileX:479,tileY:222},40:{name:"Arequipa",tileX:415,tileY:159},41:{name:"Constantine",tileX:351,tileY:159},42:{name:"Luanda",tileX:287,tileY:159},43:{name:"Corrientes",tileX:223,tileY:159},44:{name:"Rosario",tileX:159,tileY:159},45:{name:"Kirovakan",tileX:95,tileY:159},46:{name:"Jakarta",tileX:31,tileY:159},47:{name:"Skopje",tileX:479,tileY:158},48:{name:"Bogota",tileX:415,tileY:95},49:{name:"Canberra",tileX:351,tileY:95},50:{name:"Pretoria",tileX:287,tileY:95},51:{name:"Maracay",tileX:223,tileY:95},52:{name:"Cambridge",tileX:159,tileY:95},53:{name:"Laketown",tileX:95,tileY:95},54:{name:"Hanoi",tileX:31,tileY:95},55:{name:"Bishkek",tileX:479,tileY:94},56:{name:"Tirana",tileX:479,tileY:31},57:{name:"Dakar",tileX:415,tileY:31},58:{name:"Aquin",tileX:351,tileY:31},59:{name:"Bismarck",tileX:287,tileY:31},60:{name:"Albany",tileX:223,tileY:31},61:{name:"Manukau",tileX:159,tileY:31},62:{name:"Utrecht",tileX:95,tileY:31},63:{name:"Admin Inn",tileX:31,tileY:31}},Di=48,lb=3,ub=2,hb=Di/2,fb=48,ac=fb/2,cb=6.5,db=5.5,ry=i=>{if(i==null)return null;const e=Number(i);return Number.isFinite(e)?String(Math.max(0,Math.floor(e))):null},pb=i=>{if(!i||typeof i!="object")return null;const e=Number(i.pixelX),t=Number(i.pixelY),r=Number(i.tileX),n=Number(i.tileY),s=Number.isFinite(e),o=Number.isFinite(t),a=Number.isFinite(r),l=Number.isFinite(n);if(s&&o)return{x:e,y:t,tileX:a?r:null,tileY:l?n:null};if(a&&l){const u=r*Di,h=n*Di,f=u+lb*Di/2,c=h+ub*Di+hb;return{x:f-ac-cb,y:c-ac-db,tileX:r,tileY:n}}return{x:0,y:0,tileX:a?r:null,tileY:l?n:null}},Cs=i=>{const e=ry(i);if(e===null)return null;const t=di?.[e],r=pb(t);if(!r)return null;const n=t?.name||`City ${Number(e)+1}`;return{...r,name:n}},Ft=i=>{const e=ry(i);if(e!==null){const r=di?.[e];if(r?.name)return r.name}const t=Number(i);return Number.isFinite(t)?`City ${Math.max(1,Math.floor(t)+1)}`:"City"},yb=(i,e,t=3)=>{const r=Number(i),n=Number(e);if(!Number.isFinite(r)||!Number.isFinite(n))return null;let s=null,o=1/0;if(Object.keys(di||{}).forEach(l=>{const u=di[l];if(!u)return;const h=Number(u.tileX),f=Number(u.tileY);if(!Number.isFinite(h)||!Number.isFinite(f))return;const c=Math.abs(h-r),d=Math.abs(f-n),p=Math.max(c,d);if(!(p>t)){if(p<o)o=p,s=l;else if(p===o){const m=Number(s),v=Number(l);Number.isFinite(v)&&(!Number.isFinite(m)||v<m)&&(s=l)}}}),s==null)return null;const a=Number(s);return Number.isFinite(a)?a:null};function vb(i){for(var e=0;e<512;e++){i.map[e]=[];for(var t=0;t<512;t++)i.map[e][t]=0}}function mb(i){for(var e=0;e<512;e++){i.tiles[e]=[];for(var t=0;t<512;t++)i.tiles[e][t]=0}}function gb(i,e){const r=new Uint8Array(e);for(let n=0;n<512;n++)for(let s=0;s<512;s++){const o=511-n,a=511-s;i.map[n][s]=r[o+a*512]}for(let n=0;n<i.map.length;n++)for(let s=0;s<i.map.length;s++)if(i.map[s][n]===sn){const o=yb(s,n);i.buildingFactory.newBuilding(null,s,n,or,{notifyServer:!1,city:o??0,updateCity:!1,itemsLeft:0})}else if(i.map[s][n]===ty||i.map[s][n]===au){const o=i.map[s][n],a=s===0||i.map[s-1][n]!==o?1:0,l=s===511||i.map[s+1][n]!==o?1:0,u=n===0||i.map[s][n-1]!==o?1:0,h=n===511||i.map[s][n+1]!==o?1:0;i.tiles[s][n]=(a+l*2+h*4+u*8)*48}}const _b=(i,e)=>{vb(i),mb(i),gb(i,e)},bb=[{cityId:55,name:"Sentinel Anchorage"},{cityId:56,name:"Bastion Ridge"},{cityId:57,name:"Citadel Spire"},{cityId:58,name:"Rampart Cove"},{cityId:59,name:"Bulwark Flats"},{cityId:60,name:"Outrider Yard"}],lc={cities:bb},xb=()=>({...ab}),wb=()=>({canBuild:xb(),cash:X_,income:0,itemProduction:0,research:0,hospital:0,construction:0,grossIncome:0});function Tb(i){if(!i||!Array.isArray(i.cities))return;(Array.isArray(lc?.cities)?lc.cities:[]).forEach(t=>{const r=Number(t?.cityId);if(!Number.isFinite(r))return;const n=i.cities[r];n&&(t?.name&&(n.name=t.name),n.isFakeCandidate=!0)})}function Ib(i){i.cities=[],Object.keys(di||{}).forEach(e=>{const t=Number(e);if(!Number.isFinite(t))return;const r=di[e],n=Cs(t),s=wb();s.id=t;const o=Number(r?.tileX),a=Number(r?.tileY),l=Number.isFinite(o)?o:n?.tileX??0,u=Number.isFinite(a)?a:n?.tileY??0;s.tileX=l,s.tileY=u,s.x=l*48,s.y=u*48,s.name=Ft(t),i.cities[t]=s})}const Eb=i=>{Ib(i),Tb(i)},ar=(i,e)=>{if(!i||!e)return!1;const t=i.x,r=i.y,n=t+i.w,s=r+i.h,o=e.x,a=e.y,l=o+e.w,u=a+e.h;return!(n<=o||l<=t||s<=a||u<=r)},iy=i=>i.x<0?iu:i.x>510*48?nu:i.y<0?su:i.y>510*48?ou:!1,ny=(i,e)=>{var t=i.itemFactory.getHead();const r=i.player?.city??null;for(;t;){var n={x:t.x,y:t.y,w:48,h:48};if(ar(e,n)){if(t.type===oe&&t.active!==!1){const s=t.teamId??null;if(s===null||s!==r)return i.player.collidedItem=t,Ie}else if(t.type===de&&t.active!==!1){const s=t.teamId??t.city??null;if(s===null||s!==r)return i.player.collidedItem=t,Qe}else if(t.active!==!1&&t.type!==de)return Be}t=t.next}return!1},sy=(i,e)=>{var t=i.map,r=Math.floor(e.x/48),n=Math.floor((e.x+e.w)/48),s=Math.floor(e.y/48),o=Math.floor((e.y+e.h)/48);if(r&&n&&s&&o)try{if(t[r][s]!=0&&t[r][s]!=3||t[r][o]!=0&&t[r][o]!=3||t[n][s]!=0&&t[n][s]!=3||t[n][o]!=0&&t[n][o]!=3)return Be}catch{console.error("Invalid map reference")}return!1},Or=i=>{var e=8;return{x:parseInt(i.offset.x+e),y:parseInt(i.offset.y+e),w:48-e-e,h:48-e-e}};var Sb=(i,e)=>{for(var t=i.buildingFactory.getHead();t;){var r={x:t.x*48,y:t.y*48,w:144,h:144};if((t.type==0||parseInt(t.type/100)==1)&&(r.h=r.h-48),ar(e,r))return Be;t=t.next}return!1};const Me=i=>{var e=Or(i.player);i.player.collidedItem=null;var t=iy(e);return t||(t=sy(i,e)),t||(t=Sb(i,e)),t||(t=ny(i,e)),t},$r=48,oy=12,Ab=new Set([Be,iu,nu,su,ou]),ay=[{dx:1,dy:0},{dx:-1,dy:0},{dx:0,dy:1},{dx:0,dy:-1},{dx:1,dy:1},{dx:-1,dy:1},{dx:1,dy:-1},{dx:-1,dy:-1}],uc=6,Cb=96,Te=i=>{!i||!i.player||(i.player.lastSafeOffset={x:i.player.offset.x,y:i.player.offset.y})},_r=i=>Ab.has(i),tr=(i,e)=>{e&&(i.itemFactory.triggerMine(e),i.forceDraw=!0,i.player.collidedItem=null)},br=(i,e)=>{e&&(typeof i.itemFactory?.triggerDFG=="function"&&i.itemFactory.triggerDFG(e),i.player.collidedItem=null)};var Pb=i=>{i.tick>i.player.timeTurn&&(i.player.direction+=i.player.isTurning,i.player.direction<0&&(i.player.direction=31),i.player.direction>31&&(i.player.direction=0),i.player.timeTurn=i.tick+50)},Ob=i=>{i.player.offset.x,i.player.offset.y;var e=-i.player.direction,t=Math.sin(e/16*3.14)*i.player.isMoving*(i.timePassed*al);t>20&&(t=20),t<-20&&(t=-20);var r=i.player.offset.x;switch(i.player.offset.x+=t,Me(i)){case iu:i.player.offset.x=0;break;case nu:i.player.offset.x=511*48;break;case Be:i.player.offset.x=r;break;case Ie:tr(i,i.player.collidedItem);break;case Qe:br(i,i.player.collidedItem);break}t=Math.cos(e/16*3.14)*i.player.isMoving*(i.timePassed*al),t>20&&(t=20),t<-20&&(t=-20);var r=i.player.offset.y;switch(i.player.offset.y+=t,Me(i)){case su:i.player.offset.y=0;break;case ou:i.player.offset.y=511*48;break;case Be:i.player.offset.y=r;break;case Ie:tr(i,i.player.collidedItem);break;case Qe:br(i,i.player.collidedItem);break}i&&i.debug&&i.debug.logMovement};const Rb=(i,e)=>{for(let t=uc;t<=Cb;t+=uc)for(const r of ay){const n=e.x+r.dx*t,s=e.y+r.dy*t;i.player.offset.x=n,i.player.offset.y=s;const o=Me(i);if(o===Ie)return tr(i,i.player.collidedItem),Te(i),!0;if(!_r(o))return Te(i),!0}return!1},hc=(i,e,t=oy)=>{if(!i||!i.player||!Array.isArray(i.map))return null;const r=i.map.length,n=r>0&&Array.isArray(i.map[0])?i.map[0].length:0;if(r===0||n===0)return null;const s=Math.floor((e.x+$r/2)/$r),o=Math.floor((e.y+$r/2)/$r),a=[{x:s,y:o,distance:0}],l=new Set,u={x:i.player.offset.x,y:i.player.offset.y},h=i.player.collidedItem;for(;a.length;){const f=a.shift(),c=`${f.x},${f.y}`;if(l.has(c)||(l.add(c),f.distance>t)||f.x<0||f.y<0||f.x>=r||f.y>=n)continue;const d={x:f.x*$r,y:f.y*$r};i.player.offset.x=d.x,i.player.offset.y=d.y;const p=Me(i),m=i.player.collidedItem;if(i.player.offset.x=u.x,i.player.offset.y=u.y,i.player.collidedItem=h,p!==Ie){if(!_r(p))return{offset:d,collision:p,collidedItem:m}}ay.forEach(({dx:v,dy:g})=>{const I={x:f.x+v,y:f.y+g,distance:f.distance+1},w=`${I.x},${I.y}`;l.has(w)||a.push(I)})}return null},Fb=i=>{if(!i||!i.player)return;const e=Cs(i.player.city);if(e){i.player.offset.x=e.x,i.player.offset.y=e.y;return}const t=i.cities?.[i.player.city];if(t){i.player.offset.x=t.x+48,i.player.offset.y=t.y+100;return}i.player.offset.x=0,i.player.offset.y=0},Mb=i=>{if(!i||!i.player)return;const e=Me(i);if(e===Ie){tr(i,i.player.collidedItem);return}if(e===Qe){br(i,i.player.collidedItem);return}if(!_r(e)){Te(i);return}const t={x:i.player.offset.x,y:i.player.offset.y},r=i.player.lastSafeOffset?{...i.player.lastSafeOffset}:null;if(Rb(i,t))return;const n=hc(i,t);if(n){i.player.offset.x=n.offset.x,i.player.offset.y=n.offset.y;const a=Me(i);if(a===Ie){tr(i,i.player.collidedItem);return}if(a===Qe){br(i,i.player.collidedItem);return}if(!_r(a)){Te(i);return}}if(r&&(r.x!==t.x||r.y!==t.y)){i.player.offset.x=r.x,i.player.offset.y=r.y;const a=Me(i);if(a===Ie){tr(i,i.player.collidedItem),Te(i);return}if(a===Qe){br(i,i.player.collidedItem),Te(i);return}if(!_r(a)){Te(i);return}}i.player.offset.x=t.x,i.player.offset.y=t.y,Fb(i);const s=Me(i);if(s===Ie){tr(i,i.player.collidedItem);return}if(s===Qe){br(i,i.player.collidedItem);return}if(!_r(s)){Te(i);return}const o=hc(i,i.player.offset,oy*2);if(o){i.player.offset.x=o.offset.x,i.player.offset.y=o.offset.y;const a=Me(i);if(a===Ie){tr(i,i.player.collidedItem);return}if(a===Qe){br(i,i.player.collidedItem);return}if(!_r(a)){Te(i);return}}ly(i)};var ly=i=>{i.player.offset.x=0,i.player.offset.y=0,Te(i)};const Lb=i=>{const e=i.tick||Date.now();i.player.isCloaked&&i.player.cloakExpiresAt&&e>=i.player.cloakExpiresAt&&(i.player.isCloaked=!1,i.player.cloakExpiresAt=0,i.forceDraw=!0);let t=!1;i.player.isFrozen&&(!i.player.frozenUntil||e>=i.player.frozenUntil?(i.player.isFrozen=!1,i.player.frozenUntil=0,i.player.frozenBy=null):t=!0),i.player.isTurning&&Pb(i),!t&&i.player.isMoving?Ob(i):t&&(i.player.isMoving=0),t||Mb(i),i.player.health===0&&ly(i)},Nb=new Set([Zt,pe,we]);var Ln=0;const fa=(i,e)=>{if(!i||!i.player||i.player.id===void 0||i.player.id===null||!i.iconFactory||typeof i.iconFactory.findOwnedIconByType!="function")return!1;const t=i.iconFactory.findOwnedIconByType(i.player.id,e);if(!t)return!1;if(t.quantity===void 0||t.quantity===null)return!0;const r=Number.isFinite(t.quantity)?t.quantity:parseInt(t.quantity,10);return Number.isFinite(r)?r>0:!0};var ne=i=>{var e={};return e.code=i,e.isDown=!1,e.isUp=!0,e.press=void 0,e.release=void 0,e.downHandler=function(t){t.keyCode===e.code&&(e.isUp&&e.press&&e.press(),e.isDown=!0,e.isUp=!1),t.preventDefault()},e.upHandler=function(t){t.keyCode===e.code&&(e.isDown&&e.release&&e.release(),e.isDown=!1,e.isUp=!0),t.preventDefault()},window.addEventListener("keydown",e.downHandler.bind(e),!1),window.addEventListener("keyup",e.upHandler.bind(e),!1),e};const Bb=i=>{var e=ne(37),t=ne(38),r=ne(39),n=ne(40),s=ne(16),o=ne(17),a=ne(85);ne(79);var l=ne(68),u=ne(83),h=ne(66),f=ne(72),c=ne(67);e.press=function(){i.player.isTurning=-1},e.release=function(){i.player.isTurning=0},r.press=function(){i.player.isTurning=1},r.release=function(){i.player.isTurning=0},t.press=function(){i.player.isMoving=-1},t.release=function(){i.player.isMoving=0},n.press=function(){i.player.isMoving=1},n.release=function(){i.player.isMoving=0},a.press=function(){i.iconFactory.pickupIcon()},u.press=function(){console.log("Generating building output"),i.buildingFactory.outputBuildings()},l.press=function(){var d=i.iconFactory.dropSelectedIcon(),p,m,v=-i.player.direction,g=Math.sin(v/16*3.14)*-1,I=Math.cos(v/16*3.14)*-1;if(d&&Nb.has(d.type))p=i.player.offset.x+12,m=i.player.offset.y+24;else{var v=-i.player.direction,g=Math.sin(v/16*3.14)*-1,I=Math.cos(v/16*3.14)*-1;p=i.player.offset.x+g*20,m=i.player.offset.y+20+I*20}if(d){var w=i.itemFactory.newItem(d,p,m,d.type);w&&(i.player.offset.x+=30,i.player.offset.x+=30),w||i.iconFactory.newIcon(null,parseInt(p),parseInt(m),d.type,{skipProductionUpdate:!0,teamId:i.player.city??null,city:i.player.city??null})}},h.press=function(){if(i.iconFactory&&typeof i.iconFactory.getSelectedIcon=="function"){const d=i.iconFactory.getSelectedIcon(i.player.id);if(d&&d.type===Pt){d.armed=!d.armed,d.selected||(d.selected=!0),i.player.bombsArmed=d.armed,i.forceDraw=!0,console.log(`Bombs ${d.armed?"activated":"deactivated"}`);return}}i.player.bombsArmed=!i.player.bombsArmed,console.log(`Bombs ${i.player.bombsArmed?"activated":"deactivated"}`)},f.press=function(){!i?.itemFactory||typeof i.itemFactory.useMedkit!="function"||i.itemFactory.useMedkit()},c.press=function(){!i?.itemFactory||typeof i.itemFactory.activateCloak!="function"||i.itemFactory.activateCloak()},o.press=function(){if(!fa(i,As)||i.tick<=Ln||!i||!i.player||i.player.isFrozen&&(i.player.frozenUntil??0)>i.tick)return;const d=Math.round(i.player.direction)%32,p=(d+16+32)%32,m=(d+20+32)%32,v=(d+12+32)%32,g=[m,p,v],w=p/32*360*Math.PI/180,M=Math.sin(w),b=Math.cos(w)*-1,R=i.player.offset.x+24+M*30,C=i.player.offset.y+24+b*30,H=i.player.city??null;Ln=i.tick+B_,g.forEach(F=>{const B={shooter:i.player.id,x:R,y:C,type:3,angle:-F,team:H};i.bulletFactory.newBullet(i.player.id,R,C,3,-F,H),i.socketListener.sendBulletShot(B)})},s.press=function(){if(i?.player?.isFrozen&&(i.player.frozenUntil??0)>(i.tick||Date.now()))return;const d=fa(i,Ss),p=fa(i,lu),m=(i?.player?.isMoving??0)===0,v=d&&m;if(!v&&!p){console.log(d&&!m?"Cougar Missiles only fire while stationary.":"Weapon unavailable: pick up a Laser or Cougar Missile.");return}const g=v?N_:L_,I=v?1:0;if(console.log("shift key pressed"),i.tick>Ln){Ln=i.tick+g;var w=i.player.direction,M=w/32*360,b=Math.sin(M*3.14/180),R=Math.cos(M*3.14/180)*-1,C=i.player.offset.x+24+b*30,H=i.player.offset.y+24+R*30;const F=i.player.city??null;i.bulletFactory.newBullet(i.player.id,C,H,I,-w,F),i.socketListener.sendBulletShot({shooter:i.player.id,x:C,y:H,type:I,angle:-w,team:F})}}},Db=i=>{let e=new V.Container;e.hitArea=new V.Rectangle(0,0,i.maxMapX,i.maxMapY),e.interactive=!0,e.cursor="cursor",i.stage.addChild(e),i.interactionLayer=e,e.on("mousedown",t=>{if(console.log("Got mouse down event"),i.isBuilding&&i.isDragging){var r=Math.floor(i.player.offset.x%48),n=Math.floor(i.player.offset.y%48),s=Math.floor((i.player.offset.x-i.player.defaultOffset.x+r+t.data.global.x)/48),o=Math.floor((i.player.offset.y-i.player.defaultOffset.y+n+t.data.global.y)/48);i.buildingFactory.newBuilding(i.player.id,s,o,i.isBuilding)&&(i.map[s][o]=sn,i.tiles[s][o]=i.isBuilding,i.forceDraw=!0,i.clearGhostBuilding&&i.clearGhostBuilding());return}if(i.isDemolishing||(i.showBuildMenu=!i.showBuildMenu,i.forceDraw=!0,i.buildMenuOffset={x:t.data.global.x,y:t.data.global.y}),i.isDemolishing){console.log("Trying to demolish building");var a=Math.floor(i.player.offset.x%48),l=Math.floor(i.player.offset.y%48),u=Math.floor((i.player.offset.x-i.player.defaultOffset.x+a+t.data.global.x)/48),h=Math.floor((i.player.offset.y-i.player.defaultOffset.y+l+t.data.global.y)/48);i.buildingFactory.demolishBuilding(u,h),i.isDemolishing=!1,i.stage.cursor="cursor",i.interactionLayer.cursor="cursor"}}),e.on("rightdown",t=>{t.stopPropagation&&t.stopPropagation(),t.data&&t.data.originalEvent&&t.data.originalEvent.preventDefault&&t.data.originalEvent.preventDefault(),i.isBuilding&&i.clearGhostBuilding&&i.clearGhostBuilding(),i.isDemolishing&&(i.isDemolishing=!1,i.stage.cursor="cursor",i.interactionLayer.cursor="cursor");const r=t&&t.data?t.data.global:null;if(!r){typeof i.clearPanelMessage=="function"&&i.clearPanelMessage();return}if(r.x<0||r.y<0||r.x>i.maxMapX||r.y>i.maxMapY){typeof i.clearPanelMessage=="function"&&i.clearPanelMessage();return}const n=Math.floor(i.player.offset.x%48),s=Math.floor(i.player.offset.y%48),o=Math.floor((i.player.offset.x-i.player.defaultOffset.x+n+r.x)/48),a=Math.floor((i.player.offset.y-i.player.defaultOffset.y+s+r.y)/48),l=i.buildingFactory,u=l&&l.findBuildingAtTile?l.findBuildingAtTile(o,a):null;if(!u){typeof i.clearPanelMessage=="function"&&i.clearPanelMessage();return}const h=Number.isFinite(u.city)?u.city:parseInt(u.city,10),f=Number.isFinite(h)?h:0;i.socketListener&&typeof i.socketListener.requestCityInfo=="function"&&i.socketListener.requestCityInfo(f),typeof i.showCityInfo=="function"&&i.showCityInfo(f,{source:"local",building:u})}),typeof window<"u"&&(window.__battlecityContextMenuHandler||(window.__battlecityContextMenuHandler=t=>{const r=document.getElementById("game");r&&r.contains(t.target)&&t.preventDefault()},window.addEventListener("contextmenu",window.__battlecityContextMenuHandler)))};var fc=0,cc=0,dc=0,pc=0;const uy=(i,e)=>{var t=i.player.offset.x%128,r=i.player.offset.y%128;if(i.player.offset.x/128>cc||i.player.offset.x/128<fc||i.player.offset.y/128>pc||i.player.offset.y/128<dc){fc=i.player.offset.x/128-5,cc=i.player.offset.x/128+5,dc=i.player.offset.y/128-5,pc=i.player.offset.y/128+5,e.clear();for(var n=-12;n<12;n++)for(var s=-12;s<12;s++)e.addFrame(i.textures.groundTexture,n*128,s*128);e.position.set(i.player.defaultOffset.x+i.player.offset.x-t,i.player.defaultOffset.y+i.player.offset.y-r)}e.pivot.set(i.player.offset.x,i.player.offset.y)};var hy=0,fy=0,cy=0,dy=0;const ct=48,Nn=24,Zr=40,kb=Object.freeze({fontFamily:"Arial",fontSize:14,fontWeight:"bold",fill:15922943,align:"center",stroke:0,strokeThickness:4,lineHeight:16,wordWrap:!0,wordWrapWidth:120}),Ub=2,Xb=-32,Hb=i=>{if(i.tileLayer||(i.tileLayer=new V.tilemap.CompositeRectTileLayer(0,null,!0),i.addChild(i.tileLayer)),i.edgeOverlay)i.edgeOverlay.parent||i.addChild(i.edgeOverlay);else{const e=new V.Graphics;e.alpha=1,i.edgeOverlay=e,i.addChild(e)}if(!i.commandCenterLabelLayer){const e=new V.Container;e.name="commandCenterLabelLayer",i.commandCenterLabelLayer=e,i.addChild(e)}};var Gb=(i,e,t,r,n,s)=>{var o=new V.Texture(i.textures.lavaTexture.baseTexture,new V.Rectangle(i.tiles[n][s],0,ct,ct));e.addFrame(o,t*ct,r*ct)},Yb=(i,e,t,r,n,s)=>{var o=new V.Texture(i.textures.rockTexture.baseTexture,new V.Rectangle(i.tiles[n][s],0,ct,ct));e.addFrame(o,t*ct,r*ct)},zb=(i,e,t,r,n,s)=>{var o=i.tiles[n][s],a=o%100,l=parseInt(o/100,10);const u=i.buildingFactory.getBuildingByCoord(n,s);var h=new V.Texture(i.textures.buildings.baseTexture,new V.Rectangle(0,l*144,144,144,144));e.addFrame(h,t*ct,r*ct,1,0);let f=null;try{f=new V.Texture(i.textures.imageItems.baseTexture,new V.Rectangle(a*32,0,32,32))}catch{f=null}if(f)switch(l){case qt:e.addFrame(f,t*ct+14,r*ct+98);break;case Xt:e.addFrame(f,t*ct+56,r*ct+52);break}if(u&&u.population>0&&i.textures.population){const c=ct,d=ct,m=7-1,v=u?Math.floor(Number(u.type)/100):l,g=v===ul,I=v===or,w=g?Y_:z_;if(w>0){const M=Math.max(0,Math.min(w,u.population)),R=Math.min(m,Math.floor(M*m/w)),C=I?1:0,H=new V.Texture(i.textures.population.baseTexture,new V.Rectangle(R*c,C*d,c,d)),F={[or]:{x:96,y:49},[Xt]:{x:96,y:48},[ey]:{x:96,y:48},[ul]:{x:96,y:90},[qt]:{x:96,y:90}},{x:B=96,y:Y=48}=F[v]||F[l]||{x:96,y:48},D=t*ct+B,J=r*ct+Y;e.addFrame(H,D,J)}}if(l===Xt&&u&&u.smokeActive&&i.textures.smoke){const c=Math.max(0,(u.smokeFrame||1)-1),d=new V.Texture(i.textures.smoke.baseTexture,new V.Rectangle(0,c*60,180,60)),p=t*ct+6,m=r*ct-15;e.addFrame(d,p,m)}if(l===Xt&&u&&typeof u.itemsLeft=="number"&&i.textures.blackNumbers){const c=Math.max(0,Math.min(99,Math.floor(u.itemsLeft))),d=Math.floor(c/10),p=c%10,m=(v,g)=>{const I=new V.Texture(i.textures.blackNumbers.baseTexture,new V.Rectangle(v*16,0,16,16));e.addFrame(I,t*ct+g,r*ct+84)};m(d,56),m(p,72)}};const yc=(i,e=0)=>{const t=Number(i);return Number.isFinite(t)?t:e},Vb=i=>{if(!i||!i.buildingFactory)return;const e=i.commandCenterLabelLayer;if(!e)return;i.commandCenterLabelCache||(i.commandCenterLabelCache=new Map);const t=i.commandCenterLabelCache,r=new Set,n=Number.isFinite(i.player?.offset?.x)?i.player.offset.x:0,s=Number.isFinite(i.player?.offset?.y)?i.player.offset.y:0,o=Number.isFinite(i.player?.defaultOffset?.x)?i.player.defaultOffset.x:0,a=Number.isFinite(i.player?.defaultOffset?.y)?i.player.defaultOffset.y:0,l=o-n,u=a-s;let h=typeof i.buildingFactory.getHead=="function"?i.buildingFactory.getHead():null;for(;h;){const f=Number(h.type),c=Number.isFinite(f)?Math.floor(f/100):null;if(f===or||c===or){const p=h.id||`${h.x}_${h.y}`;r.add(p);const m=yc(h.x,0),v=yc(h.y,0),g=(m+1.5)*ct,I=(v+1.5)*ct,w=g+l,M=I+u,b=Ft(h.city??0),R=Math.abs(g-n)<=Zr*ct&&Math.abs(I-s)<=Zr*ct;let C=t.get(p);if(C)C.text!==b&&(C.label.text=b,C.text=b);else{const H=new V.Text(b,kb);H.anchor.set(.5),H.resolution=Ub,e.addChild(H),C={label:H,text:b},t.set(p,C)}C.label.visible=R,C.label.x=w,C.label.y=M+Xb}h=h.next}t.forEach((f,c)=>{r.has(c)||(f&&f.label&&(f.label.parent&&f.label.parent.removeChild(f.label),f.label.destroy()),t.delete(c))})},qb=i=>{if(!i?.commandCenterLabelCache)return;const e=i.commandCenterLabelCache,t=i.tick||Date.now();e.forEach((r,n)=>{if(!r||!r.label){e.delete(n);return}!r.label.visible&&r.lastHiddenAt&&t-r.lastHiddenAt>1e3?(r.label.parent&&r.label.parent.removeChild(r.label),r.label.destroy(),e.delete(n)):r.label.visible?r.lastHiddenAt&&(r.lastHiddenAt=null):r.lastHiddenAt=t})};var $b=i=>{const e=i.player.offset.x/ct,t=i.player.offset.y/ct;hy=e-Nn,fy=e+Nn,cy=t-Nn,dy=t+Nn},jb=i=>{if(i.forceDraw)return!0;const e=i.player.offset.x/ct,t=i.player.offset.y/ct;return e>=fy||e<=hy||t>=dy||t<=cy};const py=(i,e)=>{if(!i||!e||!i.map||!i.map.length)return;Hb(e),Vb(i);const t=e.tileLayer,r=e.edgeOverlay;if(!(!t||!r)){var n=Math.floor(i.player.offset.x%ct),s=Math.floor(i.player.offset.y%ct);if(jb(i)){$b(i),t.clear(),r.clear(),r.beginFill(0,1);for(var o=Math.floor(i.player.offset.x/ct),a=Math.floor(i.player.offset.y/ct),l=i.map.length,u=Array.isArray(i.map[0])?i.map[0].length:0,h=-Zr;h<Zr;h++)for(var f=-Zr;f<Zr;f++){var c=o+h,d=a+f;if(c<0||d<0||c>=l||d>=u){r.drawRect(h*ct,f*ct,ct,ct);continue}i.map[c][d]==ty&&Gb(i,t,h,f,c,d),i.map[c][d]==au&&Yb(i,t,h,f,c,d),i.map[c][d]>=sn&&zb(i,t,h,f,c,d)}r.endFill(),e.position.set(i.player.defaultOffset.x+i.player.offset.x-n,i.player.defaultOffset.y+i.player.offset.y-s)}e.pivot.set(i.player.offset.x,i.player.offset.y),qb(i)}},vc={small:{frameSize:48,totalFrames:10,duration:100,textureKey:"imageSExplosion",fallbackKey:"imageLEExplosion"},large:{frameSize:144,totalFrames:8,duration:90,textureKey:"imageLEExplosion",fallbackKey:"imageSExplosion"}},Wb=100,Kb=-6,Bn=Object.freeze({ally:15922943,enemy:16765286,rogue:16743034,neutral:16777215}),Zb=15e3,hl=i=>{const e=Number(i);return Number.isFinite(e)?Math.max(0,Math.floor(e)):null},Jb=(i,e)=>{if(!e)return null;if(typeof e.callsign=="string"&&e.callsign.trim().length)return e.callsign.trim();if(e.id&&typeof i?.resolveCallsign=="function"){const t=i.resolveCallsign(e.id);if(typeof t=="string"&&t.trim().length)return t.trim()}return null},Qb=(i,e,t={})=>{const r=Jb(i,e),n=hl(e?.city),s=Number.isFinite(n)?Ft(n):null,o=t.isRogue===!0||e?.city===-1,a=!!e?.isMayor;let l;o?l="Rogue":a?l="Mayor":l="Recruit";const u=r||"Unit";return o?`${l} ${u}`:s?`${l} ${u} of ${s}`:`${l} ${u}`},tx=(i,e,t={})=>{if(t.isRogue)return Bn.rogue;const r=hl(i?.city),n=hl(e);return r!==null&&n!==null&&r===n?Bn.ally:r===null?Bn.neutral:Bn.enemy},ex=i=>i?(i.__nameLabelCache||(i.__nameLabelCache=new Map),i.__nameLabelCache):null,rx=(i,e={})=>e.cacheKey?e.cacheKey:i&&i.id!==void 0&&i.id!==null?`entity:${i.id}`:i&&i.callsign?`callsign:${i.callsign}`:null,ix=(i,e,t={})=>{const r=ex(i);if(!r||!e)return null;const n=rx(e,t);if(!n)return null;const s=Qb(i,e,t);if(!s||!s.trim())return null;const o=tx(e,t.referenceCity,t);let a=r.get(n);if(a)a.text!==s&&(a.label.text=s,a.text=s),a.fillColor!==o&&(a.label.style.fill=o,a.fillColor=o,a.label.dirty=!0);else{const l=new V.Text(s,{fontFamily:"Arial",fontSize:12,fontWeight:"bold",fill:o,align:"center",stroke:0,strokeThickness:3});l.anchor.set(.5,1),a={label:l,text:s,fillColor:o},r.set(n,a)}return a.lastUsedTick=i.tick||Date.now(),a.label},hu=(i,e,t,r={})=>{if(!t||!e)return;const n=ix(i,e,r);n&&(n.parent!==t&&t.addChild(n),n.x=t.width/2,n.y=-t.height/2-Kb)},nx=(i,e)=>{if(!i)return 0;const t=!!i.isMayor;return typeof i.tank=="number"?i.tank:e&&i.id===e.id||(e&&i.city!==void 0?i.city===e.city:!0)?t?1:0:t?3:2},fu=(i,e,t)=>{const r=e?.direction||0,n=nx(e,t),s=new V.Texture(i.textures.tankTexture.baseTexture,new V.Rectangle(Math.floor(r/2)*48,n*48,48,48));return new V.Sprite(s)};var sx=(i,e)=>{var t=fu(i,i.player,i.player);t.x=i.player.defaultOffset.x,t.y=i.player.defaultOffset.y,hu(i,i.player,t,{referenceCity:i.player.city,cacheKey:"player:self"}),e.addChild(t)},ox=(i,e)=>{Object.keys(i.otherPlayers).forEach(t=>{var r=i.otherPlayers[t];if(r){if(r.isCloaked){const s=i.player?.id,o=(r.city??null)===(i.player?.city??null);if(t!==s&&!o)return}var n=fu(i,r,i.player);n.x=r.offset.x+(i.player.defaultOffset.x-i.player.offset.x/48*48),n.y=r.offset.y+(i.player.defaultOffset.y-i.player.offset.y/48*48),hu(i,r,n,{referenceCity:i.player.city,isRogue:r.city===-1,cacheKey:r.id||t}),e.addChild(n)}})};const ax=(i,e)=>{const t=i.rogueTankManager;!t||!Array.isArray(t.tanks)||t.tanks.length===0||t.tanks.forEach((r,n)=>{if(!r||!r.offset)return;const s=fu(i,r,i.player);s.x=r.offset.x+(i.player.defaultOffset.x-i.player.offset.x/48*48),s.y=r.offset.y+(i.player.defaultOffset.y-i.player.offset.y/48*48),hu(i,r,s,{isRogue:!0,referenceCity:i.player.city,cacheKey:r.id||`rogue:${n}`}),e.addChild(s)})};var lx=(i,e)=>{for(var t=i.bulletFactory.getHead();t;){var r=i.textures.bulletTexture.clone(),n=t&&Number.isFinite(t.type)?t.type:0;n<0&&(n=0);var s=new V.Rectangle(t.animation*8,n*8,8,8);r.frame=s;var o=new V.Sprite(r);o.x=t.x+(i.player.defaultOffset.x-i.player.offset.x),o.y=t.y+(i.player.defaultOffset.y-i.player.offset.y),t.animation++,t.animation>3&&(t.animation=0),e.addChild(o),t=t.next}};const ux=(i,e)=>{if(!Array.isArray(i.explosions)||i.explosions.length===0)return;const t=i.tick||Date.now();for(let r=i.explosions.length-1;r>=0;r--){const n=i.explosions[r];if(!n){i.explosions.splice(r,1);continue}const s=n.variant||"large",o=vc[s]||vc.large,a=i.textures[o.textureKey]||i.textures[o.fallbackKey];if(!a||!a.baseTexture)continue;const l=o.frameSize,u=o.totalFrames,h=o.duration??Wb,f=Math.max(1,Math.floor(a.baseTexture.width/l)),c=Math.max(1,Math.floor(a.baseTexture.height/l)),d=Math.min(u,f*c);if(d<=0)continue;if(n.nextFrameTick?t>=n.nextFrameTick&&(n.frame=(n.frame||0)+1,n.nextFrameTick=t+h):n.nextFrameTick=t+h,(n.frame||0)>=d){i.explosions.splice(r,1);continue}const p=Math.max(0,n.frame||0),m=new V.Texture(a.baseTexture,new V.Rectangle(p%f*l,Math.floor(p/f)*l,l,l)),v=new V.Sprite(m),g=i.player.defaultOffset.x-i.player.offset.x,I=i.player.defaultOffset.y-i.player.offset.y;v.x=(n.x||0)+g,v.y=(n.y||0)+I,e.addChild(v)}},hx=i=>{i.objectContainer.removeChildren(),sx(i,i.objectContainer),ox(i,i.objectContainer),ax(i,i.objectContainer),lx(i,i.objectContainer),ux(i,i.objectContainer);const e=i.__nameLabelCache;if(e&&e.size){const t=i.tick||Date.now();for(const[r,n]of e.entries()){if(!n){e.delete(r);continue}const s=n.lastUsedTick||0;t-s<=Zb||(n.label&&(n.label.parent&&n.label.parent.removeChild(n.label),n.label.destroy()),e.delete(r))}}};var fx=(i,e)=>ar(e,Or(i.player))?!0:Object.keys(i.otherPlayers).some(t=>ar(Or(i.otherPlayers[t]),e)),cx=(i,e)=>{for(var t=i.buildingFactory.getHead();t;){var r={x:t.x*48,y:t.y*48,w:144,h:144};if(ar(e,r))return!0;t=t.next}return!1};const dx=(i,e)=>{var t={x:e.x*48,y:e.y*48,w:140,h:140},r=iy(Or(i.player));return r?(console.log("Collided with edges"),r):(r=sy(i,t),r?(console.log("Collided with tiles"),r):(r=cx(i,t),r||(r=fx(i,t),r)?(console.log("Collided with buildings"),r):(r=ny(i,t),r)))};var yy="1.13.7",mc=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},Ps=Array.prototype,cu=Object.prototype,gc=typeof Symbol<"u"?Symbol.prototype:null,px=Ps.push,on=Ps.slice,Zi=cu.toString,yx=cu.hasOwnProperty,vy=typeof ArrayBuffer<"u",vx=typeof DataView<"u",mx=Array.isArray,_c=Object.keys,bc=Object.create,xc=vy&&ArrayBuffer.isView,gx=isNaN,_x=isFinite,my=!{toString:null}.propertyIsEnumerable("toString"),wc=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],bx=Math.pow(2,53)-1;function Qt(i,e){return e=e==null?i.length-1:+e,function(){for(var t=Math.max(arguments.length-e,0),r=Array(t),n=0;n<t;n++)r[n]=arguments[n+e];switch(e){case 0:return i.call(this,r);case 1:return i.call(this,arguments[0],r);case 2:return i.call(this,arguments[0],arguments[1],r)}var s=Array(e+1);for(n=0;n<e;n++)s[n]=arguments[n];return s[e]=r,i.apply(this,s)}}function Nr(i){var e=typeof i;return e==="function"||e==="object"&&!!i}function xx(i){return i===null}function gy(i){return i===void 0}function _y(i){return i===!0||i===!1||Zi.call(i)==="[object Boolean]"}function wx(i){return!!(i&&i.nodeType===1)}function zt(i){var e="[object "+i+"]";return function(t){return Zi.call(t)===e}}const du=zt("String"),by=zt("Number"),Tx=zt("Date"),Ix=zt("RegExp"),Ex=zt("Error"),xy=zt("Symbol"),wy=zt("ArrayBuffer");var Ty=zt("Function"),Sx=mc.document&&mc.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof Sx!="function"&&(Ty=function(i){return typeof i=="function"||!1});const jt=Ty,Iy=zt("Object");var Ey=vx&&(!/\[native code\]/.test(String(DataView))||Iy(new DataView(new ArrayBuffer(8)))),pu=typeof Map<"u"&&Iy(new Map),Ax=zt("DataView");function Cx(i){return i!=null&&jt(i.getInt8)&&wy(i.buffer)}const ds=Ey?Cx:Ax,Br=mx||zt("Array");function ur(i,e){return i!=null&&yx.call(i,e)}var fl=zt("Arguments");(function(){fl(arguments)||(fl=function(i){return ur(i,"callee")})})();const yu=fl;function Px(i){return!xy(i)&&_x(i)&&!isNaN(parseFloat(i))}function Sy(i){return by(i)&&gx(i)}function Ay(i){return function(){return i}}function Cy(i){return function(e){var t=i(e);return typeof t=="number"&&t>=0&&t<=bx}}function Py(i){return function(e){return e?.[i]}}const ps=Py("byteLength"),Ox=Cy(ps);var Rx=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;function Fx(i){return xc?xc(i)&&!ds(i):Ox(i)&&Rx.test(Zi.call(i))}const Oy=vy?Fx:Ay(!1),te=Py("length");function Mx(i){for(var e={},t=i.length,r=0;r<t;++r)e[i[r]]=!0;return{contains:function(n){return e[n]===!0},push:function(n){return e[n]=!0,i.push(n)}}}function Ry(i,e){e=Mx(e);var t=wc.length,r=i.constructor,n=jt(r)&&r.prototype||cu,s="constructor";for(ur(i,s)&&!e.contains(s)&&e.push(s);t--;)s=wc[t],s in i&&i[s]!==n[s]&&!e.contains(s)&&e.push(s)}function Ut(i){if(!Nr(i))return[];if(_c)return _c(i);var e=[];for(var t in i)ur(i,t)&&e.push(t);return my&&Ry(i,e),e}function Lx(i){if(i==null)return!0;var e=te(i);return typeof e=="number"&&(Br(i)||du(i)||yu(i))?e===0:te(Ut(i))===0}function Fy(i,e){var t=Ut(e),r=t.length;if(i==null)return!r;for(var n=Object(i),s=0;s<r;s++){var o=t[s];if(e[o]!==n[o]||!(o in n))return!1}return!0}function _t(i){if(i instanceof _t)return i;if(!(this instanceof _t))return new _t(i);this._wrapped=i}_t.VERSION=yy;_t.prototype.value=function(){return this._wrapped};_t.prototype.valueOf=_t.prototype.toJSON=_t.prototype.value;_t.prototype.toString=function(){return String(this._wrapped)};function Tc(i){return new Uint8Array(i.buffer||i,i.byteOffset||0,ps(i))}var Ic="[object DataView]";function cl(i,e,t,r){if(i===e)return i!==0||1/i===1/e;if(i==null||e==null)return!1;if(i!==i)return e!==e;var n=typeof i;return n!=="function"&&n!=="object"&&typeof e!="object"?!1:My(i,e,t,r)}function My(i,e,t,r){i instanceof _t&&(i=i._wrapped),e instanceof _t&&(e=e._wrapped);var n=Zi.call(i);if(n!==Zi.call(e))return!1;if(Ey&&n=="[object Object]"&&ds(i)){if(!ds(e))return!1;n=Ic}switch(n){case"[object RegExp]":case"[object String]":return""+i==""+e;case"[object Number]":return+i!=+i?+e!=+e:+i==0?1/+i===1/e:+i==+e;case"[object Date]":case"[object Boolean]":return+i==+e;case"[object Symbol]":return gc.valueOf.call(i)===gc.valueOf.call(e);case"[object ArrayBuffer]":case Ic:return My(Tc(i),Tc(e),t,r)}var s=n==="[object Array]";if(!s&&Oy(i)){var o=ps(i);if(o!==ps(e))return!1;if(i.buffer===e.buffer&&i.byteOffset===e.byteOffset)return!0;s=!0}if(!s){if(typeof i!="object"||typeof e!="object")return!1;var a=i.constructor,l=e.constructor;if(a!==l&&!(jt(a)&&a instanceof a&&jt(l)&&l instanceof l)&&"constructor"in i&&"constructor"in e)return!1}t=t||[],r=r||[];for(var u=t.length;u--;)if(t[u]===i)return r[u]===e;if(t.push(i),r.push(e),s){if(u=i.length,u!==e.length)return!1;for(;u--;)if(!cl(i[u],e[u],t,r))return!1}else{var h=Ut(i),f;if(u=h.length,Ut(e).length!==u)return!1;for(;u--;)if(f=h[u],!(ur(e,f)&&cl(i[f],e[f],t,r)))return!1}return t.pop(),r.pop(),!0}function Nx(i,e){return cl(i,e)}function an(i){if(!Nr(i))return[];var e=[];for(var t in i)e.push(t);return my&&Ry(i,e),e}function vu(i){var e=te(i);return function(t){if(t==null)return!1;var r=an(t);if(te(r))return!1;for(var n=0;n<e;n++)if(!jt(t[i[n]]))return!1;return i!==By||!jt(t[mu])}}var mu="forEach",Ly="has",gu=["clear","delete"],Ny=["get",Ly,"set"],Bx=gu.concat(mu,Ny),By=gu.concat(Ny),Dx=["add"].concat(gu,mu,Ly);const kx=pu?vu(Bx):zt("Map"),Ux=pu?vu(By):zt("WeakMap"),Xx=pu?vu(Dx):zt("Set"),Hx=zt("WeakSet");function xi(i){for(var e=Ut(i),t=e.length,r=Array(t),n=0;n<t;n++)r[n]=i[e[n]];return r}function Gx(i){for(var e=Ut(i),t=e.length,r=Array(t),n=0;n<t;n++)r[n]=[e[n],i[e[n]]];return r}function Dy(i){for(var e={},t=Ut(i),r=0,n=t.length;r<n;r++)e[i[t[r]]]=t[r];return e}function dl(i){var e=[];for(var t in i)jt(i[t])&&e.push(t);return e.sort()}function _u(i,e){return function(t){var r=arguments.length;if(e&&(t=Object(t)),r<2||t==null)return t;for(var n=1;n<r;n++)for(var s=arguments[n],o=i(s),a=o.length,l=0;l<a;l++){var u=o[l];(!e||t[u]===void 0)&&(t[u]=s[u])}return t}}const ky=_u(an),ys=_u(Ut),Uy=_u(an,!0);function Yx(){return function(){}}function Xy(i){if(!Nr(i))return{};if(bc)return bc(i);var e=Yx();e.prototype=i;var t=new e;return e.prototype=null,t}function zx(i,e){var t=Xy(i);return e&&ys(t,e),t}function Vx(i){return Nr(i)?Br(i)?i.slice():ky({},i):i}function qx(i,e){return e(i),i}function Hy(i){return Br(i)?i:[i]}_t.toPath=Hy;function ln(i){return _t.toPath(i)}function bu(i,e){for(var t=e.length,r=0;r<t;r++){if(i==null)return;i=i[e[r]]}return t?i:void 0}function Gy(i,e,t){var r=bu(i,ln(e));return gy(r)?t:r}function $x(i,e){e=ln(e);for(var t=e.length,r=0;r<t;r++){var n=e[r];if(!ur(i,n))return!1;i=i[n]}return!!t}function xu(i){return i}function Ji(i){return i=ys({},i),function(e){return Fy(e,i)}}function wu(i){return i=ln(i),function(e){return bu(e,i)}}function un(i,e,t){if(e===void 0)return i;switch(t??3){case 1:return function(r){return i.call(e,r)};case 3:return function(r,n,s){return i.call(e,r,n,s)};case 4:return function(r,n,s,o){return i.call(e,r,n,s,o)}}return function(){return i.apply(e,arguments)}}function Yy(i,e,t){return i==null?xu:jt(i)?un(i,e,t):Nr(i)&&!Br(i)?Ji(i):wu(i)}function Tu(i,e){return Yy(i,e,1/0)}_t.iteratee=Tu;function re(i,e,t){return _t.iteratee!==Tu?_t.iteratee(i,e):Yy(i,e,t)}function jx(i,e,t){e=re(e,t);for(var r=Ut(i),n=r.length,s={},o=0;o<n;o++){var a=r[o];s[a]=e(i[a],a,i)}return s}function zy(){}function Wx(i){return i==null?zy:function(e){return Gy(i,e)}}function Kx(i,e,t){var r=Array(Math.max(0,i));e=un(e,t,1);for(var n=0;n<i;n++)r[n]=e(n);return r}function pl(i,e){return e==null&&(e=i,i=0),i+Math.floor(Math.random()*(e-i+1))}const Qi=Date.now||function(){return new Date().getTime()};function Vy(i){var e=function(s){return i[s]},t="(?:"+Ut(i).join("|")+")",r=RegExp(t),n=RegExp(t,"g");return function(s){return s=s==null?"":""+s,r.test(s)?s.replace(n,e):s}}const qy={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},Zx=Vy(qy),Jx=Dy(qy),Qx=Vy(Jx),tw=_t.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var ca=/(.)^/,ew={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},rw=/\\|'|\r|\n|\u2028|\u2029/g;function iw(i){return"\\"+ew[i]}var nw=/^\s*(\w|\$)+\s*$/;function sw(i,e,t){!e&&t&&(e=t),e=Uy({},e,_t.templateSettings);var r=RegExp([(e.escape||ca).source,(e.interpolate||ca).source,(e.evaluate||ca).source].join("|")+"|$","g"),n=0,s="__p+='";i.replace(r,function(u,h,f,c,d){return s+=i.slice(n,d).replace(rw,iw),n=d+u.length,h?s+=`'+
((__t=(`+h+`))==null?'':_.escape(__t))+
'`:f?s+=`'+
((__t=(`+f+`))==null?'':__t)+
'`:c&&(s+=`';
`+c+`
__p+='`),u}),s+=`';
`;var o=e.variable;if(o){if(!nw.test(o))throw new Error("variable is not a bare identifier: "+o)}else s=`with(obj||{}){
`+s+`}
`,o="obj";s=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+s+`return __p;
`;var a;try{a=new Function(o,"_",s)}catch(u){throw u.source=s,u}var l=function(u){return a.call(this,u,_t)};return l.source="function("+o+`){
`+s+"}",l}function ow(i,e,t){e=ln(e);var r=e.length;if(!r)return jt(t)?t.call(i):t;for(var n=0;n<r;n++){var s=i?.[e[n]];s===void 0&&(s=t,n=r),i=jt(s)?s.call(i):s}return i}var aw=0;function lw(i){var e=++aw+"";return i?i+e:e}function uw(i){var e=_t(i);return e._chain=!0,e}function $y(i,e,t,r,n){if(!(r instanceof e))return i.apply(t,n);var s=Xy(i.prototype),o=i.apply(s,n);return Nr(o)?o:s}var wi=Qt(function(i,e){var t=wi.placeholder,r=function(){for(var n=0,s=e.length,o=Array(s),a=0;a<s;a++)o[a]=e[a]===t?arguments[n++]:e[a];for(;n<arguments.length;)o.push(arguments[n++]);return $y(i,r,this,this,o)};return r});wi.placeholder=_t;const jy=Qt(function(i,e,t){if(!jt(i))throw new TypeError("Bind must be called on a function");var r=Qt(function(n){return $y(i,r,e,this,t.concat(n))});return r}),le=Cy(te);function Dr(i,e,t,r){if(r=r||[],!e&&e!==0)e=1/0;else if(e<=0)return r.concat(i);for(var n=r.length,s=0,o=te(i);s<o;s++){var a=i[s];if(le(a)&&(Br(a)||yu(a)))if(e>1)Dr(a,e-1,t,r),n=r.length;else for(var l=0,u=a.length;l<u;)r[n++]=a[l++];else t||(r[n++]=a)}return r}const hw=Qt(function(i,e){e=Dr(e,!1,!1);var t=e.length;if(t<1)throw new Error("bindAll must be passed function names");for(;t--;){var r=e[t];i[r]=jy(i[r],i)}return i});function fw(i,e){var t=function(r){var n=t.cache,s=""+(e?e.apply(this,arguments):r);return ur(n,s)||(n[s]=i.apply(this,arguments)),n[s]};return t.cache={},t}const Wy=Qt(function(i,e,t){return setTimeout(function(){return i.apply(null,t)},e)}),cw=wi(Wy,_t,1);function dw(i,e,t){var r,n,s,o,a=0;t||(t={});var l=function(){a=t.leading===!1?0:Qi(),r=null,o=i.apply(n,s),r||(n=s=null)},u=function(){var h=Qi();!a&&t.leading===!1&&(a=h);var f=e-(h-a);return n=this,s=arguments,f<=0||f>e?(r&&(clearTimeout(r),r=null),a=h,o=i.apply(n,s),r||(n=s=null)):!r&&t.trailing!==!1&&(r=setTimeout(l,f)),o};return u.cancel=function(){clearTimeout(r),a=0,r=n=s=null},u}function pw(i,e,t){var r,n,s,o,a,l=function(){var h=Qi()-n;e>h?r=setTimeout(l,e-h):(r=null,t||(o=i.apply(a,s)),r||(s=a=null))},u=Qt(function(h){return a=this,s=h,n=Qi(),r||(r=setTimeout(l,e),t&&(o=i.apply(a,s))),o});return u.cancel=function(){clearTimeout(r),r=s=a=null},u}function yw(i,e){return wi(e,i)}function Iu(i){return function(){return!i.apply(this,arguments)}}function vw(){var i=arguments,e=i.length-1;return function(){for(var t=e,r=i[e].apply(this,arguments);t--;)r=i[t].call(this,r);return r}}function mw(i,e){return function(){if(--i<1)return e.apply(this,arguments)}}function Ky(i,e){var t;return function(){return--i>0&&(t=e.apply(this,arguments)),i<=1&&(e=null),t}}const gw=wi(Ky,2);function Zy(i,e,t){e=re(e,t);for(var r=Ut(i),n,s=0,o=r.length;s<o;s++)if(n=r[s],e(i[n],n,i))return n}function Jy(i){return function(e,t,r){t=re(t,r);for(var n=te(e),s=i>0?0:n-1;s>=0&&s<n;s+=i)if(t(e[s],s,e))return s;return-1}}const Eu=Jy(1),Qy=Jy(-1);function tv(i,e,t,r){t=re(t,r,1);for(var n=t(e),s=0,o=te(i);s<o;){var a=Math.floor((s+o)/2);t(i[a])<n?s=a+1:o=a}return s}function ev(i,e,t){return function(r,n,s){var o=0,a=te(r);if(typeof s=="number")i>0?o=s>=0?s:Math.max(s+a,o):a=s>=0?Math.min(s+1,a):s+a+1;else if(t&&s&&a)return s=t(r,n),r[s]===n?s:-1;if(n!==n)return s=e(on.call(r,o,a),Sy),s>=0?s+o:-1;for(s=i>0?o:a-1;s>=0&&s<a;s+=i)if(r[s]===n)return s;return-1}}const rv=ev(1,Eu,tv),_w=ev(-1,Qy);function yl(i,e,t){var r=le(i)?Eu:Zy,n=r(i,e,t);if(n!==void 0&&n!==-1)return i[n]}function bw(i,e){return yl(i,Ji(e))}function Ye(i,e,t){e=un(e,t);var r,n;if(le(i))for(r=0,n=i.length;r<n;r++)e(i[r],r,i);else{var s=Ut(i);for(r=0,n=s.length;r<n;r++)e(i[s[r]],s[r],i)}return i}function Rr(i,e,t){e=re(e,t);for(var r=!le(i)&&Ut(i),n=(r||i).length,s=Array(n),o=0;o<n;o++){var a=r?r[o]:o;s[o]=e(i[a],a,i)}return s}function iv(i){var e=function(t,r,n,s){var o=!le(t)&&Ut(t),a=(o||t).length,l=i>0?0:a-1;for(s||(n=t[o?o[l]:l],l+=i);l>=0&&l<a;l+=i){var u=o?o[l]:l;n=r(n,t[u],u,t)}return n};return function(t,r,n,s){var o=arguments.length>=3;return e(t,un(r,s,4),n,o)}}const da=iv(1),Ec=iv(-1);function pi(i,e,t){var r=[];return e=re(e,t),Ye(i,function(n,s,o){e(n,s,o)&&r.push(n)}),r}function xw(i,e,t){return pi(i,Iu(re(e)),t)}function Sc(i,e,t){e=re(e,t);for(var r=!le(i)&&Ut(i),n=(r||i).length,s=0;s<n;s++){var o=r?r[s]:s;if(!e(i[o],o,i))return!1}return!0}function Ac(i,e,t){e=re(e,t);for(var r=!le(i)&&Ut(i),n=(r||i).length,s=0;s<n;s++){var o=r?r[s]:s;if(e(i[o],o,i))return!0}return!1}function Ue(i,e,t,r){return le(i)||(i=xi(i)),(typeof t!="number"||r)&&(t=0),rv(i,e,t)>=0}const ww=Qt(function(i,e,t){var r,n;return jt(e)?n=e:(e=ln(e),r=e.slice(0,-1),e=e[e.length-1]),Rr(i,function(s){var o=n;if(!o){if(r&&r.length&&(s=bu(s,r)),s==null)return;o=s[e]}return o==null?o:o.apply(s,t)})});function Su(i,e){return Rr(i,wu(e))}function Tw(i,e){return pi(i,Ji(e))}function nv(i,e,t){var r=-1/0,n=-1/0,s,o;if(e==null||typeof e=="number"&&typeof i[0]!="object"&&i!=null){i=le(i)?i:xi(i);for(var a=0,l=i.length;a<l;a++)s=i[a],s!=null&&s>r&&(r=s)}else e=re(e,t),Ye(i,function(u,h,f){o=e(u,h,f),(o>n||o===-1/0&&r===-1/0)&&(r=u,n=o)});return r}function Iw(i,e,t){var r=1/0,n=1/0,s,o;if(e==null||typeof e=="number"&&typeof i[0]!="object"&&i!=null){i=le(i)?i:xi(i);for(var a=0,l=i.length;a<l;a++)s=i[a],s!=null&&s<r&&(r=s)}else e=re(e,t),Ye(i,function(u,h,f){o=e(u,h,f),(o<n||o===1/0&&r===1/0)&&(r=u,n=o)});return r}var Ew=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function sv(i){return i?Br(i)?on.call(i):du(i)?i.match(Ew):le(i)?Rr(i,xu):xi(i):[]}function ov(i,e,t){if(e==null||t)return le(i)||(i=xi(i)),i[pl(i.length-1)];var r=sv(i),n=te(r);e=Math.max(Math.min(e,n),0);for(var s=n-1,o=0;o<e;o++){var a=pl(o,s),l=r[o];r[o]=r[a],r[a]=l}return r.slice(0,e)}function Sw(i){return ov(i,1/0)}function Aw(i,e,t){var r=0;return e=re(e,t),Su(Rr(i,function(n,s,o){return{value:n,index:r++,criteria:e(n,s,o)}}).sort(function(n,s){var o=n.criteria,a=s.criteria;if(o!==a){if(o>a||o===void 0)return 1;if(o<a||a===void 0)return-1}return n.index-s.index}),"value")}function Os(i,e){return function(t,r,n){var s=e?[[],[]]:{};return r=re(r,n),Ye(t,function(o,a){var l=r(o,a,t);i(s,o,l)}),s}}const Cw=Os(function(i,e,t){ur(i,t)?i[t].push(e):i[t]=[e]}),Pw=Os(function(i,e,t){i[t]=e}),Ow=Os(function(i,e,t){ur(i,t)?i[t]++:i[t]=1}),Rw=Os(function(i,e,t){i[t?0:1].push(e)},!0);function Fw(i){return i==null?0:le(i)?i.length:Ut(i).length}function Mw(i,e,t){return e in t}const av=Qt(function(i,e){var t={},r=e[0];if(i==null)return t;jt(r)?(e.length>1&&(r=un(r,e[1])),e=an(i)):(r=Mw,e=Dr(e,!1,!1),i=Object(i));for(var n=0,s=e.length;n<s;n++){var o=e[n],a=i[o];r(a,o,i)&&(t[o]=a)}return t}),Lw=Qt(function(i,e){var t=e[0],r;return jt(t)?(t=Iu(t),e.length>1&&(r=e[1])):(e=Rr(Dr(e,!1,!1),String),t=function(n,s){return!Ue(e,s)}),av(i,t,r)});function lv(i,e,t){return on.call(i,0,Math.max(0,i.length-(e==null||t?1:e)))}function pa(i,e,t){return i==null||i.length<1?e==null||t?void 0:[]:e==null||t?i[0]:lv(i,i.length-e)}function Zn(i,e,t){return on.call(i,e==null||t?1:e)}function Nw(i,e,t){return i==null||i.length<1?e==null||t?void 0:[]:e==null||t?i[i.length-1]:Zn(i,Math.max(0,i.length-e))}function Bw(i){return pi(i,Boolean)}function Dw(i,e){return Dr(i,e,!1)}const uv=Qt(function(i,e){return e=Dr(e,!0,!0),pi(i,function(t){return!Ue(e,t)})}),kw=Qt(function(i,e){return uv(i,e)});function vl(i,e,t,r){_y(e)||(r=t,t=e,e=!1),t!=null&&(t=re(t,r));for(var n=[],s=[],o=0,a=te(i);o<a;o++){var l=i[o],u=t?t(l,o,i):l;e&&!t?((!o||s!==u)&&n.push(l),s=u):t?Ue(s,u)||(s.push(u),n.push(l)):Ue(n,l)||n.push(l)}return n}const Uw=Qt(function(i){return vl(Dr(i,!0,!0))});function Xw(i){for(var e=[],t=arguments.length,r=0,n=te(i);r<n;r++){var s=i[r];if(!Ue(e,s)){var o;for(o=1;o<t&&Ue(arguments[o],s);o++);o===t&&e.push(s)}}return e}function ml(i){for(var e=i&&nv(i,te).length||0,t=Array(e),r=0;r<e;r++)t[r]=Su(i,r);return t}const Hw=Qt(ml);function Gw(i,e){for(var t={},r=0,n=te(i);r<n;r++)e?t[i[r]]=e[r]:t[i[r][0]]=i[r][1];return t}function Yw(i,e,t){e==null&&(e=i||0,i=0),t||(t=e<i?-1:1);for(var r=Math.max(Math.ceil((e-i)/t),0),n=Array(r),s=0;s<r;s++,i+=t)n[s]=i;return n}function zw(i,e){if(e==null||e<1)return[];for(var t=[],r=0,n=i.length;r<n;)t.push(on.call(i,r,r+=e));return t}function Au(i,e){return i._chain?_t(e).chain():e}function hv(i){return Ye(dl(i),function(e){var t=_t[e]=i[e];_t.prototype[e]=function(){var r=[this._wrapped];return px.apply(r,arguments),Au(this,t.apply(_t,r))}}),_t}Ye(["pop","push","reverse","shift","sort","splice","unshift"],function(i){var e=Ps[i];_t.prototype[i]=function(){var t=this._wrapped;return t!=null&&(e.apply(t,arguments),(i==="shift"||i==="splice")&&t.length===0&&delete t[0]),Au(this,t)}});Ye(["concat","join","slice"],function(i){var e=Ps[i];_t.prototype[i]=function(){var t=this._wrapped;return t!=null&&(t=e.apply(t,arguments)),Au(this,t)}});const Vw=Object.freeze(Object.defineProperty({__proto__:null,VERSION:yy,after:mw,all:Sc,allKeys:an,any:Ac,assign:ys,before:Ky,bind:jy,bindAll:hw,chain:uw,chunk:zw,clone:Vx,collect:Rr,compact:Bw,compose:vw,constant:Ay,contains:Ue,countBy:Ow,create:zx,debounce:pw,default:_t,defaults:Uy,defer:cw,delay:Wy,detect:yl,difference:uv,drop:Zn,each:Ye,escape:Zx,every:Sc,extend:ky,extendOwn:ys,filter:pi,find:yl,findIndex:Eu,findKey:Zy,findLastIndex:Qy,findWhere:bw,first:pa,flatten:Dw,foldl:da,foldr:Ec,forEach:Ye,functions:dl,get:Gy,groupBy:Cw,has:$x,head:pa,identity:xu,include:Ue,includes:Ue,indexBy:Pw,indexOf:rv,initial:lv,inject:da,intersection:Xw,invert:Dy,invoke:ww,isArguments:yu,isArray:Br,isArrayBuffer:wy,isBoolean:_y,isDataView:ds,isDate:Tx,isElement:wx,isEmpty:Lx,isEqual:Nx,isError:Ex,isFinite:Px,isFunction:jt,isMap:kx,isMatch:Fy,isNaN:Sy,isNull:xx,isNumber:by,isObject:Nr,isRegExp:Ix,isSet:Xx,isString:du,isSymbol:xy,isTypedArray:Oy,isUndefined:gy,isWeakMap:Ux,isWeakSet:Hx,iteratee:Tu,keys:Ut,last:Nw,lastIndexOf:_w,map:Rr,mapObject:jx,matcher:Ji,matches:Ji,max:nv,memoize:fw,methods:dl,min:Iw,mixin:hv,negate:Iu,noop:zy,now:Qi,object:Gw,omit:Lw,once:gw,pairs:Gx,partial:wi,partition:Rw,pick:av,pluck:Su,property:wu,propertyOf:Wx,random:pl,range:Yw,reduce:da,reduceRight:Ec,reject:xw,rest:Zn,restArguments:Qt,result:ow,sample:ov,select:pi,shuffle:Sw,size:Fw,some:Ac,sortBy:Aw,sortedIndex:tv,tail:Zn,take:pa,tap:qx,template:sw,templateSettings:tw,throttle:dw,times:Kx,toArray:sv,toPath:Hy,transpose:ml,unescape:Qx,union:Uw,uniq:vl,unique:vl,uniqueId:lw,unzip:ml,values:xi,where:Tw,without:kw,wrap:yw,zip:Hw},Symbol.toStringTag,{value:"Module"}));var Hi=hv(Vw);Hi._=Hi;const Ze=48,gl=Ze*20,qw=gl*gl,jr=(i,e=0)=>{if(typeof i=="number"&&Number.isFinite(i))return i;if(typeof i=="string"){const t=Number(i);if(Number.isFinite(t))return t}return e},Cc=(i,e,t,r)=>{const n=i-t,s=e-r;return n*n+s*s};var fv=function(i,e,t){t=typeof t<"u"?t:[],e=typeof e<"u"?e:{id:0};var r=Hi.filter(i,function(n){return n.parentid==e.id});return Hi.isEmpty(r)||(e.id==0?t=r:e.children=r,Hi.each(r,function(n){fv(i,n)})),t},$w=fv(ob);const Pc=Object.keys(rr).reduce((i,e)=>(i[rr[e].TYPE]=e,i),{}),ya=i=>i>=100&&i<200;class jw{constructor(e){this.game=e,this.buildingListHead=null,this.buildingsById={},this.buildingsByCoord={},this.pendingBuildCosts=new Map,this.pendingDemolish=new Set}cycle(){}newBuilding(e,t,r,n,s={}){const{notifyServer:o=!0,id:a=`${t}_${r}`,population:l=0,attachedHouseId:u=null,updateCity:h,itemsLeft:f=0,city:c=this.game.player?.city??0}=s,d=`${t}_${r}`,p=Number.isFinite(c)?c:parseInt(c,10)||0,m=o&&e!==null&&e!==void 0&&this.game?.player&&e===this.game.player.id;if(m){const I=this.game.cities?.[p];if(!I)return console.warn("Cannot place building without city state"),!1;if((Number.isFinite(I.cash)?I.cash:parseInt(I.cash,10)||0)<Bi)return console.warn("City lacks funds for new building"),this.game.forceDraw=!0,!1}var v={id:a,owner:e,x:t,y:r,items:1,type:n,population:l,attachedHouseId:u,next:null,previous:null,coordKey:d,city:c,itemsLeft:f};if(dx(this.game,v))return console.log("Collision"),!1;if(m&&n!==or){const I={x:(jr(t,0)+1.5)*Ze,y:(jr(r,0)+1.5)*Ze},w=this.measureCityLayout(p,I);if(w.buildingCount>0){const M=w.nearestDistanceSq;if(M!==null&&M>qw){if(typeof this.game.notify=="function"){const b=Ft(p),R=Math.round(gl/Ze);this.game.notify({title:"Construction Denied",message:`New structures must be within ${R} tiles of your existing ${b} build grid. Try placing closer to your city.`,variant:"warn",timeout:6500})}return!1}}}if(o&&this.game.socketListener&&this.game.socketListener.sendNewBuilding&&this.game.socketListener.sendNewBuilding(v),this.buildingListHead&&(this.buildingListHead.previous=v,v.next=this.buildingListHead),(h!==void 0?h:!e||e===this.game.player.id)?this.adjustAllowedBuilds(v):this.applyResearchProgress(v.city,v.type),console.log("Created building"),console.log(v),this.buildingListHead=v,this.buildingsById[v.id]=v,this.buildingsByCoord[d]=v,this.syncFactoryItems(v),this.game.tiles[t]||(this.game.tiles[t]=[]),this.game.tiles[t][r]=n,this.game.map&&this.game.map[t]&&(this.game.map[t][r]=sn),m){const I=this.game.cities?.[p];if(I){const w=Number.isFinite(I.cash)?I.cash:parseInt(I.cash,10)||0;I.cash=Math.max(0,w-Bi),I.construction=(Number.isFinite(I.construction)?I.construction:parseInt(I.construction,10)||0)+Bi,I.updatedAt=Date.now(),this.pendingBuildCosts.set(v.id,{cityId:p,cost:Bi}),this.game.forceDraw=!0}}return v}outputBuildings(){console.log("here");for(var e=this.getHead();e;)e.type!==0&&console.log(e.type+","+e.x+","+e.y),e=e.next;return!1}demolishBuilding(e,t){console.log("Trying to demolish building at "+e+" "+t);const r=this.findBuildingAtTile(e,t);r&&(this.pendingDemolish.has(r.id)||this.game.socketListener?.sendDemolishBuilding&&(this.pendingDemolish.add(r.id),this.game.socketListener.sendDemolishBuilding(r.id)))}deleteBuilding(e,t=!0){if(this.game.map[e.x][e.y]=0,this.game.tiles[e.x][e.y]=0,this.pendingDemolish.has(e.id)&&this.pendingDemolish.delete(e.id),Array.isArray(this.game.explosions)){const s=Number.isFinite(e.x)?Number(e.x):0,o=Number.isFinite(e.y)?Number(e.y):0;this.game.explosions.push({x:s*48,y:o*48,frame:0,nextFrameTick:(this.game.tick||Date.now())+75,variant:"large"})}if(ya(e.type)){const s=this.getFactoryDropPosition(e),o=e.type%100,a=e.city??e.cityId??null,l=this.game.iconFactory.countUnownedIconsNear(s.x,s.y,o,48,a);l>0&&this.game.iconFactory.removeUnownedIconsNear(s.x,s.y,o,l,48,a),e.itemsLeft=0}(e.owner===null||e.owner===this.game.player.id)&&Object.keys(this.game.cities[this.game.player.city].canBuild).forEach(s=>{var o=rr[s].TYPE;console.log(o+" "+this.game.isBuilding),parseInt(o)==e.type&&o!=Kr&&(this.game.cities[this.game.player.city].canBuild[s]=er)}),t&&this.game.socketListener&&this.game.socketListener.sendDemolishBuilding&&this.game.socketListener.sendDemolishBuilding(e.id);var r=e.next;e.next&&(e.next.previous=e.previous),e.previous?e.previous.next=e.next:this.buildingListHead=e.next,delete this.buildingsById[e.id];const n=e.coordKey||`${e.x}_${e.y}`;return delete this.buildingsByCoord[n],this.pendingBuildCosts.has(e.id)&&this.pendingBuildCosts.delete(e.id),r}handleDemolishDenied(e){const t=e?.id;t&&this.pendingDemolish.has(t)&&this.pendingDemolish.delete(t),e?.reason&&console.warn(`Demolish denied (${e.reason}) for building ${t||"(unknown)"}`)}removeBuildingById(e){let t=this.getHead();for(;t;){if(t.id===e){this.deleteBuilding(t,!1);break}t=t.next}}handleBuildDenied(e){if(!e)return;const t=e.id||`${e.x}_${e.y}`;if(!t)return;const r=this.pendingBuildCosts.get(t);if(r){const s=this.game.cities?.[r.cityId];if(s){const o=Number.isFinite(s.cash)?s.cash:parseInt(s.cash,10)||0;s.cash=o+r.cost;const a=Number.isFinite(s.construction)?s.construction:parseInt(s.construction,10)||0;s.construction=Math.max(0,a-r.cost),s.updatedAt=Date.now()}this.pendingBuildCosts.delete(t)}const n=this.getBuildingById(t);n&&n.owner===this.game.player.id&&this.deleteBuilding(n,!1),this.game.forceDraw=!0}searchTree(e,t){if(e.id==t)return e;if(e.children!=null){var r,n=null;for(r=0;n==null&&r<e.children.length;r++)n=this.searchTree(e.children[r],t);return n}return null}adjustAllowedBuilds(e){if(e.type==or)return;const t=e.city??this.game.player.city,r=this.game.isBuilding||e.type;this.applyResearchProgress(t,r)}getHead(){return this.buildingListHead}getBuildingById(e){return this.buildingsById[e]}getBuildingByCoord(e,t){return this.buildingsByCoord[`${e}_${t}`]}findBuildingAtTile(e,t){let r=this.getHead();const n=Number.isFinite(e)?e:parseInt(e,10),s=Number.isFinite(t)?t:parseInt(t,10);if(!Number.isFinite(n)||!Number.isFinite(s))return null;for(;r;){const o=Number.isFinite(r.x)?r.x:parseInt(r.x,10)||0,a=Number.isFinite(r.y)?r.y:parseInt(r.y,10)||0;if(n>=o&&n<=o+2&&s>=a&&s<=a+2)return r;r=r.next}return null}measureCityLayout(e,t=null){const r=Number.isFinite(e)?e:parseInt(e,10),n=this.game.cities?.[r],s=jr(n?.x,0),o=jr(n?.y,0),a={x:s+Ze*1.5,y:o+Ze*1.5};let l=this.getHead(),u=0,f=Number.isFinite(t?.x)&&Number.isFinite(t?.y)?1/0:null,c=0;for(;l;){const d=Number.isFinite(l.city)?l.city:parseInt(l.city,10);if(Number.isFinite(d)&&Number.isFinite(r)&&d!==r){l=l.next;continue}const p=(jr(l.x,0)+1.5)*Ze,m=(jr(l.y,0)+1.5)*Ze,v=Cc(p,m,a.x,a.y);if(v>u&&(u=v),f!==null){const g=Cc(p,m,t.x,t.y);g<f&&(f=g)}c+=1,l=l.next}return{cityCenter:a,maxRadiusSq:u,nearestDistanceSq:f,buildingCount:c}}countBuildingsForCity(e){const t=Number.isFinite(e)?e:parseInt(e,10);if(!Number.isFinite(t))return 0;let r=0,n=this.getHead();for(;n;)(Number.isFinite(n.city)?n.city:parseInt(n.city,10)||0)===t&&(r+=1),n=n.next;return r}applyPopulationUpdate(e){if(!e||!e.id)return;if(e.removed){this.removeBuildingById(e.id),this.game.forceDraw=!0;return}let t=this.getBuildingById(e.id);!t&&e.x!==void 0&&e.y!==void 0&&e.type!==void 0&&(t=this.newBuilding(e.ownerId||null,e.x,e.y,e.type,{notifyServer:!1,id:e.id,population:e.population||0,attachedHouseId:e.attachedHouseId||null,updateCity:!1,itemsLeft:e.itemsLeft||0,city:e.city??0}),t&&this.applyResearchProgress(t.city??0,t.type)),t&&(t.coordKey=t.coordKey||`${t.x}_${t.y}`,typeof e.population=="number"&&(t.population=e.population),e.attachedHouseId!==void 0&&(t.attachedHouseId=e.attachedHouseId),e.city!==void 0&&(t.city=e.city),e.smokeActive!==void 0&&(t.smokeActive=e.smokeActive),e.smokeFrame!==void 0&&(t.smokeFrame=e.smokeFrame),e.itemsLeft!==void 0&&(t.itemsLeft=e.itemsLeft),this.syncFactoryItems(t),e.id&&this.pendingBuildCosts.has(e.id)&&this.pendingBuildCosts.delete(e.id),this.game.forceDraw=!0)}applyResearchProgress(e,t){if(t==null||e==null||e===void 0)return;const r=parseInt(e,10),n=this.game.cities?.[r];if(!n||!n.canBuild)return;const s=Number(t),o=Pc[s];if(!o||n.canBuild[o]===void 0)return;s!==Kr&&(n.canBuild[o]=Jf);const a=this.searchTree($w[0],s);a&&a.children&&a.children.forEach(l=>{const u=Pc[l.id];u&&n.canBuild[u]!==Jf&&(n.canBuild[u]=er)})}assignIconSource(e){if(!e||typeof e.type!="number")return null;if(e.sourceBuildingId&&this.buildingsById[e.sourceBuildingId])return this.buildingsById[e.sourceBuildingId];const t=this.findFactoryForIcon(e.type,e.x,e.y);return t&&(e.sourceBuildingId=t.id),t}findFactoryForIcon(e,t,r){let n=null,s=1/0,o=this.getHead();for(;o;){if(ya(o.type)&&o.type%100===e){const a=this.getFactoryDropPosition(o),l=a.x-t,u=a.y-r,h=Math.sqrt(l*l+u*u);h<s&&h<=96&&(n=o,s=h)}o=o.next}return n}handleIconProduced(e){const t=this.assignIconSource(e);t&&(t.itemsLeft=(t.itemsLeft||0)+1,this.syncFactoryItems(t))}handleIconCollected(e){const t=this.assignIconSource(e);t&&(typeof t.itemsLeft=="number"&&t.itemsLeft>0&&(t.itemsLeft-=1),this.game.socketListener&&typeof this.game.socketListener.collectFactoryItem=="function"&&t.id&&this.game.socketListener.collectFactoryItem({buildingId:t.id,type:e.type,quantity:Math.max(1,e.quantity??1)}),this.syncFactoryItems(t))}getFactoryDropPosition(e){return{x:e.x*48+56,y:e.y*48+102}}syncFactoryItems(e){if(!e||!ya(e.type)||!this.game.iconFactory||typeof this.game.iconFactory.countUnownedIconsNear!="function"||typeof this.game.iconFactory.removeUnownedIconsNear!="function")return;const t=e.itemsLeft||0,r=e.type%100,n=this.getFactoryDropPosition(e),s=e.city??e.cityId??null,o=this.game.iconFactory.countUnownedIconsNear(n.x,n.y,r,48,s);if(o>t)this.game.iconFactory.removeUnownedIconsNear(n.x,n.y,r,o-t,48,s);else if(o<t){const a=t-o;for(let l=0;l<a;l++)this.game.iconFactory.newIcon(null,n.x,n.y,r,{sourceBuildingId:e.id,teamId:s,skipProductionUpdate:!0})}}}const Jr=48,Oc=4,Ww=new Set([au,sn]);var hn=(i,e)=>{var t={x:e.x,y:e.y,w:4,h:4};return ar(i,t)};const Kw=i=>({x:i.x,y:i.y,w:Oc,h:Oc}),Zw=(i,e)=>{const t=Array.isArray(i.map)?i.map.length:0,r=t>0&&Array.isArray(i.map[0])?i.map[0].length:0;if(!t||!r)return e;const n=Math.max(0,t*Jr-e.w),s=Math.max(0,r*Jr-e.h);return{x:Math.max(0,Math.min(e.x,n)),y:Math.max(0,Math.min(e.y,s)),w:e.w,h:e.h}},Jw=(i,e)=>{const t=Array.isArray(i.map)?i.map:null;if(!t||!Array.isArray(t[0]))return!1;const r=t.length-1,n=Array.isArray(t[0])?t[0].length-1:-1;if(r<0||n<0)return!1;const s=Math.max(0,Math.floor(e.x/Jr)),o=Math.min(r,Math.floor((e.x+e.w-1)/Jr)),a=Math.max(0,Math.floor(e.y/Jr)),l=Math.min(n,Math.floor((e.y+e.h-1)/Jr));for(let u=s;u<=o;u+=1){const h=t[u];if(Array.isArray(h))for(let f=a;f<=l;f+=1){const c=h[f];if(Ww.has(c))return!0}}return!1},Qw=(i,e)=>{const t=Zw(i,Kw(e));return Jw(i,t)},tT=(i,e)=>Object.keys(i.otherPlayers).some(t=>{const r=i.otherPlayers[t];if(!r||!r.offset||e.shooter&&e.shooter===t)return!1;const n=e.team??null,s=r.city??null;return n!==null&&s===n?!1:hn(Or(r),e)})||eT(i,e);function eT(i,e){const t=i.rogueTankManager;if(!t||!Array.isArray(t.tanks))return!1;const r=e.team??null;for(let n=0;n<t.tanks.length;n+=1){const s=t.tanks[n];if(!s||!s.offset||e.shooter&&e.shooter===s.id)continue;const o=s.city??null;if(!(r!==null&&o===r)&&hn(Or(s),e))return t.handleBulletCollision(e,s),!0}return!1}const rT=(i,e)=>{const t=e.team??null,r=i.player?.city??null;return t!==null&&t===r||e.shooter&&e.shooter===i.player.id?!1:hn(Or(i.player),e)},iT=(i,e)=>{for(var t=i.itemFactory.getHead();t;){var r={x:t.x,y:t.y,w:48,h:48};if(e.sourceId&&t.id&&e.sourceId===t.id){t=t.next;continue}if(hn(r,e))return t;t=t.next}return null},nT=(i,e)=>{for(var t=i.buildingFactory.getHead();t;){var r={x:t.x*48,y:t.y*48,w:144,h:96};if(t.type<G_&&(r.h=r.h-48),hn(r,e))return!0;t=t.next}return!1},Rc={0:Qp,1:k_,3:U_},Fc={0:ll,1:ll,3:H_},sT=i=>Object.prototype.hasOwnProperty.call(Rc,i)?Rc[i]:Qp,Mc=i=>Object.prototype.hasOwnProperty.call(Fc,i)?Fc[i]:ll;class oT{constructor(e){this.game=e,this.bulletListHead=null}cycle(){for(var e=this.bulletListHead;e;){var t=e.angle;const s=e.speed??Mc(e.type);var r=Math.sin(t/16*3.14)*-1*this.game.timePassed*s,n=Math.cos(t/16*3.14)*-1*this.game.timePassed*s;e.x+=r,e.y+=n,(e.x<0||e.x>24576||e.y<0||e.y>24576)&&(e.life=We),Qw(this.game,e)&&(e.life=We);const o=iT(this.game,e);o&&(this.game.itemFactory&&typeof this.game.itemFactory.handleBulletHit=="function"?(this.game.itemFactory.handleBulletHit(o,e)||{}).consumed!==!1&&(e.life=We):e.life=We),nT(this.game,e)&&(e.life=We),tT(this.game,e)&&(e.life=We),rT(this.game,e)&&(e.life=We),e.life==We?e=this.deleteBullet(e):e=e.next}}deleteBullet(e){var t=e.next;return e.next&&(e.next.previous=e.previous),e.previous?e.previous.next=e.next:this.bulletListHead=e.next,t}newBullet(e,t,r,n,s,o=null,a={}){const l=Number.isFinite(n)?n:0,u=a||{},h=Number.isFinite(u.damage)?u.damage:sT(l);var f={shooter:e,x:t,y:r,life:M_,damage:h,animation:0,type:l,angle:s,team:o,speed:Mc(l),sourceId:u.sourceId??null,sourceType:u.sourceType??null,targetId:u.targetId??null,next:null,previous:null};return this.bulletListHead&&(this.bulletListHead.previous=f,f.next=this.bulletListHead),this.bulletListHead=f,f}getHead(){return this.bulletListHead}}class aT{constructor(e){this.game=e,this.iconListHead=null}cycle(){}getLimitForType(e){const t=sb?.[e];return typeof t=="number"?t:1/0}getOwnedQuantity(e,t){if(e==null)return 0;let r=0,n=this.getHead();for(;n;){if(n.owner===e&&n.type===t){const s=Number.isFinite(n.quantity)?n.quantity:parseInt(n.quantity,10)||1;r+=Math.max(1,s)}n=n.next}return r}getAllowedQuantity(e,t,r){const n=Math.max(1,parseInt(r,10)||1);if(e==null)return n;const s=this.getLimitForType(t);if(!Number.isFinite(s))return n;const o=this.getOwnedQuantity(e,t),a=s-o;return a<=0?0:Math.min(n,a)}newIcon(e,t,r,n,s={}){const o=s.quantity!==void 0?s.quantity:1;let a=Math.max(1,parseInt(o,10)||1);if(e!=null){const f=this.getAllowedQuantity(e,n,a);if(f<=0)return null;a=f}const l=s.city!==void 0?s.city:e!=null&&e===this.game.player?.id?this.game.player.city??null:null,u=s.teamId!==void 0?s.teamId:e!=null&&e===this.game.player?.id?this.game.player.city??null:null;var h={owner:e,x:t,y:r,type:n,next:null,previous:null,sourceBuildingId:s.sourceBuildingId??null,quantity:a,selected:!!s.selected,armed:!!s.armed,city:l,teamId:u};if(console.log("creating icon"),console.log(h),this.game.forceDraw=!0,this.iconListHead&&(this.iconListHead.previous=h,h.next=this.iconListHead),this.iconListHead=h,h.quantity=Math.max(1,parseInt(h.quantity,10)||1),this.game.buildingFactory&&h.owner==null){if(!h.sourceBuildingId&&typeof this.game.buildingFactory.assignIconSource=="function"){const f=this.game.buildingFactory.assignIconSource(h);f&&(h.sourceBuildingId=f.id)}!s.skipProductionUpdate&&typeof this.game.buildingFactory.handleIconProduced=="function"&&this.game.buildingFactory.handleIconProduced(h)}if(h.owner===this.game.player?.id&&h.selected){let f=this.iconListHead;for(;f;)f!==h&&f.owner===h.owner&&(f.selected=!1,f.type===Pt&&(f.armed=!1)),f=f.next;h.type===Pt&&(h.armed=!!h.armed,this.game.player.bombsArmed=h.armed),this.game.forceDraw=!0}return h}pickupIcon(){var e=this.findIconByLocation();if(e){const t=this.game.player.id,r=e.quantity??1,n=this.getAllowedQuantity(t,e.type,r);if(n<=0||n<r)return;const s=this.findOwnedIconByType(t,e.type);if(e.owner=t,e.city=this.game.player.city??null,e.teamId=this.game.player.city??null,e.quantity=r,e.selected=!1,e.armed=!1,this.game.buildingFactory&&typeof this.game.buildingFactory.handleIconCollected=="function"&&this.game.buildingFactory.handleIconCollected(e),s&&s!==e){const o=this.getLimitForType(e.type),a=(s.quantity??1)+r;s.quantity=Number.isFinite(o)?Math.min(o,Math.max(1,a)):Math.max(1,a),this.deleteIcon(e)}this.game.forceDraw=!0}}dropSelectedIcon(){for(var e=this.getHead(),t=null;e;){if(e.owner==this.game.player.id&&e.selected){t=e;break}e=e.next}if(!t)return null;const r=t.quantity??1,n={type:t.type,armed:!!t.armed,owner:this.game.player.id,city:this.game.player.city??null,teamId:this.game.player.city??null};return r>1?(t.quantity=r-1,t.selected=!0):this.deleteIcon(t),n.type===Pt&&(r>1?(t.armed=n.armed,this.game.player.bombsArmed=t.armed):this.game.player.bombsArmed=!1),this.game.forceDraw=!0,n}toggleSelected(e){e.selected=!e.selected;for(var t=this.getHead();t;)t.owner==e.owner&&t!=e&&(console.log("setting other icons selected to false"),t.selected=!1),t=t.next;e.type===Pt?(e.armed=e.selected,this.game.player.bombsArmed=e.armed):e.selected&&(this.game.player.bombsArmed=!1)}findIconByLocation(){var e=this.getHead(),t=24;const r=this.game.player?.city??null;for(;e;){const n=e.teamId===null||e.teamId===void 0||e.teamId===r;if(e.owner==null&&n&&e.x>=this.game.player.offset.x-t&&e.x<=this.game.player.offset.x+t&&e.y>=this.game.player.offset.y-t&&e.y<=this.game.player.offset.y+t)return e;e=e.next}return null}findOwnedIconByType(e,t){for(var r=this.getHead();r;){if(r.owner===e&&r.type===t)return r;r=r.next}return null}consumeOwnedIcon(e,t,r=1){if(e==null)return null;const n=this.findOwnedIconByType(e,t);if(!n)return null;const s=Number.isFinite(n.quantity)?n.quantity:parseInt(n.quantity,10)||1,o=Math.max(1,parseInt(r,10)||1);return s<=o?this.deleteIcon(n):n.quantity=s-o,this.game.forceDraw=!0,n}getSelectedIcon(e){for(var t=this.getHead();t;){if(t.owner===e&&t.selected)return t;t=t.next}return null}deleteIcon(e){var t=e.next;return e.next&&(e.next.previous=e.previous),e.previous?e.previous.next=e.next:this.iconListHead=e.next,this.game.player&&this.game.player.id===e.owner&&e.type===Pt&&(this.game.player.bombsArmed=e.armed),t}purgeCityItems(e,t=null){const r=Number.isFinite(t)?Math.floor(t):null,n=Number.isFinite(e)?Math.floor(e):null;let s=0,o=this.getHead();for(;o;){if(!(r===null||o.type===r)){o=o.next;continue}const l=Number.isFinite(o.city)?Math.floor(o.city):Number.isFinite(o.teamId)?Math.floor(o.teamId):null;if(n!==null&&l!==null&&l!==n){o=o.next;continue}o=this.deleteIcon(o),s+=1}return s>0&&(r===Pt&&this.game?.player&&(this.game.player.bombsArmed=!1),this.game.forceDraw=!0),s}getHead(){return this.iconListHead}countUnownedIconsNear(e,t,r,n=48,s=null){let o=0,a=this.getHead();for(;a;){const l=s==null||a.teamId===null||a.teamId===void 0||a.teamId===s;if(a.owner==null&&a.type===r&&l){const u=Math.abs(a.x-e),h=Math.abs(a.y-t);u<=n&&h<=n&&o++}a=a.next}return o}removeUnownedIconsNear(e,t,r,n,s=48,o=null){let a=0,l=this.getHead();for(;l&&a<n;){const u=l.next,h=o==null||l.teamId===null||l.teamId===void 0||l.teamId===o;if(l.owner==null&&l.type===r&&h){const f=Math.abs(l.x-e),c=Math.abs(l.y-t);f<=s&&c<=s&&(this.deleteIcon(l),a++)}l=u}return a}}const lT=new Set([Ve,Zt,we,pe]),uT=new Set([Zt,we,pe,Ve]),hT=new Set([Ki,Ss,ei,Pt,oe,ri,As,de]),Lc=new Set([oe,Pt,de]),fT=i=>Object.prototype.hasOwnProperty.call(sc,i)?sc[i]:null,cT=i=>Object.prototype.hasOwnProperty.call(oc,i)?oc[i]:null;class dT{constructor(e){this.game=e,this.itemListHead=null,this.calculateTick=0,this.itemsById=new Map,this.pendingHazards=new Set,this.pendingDefenseIds=new Set,this.socketBound=!1,this.nextLocalId=0,this.nextDefenseId=0,this.validIcons=[Zt,pe,we,Ve,oe,Pt,de,ri],this.validShooters=[Zt,pe,we],this.pendingOrbItems=[],this.game.socketListener&&this.bindSocketEvents(this.game.socketListener)}bindSocketEvents(e){!e||this.socketBound||(this.socketBound=!0,e.on("hazard:spawn",t=>this.onHazardSpawn(t)),e.on("hazard:update",t=>this.onHazardUpdate(t)),e.on("hazard:remove",t=>this.onHazardRemove(t)),e.on("orb:result",t=>this.onOrbResult(t)))}generateHazardId(){return this.nextLocalId+=1,`hazard_${this.game.socketListener?.io?.id??"local"}_${Date.now()}_${this.nextLocalId}`}generateDefenseId(){return this.nextDefenseId+=1,`defense_${this.game.socketListener?.io?.id??"local"}_${Date.now()}_${this.nextDefenseId}`}insertItem(e){this.itemListHead&&(this.itemListHead.previous=e,e.next=this.itemListHead),this.itemListHead=e,this.itemsById.set(e.id,e),this.game.forceDraw=!0}detachItem(e){e&&(e.next&&(e.next.previous=e.previous),e.previous?e.previous.next=e.next:this.itemListHead===e&&(this.itemListHead=e.next),e.next=null,e.previous=null,this.itemsById.delete(e.id))}cycle(){if(this.game.tick>this.calculateTick){this.calculateTick=this.game.tick+200;for(var e=this.getHead();e;)this.validShooters.includes(e.type)&&(this.targetNearestPlayer(e),this.fireBullet(e)),e=e.next}this.processBombs()}fireBullet(e){if(this.validShooters.includes(e.type)&&this.game.tick>e.lastFired&&e.target){e.lastFired=this.game.tick+250;var t=e.angle*3.14/180,r=-(32/6*t),n=Math.sin(e.angle*3.14/180),s=Math.cos(e.angle*3.14/180)*-1,o=e.x+20+n*23,a=e.y+24+s*23;const l=e.ownerId??e.owner??this.game.player.id,u=e.teamId??this.game.player.city??null;this.game.bulletFactory.newBullet(l,o,a,0,r,u,{sourceId:e.id??null,sourceType:this.resolveItemSourceType(e),targetId:e.target??null}),this.emitItemBulletShot(e,{x:o,y:a,angle:r,team:u})}}useMedkit(){const e=this.game?.player?.id;if(e==null)return!1;if(this.game?.player?.health>=cs)return console.log("Health already full; medkit not consumed."),!1;if(!this.game.iconFactory||typeof this.game.iconFactory.findOwnedIconByType!="function")return!1;const t=this.game.iconFactory.findOwnedIconByType(e,ei);if(!t)return console.log("No MedKit available to use."),!1;const r=t.id??null;return this.game.iconFactory.consumeOwnedIcon(e,ei,1),this.game.player&&(this.game.player.health=cs,this.game.forceDraw=!0),this.game.socketListener&&typeof this.game.socketListener.useItem=="function"&&this.game.socketListener.useItem("medkit",{iconId:r,type:ei}),!0}activateCloak(){const e=this.game?.player?.id;if(e==null||!this.game.iconFactory||typeof this.game.iconFactory.findOwnedIconByType!="function")return!1;const t=this.game.iconFactory.findOwnedIconByType(e,Ki);if(!t)return console.log("Cloak unavailable."),!1;const n=(this.game.tick||Date.now())+Wf;return this.game.player&&(this.game.player.isCloaked=!0,this.game.player.cloakExpiresAt=n,this.game.forceDraw=!0),this.game.socketListener&&typeof this.game.socketListener.useItem=="function"&&this.game.socketListener.useItem("cloak",{iconId:t.id??null,type:Ki,duration:Wf}),!0}freezeCurrentPlayer(e=D_,t="dfg"){if(!this.game||!this.game.player)return;const r=this.game.tick||Date.now();this.game.player.isFrozen=!0,this.game.player.frozenUntil=r+Math.max(0,e),this.game.player.frozenBy=t,this.game.player.isMoving=0,this.game.player.isTurning=0,this.game.forceDraw=!0}triggerDFG(e){!e||e.type!==de||(e.active=!1,e.hidden=!0,this.freezeCurrentPlayer(),this.game.forceDraw=!0)}targetNearestPlayer(e){var t=null;const r=e.teamId??null,n=(o,a)=>{if(!o||!o.offset)return;const l=o.city??null;if(!(r!==null&&l===r)){var u=o.offset.x-e.x,h=o.offset.y-e.y,f=Math.sqrt(u*u+h*h);f>400||(!t||f<t.distance)&&(t={id:a,x:o.offset.x,y:o.offset.y,distance:f,team:l})}};if(n(this.game.player,this.game.player.id),Object.keys(this.game.otherPlayers).forEach(o=>{n(this.game.otherPlayers[o],o)}),this.game.rogueTankManager&&Array.isArray(this.game.rogueTankManager.tanks)&&this.game.rogueTankManager.tanks.forEach(o=>{!o||!o.offset||n(o,o.id||`rogue_${o.offset.x}_${o.offset.y}`)}),t){e.target=t.id,e.targetTeam=t.team??null;var s=Math.atan2(t.x-e.x,t.y-e.y);s=Math.ceil(s*180/3.14),t.x>=e.x?e.angle=180-s:t.x<=e.x?e.angle=s*-1+170:e.angle=s}else e.target=null,e.targetTeam=null}ensureItemDurability(e,t=null){if(!e)return;const r=Number.isFinite(t)?t:e.type,n=fT(r);n!=null&&(Number.isFinite(e.maxLife)||(e.maxLife=n),Number.isFinite(e.life)||(e.life=n));const s=cT(r);s!=null&&(Number.isFinite(e.burnThreshold)||(e.burnThreshold=s)),Object.prototype.hasOwnProperty.call(e,"isBurning")||(e.isBurning=!1),Number.isFinite(e.life)&&Number.isFinite(e.burnThreshold)&&Number.isFinite(e.maxLife)&&e.life<e.maxLife&&e.life<=e.burnThreshold&&this.markItemBurning(e)}markItemBurning(e){e&&(e.isBurning||(e.isBurning=!0,e.lifeState="burning",Number.isFinite(e.animation)||(e.animation=1),Number.isFinite(e.animationTick)||(e.animationTick=0)))}isHazardType(e){return Lc.has(e)}shouldRemoveOnHit(e){return hT.has(e)?!0:!lT.has(e)}destroyItem(e,t={}){if(!e)return;const r=Number.isFinite(t.impactX)?t.impactX:e.x,n=Number.isFinite(t.impactY)?t.impactY:e.y;t.spawnExplosion!==!1&&this.spawnExplosion(r,n),this.deleteItem(e,{notifyServer:t.notifyServer,reason:t.reason||"destroyed"}),this.game.forceDraw=!0}handleBulletHit(e,t){if(!e||!t)return{consumed:!1};if(t.sourceId&&e.id&&t.sourceId===e.id)return{consumed:!1};const r=Number.isFinite(t.x)?t.x:e.x,n=Number.isFinite(t.y)?t.y:e.y,s=Number.isFinite(t.damage)?t.damage:5,o={consumed:!0,destroyed:!1,type:e.type};return this.shouldRemoveOnHit(e.type)?(this.destroyItem(e,{impactX:r,impactY:n}),o.destroyed=!0,o):(this.ensureItemDurability(e),Number.isFinite(e.life)?(e.life-=s,e.life<=0?(this.destroyItem(e,{impactX:r,impactY:n}),o.destroyed=!0,o):(Number.isFinite(e.burnThreshold)&&e.life<=e.burnThreshold&&this.markItemBurning(e),this.spawnExplosion(r,n),this.game.forceDraw=!0,o)):(this.destroyItem(e,{impactX:r,impactY:n}),o.destroyed=!0,o))}newItem(e,t,r,n,s={}){if(!this.validIcons.includes(n))return null;let o=null,a=null;if(e&&typeof e=="object"?(o=e.owner??e.id??null,a=e.city??null):e!==void 0&&(o=e),a===null&&o!==null&&(a=this.game.player?.city??null),s.teamId!==void 0&&s.teamId!==null){const I=Number(s.teamId);Number.isFinite(I)&&(a=Math.floor(I))}if(!Number.isFinite(a)&&s.city!==void 0&&s.city!==null){const I=Number(s.city);Number.isFinite(I)&&(a=Math.floor(I))}let l=t,u=r;(n===Pt||n===oe)&&(l=Math.floor(t/48)*48,u=Math.floor(r/48)*48);const h=Lc.has(n),f=uT.has(n),c=s.notifyServer!==!1&&h,d=s.notifyServer!==!1&&!h&&f,p=c?this.generateHazardId():d?this.generateDefenseId():null,m=s.id||p||`item_${Date.now()}_${Math.random().toString(16).slice(2)}`,v=e&&typeof e=="object"&&e.armed!==void 0?!!e.armed:this.game.player?.bombsArmed??!1,g={id:m,owner:o,ownerId:o,teamId:a,city:a,x:l,y:u,target:null,targetTeam:null,type:n,lastFired:0,active:n===Pt?v:!0,armed:n===Pt?v:!0,detonateTick:s.detonateTick||null,next:null,previous:null,synced:!(c||d)};return g.isDefense=f,this.ensureItemDurability(g,n),this.insertItem(g),f&&!d&&this.pendingDefenseIds.delete(g.id),n===ri&&s.notifyServer!==!1&&this.queueOrbDrop(g,{ownerId:o,teamId:a}),c&&this.game.socketListener&&(this.pendingHazards.add(g.id),this.game.socketListener.spawnHazard({id:g.id,type:n,x:g.x,y:g.y,armed:g.active,ownerId:o,teamId:a})),d&&this.game.socketListener&&typeof this.game.socketListener.spawnDefense=="function"&&(this.pendingDefenseIds.add(g.id),this.game.socketListener.spawnDefense({id:g.id,type:n,x:g.x,y:g.y,ownerId:o,teamId:a,cityId:a,angle:g.angle??0})),n===Pt&&this.armBomb(g,g.active,{notifyServer:!1}),g}shouldNotifyServerForItem(e){if(!e||!this.game||!this.game.socketListener||typeof this.game.socketListener.sendBulletShot!="function")return!1;const t=this.game.player?.id??null;if(!t)return!1;const r=e.ownerId??e.owner??null;return e.isDefense||r==null?!0:r===t}resolveItemSourceType(e){return e?e.type===Zt?"turret":e.type===pe?"plasma":e.type===we?"sleeper":null:null}resolveItemTeam(e,t=null){if(!e)return t;const r=e.teamId??e.city??null;return Number.isFinite(r)?r:Number.isFinite(t)?t:this.game.player?.city??null}emitItemBulletShot(e,t){if(!this.shouldNotifyServerForItem(e))return;const r=this.game.socketListener;if(!r)return;const n=this.game.player?.id??null;if(!n)return;const s={shooter:n,x:t?.x??e.x,y:t?.y??e.y,type:t?.type??0,angle:t?.angle??0,team:this.resolveItemTeam(e,t?.team??null),sourceId:e.id??null,sourceType:this.resolveItemSourceType(e)||void 0,targetId:e.target??null};r.sendBulletShot(s)}deleteItem(e,t={}){if(!e)return null;const r=t.notifyServer!==!1,n=e.next;if(Array.isArray(this.pendingOrbItems)){const s=this.pendingOrbItems.indexOf(e);s!==-1&&this.pendingOrbItems.splice(s,1)}if(r&&this.isHazardType(e.type)&&this.game.socketListener&&typeof this.game.socketListener.removeHazard=="function")try{this.game.socketListener.removeHazard(e.id)}catch(s){console.debug("Failed to notify server about hazard removal",s)}if(r&&e.isDefense&&this.game.socketListener&&typeof this.game.socketListener.removeDefense=="function")try{this.game.socketListener.removeDefense(e.id)}catch(s){console.debug("Failed to notify server about defense removal",s)}return this.detachItem(e),this.pendingHazards.delete(e.id),this.pendingDefenseIds&&this.pendingDefenseIds.delete(e.id),n}processBombs(){}armBomb(e,t,r={}){!e||e.type!==Pt||(e.active=t,e.armed=t,r.notifyServer!==!1&&this.game.socketListener&&e.id&&this.game.socketListener.updateHazard({id:e.id,armed:!!t}))}detonateBomb(e,t={}){const r=t.notifyServer!==void 0?!!t.notifyServer:!0,n=Math.floor((e.x+24)/48),s=Math.floor((e.y+24)/48);console.log(`Bomb detonated at tile ${n}, ${s}`);let o=this.deleteItem(e,{notifyServer:r}),a=this.getHead();for(;a;){const u=a.next,h=Math.floor((a.x+24)/48),f=Math.floor((a.y+24)/48);Math.abs(h-n)<=Zf&&Math.abs(f-s)<=Zf&&this.deleteItem(a,{notifyServer:r}),a=u}let l=this.game.buildingFactory.getHead();for(;l;){const u=Math.floor(l.x)-n,h=Math.floor(l.y)-s;if(Math.abs(u)<=Kf&&Math.abs(h)<=Kf){if(l.type===or){l=l.next;continue}l=this.game.buildingFactory.deleteBuilding(l,r);continue}l=l.next}return this.damagePlayersInRadius(n,s),this.game.forceDraw=!0,o}damagePlayersInRadius(){}queueOrbDrop(e,t={}){if(!e||!this.game||!this.game.socketListener)return;const r=this.game.player?.id??null,n=t.ownerId??e.ownerId??r;if(!r||n!==r)return;Array.isArray(this.pendingOrbItems)||(this.pendingOrbItems=[]),this.pendingOrbItems.push(e),e.pendingOrbCheck=!0;const s={id:e.id,x:e.x,y:e.y,ownerId:n,city:t.teamId??e.teamId??this.game.player?.city??null,type:ri};this.game.socketListener.sendOrbDrop(s)}triggerMine(e){!e||e.type!==oe||(e.active=!1,e.hidden=!0,this.game.forceDraw=!0)}onHazardSpawn(e){if(!e||!e.id)return;let t=this.itemsById.get(e.id);if(!t){const r=this.resolveItemType(e.type);if(t=this.newItem(null,e.x,e.y,r,{id:e.id,notifyServer:!1,detonateTick:e.detonateAt?e.detonateAt:null}),!t)return}this.applyHazardState(t,e),t.synced=!0,this.pendingHazards.delete(e.id)}onHazardUpdate(e){if(!e||!e.id)return;const t=this.itemsById.get(e.id);if(!t){this.onHazardSpawn(e);return}this.applyHazardState(t,e)}onHazardRemove(e){if(!e||!e.id)return;const t=this.itemsById.get(e.id);if(t){if(e.reason==="bomb_detonated"&&this.spawnExplosion(e.x??t.x,e.y??t.y),e.reason==="dfg_triggered"&&e.triggeredBy){const r=this.game.player?.id;e.triggeredBy===r&&this.freezeCurrentPlayer()}this.deleteItem(t,{notifyServer:!1}),this.game.forceDraw=!0}}onOrbResult(e){if(!Array.isArray(this.pendingOrbItems)||!this.pendingOrbItems.length)return;const t=this.pendingOrbItems.shift();!t||(t.pendingOrbCheck=!1,(e||{}).status!=="detonated")||(this.spawnExplosion(t.x,t.y),this.deleteItem(t,{notifyServer:!1}),this.game.forceDraw=!0)}applyHazardState(e,t){if(e.x=this.toFiniteNumber(t.x,e.x),e.y=this.toFiniteNumber(t.y,e.y),t.active!==void 0&&(e.active=!!t.active),t.armed!==void 0&&(e.armed=!!t.armed),t.detonateAt&&(e.detonateTick=t.detonateAt),t.life!==void 0){const r=this.toFiniteNumber(t.life,e.life);Number.isFinite(r)&&(e.life=r)}this.ensureItemDurability(e)}resolveItemType(e){return e==="mine"||e===oe||e===4?oe:e==="bomb"||e===Pt||e===3?Pt:e==="dfg"||e===de||e===7?de:oe}spawnExplosion(e,t){!this.game||!Array.isArray(this.game.explosions)||this.game.explosions.push({x:e,y:t,frame:0,nextFrameTick:null,variant:"small"})}toFiniteNumber(e,t){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const r=Number(e);if(Number.isFinite(r))return r}return t}getHead(){return this.itemListHead}getItemById(e){return e&&this.itemsById.get(e)||null}removeItemById(e,t={}){const r=this.getItemById(e);return r?(this.deleteItem(r,t),!0):!1}}const dt=48,At=dt/2,Dn=8,pT=2,yT=2,Nc=18,vT=32,mT=5e3,gT=1300,_T=2200,bT=.55,xT=2800,kn=dt*10,Bc=6,Dc=9e3,wT=4500,TT=2600,IT=1200,kc=dt*7,ET=24e4,ST=dt*7,Wr=dt*11,Uc=dt*13,AT=dt*7,CT=20,PT=6e4,OT=6e4,Xc=Object.freeze([Math.PI/4,-Math.PI/4,Math.PI/2,-Math.PI/2]),_l=dt*2.5,Ke=(i,e=0)=>{if(typeof i=="number"&&Number.isFinite(i))return i;if(typeof i=="string"){const t=Number(i);if(Number.isFinite(t))return t}return e},Un=(i,e,t,r)=>{const n=i-t,s=e-r;return n*n+s*s},RT=i=>{const e=-i/16*Math.PI;return{dx:Math.sin(e),dy:Math.cos(e)}},va=(i,e,t=0)=>{if(!Number.isFinite(i)||!Number.isFinite(e)||Math.abs(i)<1e-4&&Math.abs(e)<1e-4)return t;const r=Math.sqrt(i*i+e*e);if(r<1e-4)return t;const n=i/r,s=e/r,o=Math.atan2(n,s);let a=Math.round(-o/Math.PI*16);return a%=32,a<0&&(a+=32),a},bl=(i,e)=>{const t=Math.sqrt(i*i+e*e);return t<1e-4?{dx:0,dy:0}:{dx:i/t,dy:e/t}},FT=(i,e)=>{if(!i)return{dx:0,dy:0};const t=Math.cos(e),r=Math.sin(e),n=i.dx*t-i.dy*r,s=i.dx*r+i.dy*t;return bl(n,s)},MT=(i,e,t,r,n=_l)=>{const s=t-i,o=r-e;let a="",l="";return Math.abs(s)>n&&(a=s>0?"east":"west"),Math.abs(o)>n&&(l=o>0?"south":"north"),a&&l?`${l}-${a}`:l||a||""};class LT{constructor(e){this.game=e,this.tanks=[],this.nextId=1,this.nextSpawnCheck=0,this.instancePrefix=`local_${Math.random().toString(16).slice(-6)}`,this.nextAllowedSpawnTime=0,this.cityRadiusCache=new Map}getCallsignRegistry(){return this.game?.callsignRegistry||null}assignCallsign(e){const t=this.getCallsignRegistry();if(!t)return null;try{return t.assign(e)}catch{return null}}releaseCallsign(e){const t=this.getCallsignRegistry();if(t)try{t.release(e)}catch{}}sanitizeIdComponent(e){return!e||typeof e!="string"?null:e.replace(/[^a-zA-Z0-9_-]/g,"")}getClientInstanceId(){const e=this.game?.socketListener?.io?.id,t=this.sanitizeIdComponent(e);return t&&t.length?t:this.instancePrefix}createTankId(){const t=`rogue_${this.getClientInstanceId()}_${this.nextId}`;return this.nextId+=1,t}emitTankShot(e,t,r,n){const s=this.game?.socketListener;if(!s||typeof s.sendBulletShot!="function")return;const o=this.game.player?.id??null;o&&s.sendBulletShot({shooter:o,x:t,y:r,type:0,angle:-n,team:null,sourceId:e?.id??null,sourceType:"rogue_tank",targetId:typeof e?.target=="object"?e.target.id??null:null})}update(){if(!this.game||!this.game.buildingFactory)return;const e=this.game.tick||Date.now();e>=this.nextSpawnCheck&&(this.nextSpawnCheck=e+mT,this.evaluateSpawns(e)),this.updateTanks(e)}evaluateSpawns(e){const t=Number.isFinite(e)?e:this.game.tick||Date.now(),r=this.game.cities||[];if(!r.length)return;let n=Math.max(0,pT-this.tanks.length);n!==0&&(this.tanks.length===0&&this.nextAllowedSpawnTime>0&&t<this.nextAllowedSpawnTime||r.forEach((s,o)=>{if(!s||n<=0)return;const a=this.game.buildingFactory.countBuildingsForCity(o);if(a<Nc)return;const l=this.tanks.filter(c=>c.targetCityId===o),u=a>=vT?2:1,h=Math.min(u,yT),f=Math.min(n,h-l.length);for(let c=0;c<f;c+=1)if(this.spawnTankNearCity(s,o,t)&&(n-=1,n<=0))return}))}updateTanks(e){for(let t=this.tanks.length-1;t>=0;t-=1){const r=this.tanks[t];if(!r){this.tanks.splice(t,1);continue}if(e-r.spawnedAt>ET||!this.cityStillValid(r.targetCityId)){this.removeTankAtIndex(t);continue}this.refreshTarget(r,e),this.updateMovement(r,e),this.tryShoot(r,e),this.tryDropBomb(r,e),this.updateBombs(r,e)}}cityStillValid(e){return this.game.cities?.[e]?this.game.buildingFactory.countBuildingsForCity(e)>=Nc-3:!1}spawnTankNearCity(e,t,r){const n=Ke(e?.x,0),s=Ke(e?.y,0),o=n+dt*1.5,a=s+dt*1.5,l=Uc,u=Uc+AT;for(let h=0;h<CT;h+=1){const f=Math.random()*Math.PI*2,c=l+Math.random()*(u-l);let d=o+Math.cos(f)*c,p=a+Math.sin(f)*c;if(d=Math.max(At,Math.min(512*dt-At,d)),p=Math.max(At,Math.min(512*dt-At,p)),this.isBlocked(d,p))continue;const m=this.createTankId(),v=Number.isFinite(r)?r:this.game.tick||Date.now(),g=this.getCityEngageRadius(t,v),I={id:m,offset:{x:d,y:p},lastSafeOffset:{x:d,y:p},direction:Math.floor(Math.random()*32),isMoving:0,targetCityId:t,target:null,nextDecisionAt:v+250+Math.random()*250,nextTargetRefresh:v+Math.random()*500,fireCooldown:v+1400+Math.random()*900,bombCooldown:v+3800+Math.random()*2200,activeBombs:[],spawnedAt:v,city:-1,health:20,cachedVector:null,notifiedAttack:!1,engageRadius:g,nextRadiusRefresh:v+5e3};return I.callsign=this.assignCallsign(m)||`Rogue ${this.nextId}`,this.tanks.push(I),this.game.forceDraw=!0,!0}return!1}getCityCenter(e){const t=this.game.cities?.[e];if(!t)return null;const r=Ke(t.x,0)+dt*1.5,n=Ke(t.y,0)+dt*1.5;return{x:r,y:n}}refreshTarget(e,t){if(t<e.nextTargetRefresh)return;e.nextTargetRefresh=t+_T+Math.random()*1200;const r=this.getCityCenter(e.targetCityId);if(r){(!Number.isFinite(e.engageRadius)||t>=(e.nextRadiusRefresh||0))&&(e.engageRadius=this.getCityEngageRadius(e.targetCityId,t),e.nextRadiusRefresh=t+5e3);const o=Number.isFinite(e.engageRadius)?e.engageRadius:Wr;if(Un(e.offset.x+At,e.offset.y+At,r.x,r.y)>o*o){e.target={kind:"point",x:r.x,y:r.y};return}this.notifyCityUnderAttack(e,e.targetCityId,r,o)}const n=this.pickNearestTurret(e);if(n){e.target=n;return}const s=this.pickWanderPoint(e.targetCityId);e.target=s}pickNearestTurret(e){const t=this.game.itemFactory;if(!t)return null;let r=t.getHead(),n=null;const s=kn*kn*1.3;for(;r;){if(r.type===Zt||r.type===pe){const o=Un(r.x+At,r.y+At,e.offset.x+At,e.offset.y+At);o<s&&(!n||o<n.distanceSq)&&(n={kind:"item",id:r.id,x:r.x+At,y:r.y+At,distanceSq:o})}r=r.next}return n}pickWanderPoint(e){const t=this.game.cities?.[e],r=Ke(t?.x,0)+dt*1.5,n=Ke(t?.y,0)+dt*1.5,s=Math.random()*Math.PI*2,o=dt*2+Math.random()*ST;return{kind:"point",x:r+Math.cos(s)*o,y:n+Math.sin(s)*o}}updateMovement(e,t){if(t<e.nextDecisionAt){this.applyMovement(e,t,e.cachedVector)||(e.nextDecisionAt=t);return}e.nextDecisionAt=t+gT+Math.random()*900;const r=this.resolveTargetPosition(e.target);if(!r){e.cachedVector=null,e.isMoving=0;return}const n=r.x-(e.offset.x+At),s=r.y-(e.offset.y+At);if(n*n+s*s<dt*dt*2.5){e.cachedVector=null,e.isMoving=0;return}const a=bl(n,s),l=(Math.random()-.5)*.4,u=bl(a.dx+l,a.dy+l);e.cachedVector=u,e.direction=va(u.dx,u.dy,e.direction),this.applyMovement(e,t,u)||(e.nextDecisionAt=t+400+Math.random()*300)}applyMovement(e,t,r){if(!r||!Number.isFinite(r.dx)||!Number.isFinite(r.dy)||Math.abs(r.dx)<1e-4&&Math.abs(r.dy)<1e-4)return e.isMoving=0,!1;const s=Math.min(this.game.timePassed||0,60)*al*bT;if(s<=0)return!1;if(this.tryStep(e,r,s))return e.isMoving=1,!0;const o=this.findAlternateVector(e,r,s);return o&&this.tryStep(e,o,s)?(e.cachedVector=o,e.direction=va(o.dx,o.dy,e.direction),e.isMoving=1,!0):(e.isMoving=0,e.cachedVector=null,e.nextDecisionAt=Math.min(e.nextDecisionAt||t+400,t+450+Math.random()*250),!1)}tryStep(e,t,r){if(!t)return!1;const n=e.offset.x+t.dx*r,s=e.offset.y+t.dy*r;return this.isBlocked(n,s)?!1:(e.offset.x=n,e.offset.y=s,e.lastSafeOffset={x:n,y:s},!0)}findAlternateVector(e,t,r){if(!t)return null;for(let n=0;n<Xc.length;n+=1){const s=FT(t,Xc[n]);if(!s||Math.abs(s.dx)<1e-4&&Math.abs(s.dy)<1e-4)continue;const o=e.offset.x+s.dx*r,a=e.offset.y+s.dy*r;if(!this.isBlocked(o,a))return s}return null}resolveTargetPosition(e){if(!e)return null;if(e.kind==="item"&&e.id){const t=this.game.itemFactory?.itemsById?.get(e.id);return t?(e.x=t.x+At,e.y=t.y+At,e):null}return e}tryShoot(e,t){if(t<e.fireCooldown)return;const r=this.resolveTargetPosition(e.target);if(!r||Un(e.offset.x+At,e.offset.y+At,r.x,r.y)>kn*kn)return;const s=Math.floor(Math.random()*Bc-Bc/2),o=r.x-(e.offset.x+At),a=r.y-(e.offset.y+At);let l=va(o,a,e.direction);l=(l+s)%32,l<0&&(l+=32);const u=RT(l),h=e.offset.x+At+u.dx*30,f=e.offset.y+At+u.dy*30;this.game.bulletFactory.newBullet(e.id,h,f,0,-l,null),this.emitTankShot(e,h,f,l),e.fireCooldown=t+xT+Math.random()*800}tryDropBomb(e,t){if(t<e.bombCooldown)return;const r=this.game.cities?.[e.targetCityId];if(!r)return;const n=Ke(r.x,0)+dt*1.5,s=Ke(r.y,0)+dt*1.5;if(Un(e.offset.x+At,e.offset.y+At,n,s)>kc*kc)return;const a=this.game.itemFactory?.newItem({id:e.id,city:null,armed:!0},e.offset.x,e.offset.y,Pt,{notifyServer:!1});if(!a){e.bombCooldown=t+Dc;return}a.active=!0,a.armed=!0;const l={item:a,detonateAt:t+TT+Math.random()*IT};e.activeBombs.push(l),e.bombCooldown=t+Dc+Math.random()*wT,this.game.forceDraw=!0}updateBombs(e,t){if(!Array.isArray(e.activeBombs)||!e.activeBombs.length)return;const r=[];for(let n=0;n<e.activeBombs.length;n+=1){const s=e.activeBombs[n];if(!(!s||!s.item)){if(t>=s.detonateAt){this.game.itemFactory.spawnExplosion(s.item.x,s.item.y),this.game.itemFactory.detonateBomb(s.item,{notifyServer:!1});continue}r.push(s)}}e.activeBombs=r}isBlocked(e,t){const r={x:e+Dn,y:t+Dn,w:dt-Dn*2,h:dt-Dn*2};return!!(this.hitsEdges(r)||this.hitsBlockingTile(r)||this.hitsBuilding(r)||this.hitsItem(r))}hitsEdges(e){return e.x<0||e.y<0||e.x+e.w>512*dt||e.y+e.h>512*dt}hitsBlockingTile(e){const t=this.game.map;if(!Array.isArray(t)||!t.length)return!1;const r=Math.floor(e.x/dt),n=Math.floor((e.x+e.w)/dt),s=Math.floor(e.y/dt),o=Math.floor((e.y+e.h)/dt),a=(l,u)=>{try{return t[l][u]!==0&&t[l][u]!==3}catch{return!0}};return a(r,s)||a(r,o)||a(n,s)||a(n,o)}hitsBuilding(e){let t=this.game.buildingFactory.getHead();for(;t;){const r={x:t.x*dt,y:t.y*dt,w:dt*3,h:dt*3};if(ar(e,r))return!0;t=t.next}return!1}hitsItem(e){let t=this.game.itemFactory.getHead();for(;t;){const r={x:t.x,y:t.y,w:dt,h:dt};if(ar(e,r))return!0;t=t.next}return!1}resolveBulletKillDetails(e){const t={killerId:null,killerCallsign:null,sourceType:e&&e.sourceType?String(e.sourceType).toLowerCase():null,hazardType:null};if(!e)return t;const r=[e.sourceId,e.shooter];for(let n=0;n<r.length;n+=1){const s=r[n];if(s==null)continue;const o=`${s}`;t.killerId=o;const a=typeof this.game?.resolveCallsign=="function"?this.game.resolveCallsign(o):null;if(a){t.killerCallsign=a;break}}return typeof this.game?.describeKillSource=="function"?t.killerLabel=this.game.describeKillSource(t):t.killerCallsign?t.killerLabel=t.killerCallsign:t.killerLabel="Unknown Forces",t}announceRogueDeath(e,t){if(!e||typeof this.game?.notify!="function")return;const r=e.callsign||(typeof this.game?.resolveCallsign=="function"?this.game.resolveCallsign(e.id):null)||"Rogue Tank";let n=t?.killerLabel;t&&t.killerId&&`${t.killerId}`==`${e.id}`&&(n="Self-Inflicted"),(!n||!n.trim().length)&&typeof this.game?.describeKillSource=="function"&&(n=this.game.describeKillSource(t||{})),(!n||!n.trim().length)&&(n="Unknown Forces"),this.game.notify({title:"Elimination",message:`${r} killed by ${n}.`,variant:"warn",timeout:5200})}handleBulletCollision(e,t){if(!t||e.shooter&&e.shooter===t.id)return;const r=Number.isFinite(e.damage)?e.damage:5;if(t.health-=r,t.health<=0){const n=this.resolveBulletKillDetails(e);this.spawnTankExplosion(t),this.announceRogueDeath(t,n),this.removeTank(t)}}spawnTankExplosion(e){Array.isArray(this.game.explosions)&&this.game.explosions.push({x:e.offset.x,y:e.offset.y,frame:0,nextFrameTick:(this.game.tick||Date.now())+75,variant:"small"})}removeTank(e){const t=this.tanks.indexOf(e);t!==-1&&this.removeTankAtIndex(t)}removeTankAtIndex(e){const[t]=this.tanks.splice(e,1);t&&Array.isArray(t.activeBombs)&&t.activeBombs.forEach(r=>{!r||!r.item||this.game.itemFactory.deleteItem(r.item)}),this.tanks.length===0&&this.scheduleNextSpawn(),t&&this.releaseCallsign(t.id),this.game.forceDraw=!0}scheduleNextSpawn(){const e=this.game.tick||Date.now(),t=PT+Math.random()*OT;this.nextAllowedSpawnTime=e+t}notifyCityUnderAttack(e,t,r,n){if(!e||e.notifiedAttack)return;const s=this.game?.notify;if(typeof s!="function")return;const o=Ft(t),a=MT(r?.x??0,r?.y??0,e.offset?.x??0,e.offset?.y??0,Math.max(_l,(n||_l)*.25)),l=a?`Rogue tank assaulting ${o} from the ${a}.`:`Rogue tank assaulting ${o}.`;s({title:"Rogue Assault",message:l,variant:"warn",timeout:6500}),e.notifiedAttack=!0}getCityEngageRadius(e,t){const r=Number.isFinite(e)?e:parseInt(e,10);if(!Number.isFinite(r))return Wr;const n=Number.isFinite(t)?t:this.game.tick||Date.now(),s=this.cityRadiusCache.get(r);if(s&&n-s.timestamp<4e3)return s.radius;const o=this.computeCityEngageRadius(r);return this.cityRadiusCache.set(r,{radius:o,timestamp:n}),o}computeCityEngageRadius(e){if(!this.game?.buildingFactory||typeof this.game.buildingFactory.measureCityLayout!="function")return Wr;const t=this.game.buildingFactory.measureCityLayout(e);if(!t)return Wr;const r=Number.isFinite(t.maxRadiusSq)&&t.maxRadiusSq>0?Math.sqrt(t.maxRadiusSq):0;return!Number.isFinite(r)||r<=0?Wr:Math.max(Wr,r+dt*4)}}const Pe=Object.create(null);Pe.open="0";Pe.close="1";Pe.ping="2";Pe.pong="3";Pe.message="4";Pe.upgrade="5";Pe.noop="6";const Jn=Object.create(null);Object.keys(Pe).forEach(i=>{Jn[Pe[i]]=i});const xl={type:"error",data:"parser error"},cv=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",dv=typeof ArrayBuffer=="function",pv=i=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(i):i&&i.buffer instanceof ArrayBuffer,Cu=({type:i,data:e},t,r)=>cv&&e instanceof Blob?t?r(e):Hc(e,r):dv&&(e instanceof ArrayBuffer||pv(e))?t?r(e):Hc(new Blob([e]),r):r(Pe[i]+(e||"")),Hc=(i,e)=>{const t=new FileReader;return t.onload=function(){const r=t.result.split(",")[1];e("b"+(r||""))},t.readAsDataURL(i)};function Gc(i){return i instanceof Uint8Array?i:i instanceof ArrayBuffer?new Uint8Array(i):new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}let ma;function NT(i,e){if(cv&&i.data instanceof Blob)return i.data.arrayBuffer().then(Gc).then(e);if(dv&&(i.data instanceof ArrayBuffer||pv(i.data)))return e(Gc(i.data));Cu(i,!1,t=>{ma||(ma=new TextEncoder),e(ma.encode(t))})}const Yc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ki=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let i=0;i<Yc.length;i++)ki[Yc.charCodeAt(i)]=i;const BT=i=>{let e=i.length*.75,t=i.length,r,n=0,s,o,a,l;i[i.length-1]==="="&&(e--,i[i.length-2]==="="&&e--);const u=new ArrayBuffer(e),h=new Uint8Array(u);for(r=0;r<t;r+=4)s=ki[i.charCodeAt(r)],o=ki[i.charCodeAt(r+1)],a=ki[i.charCodeAt(r+2)],l=ki[i.charCodeAt(r+3)],h[n++]=s<<2|o>>4,h[n++]=(o&15)<<4|a>>2,h[n++]=(a&3)<<6|l&63;return u},DT=typeof ArrayBuffer=="function",Pu=(i,e)=>{if(typeof i!="string")return{type:"message",data:yv(i,e)};const t=i.charAt(0);return t==="b"?{type:"message",data:kT(i.substring(1),e)}:Jn[t]?i.length>1?{type:Jn[t],data:i.substring(1)}:{type:Jn[t]}:xl},kT=(i,e)=>{if(DT){const t=BT(i);return yv(t,e)}else return{base64:!0,data:i}},yv=(i,e)=>{switch(e){case"blob":return i instanceof Blob?i:new Blob([i]);case"arraybuffer":default:return i instanceof ArrayBuffer?i:i.buffer}},vv="",UT=(i,e)=>{const t=i.length,r=new Array(t);let n=0;i.forEach((s,o)=>{Cu(s,!1,a=>{r[o]=a,++n===t&&e(r.join(vv))})})},XT=(i,e)=>{const t=i.split(vv),r=[];for(let n=0;n<t.length;n++){const s=Pu(t[n],e);if(r.push(s),s.type==="error")break}return r};function HT(){return new TransformStream({transform(i,e){NT(i,t=>{const r=t.length;let n;if(r<126)n=new Uint8Array(1),new DataView(n.buffer).setUint8(0,r);else if(r<65536){n=new Uint8Array(3);const s=new DataView(n.buffer);s.setUint8(0,126),s.setUint16(1,r)}else{n=new Uint8Array(9);const s=new DataView(n.buffer);s.setUint8(0,127),s.setBigUint64(1,BigInt(r))}i.data&&typeof i.data!="string"&&(n[0]|=128),e.enqueue(n),e.enqueue(t)})}})}let ga;function Xn(i){return i.reduce((e,t)=>e+t.length,0)}function Hn(i,e){if(i[0].length===e)return i.shift();const t=new Uint8Array(e);let r=0;for(let n=0;n<e;n++)t[n]=i[0][r++],r===i[0].length&&(i.shift(),r=0);return i.length&&r<i[0].length&&(i[0]=i[0].slice(r)),t}function GT(i,e){ga||(ga=new TextDecoder);const t=[];let r=0,n=-1,s=!1;return new TransformStream({transform(o,a){for(t.push(o);;){if(r===0){if(Xn(t)<1)break;const l=Hn(t,1);s=(l[0]&128)===128,n=l[0]&127,n<126?r=3:n===126?r=1:r=2}else if(r===1){if(Xn(t)<2)break;const l=Hn(t,2);n=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),r=3}else if(r===2){if(Xn(t)<8)break;const l=Hn(t,8),u=new DataView(l.buffer,l.byteOffset,l.length),h=u.getUint32(0);if(h>Math.pow(2,21)-1){a.enqueue(xl);break}n=h*Math.pow(2,32)+u.getUint32(4),r=3}else{if(Xn(t)<n)break;const l=Hn(t,n);a.enqueue(Pu(s?l:ga.decode(l),e)),r=0}if(n===0||n>i){a.enqueue(xl);break}}}})}const mv=4;function Nt(i){if(i)return YT(i)}function YT(i){for(var e in Nt.prototype)i[e]=Nt.prototype[e];return i}Nt.prototype.on=Nt.prototype.addEventListener=function(i,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+i]=this._callbacks["$"+i]||[]).push(e),this};Nt.prototype.once=function(i,e){function t(){this.off(i,t),e.apply(this,arguments)}return t.fn=e,this.on(i,t),this};Nt.prototype.off=Nt.prototype.removeListener=Nt.prototype.removeAllListeners=Nt.prototype.removeEventListener=function(i,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+i];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+i],this;for(var r,n=0;n<t.length;n++)if(r=t[n],r===e||r.fn===e){t.splice(n,1);break}return t.length===0&&delete this._callbacks["$"+i],this};Nt.prototype.emit=function(i){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+i],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(t){t=t.slice(0);for(var r=0,n=t.length;r<n;++r)t[r].apply(this,e)}return this};Nt.prototype.emitReserved=Nt.prototype.emit;Nt.prototype.listeners=function(i){return this._callbacks=this._callbacks||{},this._callbacks["$"+i]||[]};Nt.prototype.hasListeners=function(i){return!!this.listeners(i).length};const Rs=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),fe=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),zT="arraybuffer";function gv(i,...e){return e.reduce((t,r)=>(i.hasOwnProperty(r)&&(t[r]=i[r]),t),{})}const VT=fe.setTimeout,qT=fe.clearTimeout;function Fs(i,e){e.useNativeTimers?(i.setTimeoutFn=VT.bind(fe),i.clearTimeoutFn=qT.bind(fe)):(i.setTimeoutFn=fe.setTimeout.bind(fe),i.clearTimeoutFn=fe.clearTimeout.bind(fe))}const $T=1.33;function jT(i){return typeof i=="string"?WT(i):Math.ceil((i.byteLength||i.size)*$T)}function WT(i){let e=0,t=0;for(let r=0,n=i.length;r<n;r++)e=i.charCodeAt(r),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(r++,t+=4);return t}function _v(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function KT(i){let e="";for(let t in i)i.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(i[t]));return e}function ZT(i){let e={},t=i.split("&");for(let r=0,n=t.length;r<n;r++){let s=t[r].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}class JT extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}}class Ou extends Nt{constructor(e){super(),this.writable=!1,Fs(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,r){return super.emitReserved("error",new JT(e,t,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Pu(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=KT(e);return t.length?"?"+t:""}}class QT extends Ou{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||t()})),this.writable||(r++,this.once("drain",function(){--r||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};XT(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,UT(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=_v()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let bv=!1;try{bv=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const tI=bv;function eI(){}class rI extends QT{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let r=location.port;r||(r=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||r!==e.port}}doWrite(e,t){const r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(n,s)=>{this.onError("xhr post error",n,s)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,r)=>{this.onError("xhr poll error",t,r)}),this.pollXhr=e}}class Se extends Nt{constructor(e,t,r){super(),this.createRequest=e,Fs(this,r),this._opts=r,this._method=r.method||"GET",this._uri=t,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var e;const t=gv(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(t);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let n in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(n)&&r.setRequestHeader(n,this._opts.extraHeaders[n])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var n;r.readyState===3&&((n=this._opts.cookieJar)===null||n===void 0||n.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(n){this.setTimeoutFn(()=>{this._onError(n)},0);return}typeof document<"u"&&(this._index=Se.requestsCount++,Se.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=eI,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Se.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Se.requestsCount=0;Se.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",zc);else if(typeof addEventListener=="function"){const i="onpagehide"in fe?"pagehide":"unload";addEventListener(i,zc,!1)}}function zc(){for(let i in Se.requests)Se.requests.hasOwnProperty(i)&&Se.requests[i].abort()}const iI=(function(){const i=xv({xdomain:!1});return i&&i.responseType!==null})();class nI extends rI{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=iI&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Se(xv,this.uri(),e)}}function xv(i){const e=i.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||tI))return new XMLHttpRequest}catch{}if(!e)try{return new fe[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const wv=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class sI extends Ou{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,r=wv?{}:gv(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,r)}catch(n){return this.emitReserved("error",n)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const r=e[t],n=t===e.length-1;Cu(r,this.supportsBinary,s=>{try{this.doWrite(r,s)}catch{}n&&Rs(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=_v()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const _a=fe.WebSocket||fe.MozWebSocket;class oI extends sI{createSocket(e,t,r){return wv?new _a(e,t,r):t?new _a(e,t):new _a(e)}doWrite(e,t){this.ws.send(t)}}class aI extends Ou{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=GT(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=e.readable.pipeThrough(t).getReader(),n=HT();n.readable.pipeTo(e.writable),this._writer=n.writable.getWriter();const s=()=>{r.read().then(({done:a,value:l})=>{a||(this.onPacket(l),s())}).catch(a=>{})};s();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const r=e[t],n=t===e.length-1;this._writer.write(r).then(()=>{n&&Rs(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const lI={websocket:oI,webtransport:aI,polling:nI},uI=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,hI=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function wl(i){if(i.length>8e3)throw"URI too long";const e=i,t=i.indexOf("["),r=i.indexOf("]");t!=-1&&r!=-1&&(i=i.substring(0,t)+i.substring(t,r).replace(/:/g,";")+i.substring(r,i.length));let n=uI.exec(i||""),s={},o=14;for(;o--;)s[hI[o]]=n[o]||"";return t!=-1&&r!=-1&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=fI(s,s.path),s.queryKey=cI(s,s.query),s}function fI(i,e){const t=/\/{2,9}/g,r=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&r.splice(0,1),e.slice(-1)=="/"&&r.splice(r.length-1,1),r}function cI(i,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,n,s){n&&(t[n]=s)}),t}const Tl=typeof addEventListener=="function"&&typeof removeEventListener=="function",Qn=[];Tl&&addEventListener("offline",()=>{Qn.forEach(i=>i())},!1);class sr extends Nt{constructor(e,t){if(super(),this.binaryType=zT,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const r=wl(e);t.hostname=r.host,t.secure=r.protocol==="https"||r.protocol==="wss",t.port=r.port,r.query&&(t.query=r.query)}else t.host&&(t.hostname=wl(t.host).host);Fs(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(r=>{const n=r.prototype.name;this.transports.push(n),this._transportsByName[n]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=ZT(this.opts.query)),Tl&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Qn.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=mv,t.transport=e,this.id&&(t.sid=this.id);const r=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&sr.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",sr.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let r=0;r<this.writeBuffer.length;r++){const n=this.writeBuffer[r].data;if(n&&(t+=jT(n)),r>0&&t>this._maxPayload)return this.writeBuffer.slice(0,r);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Rs(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,r){return this._sendPacket("message",e,t,r),this}send(e,t,r){return this._sendPacket("message",e,t,r),this}_sendPacket(e,t,r,n){if(typeof t=="function"&&(n=t,t=void 0),typeof r=="function"&&(n=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const s={type:e,data:t,options:r};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),n&&this.once("flush",n),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}_onError(e){if(sr.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Tl&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=Qn.indexOf(this._offlineEventListener);r!==-1&&Qn.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}sr.protocol=mv;class dI extends sr{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),r=!1;sr.priorWebsocketSuccess=!1;const n=()=>{r||(t.send([{type:"ping",data:"probe"}]),t.once("packet",f=>{if(!r)if(f.type==="pong"&&f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;sr.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(h(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const c=new Error("probe error");c.transport=t.name,this.emitReserved("upgradeError",c)}}))};function s(){r||(r=!0,h(),t.close(),t=null)}const o=f=>{const c=new Error("probe error: "+f);c.transport=t.name,s(),this.emitReserved("upgradeError",c)};function a(){o("transport closed")}function l(){o("socket closed")}function u(f){t&&f.name!==t.name&&s()}const h=()=>{t.removeListener("open",n),t.removeListener("error",o),t.removeListener("close",a),this.off("close",l),this.off("upgrading",u)};t.once("open",n),t.once("error",o),t.once("close",a),this.once("close",l),this.once("upgrading",u),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{r||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let r=0;r<e.length;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}}let pI=class extends dI{constructor(e,t={}){const r=typeof e=="object"?e:t;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(n=>lI[n]).filter(n=>!!n)),super(e,r)}};function yI(i,e="",t){let r=i;t=t||typeof location<"u"&&location,i==null&&(i=t.protocol+"//"+t.host),typeof i=="string"&&(i.charAt(0)==="/"&&(i.charAt(1)==="/"?i=t.protocol+i:i=t.host+i),/^(https?|wss?):\/\//.test(i)||(typeof t<"u"?i=t.protocol+"//"+i:i="https://"+i),r=wl(i)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const s=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+s+":"+r.port+e,r.href=r.protocol+"://"+s+(t&&t.port===r.port?"":":"+r.port),r}const vI=typeof ArrayBuffer=="function",mI=i=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(i):i.buffer instanceof ArrayBuffer,Tv=Object.prototype.toString,gI=typeof Blob=="function"||typeof Blob<"u"&&Tv.call(Blob)==="[object BlobConstructor]",_I=typeof File=="function"||typeof File<"u"&&Tv.call(File)==="[object FileConstructor]";function Ru(i){return vI&&(i instanceof ArrayBuffer||mI(i))||gI&&i instanceof Blob||_I&&i instanceof File}function ts(i,e){if(!i||typeof i!="object")return!1;if(Array.isArray(i)){for(let t=0,r=i.length;t<r;t++)if(ts(i[t]))return!0;return!1}if(Ru(i))return!0;if(i.toJSON&&typeof i.toJSON=="function"&&arguments.length===1)return ts(i.toJSON(),!0);for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t)&&ts(i[t]))return!0;return!1}function bI(i){const e=[],t=i.data,r=i;return r.data=Il(t,e),r.attachments=e.length,{packet:r,buffers:e}}function Il(i,e){if(!i)return i;if(Ru(i)){const t={_placeholder:!0,num:e.length};return e.push(i),t}else if(Array.isArray(i)){const t=new Array(i.length);for(let r=0;r<i.length;r++)t[r]=Il(i[r],e);return t}else if(typeof i=="object"&&!(i instanceof Date)){const t={};for(const r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=Il(i[r],e));return t}return i}function xI(i,e){return i.data=El(i.data,e),delete i.attachments,i}function El(i,e){if(!i)return i;if(i&&i._placeholder===!0){if(typeof i.num=="number"&&i.num>=0&&i.num<e.length)return e[i.num];throw new Error("illegal attachments")}else if(Array.isArray(i))for(let t=0;t<i.length;t++)i[t]=El(i[t],e);else if(typeof i=="object")for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&(i[t]=El(i[t],e));return i}const wI=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],TI=5;var pt;(function(i){i[i.CONNECT=0]="CONNECT",i[i.DISCONNECT=1]="DISCONNECT",i[i.EVENT=2]="EVENT",i[i.ACK=3]="ACK",i[i.CONNECT_ERROR=4]="CONNECT_ERROR",i[i.BINARY_EVENT=5]="BINARY_EVENT",i[i.BINARY_ACK=6]="BINARY_ACK"})(pt||(pt={}));class II{constructor(e){this.replacer=e}encode(e){return(e.type===pt.EVENT||e.type===pt.ACK)&&ts(e)?this.encodeAsBinary({type:e.type===pt.EVENT?pt.BINARY_EVENT:pt.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===pt.BINARY_EVENT||e.type===pt.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=bI(e),r=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(r),n}}function Vc(i){return Object.prototype.toString.call(i)==="[object Object]"}class Fu extends Nt{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const r=t.type===pt.BINARY_EVENT;r||t.type===pt.BINARY_ACK?(t.type=r?pt.EVENT:pt.ACK,this.reconstructor=new EI(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(Ru(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const r={type:Number(e.charAt(0))};if(pt[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===pt.BINARY_EVENT||r.type===pt.BINARY_ACK){const s=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const o=e.substring(s,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");r.attachments=Number(o)}if(e.charAt(t+1)==="/"){const s=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););r.nsp=e.substring(s,t)}else r.nsp="/";const n=e.charAt(t+1);if(n!==""&&Number(n)==n){const s=t+1;for(;++t;){const o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}r.id=Number(e.substring(s,t+1))}if(e.charAt(++t)){const s=this.tryParse(e.substr(t));if(Fu.isPayloadValid(r.type,s))r.data=s;else throw new Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case pt.CONNECT:return Vc(t);case pt.DISCONNECT:return t===void 0;case pt.CONNECT_ERROR:return typeof t=="string"||Vc(t);case pt.EVENT:case pt.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&wI.indexOf(t[0])===-1);case pt.ACK:case pt.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class EI{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=xI(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const SI=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Fu,Encoder:II,get PacketType(){return pt},protocol:TI},Symbol.toStringTag,{value:"Module"}));function _e(i,e,t){return i.on(e,t),function(){i.off(e,t)}}const AI=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Iv extends Nt{constructor(e,t,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[_e(e,"open",this.onopen.bind(this)),_e(e,"packet",this.onpacket.bind(this)),_e(e,"error",this.onerror.bind(this)),_e(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var r,n,s;if(AI.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const o={type:pt.EVENT,data:t};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const h=this.ids++,f=t.pop();this._registerAckCallback(h,f),o.id=h}const a=(n=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||n===void 0?void 0:n.writable,l=this.connected&&!(!((s=this.io.engine)===null||s===void 0)&&s._hasPingExpired());return this.flags.volatile&&!a||(l?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var r;const n=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(n===void 0){this.acks[e]=t;return}const s=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===e&&this.sendBuffer.splice(a,1);t.call(this,new Error("operation has timed out"))},n),o=(...a)=>{this.io.clearTimeoutFn(s),t.apply(this,a)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((r,n)=>{const s=(o,a)=>o?n(o):r(a);s.withError=!0,t.push(s),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((n,...s)=>r!==this._queue[0]?void 0:(n!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(n)):(this._queue.shift(),t&&t(null,...s)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:pt.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(r=>String(r.id)===e)){const r=this.acks[e];delete this.acks[e],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case pt.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case pt.EVENT:case pt.BINARY_EVENT:this.onevent(e);break;case pt.ACK:case pt.BINARY_ACK:this.onack(e);break;case pt.DISCONNECT:this.ondisconnect();break;case pt.CONNECT_ERROR:this.destroy();const r=new Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const r of t)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let r=!1;return function(...n){r||(r=!0,t.packet({type:pt.ACK,id:e,data:n}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:pt.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const r of t)r.apply(this,e.data)}}}function Ti(i){i=i||{},this.ms=i.min||100,this.max=i.max||1e4,this.factor=i.factor||2,this.jitter=i.jitter>0&&i.jitter<=1?i.jitter:0,this.attempts=0}Ti.prototype.duration=function(){var i=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*i);i=(Math.floor(e*10)&1)==0?i-t:i+t}return Math.min(i,this.max)|0};Ti.prototype.reset=function(){this.attempts=0};Ti.prototype.setMin=function(i){this.ms=i};Ti.prototype.setMax=function(i){this.max=i};Ti.prototype.setJitter=function(i){this.jitter=i};class Sl extends Nt{constructor(e,t){var r;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,Fs(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((r=t.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new Ti({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const n=t.parser||SI;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new pI(this.uri,this.opts);const t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const n=_e(t,"open",function(){r.onopen(),e&&e()}),s=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),e?e(a):this.maybeReconnectOnOpen()},o=_e(t,"error",s);if(this._timeout!==!1){const a=this._timeout,l=this.setTimeoutFn(()=>{n(),s(new Error("timeout")),t.close()},a);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(n),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(_e(e,"ping",this.onping.bind(this)),_e(e,"data",this.ondata.bind(this)),_e(e,"error",this.onerror.bind(this)),_e(e,"close",this.onclose.bind(this)),_e(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){Rs(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new Iv(this,e,t),this.nsps[e]=r),r}_destroy(e){const t=Object.keys(this.nsps);for(const r of t)if(this.nsps[r].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(n=>{n?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",n)):e.onreconnect()}))},t);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Fi={};function es(i,e){typeof i=="object"&&(e=i,i=void 0),e=e||{};const t=yI(i,e.path||"/socket.io"),r=t.source,n=t.id,s=t.path,o=Fi[n]&&s in Fi[n].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let l;return a?l=new Sl(r,e):(Fi[n]||(Fi[n]=new Sl(r,e)),l=Fi[n]),t.query&&!e.query&&(e.query=t.queryKey),l.socket(t.path,e)}Object.assign(es,{Manager:Sl,Socket:Iv,io:es,connect:es});var ba={exports:{}};/*!
 * EventEmitter2
 * https://github.com/hij1nx/EventEmitter2
 *
 * Copyright (c) 2013 hij1nx
 * Licensed under the MIT license.
 */var qc;function CI(){return qc||(qc=1,(function(i,e){(function(t){var r=Object.hasOwnProperty,n=Array.isArray?Array.isArray:function(_){return Object.prototype.toString.call(_)==="[object Array]"},s=10,o=typeof process=="object"&&typeof process.nextTick=="function",a=typeof Symbol=="function",l=typeof Reflect=="object",u=typeof setImmediate=="function",h=u?setImmediate:setTimeout,f=a?l&&typeof Reflect.ownKeys=="function"?Reflect.ownKeys:function(y){var _=Object.getOwnPropertyNames(y);return _.push.apply(_,Object.getOwnPropertySymbols(y)),_}:Object.keys;function c(){this._events={},this._conf&&d.call(this,this._conf)}function d(y){y&&(this._conf=y,y.delimiter&&(this.delimiter=y.delimiter),y.maxListeners!==t&&(this._maxListeners=y.maxListeners),y.wildcard&&(this.wildcard=y.wildcard),y.newListener&&(this._newListener=y.newListener),y.removeListener&&(this._removeListener=y.removeListener),y.verboseMemoryLeak&&(this.verboseMemoryLeak=y.verboseMemoryLeak),y.ignoreErrors&&(this.ignoreErrors=y.ignoreErrors),this.wildcard&&(this.listenerTree={}))}function p(y,_){var x="(node) warning: possible EventEmitter memory leak detected. "+y+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(x+=" Event name: "+_+"."),typeof process<"u"&&process.emitWarning){var T=new Error(x);T.name="MaxListenersExceededWarning",T.emitter=this,T.count=y,process.emitWarning(T)}else console.error(x),console.trace&&console.trace()}var m=function(y,_,x){var T=arguments.length;switch(T){case 0:return[];case 1:return[y];case 2:return[y,_];case 3:return[y,_,x];default:for(var S=new Array(T);T--;)S[T]=arguments[T];return S}};function v(y,_){for(var x={},T,S=y.length,P=0,L=0;L<S;L++)T=y[L],x[T]=L<P?_[L]:t;return x}function g(y,_,x){this._emitter=y,this._target=_,this._listeners={},this._listenersCount=0;var T,S;if((x.on||x.off)&&(T=x.on,S=x.off),_.addEventListener?(T=_.addEventListener,S=_.removeEventListener):_.addListener?(T=_.addListener,S=_.removeListener):_.on&&(T=_.on,S=_.off),!T&&!S)throw Error("target does not implement any known event API");if(typeof T!="function")throw TypeError("on method must be a function");if(typeof S!="function")throw TypeError("off method must be a function");this._on=T,this._off=S;var P=y._observers;P?P.push(this):y._observers=[this]}Object.assign(g.prototype,{subscribe:function(y,_,x){var T=this,S=this._target,P=this._emitter,L=this._listeners,N=function(){var k=m.apply(null,arguments),U={data:k,name:_,original:y};if(x){var $=x.call(S,U);$!==!1&&P.emit.apply(P,[U.name].concat(k));return}P.emit.apply(P,[_].concat(k))};if(L[y])throw Error("Event '"+y+"' is already listening");this._listenersCount++,P._newListener&&P._removeListener&&!T._onNewListener?(this._onNewListener=function(k){k===_&&L[y]===null&&(L[y]=N,T._on.call(S,y,N))},P.on("newListener",this._onNewListener),this._onRemoveListener=function(k){k===_&&!P.hasListeners(k)&&L[y]&&(L[y]=null,T._off.call(S,y,N))},L[y]=null,P.on("removeListener",this._onRemoveListener)):(L[y]=N,T._on.call(S,y,N))},unsubscribe:function(y){var _=this,x=this._listeners,T=this._emitter,S,P,L=this._off,N=this._target,k;if(y&&typeof y!="string")throw TypeError("event must be a string");function U(){_._onNewListener&&(T.off("newListener",_._onNewListener),T.off("removeListener",_._onRemoveListener),_._onNewListener=null,_._onRemoveListener=null);var $=H.call(T,_);T._observers.splice($,1)}if(y){if(S=x[y],!S)return;L.call(N,y,S),delete x[y],--this._listenersCount||U()}else{for(P=f(x),k=P.length;k-- >0;)y=P[k],L.call(N,y,x[y]);this._listeners={},this._listenersCount=0,U()}}});function I(y,_,x,T){var S=Object.assign({},_);if(!y)return S;if(typeof y!="object")throw TypeError("options must be an object");var P=Object.keys(y),L=P.length,N,k,U;function $(z){throw Error('Invalid "'+N+'" option value'+(z?". Reason: "+z:""))}for(var W=0;W<L;W++){if(N=P[W],!r.call(_,N))throw Error('Unknown "'+N+'" option');k=y[N],k!==t&&(U=x[N],S[N]=U?U(k,$):k)}return S}function w(y,_){return(typeof y!="function"||!y.hasOwnProperty("prototype"))&&_("value must be a constructor"),y}function M(y){var _="value must be type of "+y.join("|"),x=y.length,T=y[0],S=y[1];return x===1?function(P,L){if(typeof P===T)return P;L(_)}:x===2?function(P,L){var N=typeof P;if(N===T||N===S)return P;L(_)}:function(P,L){for(var N=typeof P,k=x;k-- >0;)if(N===y[k])return P;L(_)}}var b=M(["function"]),R=M(["object","function"]);function C(y,_,x){var T,S,P=0,L,N=new y(function(k,U,$){x=I(x,{timeout:0,overload:!1},{timeout:function(j,it){return j*=1,(typeof j!="number"||j<0||!Number.isFinite(j))&&it("timeout must be a positive number"),j}}),T=!x.overload&&typeof y.prototype.cancel=="function"&&typeof $=="function";function W(){S&&(S=null),P&&(clearTimeout(P),P=0)}var z=function(j){W(),k(j)},Z=function(j){W(),U(j)};T?_(z,Z,$):(S=[function(j){Z(j||Error("canceled"))}],_(z,Z,function(j){if(L)throw Error("Unable to subscribe on cancel event asynchronously");if(typeof j!="function")throw TypeError("onCancel callback must be a function");S.push(j)}),L=!0),x.timeout>0&&(P=setTimeout(function(){var j=Error("timeout");j.code="ETIMEDOUT",P=0,N.cancel(j),U(j)},x.timeout))});return T||(N.cancel=function(k){if(S){for(var U=S.length,$=1;$<U;$++)S[$](k);S[0](k),S=null}}),N}function H(y){var _=this._observers;if(!_)return-1;for(var x=_.length,T=0;T<x;T++)if(_[T]._target===y)return T;return-1}function F(y,_,x,T,S){if(!x)return null;if(T===0){var P=typeof _;if(P==="string"){var L,N,k=0,U=0,$=this.delimiter,W=$.length;if((N=_.indexOf($))!==-1){L=new Array(5);do L[k++]=_.slice(U,N),U=N+W;while((N=_.indexOf($,U))!==-1);L[k++]=_.slice(U),_=L,S=k}else _=[_],S=1}else P==="object"?S=_.length:(_=[_],S=1)}var z=null,Z,j,it,at,et,rt=_[T],xt=_[T+1],bt,St;if(T===S)x._listeners&&(typeof x._listeners=="function"?(y&&y.push(x._listeners),z=[x]):(y&&y.push.apply(y,x._listeners),z=[x]));else if(rt==="*"){for(bt=f(x),N=bt.length;N-- >0;)Z=bt[N],Z!=="_listeners"&&(St=F(y,_,x[Z],T+1,S),St&&(z?z.push.apply(z,St):z=St));return z}else if(rt==="**"){for(et=T+1===S||T+2===S&&xt==="*",et&&x._listeners&&(z=F(y,_,x,S,S)),bt=f(x),N=bt.length;N-- >0;)Z=bt[N],Z!=="_listeners"&&(Z==="*"||Z==="**"?(x[Z]._listeners&&!et&&(St=F(y,_,x[Z],S,S),St&&(z?z.push.apply(z,St):z=St)),St=F(y,_,x[Z],T,S)):Z===xt?St=F(y,_,x[Z],T+2,S):St=F(y,_,x[Z],T,S),St&&(z?z.push.apply(z,St):z=St));return z}else x[rt]&&(z=F(y,_,x[rt],T+1,S));if(j=x["*"],j&&F(y,_,j,T+1,S),it=x["**"],it)if(T<S)for(it._listeners&&F(y,_,it,S,S),bt=f(it),N=bt.length;N-- >0;)Z=bt[N],Z!=="_listeners"&&(Z===xt?F(y,_,it[Z],T+2,S):Z===rt?F(y,_,it[Z],T+1,S):(at={},at[Z]=it[Z],F(y,_,{"**":at},T+1,S)));else it._listeners?F(y,_,it,S,S):it["*"]&&it["*"]._listeners&&F(y,_,it["*"],S,S);return z}function B(y,_,x){var T=0,S=0,P,L=this.delimiter,N=L.length,k;if(typeof y=="string")if((P=y.indexOf(L))!==-1){k=new Array(5);do k[T++]=y.slice(S,P),S=P+N;while((P=y.indexOf(L,S))!==-1);k[T++]=y.slice(S)}else k=[y],T=1;else k=y,T=y.length;if(T>1){for(P=0;P+1<T;P++)if(k[P]==="**"&&k[P+1]==="**")return}var U=this.listenerTree,$;for(P=0;P<T;P++)if($=k[P],U=U[$]||(U[$]={}),P===T-1)return U._listeners?(typeof U._listeners=="function"&&(U._listeners=[U._listeners]),x?U._listeners.unshift(_):U._listeners.push(_),!U._listeners.warned&&this._maxListeners>0&&U._listeners.length>this._maxListeners&&(U._listeners.warned=!0,p.call(this,U._listeners.length,$))):U._listeners=_,!0;return!0}function Y(y,_,x,T){for(var S=f(y),P=S.length,L,N,k,U=y._listeners,$;P-- >0;)N=S[P],L=y[N],N==="_listeners"?k=x:k=x?x.concat(N):[N],$=T||typeof N=="symbol",U&&_.push($?k:k.join(this.delimiter)),typeof L=="object"&&Y.call(this,L,_,k,$);return _}function D(y){for(var _=f(y),x=_.length,T,S,P;x-- >0;)S=_[x],T=y[S],T&&(P=!0,S!=="_listeners"&&!D(T)&&delete y[S]);return P}function J(y,_,x){this.emitter=y,this.event=_,this.listener=x}J.prototype.off=function(){return this.emitter.off(this.event,this.listener),this};function Q(y,_,x){if(x===!0)S=!0;else if(x===!1)T=!0;else{if(!x||typeof x!="object")throw TypeError("options should be an object or true");var T=x.async,S=x.promisify,P=x.nextTick,L=x.objectify}if(T||P||S){var N=_,k=_._origin||_;if(P&&!o)throw Error("process.nextTick is not supported");S===t&&(S=_.constructor.name==="AsyncFunction"),_=function(){var U=arguments,$=this,W=this.event;return S?P?Promise.resolve():new Promise(function(z){h(z)}).then(function(){return $.event=W,N.apply($,U)}):(P?process.nextTick:h)(function(){$.event=W,N.apply($,U)})},_._async=!0,_._origin=k}return[_,L?new J(this,y,_):this]}function q(y){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,d.call(this,y)}q.EventEmitter2=q,q.prototype.listenTo=function(y,_,x){if(typeof y!="object")throw TypeError("target musts be an object");var T=this;x=I(x,{on:t,off:t,reducers:t},{on:b,off:b,reducers:R});function S(P){if(typeof P!="object")throw TypeError("events must be an object");var L=x.reducers,N=H.call(T,y),k;N===-1?k=new g(T,y,x):k=T._observers[N];for(var U=f(P),$=U.length,W,z=typeof L=="function",Z=0;Z<$;Z++)W=U[Z],k.subscribe(W,P[W]||W,z?L:L&&L[W])}return n(_)?S(v(_)):S(typeof _=="string"?v(_.split(/\s+/)):_),this},q.prototype.stopListeningTo=function(y,_){var x=this._observers;if(!x)return!1;var T=x.length,S,P=!1;if(y&&typeof y!="object")throw TypeError("target should be an object");for(;T-- >0;)S=x[T],(!y||S._target===y)&&(S.unsubscribe(_),P=!0);return P},q.prototype.delimiter=".",q.prototype.setMaxListeners=function(y){y!==t&&(this._maxListeners=y,this._conf||(this._conf={}),this._conf.maxListeners=y)},q.prototype.getMaxListeners=function(){return this._maxListeners},q.prototype.event="",q.prototype.once=function(y,_,x){return this._once(y,_,!1,x)},q.prototype.prependOnceListener=function(y,_,x){return this._once(y,_,!0,x)},q.prototype._once=function(y,_,x,T){return this._many(y,1,_,x,T)},q.prototype.many=function(y,_,x,T){return this._many(y,_,x,!1,T)},q.prototype.prependMany=function(y,_,x,T){return this._many(y,_,x,!0,T)},q.prototype._many=function(y,_,x,T,S){var P=this;if(typeof x!="function")throw new Error("many only accepts instances of Function");function L(){return--_===0&&P.off(y,L),x.apply(this,arguments)}return L._origin=x,this._on(y,L,T,S)},q.prototype.emit=function(){if(!this._events&&!this._all)return!1;this._events||c.call(this);var y=arguments[0],_,x=this.wildcard,T,S,P,L,N;if(y==="newListener"&&!this._newListener&&!this._events.newListener)return!1;if(x&&(_=y,y!=="newListener"&&y!=="removeListener"&&typeof y=="object")){if(S=y.length,a){for(P=0;P<S;P++)if(typeof y[P]=="symbol"){N=!0;break}}N||(y=y.join(this.delimiter))}var k=arguments.length,U;if(this._all&&this._all.length)for(U=this._all.slice(),P=0,S=U.length;P<S;P++)switch(this.event=y,k){case 1:U[P].call(this,y);break;case 2:U[P].call(this,y,arguments[1]);break;case 3:U[P].call(this,y,arguments[1],arguments[2]);break;default:U[P].apply(this,arguments)}if(x)U=[],F.call(this,U,_,this.listenerTree,0,S);else if(U=this._events[y],typeof U=="function"){switch(this.event=y,k){case 1:U.call(this);break;case 2:U.call(this,arguments[1]);break;case 3:U.call(this,arguments[1],arguments[2]);break;default:for(T=new Array(k-1),L=1;L<k;L++)T[L-1]=arguments[L];U.apply(this,T)}return!0}else U&&(U=U.slice());if(U&&U.length){if(k>3)for(T=new Array(k-1),L=1;L<k;L++)T[L-1]=arguments[L];for(P=0,S=U.length;P<S;P++)switch(this.event=y,k){case 1:U[P].call(this);break;case 2:U[P].call(this,arguments[1]);break;case 3:U[P].call(this,arguments[1],arguments[2]);break;default:U[P].apply(this,T)}return!0}else if(!this.ignoreErrors&&!this._all&&y==="error")throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},q.prototype.emitAsync=function(){if(!this._events&&!this._all)return!1;this._events||c.call(this);var y=arguments[0],_=this.wildcard,x,T,S,P,L,N;if(y==="newListener"&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);if(_&&(x=y,y!=="newListener"&&y!=="removeListener"&&typeof y=="object")){if(P=y.length,a){for(L=0;L<P;L++)if(typeof y[L]=="symbol"){T=!0;break}}T||(y=y.join(this.delimiter))}var k=[],U=arguments.length,$;if(this._all)for(L=0,P=this._all.length;L<P;L++)switch(this.event=y,U){case 1:k.push(this._all[L].call(this,y));break;case 2:k.push(this._all[L].call(this,y,arguments[1]));break;case 3:k.push(this._all[L].call(this,y,arguments[1],arguments[2]));break;default:k.push(this._all[L].apply(this,arguments))}if(_?($=[],F.call(this,$,x,this.listenerTree,0)):$=this._events[y],typeof $=="function")switch(this.event=y,U){case 1:k.push($.call(this));break;case 2:k.push($.call(this,arguments[1]));break;case 3:k.push($.call(this,arguments[1],arguments[2]));break;default:for(S=new Array(U-1),N=1;N<U;N++)S[N-1]=arguments[N];k.push($.apply(this,S))}else if($&&$.length){if($=$.slice(),U>3)for(S=new Array(U-1),N=1;N<U;N++)S[N-1]=arguments[N];for(L=0,P=$.length;L<P;L++)switch(this.event=y,U){case 1:k.push($[L].call(this));break;case 2:k.push($[L].call(this,arguments[1]));break;case 3:k.push($[L].call(this,arguments[1],arguments[2]));break;default:k.push($[L].apply(this,S))}}else if(!this.ignoreErrors&&!this._all&&y==="error")return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(k)},q.prototype.on=function(y,_,x){return this._on(y,_,!1,x)},q.prototype.prependListener=function(y,_,x){return this._on(y,_,!0,x)},q.prototype.onAny=function(y){return this._onAny(y,!1)},q.prototype.prependAny=function(y){return this._onAny(y,!0)},q.prototype.addListener=q.prototype.on,q.prototype._onAny=function(y,_){if(typeof y!="function")throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),_?this._all.unshift(y):this._all.push(y),this},q.prototype._on=function(y,_,x,T){if(typeof y=="function")return this._onAny(y,_),this;if(typeof _!="function")throw new Error("on only accepts instances of Function");this._events||c.call(this);var S=this,P;return T!==t&&(P=Q.call(this,y,_,T),_=P[0],S=P[1]),this._newListener&&this.emit("newListener",y,_),this.wildcard?(B.call(this,y,_,x),S):(this._events[y]?(typeof this._events[y]=="function"&&(this._events[y]=[this._events[y]]),x?this._events[y].unshift(_):this._events[y].push(_),!this._events[y].warned&&this._maxListeners>0&&this._events[y].length>this._maxListeners&&(this._events[y].warned=!0,p.call(this,this._events[y].length,y))):this._events[y]=_,S)},q.prototype.off=function(y,_){if(typeof _!="function")throw new Error("removeListener only takes instances of Function");var x,T=[];if(this.wildcard){var S=typeof y=="string"?y.split(this.delimiter):y.slice();if(T=F.call(this,null,S,this.listenerTree,0),!T)return this}else{if(!this._events[y])return this;x=this._events[y],T.push({_listeners:x})}for(var P=0;P<T.length;P++){var L=T[P];if(x=L._listeners,n(x)){for(var N=-1,k=0,U=x.length;k<U;k++)if(x[k]===_||x[k].listener&&x[k].listener===_||x[k]._origin&&x[k]._origin===_){N=k;break}if(N<0)continue;return this.wildcard?L._listeners.splice(N,1):this._events[y].splice(N,1),x.length===0&&(this.wildcard?delete L._listeners:delete this._events[y]),this._removeListener&&this.emit("removeListener",y,_),this}else(x===_||x.listener&&x.listener===_||x._origin&&x._origin===_)&&(this.wildcard?delete L._listeners:delete this._events[y],this._removeListener&&this.emit("removeListener",y,_))}return this.listenerTree&&D(this.listenerTree),this},q.prototype.offAny=function(y){var _=0,x=0,T;if(y&&this._all&&this._all.length>0){for(T=this._all,_=0,x=T.length;_<x;_++)if(y===T[_])return T.splice(_,1),this._removeListener&&this.emit("removeListenerAny",y),this}else{if(T=this._all,this._removeListener)for(_=0,x=T.length;_<x;_++)this.emit("removeListenerAny",T[_]);this._all=[]}return this},q.prototype.removeListener=q.prototype.off,q.prototype.removeAllListeners=function(y){if(y===t)return!this._events||c.call(this),this;if(this.wildcard){var _=F.call(this,null,y,this.listenerTree,0),x,T;if(!_)return this;for(T=0;T<_.length;T++)x=_[T],x._listeners=null;this.listenerTree&&D(this.listenerTree)}else this._events&&(this._events[y]=null);return this},q.prototype.listeners=function(y){var _=this._events,x,T,S,P,L;if(y===t){if(this.wildcard)throw Error("event name required for wildcard emitter");if(!_)return[];for(x=f(_),P=x.length,S=[];P-- >0;)T=_[x[P]],typeof T=="function"?S.push(T):S.push.apply(S,T);return S}else{if(this.wildcard){if(L=this.listenerTree,!L)return[];var N=[],k=typeof y=="string"?y.split(this.delimiter):y.slice();return F.call(this,N,k,L,0),N}return _?(T=_[y],T?typeof T=="function"?[T]:T:[]):[]}},q.prototype.eventNames=function(y){var _=this._events;return this.wildcard?Y.call(this,this.listenerTree,[],null,y):_?f(_):[]},q.prototype.listenerCount=function(y){return this.listeners(y).length},q.prototype.hasListeners=function(y){if(this.wildcard){var _=[],x=typeof y=="string"?y.split(this.delimiter):y.slice();return F.call(this,_,x,this.listenerTree,0),_.length>0}var T=this._events,S=this._all;return!!(S&&S.length||T&&(y===t?f(T).length:T[y]))},q.prototype.listenersAny=function(){return this._all?this._all:[]},q.prototype.waitFor=function(y,_){var x=this,T=typeof _;return T==="number"?_={timeout:_}:T==="function"&&(_={filter:_}),_=I(_,{timeout:0,filter:t,handleError:!1,Promise,overload:!1},{filter:b,Promise:w}),C(_.Promise,function(S,P,L){function N(){var k=_.filter;if(!(k&&!k.apply(x,arguments)))if(x.off(y,N),_.handleError){var U=arguments[0];U?P(U):S(m.apply(null,arguments).slice(1))}else S(m.apply(null,arguments))}L(function(){x.off(y,N)}),x._on(y,N,!1)},{timeout:_.timeout,overload:_.overload})};function A(y,_,x){x=I(x,{Promise,timeout:0,overload:!1},{Promise:w});var T=x.Promise;return C(T,function(S,P,L){var N;if(typeof y.addEventListener=="function"){N=function(){S(m.apply(null,arguments))},L(function(){y.removeEventListener(_,N)}),y.addEventListener(_,N,{once:!0});return}var k=function(){U&&y.removeListener("error",U),S(m.apply(null,arguments))},U;_!=="error"&&(U=function($){y.removeListener(_,k),P($)},y.once("error",U)),L(function(){U&&y.removeListener("error",U),y.removeListener(_,k)}),y.once(_,k)},{timeout:x.timeout,overload:x.overload})}var O=q.prototype;Object.defineProperties(q,{defaultMaxListeners:{get:function(){return O._maxListeners},set:function(y){if(typeof y!="number"||y<0||Number.isNaN(y))throw TypeError("n must be a non-negative number");O._maxListeners=y},enumerable:!0},once:{value:A,writable:!0,configurable:!0}}),Object.defineProperties(O,{_maxListeners:{value:s,writable:!0,configurable:!0},_observers:{value:null,writable:!0,configurable:!0}}),i.exports=q})()})(ba)),ba.exports}var PI=CI();class OI extends PI.EventEmitter2{constructor(e){super(),this.game=e,this.sequenceCounter=0,this.lastServerSequence=0}listen(){this.io=es("http://localhost:8021",{transports:["websocket"]}),this.io.on("connect",()=>{console.log("connected"),this.sequenceCounter=0,this.lastServerSequence=0,this.emit("connected"),this.requestLobbySnapshot()}),this.io.on("connect_error",e=>{console.error("socket connect_error",e?.message??e)}),this.io.on("disconnect",e=>{console.warn("socket disconnected",e),this.lastServerSequence=0,this.emit("disconnected",e)}),this.io.on("lobby:snapshot",e=>{const t=this.safeParse(e);this.emit("lobby:snapshot",t)}),this.io.on("lobby:update",e=>{const t=this.safeParse(e);this.emit("lobby:update",t)}),this.io.on("lobby:assignment",e=>{const t=this.safeParse(e);t&&this.game&&this.game.player&&(t.city!==void 0&&t.city!==null&&(this.game.player.city=this.toFiniteNumber(t.city,this.game.player.city??0)),t.role&&(this.game.player.isMayor=t.role==="mayor")),this.emit("lobby:assignment",t)}),this.io.on("lobby:denied",e=>{const t=this.safeParse(e);this.emit("lobby:denied",t)}),this.io.on("enter_game",e=>{const t=this.normalisePlayerPayload(e);t&&this.applyPlayerUpdate(t,{source:"enter_game"})}),this.io.on("player",e=>{const t=this.normalisePlayerPayload(e);t&&this.applyPlayerUpdate(t,{source:"player"})}),this.io.on("players:snapshot",e=>{const t=this.safeParse(e);Array.isArray(t)&&t.forEach(r=>{const n=this.normalisePlayerPayload(r);n&&this.applyPlayerUpdate(n,{source:"snapshot"})})}),this.io.on("player:removed",e=>{const t=this.safeParse(e);!t||!t.id||this.io?.id&&t.id===this.io.id||delete this.game.otherPlayers[t.id]}),this.io.on("player:rejected",e=>{const t=this.safeParse(e);if(t&&(Array.isArray(t.reasons)&&t.reasons.length&&console.warn("Authoritative server rejected player update",t.reasons),t.player)){const r=this.normalisePlayerPayload(t.player);if(!r)return;this.applyPlayerUpdate(r,{source:"rejected"})}}),this.io.on("bullet_shot",t=>{var t=JSON.parse(t);const r={sourceId:t.sourceId??null,sourceType:t.sourceType??null,targetId:t.targetId??null};if(t.damage!==void 0){const n=Number(t.damage);Number.isFinite(n)&&(r.damage=n)}this.game.bulletFactory.newBullet(t.shooter,t.x,t.y,t.type,t.angle,t.team??null,r)}),this.io.on("new_icon",e=>{const t=typeof e=="string"?JSON.parse(e):e;if(!t)return;const r=t.ownerId??t.owner??null;this.game.iconFactory.newIcon(r,t.x,t.y,t.type,{sourceBuildingId:t.buildingId??t.sourceBuildingId??null,city:t.cityId??null,teamId:t.teamId??t.cityId??null,quantity:t.quantity??1,armed:!!t.armed})}),this.io.on("factory:purge",e=>{const t=this.safeParse(e);if(!t||!this.game||!this.game.iconFactory)return;const r=this.toFiniteNumber(t.itemType,null),n=this.toFiniteNumber(t.cityId,null);this.game.iconFactory.purgeCityItems(n,r)}),this.io.on("new_building",e=>{try{const t=typeof e=="string"?JSON.parse(e):e;t&&(t.type=Number(t.type),t.population=t.population||0,t.ownerId=t.ownerId||t.owner||null,t.attachedHouseId=t.attachedHouseId??null,t.city=t.city??0,t.itemsLeft=t.itemsLeft||0,t.smokeActive=!!t.smokeActive,t.smokeFrame=t.smokeFrame||0),this.emit("building:new",t)}catch(t){console.warn("Failed to parse new_building payload",t)}}),this.io.on("population:update",e=>{try{const t=typeof e=="string"?JSON.parse(e):e;t&&(t.type=Number(t.type),t.population=t.population||0,t.attachedHouseId=t.attachedHouseId??null,t.city=t.city??0,t.smokeActive=!!t.smokeActive,t.smokeFrame=t.smokeFrame||0,t.itemsLeft=t.itemsLeft||0),this.emit("population:update",t)}catch(t){console.warn("Failed to parse population update",t)}}),this.io.on("city:finance",e=>{try{const t=typeof e=="string"?JSON.parse(e):e;t&&this.emit("city:finance",t)}catch(t){console.warn("Failed to parse finance update",t)}}),this.io.on("city:info",e=>{const t=this.safeParse(e);!t||typeof t!="object"||(t.cityId===void 0&&t.city!==void 0?t.cityId=this.toFiniteNumber(t.city,t.city):t.cityId!==void 0&&(t.cityId=this.toFiniteNumber(t.cityId,t.cityId)),this.emit("city:info",t))}),this.io.on("city:defenses",e=>{const t=this.safeParse(e);if(!t||t.cityId===void 0)return;const r=this.toFiniteNumber(t.cityId,t.cityId);if(r==null)return;const n=Array.isArray(t.items)?t.items:[];this.game&&typeof this.game.applyDefenseSnapshot=="function"&&this.game.applyDefenseSnapshot(r,n)}),this.io.on("city:defenses:clear",e=>{const t=this.safeParse(e);if(!t||t.cityId===void 0)return;const r=this.toFiniteNumber(t.cityId,t.cityId);r!=null&&this.game&&typeof this.game.clearDefenseItems=="function"&&this.game.clearDefenseItems(r)}),this.io.on("build:denied",e=>{try{const t=typeof e=="string"?JSON.parse(e):e;t&&this.emit("build:denied",t)}catch(t){console.warn("Failed to parse build denied payload",t)}}),this.io.on("demolish_building",e=>{try{const t=typeof e=="string"?JSON.parse(e):e;t&&t.id&&this.game.buildingFactory?.removeBuildingById&&this.game.buildingFactory.removeBuildingById(t.id)}catch(t){console.warn("Failed to handle demolish payload",t)}}),this.io.on("demolish:denied",e=>{const t=this.safeParse(e);this.game.buildingFactory?.handleDemolishDenied&&this.game.buildingFactory.handleDemolishDenied(t)}),this.io.on("player:health",e=>{const t=this.safeParse(e);!t||!t.id||this.applyHealthUpdate(t)}),this.io.on("player:dead",e=>{const t=this.safeParse(e);!t||!t.id||(this.emit("player:dead",t),this.applyHealthUpdate({id:t.id,health:0,source:t.reason}))}),this.io.on("player:status",e=>{const t=this.safeParse(e);!t||!t.id||this.applyStatusUpdate(t)}),this.io.on("hazard:spawn",e=>{const t=this.normaliseHazardPayload(e);t&&this.emit("hazard:spawn",t)}),this.io.on("hazard:update",e=>{const t=this.normaliseHazardPayload(e);t&&this.emit("hazard:update",t)}),this.io.on("hazard:remove",e=>{const t=this.normaliseHazardPayload(e);t&&this.emit("hazard:remove",t)}),this.io.on("orb:result",e=>{const t=this.safeParse(e);this.emit("orb:result",t)}),this.io.on("city:orbed",e=>{const t=this.safeParse(e);this.emit("city:orbed",t)}),this.io.on("lobby:evicted",e=>{const t=this.safeParse(e);this.emit("lobby:evicted",t)})}sendNewBuilding(e){this.io&&!this.io.disconnected&&this.io.emit("new_building",JSON.stringify(e))}sendDemolishBuilding(e){!this.io||this.io.disconnected||!e||this.io.emit("demolish_building",JSON.stringify({id:e}))}requestCityInfo(e){if(!this.io||this.io.disconnected)return;const t=this.toFiniteNumber(e,null);if(!Number.isFinite(t))return;const r=Math.max(0,Math.floor(t));this.io.emit("city:inspect",JSON.stringify({city:r}))}sendBulletShot(e){this.io&&!this.io.disconnected&&this.io.emit("bullet_shot",JSON.stringify(e))}enterGame(e={}){if(console.log("Telling server we've entered the game"),this.io&&!this.io.disconnected){this.sequenceCounter=0,this.game.player.sequence=0;const t=this.createPlayerPayload(),r=this.buildEntryAssignment(e);return Object.assign(t,r),this.io.emit("enter_game",JSON.stringify(t)),this.io.id}return null}requestLobbySnapshot(){this.io&&!this.io.disconnected&&this.io.emit("lobby:refresh")}buildEntryAssignment(e){if(!e||typeof e!="object")return{};const t={},r={};let n=!1;if(e.city!==void 0&&e.city!==null){const s=this.toFiniteNumber(e.city,null);if(Number.isFinite(s)){const o=Math.max(0,Math.floor(s));t.requestedCity=o,r.city=o,r.cityId=o,n=!0}}if(e.role){const s=`${e.role}`.trim().toLowerCase();(s==="mayor"||s==="recruit"||s==="auto")&&(t.requestedRole=s,r.role=s,n=!0)}return e.auto===!0?t.autoAssign=!0:e.auto===!1&&(t.autoAssign=!1),n&&(t.assignment=r),t}cycle(){if(this.io&&!this.io.disconnected){this.sequenceCounter+=1,this.game.player.sequence=this.sequenceCounter;const e=this.createPlayerPayload();this.io.emit("player",JSON.stringify(e))}}spawnHazard(e){!this.io||this.io.disconnected||this.io.emit("hazard:spawn",JSON.stringify(e))}useItem(e,t={}){if(!this.io||this.io.disconnected||!e)return;const r=Object.assign({},t,{type:e});this.io.emit("item:use",JSON.stringify(r))}updateHazard(e){!this.io||this.io.disconnected||this.io.emit("hazard:arm",JSON.stringify(e))}removeHazard(e){!this.io||this.io.disconnected||!e||this.io.emit("hazard:remove",JSON.stringify({id:e}))}spawnDefense(e){if(!this.io||this.io.disconnected||!e)return;const t=typeof e=="string"?e:JSON.stringify(e);this.io.emit("defense:spawn",t)}removeDefense(e){if(!this.io||this.io.disconnected||!e)return;const t=typeof e=="object"?e.id??null:e;t&&this.io.emit("defense:remove",JSON.stringify({id:t}))}collectFactoryItem(e){if(!this.io||this.io.disconnected||!e)return;const t=typeof e=="string"?e:JSON.stringify(e);this.io.emit("factory:collect",t)}sendOrbDrop(e){if(!this.io||this.io.disconnected||e===null||e===void 0)return;const t=typeof e=="string"?e:JSON.stringify(e);this.io.emit("orb:drop",t)}createPlayerPayload(){const e=this.game.player,t=Number.isFinite(e.isMoving)?e.isMoving:Number(e.isMoving),r=Number.isFinite(t)?Math.max(-1,Math.min(1,t)):0,n=Number.isFinite(e.isTurning)?e.isTurning:Number(e.isTurning),s=Number.isFinite(n)?Math.max(-1,Math.min(1,Math.round(n))):0;return{id:e.id,city:e.city,isMayor:e.isMayor,health:e.health,direction:(Math.round(e.direction)%32+32)%32,isTurning:s,isMoving:r,bombsArmed:!!e.bombsArmed,isCloaked:!!e.isCloaked,cloakExpiresAt:e.cloakExpiresAt??0,isFrozen:!!e.isFrozen,frozenUntil:e.frozenUntil??0,sequence:e.sequence,offset:{x:e.offset?.x??0,y:e.offset?.y??0}}}applyPlayerUpdate(e,t={}){if(!e||!e.id)return;const r=this.io?.id;if(r&&e.id===r){this.syncLocalPlayer(e,t);return}const n=this.game.otherPlayers[e.id];if(n&&n.sequence!==void 0&&e.sequence!==void 0&&e.sequence<=n.sequence)return;const s=n?Object.assign({},n,e):Object.assign({},e);!s.callsign&&n&&n.callsign&&(s.callsign=n.callsign),this.game.otherPlayers[e.id]=s}syncLocalPlayer(e,t={}){if(!e||!this.game||!this.game.player)return;const r=this.game.player;if(e.sequence!==void 0&&e.sequence<this.lastServerSequence&&this.lastServerSequence!==0){const l=Math.abs(e.offset.x-r.offset.x),u=Math.abs(e.offset.y-r.offset.y),h=96;if(l<h&&u<h)return}e.sequence!==void 0&&(this.lastServerSequence=Math.max(this.lastServerSequence,e.sequence)),r.id=e.id??r.id,typeof e.callsign=="string"&&e.callsign.trim().length&&(r.callsign=e.callsign.trim());const n=Number.isFinite(r.city)?r.city:null,s=this.toFiniteNumber(e.city,r.city),o=n!==s;if(e.offset&&typeof e.offset=="object"){const l=this.toFiniteNumber(e.offset.x,r.offset.x),u=this.toFiniteNumber(e.offset.y,r.offset.y),h=l-r.offset.x,f=u-r.offset.y,c=h*h+f*f,d=9216,p=.1;c>d?(r.offset.x=l,r.offset.y=u):(r.offset.x+=h*p,r.offset.y+=f*p),r.lastSafeOffset&&(r.lastSafeOffset.x=r.offset.x,r.lastSafeOffset.y=r.offset.y)}if(r.city=s,o){const l=Cs(s);if(l)r.offset.x=l.x,r.offset.y=l.y;else{const u=this.game.cities?.[s];u&&(r.offset.x=u.x+48,r.offset.y=u.y+100)}r.lastSafeOffset&&(r.lastSafeOffset.x=r.offset.x,r.lastSafeOffset.y=r.offset.y)}if(r.isMayor=!!e.isMayor,r.health=this.toFiniteNumber(e.health,r.health),e.isCloaked!==void 0&&(r.isCloaked=!!e.isCloaked),e.cloakExpiresAt!==void 0){const l=this.toFiniteNumber(e.cloakExpiresAt,r.cloakExpiresAt??0);r.cloakExpiresAt=Number.isFinite(l)?Math.max(0,l):0}if(e.isFrozen!==void 0&&(r.isFrozen=!!e.isFrozen),e.frozenUntil!==void 0){const l=this.toFiniteNumber(e.frozenUntil,r.frozenUntil??0);r.frozenUntil=Number.isFinite(l)?Math.max(0,l):0,(!r.isFrozen||r.frozenUntil===0)&&(r.frozenBy=null)}const a=Math.round(this.toFiniteNumber(e.direction,r.direction));if(Number.isFinite(a)){const l=(a%32+32)%32,u=Number.isFinite(r.direction)?(Math.round(r.direction)%32+32)%32:l;Math.min(Math.abs(l-u),32-Math.abs(l-u))>4&&(r.direction=l)}if(e.sequence!==void 0&&(r.sequence=e.sequence),this.game&&typeof this.game.updateOrbHint=="function"){const l=t&&t.source==="enter_game";this.game.updateOrbHint({force:l})}}normalisePlayerPayload(e){const t=this.safeParse(e);if(!t||typeof t!="object")return null;const r=Object.assign({},t);if(!r.id)if(e&&e.id)r.id=e.id;else return null;const n=r.offset&&typeof r.offset=="object"?r.offset:{};r.offset={x:this.toFiniteNumber(n.x,0),y:this.toFiniteNumber(n.y,0)},r.city=this.toFiniteNumber(r.city,0),r.isMayor=!!r.isMayor;const s=this.toFiniteNumber(r.health,this.game?.player?.health??0);r.health=Number.isFinite(s)?Math.max(0,s):0;const o=this.toFiniteNumber(r.direction,0);Number.isFinite(o)?r.direction=(Math.round(o)%32+32)%32:r.direction=0;const a=this.toFiniteNumber(r.isTurning,0);r.isTurning=Math.max(-1,Math.min(1,Math.round(Number.isFinite(a)?a:0)));const l=this.toFiniteNumber(r.isMoving,0);Number.isFinite(l)?l>1?r.isMoving=1:l<-1?r.isMoving=-1:r.isMoving=l:r.isMoving=0,r.sequence=Math.max(0,Math.round(this.toFiniteNumber(r.sequence,0))),r.isCloaked=!!r.isCloaked;const u=this.toFiniteNumber(r.cloakExpiresAt,r.isCloaked?r.cloakExpiresAt??0:0);r.cloakExpiresAt=Number.isFinite(u)?Math.max(0,u):0,r.isFrozen=!!r.isFrozen;const h=this.toFiniteNumber(r.frozenUntil,r.isFrozen?r.frozenUntil??0:0);if(r.frozenUntil=Number.isFinite(h)?Math.max(0,h):0,r.isFrozen?r.frozenBy=r.frozenBy??null:r.frozenBy=null,typeof r.callsign=="string"){const f=r.callsign.trim();f.length?r.callsign=f:delete r.callsign}return r}normaliseHazardPayload(e){const t=this.safeParse(e);return!t||typeof t!="object"||!t.id?null:{id:t.id,type:t.type,x:this.toFiniteNumber(t.x,0),y:this.toFiniteNumber(t.y,0),ownerId:t.ownerId??null,teamId:t.teamId??null,active:!!t.active,armed:!!t.armed,detonateAt:t.detonateAt??null,reason:t.reason??null}}applyHealthUpdate(e){const t=this.toFiniteNumber(e.health,null);if(!e.id||t===null)return;const r=this.io?.id;if(r&&e.id===r){this.game.player.health=Math.max(0,t);return}this.game.otherPlayers[e.id]||(this.game.otherPlayers[e.id]={id:e.id}),this.game.otherPlayers[e.id].health=Math.max(0,t)}applyStatusUpdate(e){const t=this.io?.id,r=t&&e.id===t?this.game.player:this.game.otherPlayers[e.id]??(this.game.otherPlayers[e.id]={id:e.id});if(r){if(e.isCloaked!==void 0&&(r.isCloaked=!!e.isCloaked),e.cloakExpiresAt!==void 0){const n=this.toFiniteNumber(e.cloakExpiresAt,r.cloakExpiresAt??0);r.cloakExpiresAt=Number.isFinite(n)?Math.max(0,n):0}if(e.isFrozen!==void 0&&(r.isFrozen=!!e.isFrozen,r.isFrozen||(r.frozenBy=null)),e.frozenUntil!==void 0){const n=this.toFiniteNumber(e.frozenUntil,r.frozenUntil??0);r.frozenUntil=Number.isFinite(n)?Math.max(0,n):0}e.frozenBy!==void 0&&e.frozenBy!==null&&(r.frozenBy=e.frozenBy),t&&e.id===t&&(this.game.forceDraw=!0)}}safeParse(e){if(e==null)return null;if(typeof e!="string")return e;try{return JSON.parse(e)}catch(t){return console.warn("Failed to parse payload from server",t),null}}toFiniteNumber(e,t){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const r=Number(e);if(Number.isFinite(r))return r}return t!==void 0?t:0}}var $t=new V.Container;let Gi=null,Yi=null;const $c=new V.Point;function RI(i){var e=s=>{s.stopPropagation(),console.log("Setting is demolishing to true"),i.isDemolishing=!0,i.stage.cursor="demolish",i.interactionLayer&&(i.interactionLayer.cursor="demolish")},t=new V.Texture(i.textures.buildingIcons.baseTexture,new V.Rectangle(208,0,16,16)),r=new V.Sprite(t);r.x=i.buildMenuOffset.x-16,r.y=i.buildMenuOffset.y,r.interactive=!0,r.iconType=13,r.on("mousedown",e);var n=new V.Text("Demolish building",{fontSize:12,fill:16777215});n.x=i.buildMenuOffset.x,n.y=i.buildMenuOffset.y,n.interactive=!0,n.on("mousedown",e),$t.addChild(r),$t.addChild(n)}const Al=i=>{Yi&&i.interactionLayer&&(i.interactionLayer.off("pointermove",Yi),Yi=null),Gi&&(Gi.destroy(),Gi=null),i.isBuilding=!1,i.isDragging=!1,i.showBuildMenu=!1,$t.visible=!1,i.interactionLayer&&(i.interactionLayer.cursor="cursor")},Cl=(i,e,t)=>{Al(i),i.isBuilding=e,i.isDragging=!0,i.showBuildMenu=!1,$t.visible=!1;const r=new V.Texture(i.textures.buildings.baseTexture,new V.Rectangle(0,parseInt(i.isBuilding/100)*144,144,144)),n=new V.Sprite(r);n.alpha=.5,n.interactive=!1,n.buttonMode=!1,i.stage.addChild(n),Gi=n;const s=o=>{let a;if(o&&o.global)a=o.global;else if(i.app&&i.app.renderer&&i.app.renderer.plugins&&i.app.renderer.plugins.interaction){const u=i.app.renderer.plugins.interaction,h=u.pointer||u.mouse;h&&h.global&&(a=h.global)}if(!a)return;$c.copyFrom(a);const l=n.parent.toLocal($c);n.position.copyFrom(l)};i.interactionLayer&&(Yi=o=>s(o.data),i.interactionLayer.on("pointermove",Yi),i.interactionLayer.cursor="pointer"),s(t)},Ev=i=>{if(!i||!i.stage)return;const e=Number.isFinite(i?.player?.city)?i.player.city:null,r=(e!==null&&Array.isArray(i?.cities)?i.cities[e]:null)?.canBuild;if(!r){Al(i),$t.visible=!1,$t.parent||i.stage.addChild($t);return}if(i.forceDraw){$t.removeChildren();var n=Object.keys(r),s=1;n.forEach(a=>{r[a]==er&&s++});var o=new V.Graphics;o.lineStyle(2,0,0),o.beginFill(0,1),o.drawRect(i.buildMenuOffset.x,i.buildMenuOffset.y,180,s*16),o.endFill(),$t.addChild(o),RI(i),s=1,n.forEach((a,l)=>{if(r[a]==er){var u=rr[a].TYPE,h=p=>{p.stopPropagation(),Cl(i,u,p.data)},f=new V.Texture(i.textures.buildingIcons.baseTexture,new V.Rectangle(rr[a].ICON*16,0,16,16)),c=new V.Sprite(f);c.x=i.buildMenuOffset.x-16,c.y=i.buildMenuOffset.y+s*16,c.interactive=!0,c.iconType=rr[a].IMAGE,c.on("mousedown",h);var d=new V.Text(rr[a].LABEL,{fontSize:12,fill:16777215});d.x=i.buildMenuOffset.x,d.y=i.buildMenuOffset.y+s*16,d.interactive=!0,d.on("mousedown",h),$t.addChild(c),$t.addChild(d),s++}}),$t.visible=!1}$t.parent||i.stage.addChild($t),i.clearGhostBuilding=()=>Al(i),i.startGhostBuilding=(a,l)=>Cl(i,a,l)};function FI(i){i.isBuilding&&!Gi&&Cl(i,i.isBuilding,null)}const MI=i=>{!i.isDragging&&!i.isDemolishing&&($t.visible=i.showBuildMenu),FI(i)};var jc=0,LI=function(i,e){for(var t=i.getHead(),r=1920,n=[];t;)t.x>e.offset.x-r&&t.x<e.offset.x+r&&t.y>e.offset.y-r&&t.y<e.offset.y+r&&n.push(t),t=t.next;return n},Pl=(i,e,t,r,n)=>{const s=i.textures.imageTurretBase?.baseTexture;if(!s)return;const o=Math.max(0,Math.min(2,(t.type??Zt)-Zt)),a=Number.isFinite(t?.maxLife)?t.maxLife:null,l=Number.isFinite(t?.life)?t.life:null,u=Number.isFinite(t?.burnThreshold)?t.burnThreshold:null;let h=0;if(a&&l!==null&&l<a){const p=l/a;p<=0||u!==null&&l<=u?h=2:p<=.66&&(h=1)}else t?.isBurning&&(h=2);h=Math.max(0,Math.min(2,h));const f=new V.Texture(s,new V.Rectangle(h*48,o*48,48,48));e.addFrame(f,t.x-i.player.offset.x+r,t.y-i.player.offset.y+n);let c=0;Number.isFinite(t.angle)&&(c=parseInt(t.angle/22.5+1,10)),(c>=16||c<0)&&(c=0);var d=new V.Texture(i.textures.imageTurretHead.baseTexture,new V.Rectangle(c*48,(t.type-9)*48,48,48));e.addFrame(d,t.x-i.player.offset.x+r,t.y-i.player.offset.y+n)},NI=(i,e,t,r,n)=>{const s=t.city??t.teamId??null,o=i.player?.city??null;if(!(t.active&&s!==null&&s!==o)){var a=new V.Texture(i.textures.imageItems.baseTexture,new V.Rectangle(oe*32,0,32,32)),l=t.x-i.player.offset.x+r+8,u=t.y-i.player.offset.y+n+8;e.addFrame(a,l,u)}},BI=(i,e,t,r,n)=>{const s=t.city??t.teamId??null,o=i.player?.city??null;if(t.active&&s!==null&&s!==o)return;const a=i.textures.imageItems?.baseTexture;if(!a)return;const l=new V.Texture(a,new V.Rectangle(de*48,42,48,48)),u=t.x-i.player.offset.x+r,h=t.y-i.player.offset.y+n;e.addFrame(l,u,h)},DI=(i,e,t,r,n)=>{const s=i.textures.imageItems?.baseTexture;if(!s)return;const a=!!t.active?new V.Rectangle(144,91,48,48):new V.Rectangle(Pt*48,42,48,48),l=new V.Texture(s,a),u=t.x-i.player.offset.x+r,h=t.y-i.player.offset.y+n;e.addFrame(l,u,h)};const kI=(i,e,t,r,n)=>{const s=i.textures.imageItems?.baseTexture;if(!s)return;const o=new V.Texture(s,new V.Rectangle(Ve*48,42,48,48)),a=t.x-i.player.offset.x+r,l=t.y-i.player.offset.y+n;e.addFrame(o,a,l)},UI=(i,e,t,r,n)=>{const s=t.city??t.teamId??null,o=i.player?.city??null;!(s===null||o===null||s===o)&&!t.target||Pl(i,e,t,r,n)},XI=(i,e,t,r,n)=>{const s=i.textures.imageItems?.baseTexture;if(!s)return;const o=t.type*48,a=new V.Texture(s,new V.Rectangle(o,42,48,48)),l=t.x-i.player.offset.x+r,u=t.y-i.player.offset.y+n;e.addFrame(a,l,u)},HI={[Zt]:Pl,[pe]:Pl,[we]:UI,[Ve]:kI,[oe]:NI,[de]:BI,[Pt]:DI},Sv=(i,e)=>{var t=Math.floor(i.player.offset.x%48),r=Math.floor(i.player.offset.y%48);if(i.tick>jc){jc=i.tick+200,e.clear();var n=LI(i.itemFactory,i.player);n.forEach((s,o)=>{switch(s.type){default:{const a=HI[s.type];a?a(i,e,s,t,r):XI(i,e,s,t,r);break}}}),e.position.set(i.player.defaultOffset.x+i.player.offset.x-t,i.player.defaultOffset.y+i.player.offset.y-r)}e.pivot.set(i.player.offset.x,i.player.offset.y)};var GI=function(i,e){for(var t=i.getHead(),r=1920,n=[];t;)t.owner==null&&t.x>e.offset.x-r&&t.x<e.offset.x+r&&t.y>e.offset.y-r&&t.y<e.offset.y+r&&n.push(t),t=t.next;return console.log(n),n};const Av=(i,e)=>{var t=Math.floor(i.player.offset.x%32),r=Math.floor(i.player.offset.y%32);if(i.forceDraw){e.clear();var n=GI(i.iconFactory,i.player);n.forEach((s,o)=>{console.log(i.player.offset.x-s.x);var a=new V.Texture(i.textures.imageItems.baseTexture,new V.Rectangle(s.type*32,0,32,32));e.addFrame(a,s.x-i.player.offset.x+t,s.y-i.player.offset.y+r)}),e.position.set(i.player.defaultOffset.x+i.player.offset.x-t,i.player.defaultOffset.y+i.player.offset.y-r)}e.pivot.set(i.player.offset.x,i.player.offset.y)},Cv=48,Wc=Cv/2,Kc=Cv*1.5,xa=32,Zc=8,se={offsetX:8,offsetY:208,width:188,headerHeight:58,paddingX:14,paddingTop:10,paddingBottom:14,collapsedExtra:18,columns:4},Pv={[lu]:{column:0,row:0},[Ss]:{column:1,row:0},[ei]:{column:2,row:0},[Ki]:{column:3,row:0},[Pt]:{column:0,row:1},[oe]:{column:1,row:1},[ri]:{column:2,row:1},[As]:{column:3,row:1},[de]:{column:0,row:2},[Ve]:{column:1,row:2},[Zt]:{column:2,row:2},[we]:{column:3,row:2},[pe]:{column:0,row:3}},YI=i=>{const e=(i?.maxMapX||0)+se.offsetX,t=se.offsetY,r=xa+Zc,n=r,s=Object.values(Pv).reduce((c,d)=>Math.max(c,d.row),0),o=Math.max(1,s+1),a=e+se.paddingX,l=t+se.headerHeight+se.paddingTop,u=o*xa+(o-1)*Zc,h=se.headerHeight+se.paddingTop+u+se.paddingBottom,f=se.headerHeight+se.collapsedExtra;return{panelX:e,panelY:t,panelWidth:se.width,headerHeight:se.headerHeight,startX:a,startY:l,columnSpacing:r,rowSpacing:n,slotSize:xa,columns:se.columns,rows:o,expandedHeight:h,collapsedHeight:f}},zI=(i,e,t=0)=>{const r=Pv[e];if(r)return{x:i.startX+r.column*i.columnSpacing,y:i.startY+r.row*i.rowSpacing};const n=t%i.columns,s=Math.floor(t/i.columns);return{x:i.startX+n*i.columnSpacing,y:i.startY+s*i.rowSpacing}},VI=[{key:"staff",offsetX:145,y:268,width:45,height:20,handler:i=>i?.showStaffSummary&&i.showStaffSummary()},{key:"map",offsetX:145,y:290,width:45,height:20,handler:i=>i?.toggleMapOverlay&&i.toggleMapOverlay()},{key:"info",offsetX:145,y:312,width:45,height:20,handler:i=>i?.showPlayerCityInfo&&i.showPlayerCityInfo()},{key:"points",offsetX:145,y:334,width:45,height:20,handler:i=>i?.showPointsSummary&&i.showPointsSummary()},{key:"options",offsetX:145,y:356,width:45,height:20,handler:i=>i?.openOptionsPanel&&i.openOptionsPanel()},{key:"help",offsetX:145,y:378,width:45,height:20,handler:i=>i?.showHelpMessage&&i.showHelpMessage()},{key:"build",offsetX:126,y:400,width:64,height:22,handler:i=>i?.toggleBuildMenuFromPanel&&i.toggleBuildMenuFromPanel()},{key:"exit",offsetX:150,y:576,width:42,height:18,handler:i=>i?.requestExitToLobby&&i.requestExitToLobby()}],Mu=i=>((!i.panelState||typeof i.panelState!="object")&&(i.panelState={}),typeof i.panelState.isInventoryCollapsed!="boolean"&&(i.panelState.isInventoryCollapsed=!1),i.panelState),qI=i=>!!Mu(i).isInventoryCollapsed,$I=i=>{const e=Mu(i);e.isInventoryCollapsed=!e.isInventoryCollapsed,i&&(i.forceDraw=!0)},jI=(i,e)=>{if(!i||!e)return;const t=i.maxMapX||0;VI.forEach(r=>{const n=new V.Graphics;n.beginFill(16777215,.001),n.drawRect(t+r.offsetX,r.y,r.width,r.height),n.endFill(),n.interactive=!0,n.buttonMode=!0,n.cursor="pointer",n.on("pointertap",s=>{s.stopPropagation(),typeof r.handler=="function"&&r.handler(i)}),e.addChild(n)})},wa=i=>{const e=Number.isFinite(i)?i:parseInt(i,10)||0;try{return e.toLocaleString("en-US")}catch{return`${e}`}},WI=i=>{if(!i)return 0;if(typeof i.grossIncome=="number"&&Number.isFinite(i.grossIncome))return i.grossIncome;const e=Number(i.income||0),t=Number(i.itemProduction||0)+Number(i.research||0)+Number(i.hospital||0)+Number(i.construction||0);return e-t},Jc="__radarState",KI=2,ii=2,Qc="__homeArrowState",Ta=40,Ov=5,Rv=160,Yt=(i,e=null)=>{if(typeof i=="number"&&Number.isFinite(i))return i;if(typeof i=="string"){const t=Number(i);if(Number.isFinite(t))return t}return e},Gn=(i,e)=>!i||!i.baseTexture?null:new V.Texture(i.baseTexture,new V.Rectangle(e*ii,0,ii,ii)),ZI=i=>{if(!i||!i.textures)return null;const e=i.textures.imgRadarColors;if(!e)return null;const t={neutral:Gn(e,0),admin:Gn(e,1),enemy:Gn(e,2),ally:Gn(e,3)},r=i.textures.imgMiniMapColors;return r&&r.baseTexture&&(t.dead=new V.Texture(r.baseTexture,new V.Rectangle(15*ii,0,ii,ii))),t},td=i=>{const e=i?.textures?.imgArrows;if(!e||!e.baseTexture)return[];const t=[];for(let r=0;r<8;r+=1){const n=new V.Rectangle(r*Ta,0,Ta,Ta);t.push(new V.Texture(e.baseTexture,n))}return t},JI=(i,e)=>{if(!i||!e||!i.textures?.imgArrows)return null;let t=e[Qc];if(!t){const r=td(i);if(!r.length)return null;const n=new V.Container;n.name="home-arrow",n.position.set((i.maxMapX||0)+Ov,Rv);const s=new V.Sprite(r[0]);return n.addChild(s),e.addChild(n),t={container:n,sprite:s,textures:r,lastIndex:-1},e[Qc]=t,t}return(!t.container.parent||t.container.parent!==e)&&e.addChild(t.container),(!Array.isArray(t.textures)||t.textures.length!==8)&&(t.textures=td(i),t.sprite&&t.textures.length&&(t.sprite.texture=t.textures[0],t.lastIndex=-1)),t},QI=(i,e)=>{const t=JI(i,e);if(!t||!t.sprite)return;const r=t.container;r.position.set((i.maxMapX||0)+Ov,Rv);const n=i?.player,s=n?.offset,o=Yt(n?.city,null);if(!s||o===null){r.visible=!1;return}const a=i.cities?.[o];if(!a){r.visible=!1;return}const l=Yt(a.x,null),u=Yt(a.y,null),h=Yt(s.x,null),f=Yt(s.y,null);if(!Number.isFinite(l)||!Number.isFinite(u)||!Number.isFinite(h)||!Number.isFinite(f)){r.visible=!1;return}const c=l+Kc,d=u+Kc,p=h+Wc,m=f+Wc,v=c-p,g=d-m;if(Math.abs(v)<1&&Math.abs(g)<1){r.visible=!1;return}const I=Math.atan2(-g,v);let w=Math.round(I/(Math.PI/4));w=(w%8+8)%8;const M=t.textures;if(!M||!M[w]){r.visible=!1;return}t.lastIndex!==w&&(t.sprite.texture=M[w],t.lastIndex=w),r.visible=!0},t1=(i,e)=>{if(!i||!e||!i.textures||!i.textures.imgRadarColors)return null;let t=e[Jc];if(!t){const h=new V.Container;h.name="radar-container";const f=new V.Container;f.name="radar-points",h.addChild(f),t={container:h,pointsLayer:f,pool:[],spriteScale:KI,textures:null,bounds:null},e[Jc]=t}if(t.textures||(t.textures=ZI(i)),!t.textures)return null;const r=i.maxMapX||0,{offsetX:n,offsetY:s,width:o,height:a}=O_,l=r+n,u=s;return t.bounds={left:l,top:u,right:l+o,bottom:u+a,width:o,height:a},t.container.position.set(l,u),(!t.container.parent||t.container.parent!==e)&&e.addChild(t.container),t},e1=(i,e)=>{if(!i||!e||!e.pointsLayer||!e.textures)return;const t=i.player;if(!t||!t.offset){e.pointsLayer.visible=!1;return}const r=Yt(t.offset.x,null),n=Yt(t.offset.y,null);if(!Number.isFinite(r)||!Number.isFinite(n)){e.pointsLayer.visible=!1;return}const s=e.bounds;if(!s){e.pointsLayer.visible=!1;return}const o=e.pool,a=e.textures,l=(i.maxMapX||0)+C_,u=P_,h=A_,f=Yt(t.city,null),c=Number.isFinite(f);let d=0;const p=(I,w,M)=>{let b=o[d];b||(b=new V.Sprite(I),b.anchor.set(.5),b.scale.set(e.spriteScale,e.spriteScale),e.pointsLayer.addChild(b),o[d]=b),b.texture!==I&&(b.texture=I),b.visible=!0,b.position.set(w-s.left,M-s.top),d+=1},m=(I,w,M,b,R,C,H)=>{const F=I-r,B=w-n;if(Math.abs(F)>h||Math.abs(B)>h)return;const Y=l+(F-R_)/jf,D=u+(B-F_)/jf;if(Y<s.left||Y>s.right||D<s.top||D>s.bottom)return;let J=a.enemy;if(H!=="rogue"){const Q=Number.isFinite(M)?M:null;R||c&&Q!==null&&Q===f?J=a.ally||a.neutral||J:C&&a.admin?J=a.admin:Q===null&&a.neutral&&(J=a.neutral)}Number.isFinite(b)&&b<=0&&a.dead&&(J=a.dead),J&&p(J,Y,D)};t.isCloaked||m(r,n,f,Yt(t.health,null),!0,!1,"player");const v=i.otherPlayers;if(v)for(const I in v){if(!Object.prototype.hasOwnProperty.call(v,I))continue;const w=v[I];if(!w||!w.offset||w.isCloaked)continue;const M=Yt(w.offset.x,null),b=Yt(w.offset.y,null);!Number.isFinite(M)||!Number.isFinite(b)||m(M,b,Yt(w.city,null),Yt(w.health,null),!1,!!w.isAdmin,"player")}const g=i.rogueTankManager;if(g&&Array.isArray(g.tanks)){const I=g.tanks;for(let w=0;w<I.length;w+=1){const M=I[w];if(!M||!M.offset)continue;const b=Yt(M.offset.x,null),R=Yt(M.offset.y,null);!Number.isFinite(b)||!Number.isFinite(R)||m(b,R,null,Yt(M.health,null),!1,!1,"rogue")}}for(let I=d;I<o.length;I+=1){const w=o[I];w&&(w.visible=!1)}e.pointsLayer.visible=d>0};var r1=(i,e)=>{var t=new V.Sprite(i.textures.interfaceTop);t.x=i.maxMapX,t.y=0,e.addChild(t);var r=new V.Sprite(i.textures.interfaceBottom);r.x=i.maxMapX,r.y=430,e.addChild(r)};const i1=(i,e,t)=>{const r=t?e.collapsedHeight:e.expandedHeight,n=new V.Graphics;n.lineStyle(1,2575239,.65),n.beginFill(133918,.92),n.drawRoundedRect(e.panelX,e.panelY,e.panelWidth,r,12),n.endFill(),i.addChild(n);const s=new V.Graphics;s.beginFill(16777215,.05),s.drawRoundedRect(e.panelX+1,e.panelY+1,e.panelWidth-2,e.headerHeight+6,11),s.endFill(),i.addChild(s);const o=new V.Graphics;o.beginFill(16777215,.12),o.drawRect(e.panelX+12,e.panelY+e.headerHeight,e.panelWidth-24,1),o.endFill(),i.addChild(o)},n1=(i,e)=>{const t=new V.Graphics;for(let r=0;r<e.rows;r+=1)for(let n=0;n<e.columns;n+=1){const s=e.startX+n*e.columnSpacing,o=e.startY+r*e.rowSpacing;t.lineStyle(1,1847636,.55),t.beginFill(463653,.82),t.drawRoundedRect(s-4,o-4,e.slotSize+8,e.slotSize+8,6),t.endFill()}i.addChild(t)},s1=(i,e,t,r)=>{const n=new V.Text("Inventory",{fontFamily:"Arial",fontSize:16,fontWeight:"bold",fill:11458289,stroke:0,strokeThickness:3,letterSpacing:.6});n.x=t.panelX+16,n.y=t.panelY+10,e.addChild(n);const s=i?.player?.city??0,o=i?.cities?.[s]??null,a=!!(i?.player&&i.player.isMayor);if(o&&a){const f=WI(o),c=f>=0?`+${wa(f)}`:wa(f),d=f<0?"imgMoneyDown":"imgMoneyUp";let p=t.panelX+16;const m=i.textures[d];if(m){const M=new V.Sprite(m);M.x=p,M.y=t.panelY+29,M.alpha=.9,e.addChild(M),p=M.x+M.width+6}const v=new V.Text(`Net ${c}`,{fontFamily:"Arial",fontSize:12,fill:f<0?15158332:3066993,stroke:0,strokeThickness:2});v.x=p,v.y=t.panelY+30,e.addChild(v);const g=wa(o.cash??0),I=new V.Text(`$${g}`,{fontFamily:"Arial",fontSize:15,fontWeight:"bold",fill:16316927,stroke:0,strokeThickness:3});I.anchor.set(1,0),I.x=t.panelX+t.panelWidth-18,I.y=t.panelY+10,e.addChild(I);const w=new V.Text("City Cash",{fontFamily:"Arial",fontSize:11,fill:12308991,stroke:0,strokeThickness:2});w.anchor.set(1,0),w.x=I.x,w.y=I.y+18,e.addChild(w)}if(o){const f=Number.isFinite(o.score)?o.score:parseInt(o.score,10)||0,c=Number.isFinite(o.orbs)?o.orbs:parseInt(o.orbs,10)||0,d={fontFamily:"Arial",fontSize:12,fill:14084856,stroke:0,strokeThickness:2},p=new V.Text(`Score ${f}`,d);p.x=t.panelX+16,p.y=t.panelY+t.headerHeight-22,e.addChild(p);const m=new V.Text(`Orbs ${c}`,d);m.anchor.set(1,0),m.x=t.panelX+t.panelWidth-18,m.y=p.y,e.addChild(m)}else{const f=new V.Text("Manage your battlefield tools",{fontFamily:"Arial",fontSize:12,fill:14084856,stroke:0,strokeThickness:2});f.x=t.panelX+16,f.y=t.panelY+30,e.addChild(f)}const l=new V.Container;l.x=t.panelX+t.panelWidth-32,l.y=t.panelY+22;const u=new V.Graphics;u.beginFill(16777215,.001),u.drawCircle(0,0,14),u.endFill(),l.addChild(u);const h=new V.Graphics;h.beginFill(10273791),r?(h.moveTo(-6,-2),h.lineTo(0,6),h.lineTo(6,-2)):(h.moveTo(-6,2),h.lineTo(0,-6),h.lineTo(6,2)),h.endFill(),l.addChild(h),l.interactive=!0,l.buttonMode=!0,l.cursor="pointer",l.on("pointertap",f=>{f.stopPropagation(),$I(i)}),e.addChild(l)},o1=(i,e,t,r)=>{if(!i||!e||!t||r)return;let n=i.iconFactory.getHead(),s=0;for(;n;){if(n.owner===i.player.id){let o=n.type*32,a=0;n.type===Pt&&n.armed&&(o=152,a=89);const l=new V.Texture(i.textures.imageItems.baseTexture,new V.Rectangle(o,a,32,32)),u=new V.Sprite(l),h=zI(t,n.type,s),f=h.x,c=h.y;if(n.selected){const m=new V.Graphics;m.lineStyle(2,6139362,.95),m.beginFill(6139362,.18),m.drawRoundedRect(f-4,c-4,t.slotSize+8,t.slotSize+8,6),m.endFill(),e.addChild(m)}u.x=f,u.y=c,u.interactive=!0,u.buttonMode=!0,u.cursor="pointer";const d=n;u.on("pointertap",m=>{m.stopPropagation(),typeof i.iconFactory.toggleSelected=="function"&&i.iconFactory.toggleSelected(d),i.forceDraw=!0}),e.addChild(u);const p=n.quantity??1;if(p>1){const m=new V.Text(`${p}`,{fontFamily:"Arial",fontSize:12,fill:16777215,fontWeight:"bold",stroke:0,strokeThickness:3});m.anchor.set(1,1),m.x=f+t.slotSize-3,m.y=c+t.slotSize-2,e.addChild(m)}s+=1}n=n.next}},a1=(i,e)=>{if(!i||!e)return;const t=Mu(i),r=t.heading||"",n=Array.isArray(t.lines)?t.lines:[];if(!r&&!n.length)return;const s=i.maxMapX+12;let o=465;if(r){const l=new V.Text(r,{fontFamily:"Arial",fontSize:14,fontWeight:"bold",fill:16044095,stroke:0,strokeThickness:2});l.x=s,l.y=o,e.addChild(l),o+=15}const a={fontFamily:"Arial",fontSize:12,fill:16645886,stroke:0,strokeThickness:2};n.forEach(l=>{if(l==null){o+=15;return}const u=new V.Text(`${l}`,a);u.x=s,u.y=o,e.addChild(u),o+=15})};var l1=(i,e)=>{var t=i.player.health/cs,r=new V.Texture(i.textures.health.baseTexture,new V.Rectangle(0,0,38,t*87)),n=new V.Sprite(r);n.anchor={x:1,y:1},n.x=i.maxMapX+175,n.y=247,e.addChild(n)};const Fv=(i,e)=>{if(i.forceDraw){e.removeChildren(),r1(i,e);const r=YI(i),n=qI(i);i1(e,r,n),s1(i,e,r,n),n||n1(e,r),l1(i,e),o1(i,e,r,n),a1(i,e),jI(i,e)}const t=t1(i,e);e1(i,t),QI(i,e)};class u1{constructor(e){this.game=e,this.socketListener=null,this.lastSnapshot=null,this.waiting=!1,this.waitingCity=null,this.waitingRole=null,this.visible=!1,this.inGame=!1,this.onLobbySnapshot=t=>this.updateSnapshot(t),this.onLobbyUpdate=t=>this.updateSnapshot(t),this.onLobbyAssignment=t=>this.handleAssignment(t),this.onLobbyDenied=t=>this.handleDenial(t),this.onSocketConnected=()=>this.handleConnected(),this.onSocketDisconnected=t=>this.handleDisconnected(t),this.onLobbyEvicted=t=>this.handleEviction(t),this.injectStyles(),this.createOverlay(),this.show(),this.setStatus("Connecting to lobby...")}injectStyles(){if(document.getElementById("lobby-overlay-styles"))return;const e=document.createElement("style");e.id="lobby-overlay-styles",e.textContent=`
            .lobby-overlay {
                position: fixed;
                inset: 0;
                display: none;
                align-items: center;
                justify-content: center;
                background: rgba(8, 10, 16, 0.85);
                z-index: 9999;
                pointer-events: auto;
            }
            .lobby-overlay.visible {
                display: flex;
            }
            .lobby-panel {
                background: #131722;
                border: 1px solid #2a3140;
                border-radius: 8px;
                width: min(620px, 92vw);
                max-height: 86vh;
                padding: 24px 28px;
                color: #f5f7ff;
                font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
                box-shadow: 0 12px 32px rgba(0, 0, 0, 0.55);
                display: flex;
                flex-direction: column;
                gap: 20px;
            }
            .lobby-header {
                display: flex;
                flex-direction: column;
                gap: 4px;
            }
            .lobby-title {
                font-size: 24px;
                font-weight: 600;
                margin: 0;
            }
            .lobby-subtitle {
                font-size: 14px;
                color: #b3b9c9;
                margin: 0;
            }
            .lobby-city-list {
                flex: 1;
                overflow-y: auto;
                padding-right: 6px;
                display: flex;
                flex-direction: column;
                gap: 12px;
            }
            .lobby-city-empty {
                color: #b3b9c9;
                font-size: 14px;
                text-align: center;
                padding: 24px 0;
            }
            .lobby-city-row {
                display: flex;
                justify-content: space-between;
                align-items: center;
                background: rgba(22, 27, 38, 0.85);
                border: 1px solid rgba(53, 63, 83, 0.8);
                border-radius: 6px;
                padding: 12px 16px;
                gap: 16px;
            }
            .lobby-city-row.waiting {
                border-color: #5c9eff;
                box-shadow: 0 0 0 1px rgba(92, 158, 255, 0.35);
            }
            .lobby-city-info {
                display: flex;
                flex-direction: column;
                gap: 6px;
                min-width: 0;
            }
            .lobby-city-name {
                font-size: 16px;
                font-weight: 600;
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;
            }
            .lobby-city-meta {
                font-size: 13px;
                color: #9aa3b8;
            }
            .lobby-city-actions {
                display: flex;
                gap: 8px;
            }
            .lobby-btn {
                background: #1f2534;
                color: #e1e6f6;
                border: 1px solid #384156;
                border-radius: 4px;
                padding: 8px 14px;
                font-size: 13px;
                cursor: pointer;
                transition: background 0.15s, border-color 0.15s, transform 0.15s;
            }
            .lobby-btn:hover:not(:disabled) {
                background: #2a3245;
                border-color: #4f5d7c;
            }
            .lobby-btn:active:not(:disabled) {
                transform: translateY(1px);
            }
            .lobby-btn:disabled {
                opacity: 0.45;
                cursor: default;
            }
            .lobby-actions {
                display: flex;
                justify-content: space-between;
                align-items: center;
                gap: 12px;
                flex-wrap: wrap;
            }
            .lobby-action-group {
                display: flex;
                gap: 10px;
                flex-wrap: wrap;
            }
            .lobby-status {
                font-size: 13px;
                color: #b3b9c9;
                min-height: 18px;
            }
            .lobby-status[data-type="error"] {
                color: #ff8080;
            }
            .lobby-status[data-type="warn"] {
                color: #ffc977;
            }
            .lobby-status[data-type="success"] {
                color: #7be17d;
            }
        `,document.head.appendChild(e)}createOverlay(){this.overlay=document.createElement("div"),this.overlay.className="lobby-overlay";const e=document.createElement("div");e.className="lobby-panel";const t=document.createElement("div");t.className="lobby-header";const r=document.createElement("h1");r.className="lobby-title",r.textContent="City Lobby";const n=document.createElement("p");n.className="lobby-subtitle",n.textContent="Choose a city to join as mayor or recruit. Everyone starts at the same time.",t.appendChild(r),t.appendChild(n),this.cityListContainer=document.createElement("div"),this.cityListContainer.className="lobby-city-list";const s=document.createElement("div");s.className="lobby-actions";const o=document.createElement("div");o.className="lobby-action-group",this.autoButton=document.createElement("button"),this.autoButton.type="button",this.autoButton.className="lobby-btn",this.autoButton.textContent="Auto Assign",this.autoButton.addEventListener("click",()=>this.handleAutoJoin()),this.refreshButton=document.createElement("button"),this.refreshButton.type="button",this.refreshButton.className="lobby-btn",this.refreshButton.textContent="Refresh",this.refreshButton.addEventListener("click",()=>this.requestSnapshot()),o.appendChild(this.autoButton),o.appendChild(this.refreshButton),s.appendChild(o),this.statusNode=document.createElement("div"),this.statusNode.className="lobby-status",this.statusNode.dataset.type="info",e.appendChild(t),e.appendChild(this.cityListContainer),e.appendChild(s),e.appendChild(this.statusNode),this.overlay.appendChild(e),document.body.appendChild(this.overlay)}attachSocket(e){e&&this.socketListener!==e&&(this.socketListener&&(this.socketListener.off("lobby:snapshot",this.onLobbySnapshot),this.socketListener.off("lobby:update",this.onLobbyUpdate),this.socketListener.off("lobby:assignment",this.onLobbyAssignment),this.socketListener.off("lobby:denied",this.onLobbyDenied),this.socketListener.off("connected",this.onSocketConnected),this.socketListener.off("disconnected",this.onSocketDisconnected),this.socketListener.off("lobby:evicted",this.onLobbyEvicted)),this.socketListener=e,e.on("lobby:snapshot",this.onLobbySnapshot),e.on("lobby:update",this.onLobbyUpdate),e.on("lobby:assignment",this.onLobbyAssignment),e.on("lobby:denied",this.onLobbyDenied),e.on("connected",this.onSocketConnected),e.on("disconnected",this.onSocketDisconnected),e.on("lobby:evicted",this.onLobbyEvicted))}show(){this.overlay&&this.overlay.classList.add("visible"),this.visible=!0}hide(){this.overlay&&this.overlay.classList.remove("visible"),this.visible=!1}isInGame(){return this.inGame}setStatus(e,t={}){if(!this.statusNode)return;const r=t.type||"info";this.statusNode.dataset.type=r,this.statusNode.textContent=e||""}updateSnapshot(e){let t=e;if(t){if(typeof t=="string")try{t=JSON.parse(t)}catch(r){console.warn("Failed to parse lobby snapshot",r);return}!t||!Array.isArray(t.cities)||(this.lastSnapshot=t,this.renderCityList(),this.waiting||!t.cities.some(n=>n.openMayor||n.openRecruits>0)&&this.visible&&this.setStatus("All cities are currently full. Please wait for an opening.",{type:"warn"}))}}renderCityList(){if(!this.cityListContainer)return;if(this.cityListContainer.innerHTML="",!this.lastSnapshot||!Array.isArray(this.lastSnapshot.cities)||!this.lastSnapshot.cities.length){const t=document.createElement("div");t.className="lobby-city-empty",t.textContent="Waiting for available cities...",this.cityListContainer.appendChild(t);return}[...this.lastSnapshot.cities].sort((t,r)=>{const n=Number.isFinite(t?.id)?t.id:0,s=Number.isFinite(r?.id)?r.id:0;return n-s}).forEach(t=>{const r=document.createElement("div");r.className="lobby-city-row",r.dataset.cityId=t.id,this.waiting&&this.waitingCity===t.id&&r.classList.add("waiting");const n=document.createElement("div");n.className="lobby-city-info";const s=document.createElement("div");s.className="lobby-city-name",s.textContent=t.name||`City ${t.id}`;const o=t.openMayor?"(open)":t.mayorLabel||"(unknown)",a=Number.isFinite(t.capacity)?t.capacity:1+(t.maxRecruits??3),l=Number.isFinite(t.playerCount)?t.playerCount:0,u=document.createElement("div");u.className="lobby-city-meta";const h=[`Mayor: ${o}`,`Players: ${l}/${a}`],f=Number.isFinite(t.score)?t.score:Number(t.score);Number.isFinite(f)&&h.push(`Score: ${f}`);const c=Number.isFinite(t.orbs)?t.orbs:Number(t.orbs);Number.isFinite(c)&&h.push(`Orbs: ${c}`),u.textContent=h.join("  "),n.appendChild(s),n.appendChild(u);const d=document.createElement("div");d.className="lobby-city-actions";const p=document.createElement("button");p.type="button",p.className="lobby-btn",p.textContent="Mayor",p.disabled=!t.openMayor||this.waiting,p.addEventListener("click",()=>this.handleJoin(t.id,"mayor"));const m=document.createElement("button");m.type="button",m.className="lobby-btn",m.textContent="Recruit";const v=Number.isFinite(t.openRecruits)?t.openRecruits>0:!!t.hasRecruitVacancy;m.disabled=!v||this.waiting,m.addEventListener("click",()=>this.handleJoin(t.id,"recruit")),d.appendChild(p),d.appendChild(m),r.appendChild(n),r.appendChild(d),this.cityListContainer.appendChild(r)}),this.autoButton&&(this.autoButton.disabled=this.waiting),this.refreshButton&&(this.refreshButton.disabled=this.waiting)}handleJoin(e,t){if(this.waiting)return;if(!this.socketListener||this.socketListener.io&&this.socketListener.io.disconnected){this.setStatus("Cannot join right now. Connection unavailable.",{type:"error"});return}this.waiting=!0,this.waitingCity=e,this.waitingRole=t,this.setStatus(`Requesting ${t==="mayor"?"mayor":"recruit"} slot in city ${e}...`),this.renderCityList();const r=this.socketListener.enterGame({city:e,role:t});r&&(this.game.player.id=r)}handleAutoJoin(){if(this.waiting)return;if(!this.socketListener||this.socketListener.io&&this.socketListener.io.disconnected){this.setStatus("Cannot join right now. Connection unavailable.",{type:"error"});return}this.waiting=!0,this.waitingCity=null,this.waitingRole=null,this.setStatus("Requesting automatic assignment..."),this.renderCityList();const e=this.socketListener.enterGame({auto:!0});e&&(this.game.player.id=e)}handleAssignment(e){this.waiting=!1,this.waitingCity=null,this.waitingRole=null,this.inGame=!0,this.setStatus("Assignment confirmed. Entering city...",{type:"success"}),this.renderCityList(),this.hide()}handleEviction(e){this.waiting=!1,this.waitingCity=null,this.waitingRole=null,this.inGame=!1;const t=typeof e?.reason=="string"?e.reason:"orb",r=Number.isFinite(e?.city)?Number(e.city):null,n=Number.isFinite(e?.attackerCity)?Number(e.attackerCity):null,s=Number.isFinite(e?.points)?Number(e.points):null,o=r!==null?Ft(r):"your city",a=n!==null?Ft(n):null,l=[];t==="death"?a?l.push(`${a} eliminated you.`):l.push("You were eliminated in combat."):a?l.push(`${a} destroyed ${o}.`):l.push(`An enemy orb destroyed ${o}.`),t!=="death"&&s!==null&&s>0&&l.push(`They earned ${s} points.`),this.show(),this.setStatus(l.join(" "),{type:"error"}),this.renderCityList(),this.requestSnapshot()}handleDenial(e){this.waiting=!1,this.inGame=!1;const t=e?.requestedCity,r=e?.reason==="cities_full"?"All cities are currently full. Please try again in a moment.":"Selected slot was unavailable. Please choose a different option.",n=e?.reason==="cities_full"?"warn":"error";t!=null?this.waitingCity=t:this.waitingCity=null,this.waitingRole=null,this.setStatus(r,{type:n}),this.renderCityList(),this.requestSnapshot()}handleConnected(){this.inGame=!1,this.waiting=!1,this.waitingCity=null,this.waitingRole=null,this.show(),this.setStatus("Connected. Choose a city to enter.",{type:"info"}),this.requestSnapshot()}handleDisconnected(e){this.inGame=!1,this.waiting=!1,this.waitingCity=null,this.waitingRole=null,this.show();const t=e?`Connection lost (${e}). Reconnecting...`:"Connection lost. Reconnecting...";this.setStatus(t,{type:"error"})}requestSnapshot(){this.socketListener&&typeof this.socketListener.requestLobbySnapshot=="function"&&this.socketListener.requestLobbySnapshot()}}class h1{constructor(e={}){this.maxVisible=Number.isFinite(e.maxVisible)?Math.max(1,e.maxVisible):5,this.defaultTimeout=Number.isFinite(e.timeout)?e.timeout:5e3,this.notifications=new Set,this.injectStyles(),this.container=this.createContainer()}injectStyles(){if(typeof document>"u"||document.getElementById("battlecity-toast-styles"))return;const e=document.createElement("style");e.id="battlecity-toast-styles",e.textContent=`
            #battlecity-toast-container {
                position: fixed;
                inset: auto 24px 24px auto;
                display: flex;
                flex-direction: column;
                justify-content: flex-end;
                gap: 12px;
                width: min(340px, 92vw);
                z-index: 1200;
                pointer-events: none;
            }
            .battlecity-toast {
                background: rgba(16, 20, 32, 0.92);
                border-radius: 12px;
                border: 1px solid rgba(82, 104, 176, 0.35);
                box-shadow: 0 18px 40px rgba(5, 9, 20, 0.55);
                padding: 12px 16px 12px 18px;
                display: flex;
                flex-direction: column;
                gap: 6px;
                font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
                color: #ecf2ff;
                pointer-events: auto;
                cursor: pointer;
                opacity: 0;
                transform: translateY(8px);
                transition: opacity 160ms ease, transform 160ms ease;
            }
            .battlecity-toast[data-visible="true"] {
                opacity: 1;
                transform: translateY(0);
            }
            .battlecity-toast__title {
                font-weight: 600;
                letter-spacing: 0.3px;
                font-size: 14px;
            }
            .battlecity-toast__body {
                font-size: 13px;
                line-height: 1.45;
                opacity: 0.9;
            }
            .battlecity-toast[data-variant="success"] {
                border-color: rgba(82, 176, 125, 0.5);
            }
            .battlecity-toast[data-variant="warn"] {
                border-color: rgba(220, 156, 72, 0.5);
            }
            .battlecity-toast[data-variant="error"] {
                border-color: rgba(220, 92, 92, 0.5);
            }
        `,document.head.appendChild(e)}createContainer(){if(typeof document>"u")return null;let e=document.getElementById("battlecity-toast-container");return e||(e=document.createElement("div"),e.id="battlecity-toast-container",document.body.appendChild(e)),e}normaliseMessage(e){return e==null?"":Array.isArray(e)?e.filter(t=>t!=null).map(t=>`${t}`).join(" "):`${e}`}notify(e={}){if(!this.container)return null;const t=e.title?`${e.title}`:"",r=this.normaliseMessage(e.message),n=e.variant||e.level||"info",s=Number.isFinite(e.timeout)?e.timeout:this.defaultTimeout;for(;this.notifications.size>=this.maxVisible;){const l=this.notifications.values().next().value;if(!l)break;this.dismiss(l)}const o=document.createElement("div");if(o.className="battlecity-toast",o.dataset.variant=n,t){const l=document.createElement("div");l.className="battlecity-toast__title",l.textContent=t,o.appendChild(l)}if(r){const l=document.createElement("div");l.className="battlecity-toast__body",l.textContent=r,o.appendChild(l)}const a=()=>this.dismiss(o);return o.addEventListener("click",a),this.container.appendChild(o),this.notifications.add(o),requestAnimationFrame(()=>{o.dataset.visible="true"}),s>0&&(o.__battlecityTimeout=window.setTimeout(()=>this.dismiss(o),s)),o}dismiss(e){!e||!this.notifications.has(e)||(this.notifications.delete(e),e.dataset.visible="false",e.__battlecityTimeout&&window.clearTimeout(e.__battlecityTimeout),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},180))}clear(){Array.from(this.notifications).forEach(e=>this.dismiss(e))}}const ed=["Iron Vanguard","Steel Warden","Brass Rampart","Cobalt Siege","Obsidian Bastion","Chrome Juggernaut","Granite Lancer","Carbon Phalanx","Titan Howl","Copper Barrage","Lead Avalanche","Onyx Hammer","Nickel Sentry","Tungsten Brawler","Graphite Sabre","Mercury Raptor","Plasma Maul","Ironclad Echo","Steel Tempest","Rivet Spectre","Bunker Wolf","Siege Lynx","Mortar Hydra","Shrapnel Ghost","Grit Titan","Arc Bastion","Vulcan Aegis","Ferro Talon","Razor Rampart","Blast Cyclops","Warden Basilisk","Forge Kraken","Piston Revenant","Tread Harbinger","Serrated Bulwark","Verdant Mauler","Sable Vanguard","Chrome Gorgon","Thunder Pillar","Siege Rancor","Smokestack Viper","Recoil Behemoth","Ashen Paladin","Slate Raider","Oxide Marauder","Coldfire Titan","Tremor Wraith","Steel Cyclone"],f1=Array.isArray(ed)?ed.filter(i=>typeof i=="string"&&i.trim().length):[],c1=i=>Number.isFinite(i)?i<10?`0${i}`:`${i}`:"";class d1{constructor(e={}){const t=Array.isArray(e.names)&&e.names.length?e.names:f1;this.names=t.map(r=>`${r}`.trim()),this.cursor=0,this.assigned=new Map,this.usage=new Map}nextBaseName(){if(!this.names.length)return"Rampart";const e=this.names[this.cursor%this.names.length];return this.cursor=(this.cursor+1)%(this.names.length*1e3),e}buildName(e){const t=(this.usage.get(e)||0)+1;return this.usage.set(e,t),t===1?e:`${e}-${c1(t)}`}assign(e,t={}){if(e==null)return this.buildName(this.nextBaseName());const r=`${e}`;if(this.assigned.has(r))return this.assigned.get(r).name;const n=t.baseName||this.nextBaseName(),s=this.buildName(n);return this.assigned.set(r,{name:s,base:n}),s}get(e){if(e==null)return null;const t=this.assigned.get(`${e}`);return t?t.name:null}release(e){if(e==null)return;const t=`${e}`,r=this.assigned.get(t);if(!r)return;const{base:n}=r;if(this.assigned.delete(t),!n)return;const s=this.usage.get(n)||1,o=Math.max(0,s-1);o===0?this.usage.delete(n):this.usage.set(n,o)}}const gt=i=>`/${i}`,vs=V.LoaderResource||V.loaders&&V.loaders.Resource,Yn=vs?vs.LOAD_TYPE:{},rd=vs?vs.XHR_RESPONSE_TYPE:{},p1={r:255,g:0,b:255},Qr=48,Fr={heading:"Intel",lines:["Right-click a city building to inspect."]},y1=(i,e=p1)=>{if(!i||!i.data||!i.texture)return;const t=i.data,r=t.width,n=t.height,s=document.createElement("canvas");s.width=r,s.height=n;const o=s.getContext("2d");if(!o)return;o.drawImage(t,0,0);const a=o.getImageData(0,0,r,n),l=a.data;for(let h=0;h<l.length;h+=4)l[h]===e.r&&l[h+1]===e.g&&l[h+2]===e.b&&(l[h+3]=0);o.putImageData(a,0,0),i.texture&&i.texture.destroy(!0);const u=V.BaseTexture.from(s);u.alphaMode=V.ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,u.scaleMode=V.SCALE_MODES.NEAREST,i.data=s,i.texture=new V.Texture(u),i.baseTexture=u},ht=(i,e=0)=>{if(typeof i=="number"&&Number.isFinite(i))return i;if(typeof i=="string"){const t=parseInt(i,10);if(!Number.isNaN(t))return t}return e},Gt=(i,e=null)=>{const t=ht(i,e);return Number.isFinite(t)?Math.max(0,Math.floor(t)):e},Mv=i=>!i||typeof i!="string"?null:i.length<=8?i:`${i.slice(0,4)}...${i.slice(-2)}`;V.utils.isWebGLSupported();var he=new V.Application({width:Wn,height:Kn});he.renderer.plugins.interaction.cursorStyles={demolish:`url(${gt("imgDemolish.png")}), auto`,cursor:`url(${gt("imgCursor.png")}), auto`};document.getElementById("game").appendChild(he.view);var ms=new S_;ms.showPanel(0);document.getElementById("game").appendChild(ms.dom);var Lv=new V.Container,Ol=new V.Container,Rl=new V.Container,rs=null,is=null,ns=null,ss=null;const Ms=V.Loader.shared,E={map:[],tiles:[],tick:0,lastTick:0,timePassed:0,staticTick:0,textures:[],maxMapX:Wn-200,maxMapY:Kn,maxCities:0,otherPlayers:{},showBuildMenu:!1,buildMenuOffset:{x:(Wn-200)/2,y:Kn/2},buildings:{},cities:[],player:{id:-1,city:0,isMayor:!1,health:cs,isTurning:0,timeTurn:0,direction:0,defaultOffset:{x:(Wn-200)/2,y:Kn/2},offset:{x:0,y:0,vx:0,vy:0},bombsArmed:!1,lastSafeOffset:{x:0,y:0},sequence:0,isCloaked:!1,cloakExpiresAt:0,isFrozen:!1,frozenUntil:0,frozenBy:null,callsign:null},explosions:[],panelState:{heading:Fr.heading,lines:[...Fr.lines],isInventoryCollapsed:!1},defenseItems:new Map,lobby:null,app:he,stage:he.stage,objectContainer:Lv,commandCenterLabelLayer:Ol,orbHintElement:null,lastOrbHintMessage:"",nextOrbHintUpdate:0},Ls=document.createElement("div");Ls.id="orb-hint";const Vt=Ls.style;Vt.position="fixed";Vt.top="24px";Vt.right="24px";Vt.padding="10px 14px";Vt.borderRadius="12px";Vt.background="rgba(10, 18, 52, 0.82)";Vt.border="1px solid rgba(123, 152, 255, 0.35)";Vt.boxShadow="0 18px 36px rgba(0, 0, 0, 0.45)";Vt.fontFamily='"Segoe UI", Tahoma, Geneva, Verdana, sans-serif';Vt.fontSize="14px";Vt.color="#f0f6ff";Vt.letterSpacing="0.3px";Vt.maxWidth="320px";Vt.zIndex="1000";Vt.pointerEvents="none";Vt.display="none";document.body.appendChild(Ls);E.orbHintElement=Ls;E.lastOrbHintMessage="";E.callsignRegistry=new d1;E.notificationManager=new h1;E.notify=i=>E.notificationManager?E.notificationManager.notify(i):null;E.resolveCallsign=i=>{if(i==null)return null;const e=`${i}`,t=E.player&&E.player.id!==void 0?`${E.player.id}`:null;if(t&&e===t)return E.player?.callsign||null;const r=E.otherPlayers?E.otherPlayers[e]:null;if(r&&typeof r.callsign=="string"&&r.callsign.trim().length)return r.callsign;if(E.callsignRegistry&&typeof E.callsignRegistry.get=="function"){const n=E.callsignRegistry.get(e);if(n)return n}return null};E.describeKillSource=(i={})=>{if(!i)return"System Hazard";if(i.killerCallsign)return i.killerCallsign;const e=Number.isFinite(i.killerCity)?Math.max(0,Math.floor(i.killerCity)):null,r=(()=>{if(e===null)return null;const o=Array.isArray(E.cities)?E.cities[e]:null;if(o&&typeof o=="object"){if(typeof o.nameOverride=="string"&&o.nameOverride.trim().length)return o.nameOverride.trim();if(typeof o.name=="string"&&o.name.trim().length)return o.name.trim()}return Ft(e)})(),n=i.sourceType?String(i.sourceType).toLowerCase():null;if(n)switch(n){case"turret":return`${r||"City"} Turret`;case"plasma":case"plasma_cannon":return`${r||"City"} Plasma Cannon`;case"sleeper":return`${r||"City"} Sleeper Turret`;case"rogue_tank":return"Rogue Tank";case"fake_recruit":case"city_recruit":return`${r||"City"} Recruit`}const s=i.hazardType?String(i.hazardType).toLowerCase():null;if(s)switch(s){case"mine":return`${r||"City"} Mine`;case"bomb":return`${r||"City"} Bomb`;case"dfg":case"dfg_field":return`${r||"City"} DFG Field`}return"System Hazard"};E.cityFinanceFlags=new Map;E.mapOverlayActive=!1;const v1=(i,e,t=Qr)=>{let r="",n="";return Math.abs(i)>t&&(r=i>0?"east":"west"),Math.abs(e)>t&&(n=e>0?"south":"north"),r&&n?`${n}-${r}`:n||r||"nearby"},m1=i=>!i||typeof i!="string"?"":i.split("-").map(e=>e&&e.charAt(0).toUpperCase()+e.slice(1)).join("-"),g1=i=>{if(!i)return null;const e=Number.isFinite(i.x)?i.x:Qr*ht(i.tileX,0),t=Number.isFinite(i.y)?i.y:Qr*ht(i.tileY,0);return{x:e+1.5*Qr,y:t+1*Qr}},_1=(i,e)=>i&&typeof i.name=="string"&&i.name.trim().length?i.name:Ft(e),b1=Object.values(rr||{}).reduce((i,e)=>(!e||e.TYPE===void 0||(i[e.TYPE]=e.LABEL),i),{}),x1=(i,e)=>{const t={totalPopulation:0,totalBuildings:0,staffedBuildings:0,houses:0,labels:new Map};if(!i||!i.buildingFactory||typeof i.buildingFactory.getHead!="function")return t;let r=i.buildingFactory.getHead();for(;r;){if(Gt(r.city,null)===e){t.totalBuildings+=1;const s=ht(r.population,0),o=Number.isFinite(s)?Math.max(0,s):0;t.totalPopulation+=o,o>0&&(t.staffedBuildings+=1);const a=b1[r.type]||"Structure";t.labels.has(a)||t.labels.set(a,{count:0,population:0});const l=t.labels.get(a);l.count+=1,l.population+=o,a.toLowerCase().includes("house")&&(t.houses+=1)}r=r.next}return t};E.updateOrbHint=(i={})=>{const{force:e=!1}=i,t=E.orbHintElement;if(!t)return;const r=E.lobby;if(!(r&&typeof r.isInGame=="function"?r.isInGame():!1)){t.style.display!=="none"&&(t.style.display="none",E.lastOrbHintMessage="");return}const s=E.player,o=s?.offset,a=ht(o?.x,NaN),l=ht(o?.y,NaN);if(!Number.isFinite(a)||!Number.isFinite(l)){t.style.display!=="none"&&(t.style.display="none",E.lastOrbHintMessage="");return}const u=Gt(s?.city,null);let h=null;(Array.isArray(E.cities)?E.cities:[]).forEach((d,p)=>{if(!d||p===u||!d.isOrbable)return;const m=g1(d);if(!m)return;const v=m.x-a,g=m.y-l,I=v*v+g*g;Number.isFinite(I)&&(!h||I<h.distanceSq)&&(h={city:d,index:p,dx:v,dy:g,distanceSq:I})});let c;if(!h)c="No orbable cities detected yet.";else{const d=_1(h.city,h.index),p=m1(v1(h.dx,h.dy)),m=Math.sqrt(h.distanceSq),v=Math.round(m/Qr),g=v>1?` (~${v} tiles)`:"";c=`Nearest orbable city: ${d}  ${p}${g}`}!e&&c===E.lastOrbHintMessage||(t.textContent=c||"",t.style.display=c?"block":"none",E.lastOrbHintMessage=c||"")};E.updateOrbHint({force:!0});E.clearDefenseItems=i=>{const e=Gt(i,null);if(e===null)return;const t=E.defenseItems.get(e);Array.isArray(t)&&E.itemFactory&&typeof E.itemFactory.removeItemById=="function"&&t.forEach(r=>{E.itemFactory.removeItemById(r,{notifyServer:!1})}),E.defenseItems.delete(e),E.forceDraw=!0};E.applyDefenseSnapshot=(i,e)=>{const t=Gt(i,null);if(t===null||!E.itemFactory||typeof E.itemFactory.newItem!="function"||(E.clearDefenseItems(t),!Array.isArray(e)||!e.length))return;const r=[];e.forEach((n,s)=>{const o=ht(n?.type,null),a=ht(n?.x,null),l=ht(n?.y,null);if(!Number.isFinite(o)||!Number.isFinite(a)||!Number.isFinite(l))return;const u=ht(n?.teamId,t),h=typeof n?.id=="string"&&n.id.length>0?n.id:`defense_${t}_${s}`;typeof E.itemFactory.removeItemById=="function"&&E.itemFactory.removeItemById(h,{notifyServer:!1});const c={id:typeof n?.ownerId=="string"&&n.ownerId.length>0?n.ownerId:`fake_city_${t}`,city:t},d=E.itemFactory.newItem(c,a,l,o,{id:h,notifyServer:!1,teamId:u,city:u});if(d){if(d.isDefense=!0,n?.angle!==void 0){const p=ht(n.angle,null);Number.isFinite(p)&&(d.angle=p)}r.push(d.id)}}),r.length&&(E.defenseItems.set(t,r),E.forceDraw=!0)};const tn=i=>{const e=i&&typeof i.heading=="string"?i.heading:"",t=i&&Array.isArray(i.lines)?i.lines:[],r=[];t.forEach(s=>{if(s==null)return;const o=`${s}`;r.push(o)});const n=E.panelState&&typeof E.panelState=="object"?E.panelState:{};E.panelState={...n,heading:e,lines:r},E.forceDraw=!0},w1=i=>{const e=Gt(i,null);if(e===null)return null;let t=0,r=null;Gt(E.player&&E.player.city,null)===e&&(t+=1,E.player&&E.player.isMayor&&(r=E.player.id||r)),Object.keys(E.otherPlayers||{}).forEach(a=>{const l=E.otherPlayers[a];l&&Gt(l.city,null)===e&&(t+=1,!r&&l.isMayor&&(r=l.id||null))});const s=E.buildingFactory,o=s&&typeof s.countBuildingsForCity=="function"?s.countBuildingsForCity(e):0;return{cityId:e,playerCount:t,buildingCount:o,mayorId:r,mayorLabel:r?Mv(r):null}},T1=(i,e={})=>{const t=Gt(i,null);if(t===null)return{heading:Fr.heading,lines:[...Fr.lines]};const r=w1(t)||{playerCount:0,buildingCount:0,mayorId:null,mayorLabel:null},n=E.cities?.[t],s=e.cityName||n?.name||Ft(t),o=e.mayorLabel||r.mayorLabel,a=e.mayorId!==void 0?e.mayorId:r.mayorId,l=o||Mv(a)||"(unknown)",u=Number.isFinite(e.playerCount)?e.playerCount:r.playerCount,h=Number.isFinite(e.buildingCount)?e.buildingCount:r.buildingCount,f=[`Mayor:   ${l}`,`Players: ${u}`,`Size:    ${h} building${h===1?"":"s"}`];if(e.score!==void 0){const c=Number.isFinite(e.score)?e.score:ht(e.score,0);f.push(`Score:   ${c} pts`)}if(e.isOrbable&&e.orbPoints!==void 0){const c=Number.isFinite(e.orbPoints)?e.orbPoints:ht(e.orbPoints,0);f.push(`Bounty:  ${c} points`)}if(e.isOrbable&&e.orbs!==void 0){const c=Number.isFinite(e.orbs)?e.orbs:ht(e.orbs,0);f.push(`Orbs:    ${c}`)}if(e.uptimeInMinutes!==void 0&&e.uptimeInMinutes!==null){const c=Number.isFinite(e.uptimeInMinutes)?e.uptimeInMinutes:ht(e.uptimeInMinutes,0);if(Number.isFinite(c)&&c>0){const d=Math.floor(c/60),p=c%60;f.push(`Uptime:  ${d}h ${p}m`)}}return{heading:s,lines:f}};E.setPanelMessage=i=>{if(!i){tn(Fr);return}tn(i)};E.clearPanelMessage=()=>{E.mapOverlayActive=!1,tn(Fr)};E.showCityInfo=(i,e={})=>{let t=e||{},r=i;i&&typeof i=="object"&&!Array.isArray(i)&&(t=i,i.cityId!==void 0?r=i.cityId:i.city!==void 0&&(r=i.city));const n=Gt(r,null);if(n===null){tn(Fr);return}const s=T1(n,t||{});tn(s)};E.showStaffSummary=()=>{const i=Gt(E.player&&E.player.city,null);if(i===null){E.notify&&E.notify({title:"Staff Overview",message:"Join a city to view staffing information.",variant:"warn"});return}const e=x1(E,i),t=Ft(i),r=[`Population: ${e.totalPopulation}`,`Buildings: ${e.totalBuildings}`,`Staffed:   ${e.staffedBuildings}`];e.houses>0&&r.push(`Housing:  ${e.houses}`);const n=Array.from(e.labels.entries()).filter(([,s])=>s.population>0).sort((s,o)=>o[1].population-s[1].population).slice(0,3);n.length?n.forEach(([s,o])=>{r.push(`${s}: ${o.population}`)}):r.push("Factories need staff before production begins."),E.setPanelMessage({heading:`${t} Staff`,lines:r}),E.notify&&E.notify({title:"Staff Overview",message:`${t}: ${e.totalPopulation} population across ${e.totalBuildings} structures.`,variant:"info",timeout:4600}),E.forceDraw=!0};E.toggleMapOverlay=()=>{E.mapOverlayActive=!E.mapOverlayActive,E.mapOverlayActive?(E.setPanelMessage({heading:"Tactical Map",lines:["Full-screen map is still under construction.","Use the radar and right-click inspections for intel.","Notifications highlight city threats in real time."]}),E.notify&&E.notify({title:"Tactical Map",message:"Radar and notifications provide situational awareness until the full map returns.",variant:"info",timeout:5200})):E.clearPanelMessage(),E.forceDraw=!0};E.showPlayerCityInfo=()=>{const i=Gt(E.player&&E.player.city,null);if(i===null){E.notify&&E.notify({title:"City Intel",message:"Join a city to view local intel.",variant:"warn"});return}E.showCityInfo(i),E.notify&&E.notify({title:"City Intel",message:`Showing intel for ${Ft(i)} in the panel.`,variant:"info",timeout:3600})};E.showPointsSummary=()=>{const i=Gt(E.player&&E.player.city,null);if(i===null){E.notify&&E.notify({title:"Points Overview",message:"Join a city to review point totals.",variant:"warn"});return}const e=E.cities?.[i]||{},t=ht(e.score,0),r=ht(e.orbs,0),n=ht(e.orbPoints,0),s=[`City score: ${t}`,`Orbs fired: ${r}`,`Orb bounty: ${n}`,"Monthly leaderboards will surface in a future patch."];E.setPanelMessage({heading:`${Ft(i)} Points`,lines:s}),E.notify&&E.notify({title:"Points Overview",message:`${Ft(i)} currently holds ${t} points.`,variant:"info",timeout:4e3}),E.forceDraw=!0};E.openOptionsPanel=()=>{E.setPanelMessage({heading:"Options (Preview)",lines:["In-game configuration UI is still on the roadmap.","Use the lobby overlay to change cities or roles.","See AGENTS.md for developer setup and tweaks."]}),E.notify&&E.notify({title:"Options",message:"Configuration controls are coming soon. The panel lists available workarounds.",variant:"warn"}),E.forceDraw=!0};E.showHelpMessage=()=>{E.setPanelMessage({heading:"Help",lines:["Movement: WASD / Arrow keys","Fire: SHIFT    Drop item: Space    Arm bomb: B","Medkit: H    Cloak: C    DFG freeze: use from inventory","Right-click structures for city intel and build options."]}),E.notify&&E.notify({title:"Help",message:"Core controls and tips are listed in the panel. GameRules.md tracks full mechanics.",variant:"info",timeout:6e3}),E.forceDraw=!0};E.toggleBuildMenuFromPanel=()=>{E.showBuildMenu=!E.showBuildMenu,E.notify&&E.notify({title:"Build Menu",message:E.showBuildMenu?"Select a blueprint to place or choose Demolish.":"Build menu hidden.",variant:"info",timeout:3600}),E.forceDraw=!0};E.requestExitToLobby=()=>{E.lobby&&typeof E.lobby.show=="function"&&(E.lobby.show(),E.lobby.setStatus("Lobby opened. Choose a city slot or wait for the next match.",{type:"info"})),E.notify&&E.notify({title:"Exit to Lobby",message:"The lobby overlay is open. Session hand-off will improve in a future build.",variant:"warn"})};E.clearPanelMessage();E.bulletFactory=new oT(E);E.buildingFactory=new jw(E);E.socketListener=new OI(E);E.lobby=new u1(E);E.lobby.attachSocket(E.socketListener);E.iconFactory=new aT(E);E.itemFactory=new dT(E);E.rogueTankManager=new LT(E);const I1=[{name:"imgTanks",url:gt("imgTanks.png")},{name:"imgGround",url:gt("skins/BattleCityDX/imgGround.png")},{name:"imgLava",url:gt("skins/BattleCityDX/imgLava.png")},{name:"imgRocks",url:gt("skins/BattleCityDX/imgRocks.png")},{name:"imgBullets",url:gt("skins/BattleCityDX/imgBullets.png")},{name:"imgInterfaceTop",url:gt("skins/BattleCityDX/imgInterface.png")},{name:"imgInterfaceBottom",url:gt("skins/BattleCityDX/imgInterfaceBottom.png")},{name:"imgHealth",url:gt("skins/BattleCityDX/imgHealth.png")},{name:"imgBuildings",url:gt("skins/BattleCityDX/imgBuildings.png")},{name:"imgBuildIcons",url:gt("imgBuildIcons.png")},{name:"imgItems",url:gt("imgItems.png")},{name:"imgInventorySelection",url:gt("imgInventorySelection.png")},{name:"imgArrows",url:gt("imgArrows.png")},{name:"imgArrowsRed",url:gt("imgArrowsRed.png")},{name:"imgRadarColors",url:gt("imgRadarColors.png")},{name:"imgMiniMapColors",url:gt("imgMiniMapColors.png")},{name:"imgPopulation",url:gt("imgPopulation.png")},{name:"imgBlackNumbers",url:gt("imgBlackNumbers.png")},{name:"imgMoneyBox",url:gt("skins/BattleCity3.1/imgMoneyBox.png")},{name:"imgMoneyUp",url:gt("skins/BattleCity3.1/imgMoneyUp.png")},{name:"imgMoneyDown",url:gt("skins/BattleCity3.1/imgMoneyDown.png")},{name:"imgTurretBase",url:gt("skins/BattleCityDX/imgTurretBase.png")},{name:"imgTurretHead",url:gt("skins/BattleCityDX/imgTurretHead.png")},{name:"imgSmoke",url:gt("imgSmoke.png")},{name:"imgLEExplosion",url:gt("imgLExplosion.png")},{name:"imgSExplosion",url:gt("imgSExplosion.png")},{name:"mapData",url:gt("map.dat"),loadType:Yn.XHR!==void 0?Yn.XHR:1,xhrType:rd.BUFFER||"arraybuffer"},{name:"cityDemo",url:gt("cities/Balkh/demo.city"),loadType:Yn.XHR!==void 0?Yn.XHR:1,xhrType:rd.TEXT||"text"}];Ms.add(I1);Ms.onProgress.add(E1);Ms.load(S1);function E1(i,e){e&&console.log("loading: "+e.url),console.log("progress: "+i.progress+"%")}function S1(){console.log("loaded");const i=Ms.resources;var e=i.mapData.data;_b(E,e),Eb(E);const t=Cs(E.player.city);t?(E.player.offset.x=t.x,E.player.offset.y=t.y):E.cities[E.player.city]?(E.player.offset.x=E.cities[E.player.city].x+48,E.player.offset.y=E.cities[E.player.city].y+100):(E.player.offset.x=0,E.player.offset.y=0),E.player.lastSafeOffset={x:E.player.offset.x,y:E.player.offset.y},[i.imgGround,i.imgLava,i.imgRocks,i.imgBuildings,i.imgBuildIcons,i.imgItems,i.imgInventorySelection,i.imgArrows,i.imgArrowsRed,i.imgInterfaceTop,i.imgInterfaceBottom,i.imgRadarColors,i.imgMiniMapColors,i.imgTurretBase,i.imgTurretHead,i.imgPopulation,i.imgBlackNumbers,i.imgMoneyBox,i.imgMoneyUp,i.imgMoneyDown,i.imgSmoke,i.imgLEExplosion,i.imgSExplosion].forEach(n=>y1(n)),E.textures.groundTexture=i.imgGround.texture,E.textures.tankTexture=i.imgTanks.texture,E.textures.rockTexture=i.imgRocks.texture,E.textures.lavaTexture=i.imgLava.texture,E.textures.bulletTexture=i.imgBullets.texture,E.textures.interfaceTop=i.imgInterfaceTop.texture,E.textures.interfaceBottom=i.imgInterfaceBottom.texture,E.textures.imgRadarColors=i.imgRadarColors.texture,E.textures.imgMiniMapColors=i.imgMiniMapColors.texture,E.textures.health=i.imgHealth.texture,E.textures.buildings=i.imgBuildings.texture,E.textures.buildingIcons=i.imgBuildIcons.texture,E.textures.imageIcons=i.imgItems.texture,E.textures.imageItems=i.imgItems.texture,E.textures.imageInventorySelection=i.imgInventorySelection.texture,E.textures.imgArrows=i.imgArrows.texture,E.textures.imgArrowsRed=i.imgArrowsRed.texture,E.textures.imageTurretBase=i.imgTurretBase.texture,E.textures.imageTurretHead=i.imgTurretHead.texture,E.textures.population=i.imgPopulation.texture,E.textures.blackNumbers=i.imgBlackNumbers.texture,E.textures.imgMoneyBox=i.imgMoneyBox.texture,E.textures.imgMoneyUp=i.imgMoneyUp.texture,E.textures.imgMoneyDown=i.imgMoneyDown.texture,E.textures.smoke=i.imgSmoke.texture,E.textures.imageLEExplosion=i.imgLEExplosion.texture,E.textures.imgLEExplosion=i.imgLEExplosion.texture,E.textures.imageSExplosion=i.imgSExplosion.texture,Bb(E),Db(E),E.socketListener.listen(),E.itemFactory.bindSocketEvents(E.socketListener),E.socketListener.on("connected",()=>{console.log("Connected to server")}),E.socketListener.on("population:update",n=>{E.buildingFactory.applyPopulationUpdate(n)}),E.socketListener.on("building:new",n=>{n&&(E.buildingFactory.newBuilding(n.ownerId||null,n.x,n.y,n.type,{notifyServer:!1,id:n.id,population:n.population||0,attachedHouseId:n.attachedHouseId||null,city:n.city??0,itemsLeft:n.itemsLeft||0,updateCity:!1}),E.forceDraw=!0)}),E.socketListener.on("city:finance",n=>{let s=n;if(typeof n=="string")try{s=JSON.parse(n)}catch(c){console.warn("Failed to parse finance payload",c);return}if(!s)return;const o=s.id??s.city;if(o==null)return;const a=ht(o,0);E.cities[a]||(E.cities[a]={id:a,canBuild:{},cash:0,income:0,itemProduction:0,research:0,hospital:0,construction:0,grossIncome:0});const l=E.cities[a],u=E.cityFinanceFlags.get(a)||{};l.cash=ht(s.cash,l.cash??0),l.income=ht(s.income,0),l.itemProduction=ht(s.itemProduction,0),l.research=ht(s.research,0),l.hospital=ht(s.hospital,0),l.construction=ht(s.construction,0),s.grossIncome!==void 0?l.grossIncome=ht(s.grossIncome,l.grossIncome??0):l.grossIncome=l.income-(l.itemProduction+l.research+l.hospital+l.construction),s.orbPoints!==void 0&&(l.orbPoints=ht(s.orbPoints,l.orbPoints??0)),s.score!==void 0&&(l.score=ht(s.score,l.score??0)),s.orbs!==void 0&&(l.orbs=ht(s.orbs,l.orbs??0)),s.isOrbable!==void 0&&(l.isOrbable=!!s.isOrbable),s.currentBuildings!==void 0&&(l.currentBuildings=ht(s.currentBuildings,l.currentBuildings??0)),s.maxBuildings!==void 0&&(l.maxBuildings=ht(s.maxBuildings,l.maxBuildings??0)),l.updatedAt=s.updatedAt?ht(s.updatedAt,Date.now()):Date.now();const h=Gt(E.player&&E.player.city,null),f={orbable:!!l.isOrbable,negativeIncome:l.grossIncome<0,cashZero:l.cash<=0,cashLow:l.cash>0&&l.cash<Bi};if(E.cityFinanceFlags.set(a,f),h===a&&E.notify){const c=Ft(a);f.cashZero&&!u.cashZero?E.notify({title:"City Treasury Empty",message:`${c} has run out of cash. Income ticks are needed before building again.`,variant:"error"}):f.negativeIncome&&!u.negativeIncome&&E.notify({title:"Income Shortfall",message:`${c} is spending more than it earns. Consider staffing houses or pausing construction.`,variant:"warn",timeout:5200}),f.orbable&&!u.orbable&&E.notify({title:"City Orbable",message:`${c} can now be destroyed by an enemy orb. Strengthen defenses.`,variant:"warn",timeout:5200})}typeof E.updateOrbHint=="function"&&E.updateOrbHint({force:!0}),E.forceDraw=!0}),E.socketListener.on("city:info",n=>{n&&E.showCityInfo(n)}),E.socketListener.on("orb:result",n=>{if(n){if(n.status==="detonated"){const s=n.targetCity!==void 0&&n.targetCity!==null?Ft(n.targetCity):"Enemy city",o=ht(n.points,0),a=[`Destroyed ${s}.`,o>0?`Awarded ${o} points.`:null].filter(Boolean);if(E.setPanelMessage({heading:"Orb Successful",lines:a}),E.notify){const l=[`${s} destroyed.`];o>0&&l.push(`+${o} points.`),E.notify({title:"Orb Detonated",message:l.join(" "),variant:"success",timeout:5400})}E.forceDraw=!0;return}if(n.status==="idle"||n.status==="rejected"){let s="The orb failed to trigger.";n.reason==="not_orbable"?s="Target city is not orbable yet.":n.reason==="no_target"&&(s="An orb must land on an enemy command center."),E.setPanelMessage({heading:"Orb Inert",lines:[s]}),E.notify&&E.notify({title:"Orb Failed",message:s,variant:"warn",timeout:4200}),E.forceDraw=!0}}}),E.socketListener.on("city:orbed",n=>{if(!n)return;const s=Ft(n.attackerCity),o=Ft(n.targetCity),a=ht(n.points,0),l=[`${s} destroyed ${o}.`,a>0?`They earned ${a} points.`:null].filter(Boolean);if(E.setPanelMessage({heading:"City Destroyed",lines:l}),E.notify){const u=[`${s} eliminated ${o}.`];a>0&&u.push(`+${a} points.`),E.notify({title:"City Destroyed",message:u.join(" "),variant:n.targetCity===Gt(E.player&&E.player.city,null)?"error":"warn",timeout:5600})}if(Number.isFinite(n.targetCity)&&E.cities?.[n.targetCity]){const u=E.cities[n.targetCity];u.orbPoints=0,u.isOrbable=!1,u.currentBuildings=ht(u.currentBuildings,1),u.maxBuildings=Math.max(1,ht(u.maxBuildings,1)),u.updatedAt=Date.now()}E.forceDraw=!0}),E.socketListener.on("lobby:evicted",n=>{E.player&&(E.player.city=null,E.player.isMayor=!1);let s=n;if(typeof n=="string")try{s=JSON.parse(n)}catch{s={}}if(E.notify&&s){const o=typeof s.reason=="string"?s.reason:"orb",a=Gt(s.city,null),l=Gt(s.attackerCity,null),u=a!==null?Ft(a):"your city",h=l!==null?Ft(l):null,f={death:"error",orb:"error"},c=[];o==="death"?c.push(h?`${h} eliminated you.`:"You were destroyed in combat."):h?c.push(`${h} destroyed ${u}.`):c.push(`${u} was destroyed.`),Number.isFinite(s.points)&&s.points>0&&c.push(`They earned ${s.points} points.`),E.notify({title:"Evicted",message:c.join(" "),variant:f[o]||"warn",timeout:5600})}E.lobby&&typeof E.lobby.handleEviction=="function"&&E.lobby.handleEviction(n),E.forceDraw=!0}),E.socketListener.on("player:dead",n=>{if(!n||!E.notify)return;let s=n;if(typeof n=="string")try{s=JSON.parse(n)}catch(Y){console.warn("Failed to parse player:dead payload",Y);return}if(!s||!s.id)return;const o=s.reason&&typeof s.reason=="object"?s.reason:{},l=`${s.id}`,u=E.socketListener?.io?.id?`${E.socketListener.io.id}`:null,h=u&&l===u,f=s.sourceType??o.sourceType??null,c=s.hazardType??o.type??null,d=ht(s.killerCity,null),p=ht(o.teamId,null),m=ht(s.teamId,null),v=Number.isFinite(d)?Math.max(0,Math.floor(d)):Number.isFinite(p)?Math.max(0,Math.floor(p)):null,g=Number.isFinite(p)?Math.max(0,Math.floor(p)):Number.isFinite(m)?Math.max(0,Math.floor(m)):v,I=s.killerId??o.sourceId??o.shooterId??o.emitterId??o.ownerId??null,w=I!=null?`${I}`:null,M=h?E.player:E.otherPlayers?.[l]||null,b=Gt(M?.city??o.cityId??o.teamId??null,null);let R=s.callsign||E.resolveCallsign(l)||(h?"Your Tank":null);R||(R=b!==null?`${Ft(b)} Tank`:"Unknown Tank");const C=s.killerCallsign||E.resolveCallsign(w);let H=s.killerLabel&&typeof s.killerLabel=="string"?s.killerLabel:null;H||(H=E.describeKillSource({killerCallsign:C,killerCity:v,teamId:g,sourceType:f,hazardType:c})),w&&l===w&&(H="Self-Inflicted"),(!H||!H.trim().length)&&(H="Unknown Forces");const F=h?"error":"warn",B=`${R} killed by ${H}.`;E.notify({title:"Elimination",message:B,variant:F,timeout:5200})}),E.socketListener.on("build:denied",n=>{let s=n;if(typeof n=="string")try{s=JSON.parse(n)}catch(o){console.warn("Failed to parse build denied payload",o);return}s&&E.buildingFactory.handleBuildDenied(s)}),rs=new V.tilemap.CompositeRectTileLayer(0,E.textures.groundTexture,!0),is=new V.Container,ns=new V.tilemap.CompositeRectTileLayer(0,E.textures.imageItems,!0),ss=new V.tilemap.CompositeRectTileLayer(0,null,!0),Ol.removeChildren(),E.commandCenterLabelCache&&typeof E.commandCenterLabelCache.clear=="function"&&E.commandCenterLabelCache.clear(),he.stage.addChild(rs),he.stage.addChild(is),he.stage.addChild(ss),he.stage.addChild(ns),he.stage.addChild(Ol),he.stage.addChild(Lv),he.stage.addChild(Rl),Ev(E),E.forceDraw=!0,uy(E,rs),py(E,is),Av(E,ns),Sv(E,ss),Fv(E,Rl),E.forceDraw=!1,Nv()}var Mi=0,id=0;function Nv(){if(ms.begin(),E.lastTick=E.tick,E.tick=new Date().getTime(),E.timePassed=E.tick-E.lastTick,E.bulletFactory.cycle(),(!E.lobby||E.lobby.isInGame())&&E.socketListener.cycle(),E.itemFactory.cycle(),E.rogueTankManager&&E.rogueTankManager.update(),Ev(E),uy(E,rs),py(E,is),Sv(E,ss),hx(E),MI(E),Av(E,ns),Fv(E,Rl),Lb(E),typeof E.updateOrbHint=="function"){const i=Number.isFinite(E.nextOrbHintUpdate)?E.nextOrbHintUpdate:0;(!i||E.tick>=i)&&(E.updateOrbHint(),E.nextOrbHintUpdate=E.tick+500)}he.renderer.plugins.tilemap.tileAnim[0]=Mi*144,E.forceDraw=!1,ms.end(),requestAnimationFrame(Nv),E.tick>id&&(id=E.tick+300,Mi=Mi+1,Mi>=3&&(Mi=0))}
